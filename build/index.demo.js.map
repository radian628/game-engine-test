{
  "version": 3,
  "sources": ["../node_modules/is-any-array/src/index.ts", "../node_modules/ml-array-max/lib/index.js", "../node_modules/ml-array-min/lib/index.js", "../node_modules/ml-array-rescale/lib/index.js", "../node_modules/ml-matrix/matrix.js", "../src/components/renderer.ts", "../node_modules/@loaders.gl/loader-utils/dist/loader-types.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/env-utils/assert.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/env-utils/globals.js", "../node_modules/@probe.gl/env/src/lib/globals.ts", "../node_modules/@probe.gl/env/src/lib/is-electron.ts", "../node_modules/@probe.gl/env/src/lib/is-browser.ts", "../node_modules/@probe.gl/env/src/index.ts", "../node_modules/@probe.gl/log/src/utils/local-storage.ts", "../node_modules/@probe.gl/log/src/utils/formatters.ts", "../node_modules/@probe.gl/log/src/utils/color.ts", "../node_modules/@probe.gl/log/src/utils/autobind.ts", "../node_modules/@probe.gl/log/src/utils/assert.ts", "../node_modules/@probe.gl/log/src/utils/hi-res-timestamp.ts", "../node_modules/@probe.gl/log/src/log.ts", "../node_modules/@probe.gl/log/src/init.ts", "../node_modules/@probe.gl/log/src/index.ts", "../node_modules/@loaders.gl/loader-utils/dist/lib/log-utils/log.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/option-utils/merge-loader-options.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/module-utils/js-module-utils.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/env-utils/version.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/env-utils/assert.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/env-utils/globals.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-farm/worker-job.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/node/worker_threads-browser.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-utils/get-loadable-worker-url.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-utils/get-transfer-list.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-farm/worker-thread.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-farm/worker-pool.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-farm/worker-farm.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-api/get-worker-url.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/worker-api/validate-worker-version.js", "../node_modules/@loaders.gl/worker-utils/dist/lib/library-utils/library-utils.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/worker-loader-utils/parse-with-worker.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/binary-utils/get-first-characters.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/parser-utils/parse-json.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/binary-utils/array-buffer-utils.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/binary-utils/memory-copy-utils.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/iterators/async-iteration.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/path-utils/file-aliases.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/binary-utils/memory-conversion-utils.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/path-utils/path.js", "../node_modules/@loaders.gl/loader-utils/dist/lib/path-utils/get-cwd.js", "../node_modules/@loaders.gl/core/dist/javascript-utils/is-type.js", "../node_modules/@loaders.gl/core/dist/lib/fetch/fetch-error.js", "../node_modules/@loaders.gl/core/dist/lib/utils/mime-type-utils.js", "../node_modules/@loaders.gl/core/dist/lib/utils/url-utils.js", "../node_modules/@loaders.gl/core/dist/lib/utils/resource-utils.js", "../node_modules/@loaders.gl/core/dist/lib/utils/response-utils.js", "../node_modules/@loaders.gl/core/dist/lib/fetch/fetch-file.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/loggers.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/option-defaults.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/option-utils.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/normalize-loader.js", "../node_modules/@loaders.gl/core/dist/lib/api/register-loaders.js", "../node_modules/@loaders.gl/core/dist/lib/api/select-loader.js", "../node_modules/@loaders.gl/core/dist/iterators/make-iterator/make-string-iterator.js", "../node_modules/@loaders.gl/core/dist/iterators/make-iterator/make-array-buffer-iterator.js", "../node_modules/@loaders.gl/core/dist/iterators/make-iterator/make-blob-iterator.js", "../node_modules/@loaders.gl/core/dist/iterators/make-iterator/make-stream-iterator.js", "../node_modules/@loaders.gl/core/dist/iterators/make-iterator/make-iterator.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/get-data.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/get-fetch-function.js", "../node_modules/@loaders.gl/core/dist/lib/loader-utils/loader-context.js", "../node_modules/@loaders.gl/core/dist/lib/api/parse.js", "../node_modules/@loaders.gl/schema/dist/lib/table/simple-table/data-type.js", "../node_modules/@loaders.gl/schema/dist/lib/mesh/mesh-utils.js", "../node_modules/@loaders.gl/schema/dist/lib/mesh/deduce-mesh-schema.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/EXT_mesh_features.js", "../node_modules/@loaders.gl/images/dist/lib/utils/version.js", "../node_modules/@loaders.gl/images/dist/lib/category-api/image-type.js", "../node_modules/@loaders.gl/images/dist/lib/category-api/parsed-image-api.js", "../node_modules/@loaders.gl/images/dist/lib/parsers/svg-utils.js", "../node_modules/@loaders.gl/images/dist/lib/parsers/parse-to-image.js", "../node_modules/@loaders.gl/images/dist/lib/parsers/parse-to-image-bitmap.js", "../node_modules/@loaders.gl/images/dist/lib/category-api/parse-isobmff-binary.js", "../node_modules/@loaders.gl/images/dist/lib/category-api/binary-image-api.js", "../node_modules/@loaders.gl/images/dist/lib/parsers/parse-to-node-image.js", "../node_modules/@loaders.gl/images/dist/lib/parsers/parse-image.js", "../node_modules/@loaders.gl/images/dist/image-loader.js", "../node_modules/@loaders.gl/images/dist/lib/category-api/image-format.js", "../node_modules/@loaders.gl/gltf/dist/lib/utils/assert.js", "../node_modules/@loaders.gl/gltf/dist/lib/gltf-utils/gltf-constants.js", "../node_modules/@loaders.gl/gltf/dist/lib/gltf-utils/gltf-utils.js", "../node_modules/@loaders.gl/gltf/dist/lib/gltf-utils/get-typed-array.js", "../node_modules/@loaders.gl/gltf/dist/lib/api/gltf-scenegraph.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/utils/3d-tiles-utils.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/EXT_structural_metadata.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/deprecated/EXT_feature_metadata.js", "../node_modules/@loaders.gl/gltf/dist/lib/utils/version.js", "../node_modules/@loaders.gl/textures/dist/lib/utils/version.js", "../node_modules/@loaders.gl/textures/dist/lib/parsers/basis-module-loader.js", "../node_modules/@loaders.gl/textures/dist/lib/gl-extensions.js", "../node_modules/@loaders.gl/textures/dist/lib/utils/texture-formats.js", "../node_modules/@loaders.gl/textures/dist/lib/parsers/parse-ktx.js", "../node_modules/@loaders.gl/textures/dist/lib/parsers/parse-basis.js", "../node_modules/@loaders.gl/textures/dist/basis-loader.js", "../node_modules/@loaders.gl/gltf/dist/lib/parsers/parse-glb.js", "../node_modules/@loaders.gl/gltf/dist/lib/gltf-utils/resolve-url.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/EXT_meshopt_compression.js", "../node_modules/@loaders.gl/gltf/dist/meshopt/meshopt-decoder.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/EXT_texture_webp.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/KHR_texture_basisu.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/KHR_draco_mesh_compression.js", "../node_modules/@loaders.gl/draco/dist/lib/utils/version.js", "../node_modules/@loaders.gl/draco/dist/draco-loader.js", "../node_modules/@loaders.gl/draco/dist/lib/utils/get-draco-schema.js", "../node_modules/@loaders.gl/draco/dist/lib/draco-parser.js", "../node_modules/@loaders.gl/draco/dist/lib/draco-module-loader.js", "../node_modules/@loaders.gl/draco/dist/index.js", "../node_modules/@loaders.gl/gltf/dist/lib/gltf-utils/gltf-attribute-utils.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/KHR_texture_transform.js", "../node_modules/@math.gl/core/src/lib/common.ts", "../node_modules/@math.gl/core/src/classes/base/math-array.ts", "../node_modules/@math.gl/core/src/lib/validators.ts", "../node_modules/@math.gl/core/src/lib/assert.ts", "../node_modules/@math.gl/core/src/classes/base/vector.ts", "../node_modules/@math.gl/core/src/gl-matrix/common.js", "../node_modules/@math.gl/core/src/gl-matrix/vec2.ts", "../node_modules/@math.gl/core/src/lib/gl-matrix-extras.ts", "../node_modules/@math.gl/core/src/gl-matrix/vec3.ts", "../node_modules/@math.gl/core/src/classes/vector3.ts", "../node_modules/@math.gl/core/src/classes/base/matrix.ts", "../node_modules/@math.gl/core/src/gl-matrix/mat3.ts", "../node_modules/@math.gl/core/src/classes/matrix3.ts", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/deprecated/KHR_lights_punctual.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/deprecated/KHR_materials_unlit.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/deprecated/KHR_techniques_webgl.js", "../node_modules/@loaders.gl/gltf/dist/lib/api/gltf-extensions.js", "../node_modules/@loaders.gl/gltf/dist/lib/extensions/KHR_binary_gltf.js", "../node_modules/@loaders.gl/gltf/dist/lib/api/normalize-gltf-v1.js", "../node_modules/@loaders.gl/gltf/dist/lib/parsers/parse-gltf.js", "../node_modules/@loaders.gl/gltf/dist/gltf-loader.js", "../node_modules/@loaders.gl/gltf/dist/lib/api/post-process-gltf.js", "../src/components/physics-components.ts", "../src/mesh-generation.ts", "raw-ns:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\lighting.wgsl?raw", "wgsl:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\lighting.wgsl", "../node_modules/ml-matrix/matrix.mjs", "../src/matrix.ts", "../src/components/lighting.ts", "raw-ns:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\gbuffer.wgsl?raw", "wgsl:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\gbuffer.wgsl", "../src/components/geometry.ts", "raw-ns:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\particles.wgsl?raw", "wgsl:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\particles.wgsl", "raw-ns:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\components\\particle-forcefield.wgsl?raw", "../src/components/particle-system.ts", "../src/components/postprocess.ts", "../src/shaders/string-utils.ts", "../node_modules/wgsl_reflect/src/reflect/info.ts", "../node_modules/wgsl_reflect/src/utils/float.ts", "../node_modules/wgsl_reflect/src/utils/texture_sample.ts", "../node_modules/wgsl_reflect/src/utils/texture_format_info.ts", "../node_modules/wgsl_reflect/src/wgsl_ast.ts", "../node_modules/wgsl_reflect/src/wgsl_scanner.ts", "../node_modules/wgsl_reflect/src/utils/cast.ts", "../node_modules/wgsl_reflect/src/reflect/reflect.ts", "../node_modules/wgsl_reflect/src/exec/exec_context.ts", "../node_modules/wgsl_reflect/src/exec/exec_interface.ts", "../node_modules/wgsl_reflect/src/exec/builtin_functions.ts", "../node_modules/wgsl_reflect/src/utils/matrix.ts", "../node_modules/wgsl_reflect/src/wgsl_exec.ts", "../node_modules/wgsl_reflect/src/ast/parse_context.ts", "../node_modules/wgsl_reflect/src/wgsl_parser.ts", "../node_modules/wgsl_reflect/src/wgsl_reflect.ts", "../node_modules/wgsl_reflect/src/exec/command.ts", "../node_modules/wgsl_reflect/src/exec/stack_frame.ts", "../node_modules/wgsl_reflect/src/exec/exec_stack.ts", "../node_modules/wgsl_reflect/src/wgsl_debug.ts", "raw-ns:C:\\Users\\baker\\Documents\\GitHub\\game-engine-test\\src\\shaders\\simple-filter.wgsl?raw", "../src/shaders/simple-filter.ts", "../src/components/player-controller.ts", "../src/index.demo.ts"],
  "sourcesContent": ["// eslint-disable-next-line @typescript-eslint/unbound-method\nconst toString = Object.prototype.toString;\n\nexport type AnyArray =\n  | any[] // eslint-disable-line @typescript-eslint/no-explicit-any\n  | Int8Array\n  | Uint8Array\n  | Uint8ClampedArray\n  | Int16Array\n  | Uint16Array\n  | Int32Array\n  | Uint32Array\n  | Float32Array\n  | Float64Array;\n\n/**\n * Checks if an object is an instance of an Array (array or typed array, except those that contain bigint values).\n *\n * @param value - Object to check.\n * @returns True if the object is an array or a typed array.\n */\nexport function isAnyArray(value: unknown): value is AnyArray {\n  const tag = toString.call(value);\n  return tag.endsWith('Array]') && !tag.includes('Big');\n}\n", "'use strict';\n\nvar isAnyArray = require('is-any-array');\n\nfunction max(input, options = {}) {\n  if (!isAnyArray.isAnyArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  const { fromIndex = 0, toIndex = input.length } = options;\n\n  if (\n    fromIndex < 0 ||\n    fromIndex >= input.length ||\n    !Number.isInteger(fromIndex)\n  ) {\n    throw new Error('fromIndex must be a positive integer smaller than length');\n  }\n\n  if (\n    toIndex <= fromIndex ||\n    toIndex > input.length ||\n    !Number.isInteger(toIndex)\n  ) {\n    throw new Error(\n      'toIndex must be an integer greater than fromIndex and at most equal to length',\n    );\n  }\n\n  let maxValue = input[fromIndex];\n  for (let i = fromIndex + 1; i < toIndex; i++) {\n    if (input[i] > maxValue) maxValue = input[i];\n  }\n  return maxValue;\n}\n\nmodule.exports = max;\n", "'use strict';\n\nvar isAnyArray = require('is-any-array');\n\nfunction min(input, options = {}) {\n  if (!isAnyArray.isAnyArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  const { fromIndex = 0, toIndex = input.length } = options;\n\n  if (\n    fromIndex < 0 ||\n    fromIndex >= input.length ||\n    !Number.isInteger(fromIndex)\n  ) {\n    throw new Error('fromIndex must be a positive integer smaller than length');\n  }\n\n  if (\n    toIndex <= fromIndex ||\n    toIndex > input.length ||\n    !Number.isInteger(toIndex)\n  ) {\n    throw new Error(\n      'toIndex must be an integer greater than fromIndex and at most equal to length',\n    );\n  }\n\n  let minValue = input[fromIndex];\n  for (let i = fromIndex + 1; i < toIndex; i++) {\n    if (input[i] < minValue) minValue = input[i];\n  }\n  return minValue;\n}\n\nmodule.exports = min;\n", "'use strict';\n\nvar isAnyArray = require('is-any-array');\nvar max = require('ml-array-max');\nvar min = require('ml-array-min');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar max__default = /*#__PURE__*/_interopDefaultLegacy(max);\nvar min__default = /*#__PURE__*/_interopDefaultLegacy(min);\n\nfunction rescale(input, options = {}) {\n  if (!isAnyArray.isAnyArray(input)) {\n    throw new TypeError('input must be an array');\n  } else if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  let output;\n  if (options.output !== undefined) {\n    if (!isAnyArray.isAnyArray(options.output)) {\n      throw new TypeError('output option must be an array if specified');\n    }\n    output = options.output;\n  } else {\n    output = new Array(input.length);\n  }\n\n  const currentMin = min__default['default'](input);\n  const currentMax = max__default['default'](input);\n\n  if (currentMin === currentMax) {\n    throw new RangeError(\n      'minimum and maximum input values are equal. Cannot rescale a constant array',\n    );\n  }\n\n  const {\n    min: minValue = options.autoMinMax ? currentMin : 0,\n    max: maxValue = options.autoMinMax ? currentMax : 1,\n  } = options;\n\n  if (minValue >= maxValue) {\n    throw new RangeError('min option must be smaller than max option');\n  }\n\n  const factor = (maxValue - minValue) / (currentMax - currentMin);\n  for (let i = 0; i < input.length; i++) {\n    output[i] = (input[i] - currentMin) * factor + minValue;\n  }\n\n  return output;\n}\n\nmodule.exports = rescale;\n", "'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar isAnyArray = require('is-any-array');\nvar rescale = require('ml-array-rescale');\n\nconst indent = ' '.repeat(2);\nconst indentData = ' '.repeat(4);\n\n/**\n * @this {Matrix}\n * @returns {string}\n */\nfunction inspectMatrix() {\n  return inspectMatrixWithOptions(this);\n}\n\nfunction inspectMatrixWithOptions(matrix, options = {}) {\n  const {\n    maxRows = 15,\n    maxColumns = 10,\n    maxNumSize = 8,\n    padMinus = 'auto',\n  } = options;\n  return `${matrix.constructor.name} {\n${indent}[\n${indentData}${inspectData(matrix, maxRows, maxColumns, maxNumSize, padMinus)}\n${indent}]\n${indent}rows: ${matrix.rows}\n${indent}columns: ${matrix.columns}\n}`;\n}\n\nfunction inspectData(matrix, maxRows, maxColumns, maxNumSize, padMinus) {\n  const { rows, columns } = matrix;\n  const maxI = Math.min(rows, maxRows);\n  const maxJ = Math.min(columns, maxColumns);\n  const result = [];\n\n  if (padMinus === 'auto') {\n    padMinus = false;\n    loop: for (let i = 0; i < maxI; i++) {\n      for (let j = 0; j < maxJ; j++) {\n        if (matrix.get(i, j) < 0) {\n          padMinus = true;\n          break loop;\n        }\n      }\n    }\n  }\n\n  for (let i = 0; i < maxI; i++) {\n    let line = [];\n    for (let j = 0; j < maxJ; j++) {\n      line.push(formatNumber(matrix.get(i, j), maxNumSize, padMinus));\n    }\n    result.push(`${line.join(' ')}`);\n  }\n  if (maxJ !== columns) {\n    result[result.length - 1] += ` ... ${columns - maxColumns} more columns`;\n  }\n  if (maxI !== rows) {\n    result.push(`... ${rows - maxRows} more rows`);\n  }\n  return result.join(`\\n${indentData}`);\n}\n\nfunction formatNumber(num, maxNumSize, padMinus) {\n  return (\n    num >= 0 && padMinus\n      ? ` ${formatNumber2(num, maxNumSize - 1)}`\n      : formatNumber2(num, maxNumSize)\n  ).padEnd(maxNumSize);\n}\n\nfunction formatNumber2(num, len) {\n  // small.length numbers should be as is\n  let str = num.toString();\n  if (str.length <= len) return str;\n\n  // (7)'0.00123' is better then (7)'1.23e-2'\n  // (8)'0.000123' is worse then (7)'1.23e-3',\n  let fix = num.toFixed(len);\n  if (fix.length > len) {\n    fix = num.toFixed(Math.max(0, len - (fix.length - len)));\n  }\n  if (\n    fix.length <= len &&\n    !fix.startsWith('0.000') &&\n    !fix.startsWith('-0.000')\n  ) {\n    return fix;\n  }\n\n  // well, if it's still too long the user should've used longer numbers\n  let exp = num.toExponential(len);\n  if (exp.length > len) {\n    exp = num.toExponential(Math.max(0, len - (exp.length - len)));\n  }\n  return exp.slice(0);\n}\n\nfunction installMathOperations(AbstractMatrix, Matrix) {\n  AbstractMatrix.prototype.add = function add(value) {\n    if (typeof value === 'number') return this.addS(value);\n    return this.addM(value);\n  };\n\n  AbstractMatrix.prototype.addS = function addS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.addM = function addM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.add = function add(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.add(value);\n  };\n\n  AbstractMatrix.prototype.sub = function sub(value) {\n    if (typeof value === 'number') return this.subS(value);\n    return this.subM(value);\n  };\n\n  AbstractMatrix.prototype.subS = function subS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.subM = function subM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.sub = function sub(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.sub(value);\n  };\n  AbstractMatrix.prototype.subtract = AbstractMatrix.prototype.sub;\n  AbstractMatrix.prototype.subtractS = AbstractMatrix.prototype.subS;\n  AbstractMatrix.prototype.subtractM = AbstractMatrix.prototype.subM;\n  AbstractMatrix.subtract = AbstractMatrix.sub;\n\n  AbstractMatrix.prototype.mul = function mul(value) {\n    if (typeof value === 'number') return this.mulS(value);\n    return this.mulM(value);\n  };\n\n  AbstractMatrix.prototype.mulS = function mulS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.mulM = function mulM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.mul = function mul(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.mul(value);\n  };\n  AbstractMatrix.prototype.multiply = AbstractMatrix.prototype.mul;\n  AbstractMatrix.prototype.multiplyS = AbstractMatrix.prototype.mulS;\n  AbstractMatrix.prototype.multiplyM = AbstractMatrix.prototype.mulM;\n  AbstractMatrix.multiply = AbstractMatrix.mul;\n\n  AbstractMatrix.prototype.div = function div(value) {\n    if (typeof value === 'number') return this.divS(value);\n    return this.divM(value);\n  };\n\n  AbstractMatrix.prototype.divS = function divS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.divM = function divM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.div = function div(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.div(value);\n  };\n  AbstractMatrix.prototype.divide = AbstractMatrix.prototype.div;\n  AbstractMatrix.prototype.divideS = AbstractMatrix.prototype.divS;\n  AbstractMatrix.prototype.divideM = AbstractMatrix.prototype.divM;\n  AbstractMatrix.divide = AbstractMatrix.div;\n\n  AbstractMatrix.prototype.mod = function mod(value) {\n    if (typeof value === 'number') return this.modS(value);\n    return this.modM(value);\n  };\n\n  AbstractMatrix.prototype.modS = function modS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) % value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.modM = function modM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) % matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.mod = function mod(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.mod(value);\n  };\n  AbstractMatrix.prototype.modulus = AbstractMatrix.prototype.mod;\n  AbstractMatrix.prototype.modulusS = AbstractMatrix.prototype.modS;\n  AbstractMatrix.prototype.modulusM = AbstractMatrix.prototype.modM;\n  AbstractMatrix.modulus = AbstractMatrix.mod;\n\n  AbstractMatrix.prototype.and = function and(value) {\n    if (typeof value === 'number') return this.andS(value);\n    return this.andM(value);\n  };\n\n  AbstractMatrix.prototype.andS = function andS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) & value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.andM = function andM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) & matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.and = function and(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.and(value);\n  };\n\n  AbstractMatrix.prototype.or = function or(value) {\n    if (typeof value === 'number') return this.orS(value);\n    return this.orM(value);\n  };\n\n  AbstractMatrix.prototype.orS = function orS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) | value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.orM = function orM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) | matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.or = function or(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.or(value);\n  };\n\n  AbstractMatrix.prototype.xor = function xor(value) {\n    if (typeof value === 'number') return this.xorS(value);\n    return this.xorM(value);\n  };\n\n  AbstractMatrix.prototype.xorS = function xorS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) ^ value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.xorM = function xorM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) ^ matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.xor = function xor(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.xor(value);\n  };\n\n  AbstractMatrix.prototype.leftShift = function leftShift(value) {\n    if (typeof value === 'number') return this.leftShiftS(value);\n    return this.leftShiftM(value);\n  };\n\n  AbstractMatrix.prototype.leftShiftS = function leftShiftS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) << value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.leftShiftM = function leftShiftM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) << matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.leftShift = function leftShift(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.leftShift(value);\n  };\n\n  AbstractMatrix.prototype.signPropagatingRightShift = function signPropagatingRightShift(value) {\n    if (typeof value === 'number') return this.signPropagatingRightShiftS(value);\n    return this.signPropagatingRightShiftM(value);\n  };\n\n  AbstractMatrix.prototype.signPropagatingRightShiftS = function signPropagatingRightShiftS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) >> value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.signPropagatingRightShiftM = function signPropagatingRightShiftM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) >> matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.signPropagatingRightShift = function signPropagatingRightShift(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.signPropagatingRightShift(value);\n  };\n\n  AbstractMatrix.prototype.rightShift = function rightShift(value) {\n    if (typeof value === 'number') return this.rightShiftS(value);\n    return this.rightShiftM(value);\n  };\n\n  AbstractMatrix.prototype.rightShiftS = function rightShiftS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) >>> value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.rightShiftM = function rightShiftM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) >>> matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.rightShift = function rightShift(matrix, value) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.rightShift(value);\n  };\n  AbstractMatrix.prototype.zeroFillRightShift = AbstractMatrix.prototype.rightShift;\n  AbstractMatrix.prototype.zeroFillRightShiftS = AbstractMatrix.prototype.rightShiftS;\n  AbstractMatrix.prototype.zeroFillRightShiftM = AbstractMatrix.prototype.rightShiftM;\n  AbstractMatrix.zeroFillRightShift = AbstractMatrix.rightShift;\n\n  AbstractMatrix.prototype.not = function not() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, ~(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.not = function not(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.not();\n  };\n\n  AbstractMatrix.prototype.abs = function abs() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.abs(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.abs = function abs(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.abs();\n  };\n\n  AbstractMatrix.prototype.acos = function acos() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.acos(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.acos = function acos(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.acos();\n  };\n\n  AbstractMatrix.prototype.acosh = function acosh() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.acosh(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.acosh = function acosh(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.acosh();\n  };\n\n  AbstractMatrix.prototype.asin = function asin() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.asin(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.asin = function asin(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.asin();\n  };\n\n  AbstractMatrix.prototype.asinh = function asinh() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.asinh(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.asinh = function asinh(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.asinh();\n  };\n\n  AbstractMatrix.prototype.atan = function atan() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.atan(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.atan = function atan(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.atan();\n  };\n\n  AbstractMatrix.prototype.atanh = function atanh() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.atanh(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.atanh = function atanh(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.atanh();\n  };\n\n  AbstractMatrix.prototype.cbrt = function cbrt() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.cbrt(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.cbrt = function cbrt(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.cbrt();\n  };\n\n  AbstractMatrix.prototype.ceil = function ceil() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.ceil(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.ceil = function ceil(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.ceil();\n  };\n\n  AbstractMatrix.prototype.clz32 = function clz32() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.clz32(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.clz32 = function clz32(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.clz32();\n  };\n\n  AbstractMatrix.prototype.cos = function cos() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.cos(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.cos = function cos(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.cos();\n  };\n\n  AbstractMatrix.prototype.cosh = function cosh() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.cosh(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.cosh = function cosh(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.cosh();\n  };\n\n  AbstractMatrix.prototype.exp = function exp() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.exp(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.exp = function exp(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.exp();\n  };\n\n  AbstractMatrix.prototype.expm1 = function expm1() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.expm1(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.expm1 = function expm1(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.expm1();\n  };\n\n  AbstractMatrix.prototype.floor = function floor() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.floor(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.floor = function floor(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.floor();\n  };\n\n  AbstractMatrix.prototype.fround = function fround() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.fround(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.fround = function fround(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.fround();\n  };\n\n  AbstractMatrix.prototype.log = function log() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.log(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.log = function log(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.log();\n  };\n\n  AbstractMatrix.prototype.log1p = function log1p() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.log1p(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.log1p = function log1p(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.log1p();\n  };\n\n  AbstractMatrix.prototype.log10 = function log10() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.log10(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.log10 = function log10(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.log10();\n  };\n\n  AbstractMatrix.prototype.log2 = function log2() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.log2(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.log2 = function log2(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.log2();\n  };\n\n  AbstractMatrix.prototype.round = function round() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.round(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.round = function round(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.round();\n  };\n\n  AbstractMatrix.prototype.sign = function sign() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.sign(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.sign = function sign(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.sign();\n  };\n\n  AbstractMatrix.prototype.sin = function sin() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.sin(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.sin = function sin(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.sin();\n  };\n\n  AbstractMatrix.prototype.sinh = function sinh() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.sinh(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.sinh = function sinh(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.sinh();\n  };\n\n  AbstractMatrix.prototype.sqrt = function sqrt() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.sqrt(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.sqrt = function sqrt(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.sqrt();\n  };\n\n  AbstractMatrix.prototype.tan = function tan() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.tan(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.tan = function tan(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.tan();\n  };\n\n  AbstractMatrix.prototype.tanh = function tanh() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.tanh(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.tanh = function tanh(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.tanh();\n  };\n\n  AbstractMatrix.prototype.trunc = function trunc() {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, Math.trunc(this.get(i, j)));\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.trunc = function trunc(matrix) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.trunc();\n  };\n\n  AbstractMatrix.pow = function pow(matrix, arg0) {\n    const newMatrix = new Matrix(matrix);\n    return newMatrix.pow(arg0);\n  };\n\n  AbstractMatrix.prototype.pow = function pow(value) {\n    if (typeof value === 'number') return this.powS(value);\n    return this.powM(value);\n  };\n\n  AbstractMatrix.prototype.powS = function powS(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) ** value);\n      }\n    }\n    return this;\n  };\n\n  AbstractMatrix.prototype.powM = function powM(matrix) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n      this.columns !== matrix.columns) {\n      throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) ** matrix.get(i, j));\n      }\n    }\n    return this;\n  };\n}\n\n/**\n * @private\n * Check that a row index is not out of bounds\n * @param {Matrix} matrix\n * @param {number} index\n * @param {boolean} [outer]\n */\nfunction checkRowIndex(matrix, index, outer) {\n  let max = outer ? matrix.rows : matrix.rows - 1;\n  if (index < 0 || index > max) {\n    throw new RangeError('Row index out of range');\n  }\n}\n\n/**\n * @private\n * Check that a column index is not out of bounds\n * @param {Matrix} matrix\n * @param {number} index\n * @param {boolean} [outer]\n */\nfunction checkColumnIndex(matrix, index, outer) {\n  let max = outer ? matrix.columns : matrix.columns - 1;\n  if (index < 0 || index > max) {\n    throw new RangeError('Column index out of range');\n  }\n}\n\n/**\n * @private\n * Check that the provided vector is an array with the right length\n * @param {Matrix} matrix\n * @param {Array|Matrix} vector\n * @return {Array}\n * @throws {RangeError}\n */\nfunction checkRowVector(matrix, vector) {\n  if (vector.to1DArray) {\n    vector = vector.to1DArray();\n  }\n  if (vector.length !== matrix.columns) {\n    throw new RangeError(\n      'vector size must be the same as the number of columns',\n    );\n  }\n  return vector;\n}\n\n/**\n * @private\n * Check that the provided vector is an array with the right length\n * @param {Matrix} matrix\n * @param {Array|Matrix} vector\n * @return {Array}\n * @throws {RangeError}\n */\nfunction checkColumnVector(matrix, vector) {\n  if (vector.to1DArray) {\n    vector = vector.to1DArray();\n  }\n  if (vector.length !== matrix.rows) {\n    throw new RangeError('vector size must be the same as the number of rows');\n  }\n  return vector;\n}\n\nfunction checkRowIndices(matrix, rowIndices) {\n  if (!isAnyArray.isAnyArray(rowIndices)) {\n    throw new TypeError('row indices must be an array');\n  }\n\n  for (let i = 0; i < rowIndices.length; i++) {\n    if (rowIndices[i] < 0 || rowIndices[i] >= matrix.rows) {\n      throw new RangeError('row indices are out of range');\n    }\n  }\n}\n\nfunction checkColumnIndices(matrix, columnIndices) {\n  if (!isAnyArray.isAnyArray(columnIndices)) {\n    throw new TypeError('column indices must be an array');\n  }\n\n  for (let i = 0; i < columnIndices.length; i++) {\n    if (columnIndices[i] < 0 || columnIndices[i] >= matrix.columns) {\n      throw new RangeError('column indices are out of range');\n    }\n  }\n}\n\nfunction checkRange(matrix, startRow, endRow, startColumn, endColumn) {\n  if (arguments.length !== 5) {\n    throw new RangeError('expected 4 arguments');\n  }\n  checkNumber('startRow', startRow);\n  checkNumber('endRow', endRow);\n  checkNumber('startColumn', startColumn);\n  checkNumber('endColumn', endColumn);\n  if (\n    startRow > endRow ||\n    startColumn > endColumn ||\n    startRow < 0 ||\n    startRow >= matrix.rows ||\n    endRow < 0 ||\n    endRow >= matrix.rows ||\n    startColumn < 0 ||\n    startColumn >= matrix.columns ||\n    endColumn < 0 ||\n    endColumn >= matrix.columns\n  ) {\n    throw new RangeError('Submatrix indices are out of range');\n  }\n}\n\nfunction newArray(length, value = 0) {\n  let array = [];\n  for (let i = 0; i < length; i++) {\n    array.push(value);\n  }\n  return array;\n}\n\nfunction checkNumber(name, value) {\n  if (typeof value !== 'number') {\n    throw new TypeError(`${name} must be a number`);\n  }\n}\n\nfunction checkNonEmpty(matrix) {\n  if (matrix.isEmpty()) {\n    throw new Error('Empty matrix has no elements to index');\n  }\n}\n\nfunction sumByRow(matrix) {\n  let sum = newArray(matrix.rows);\n  for (let i = 0; i < matrix.rows; ++i) {\n    for (let j = 0; j < matrix.columns; ++j) {\n      sum[i] += matrix.get(i, j);\n    }\n  }\n  return sum;\n}\n\nfunction sumByColumn(matrix) {\n  let sum = newArray(matrix.columns);\n  for (let i = 0; i < matrix.rows; ++i) {\n    for (let j = 0; j < matrix.columns; ++j) {\n      sum[j] += matrix.get(i, j);\n    }\n  }\n  return sum;\n}\n\nfunction sumAll(matrix) {\n  let v = 0;\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      v += matrix.get(i, j);\n    }\n  }\n  return v;\n}\n\nfunction productByRow(matrix) {\n  let sum = newArray(matrix.rows, 1);\n  for (let i = 0; i < matrix.rows; ++i) {\n    for (let j = 0; j < matrix.columns; ++j) {\n      sum[i] *= matrix.get(i, j);\n    }\n  }\n  return sum;\n}\n\nfunction productByColumn(matrix) {\n  let sum = newArray(matrix.columns, 1);\n  for (let i = 0; i < matrix.rows; ++i) {\n    for (let j = 0; j < matrix.columns; ++j) {\n      sum[j] *= matrix.get(i, j);\n    }\n  }\n  return sum;\n}\n\nfunction productAll(matrix) {\n  let v = 1;\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      v *= matrix.get(i, j);\n    }\n  }\n  return v;\n}\n\nfunction varianceByRow(matrix, unbiased, mean) {\n  const rows = matrix.rows;\n  const cols = matrix.columns;\n  const variance = [];\n\n  for (let i = 0; i < rows; i++) {\n    let sum1 = 0;\n    let sum2 = 0;\n    let x = 0;\n    for (let j = 0; j < cols; j++) {\n      x = matrix.get(i, j) - mean[i];\n      sum1 += x;\n      sum2 += x * x;\n    }\n    if (unbiased) {\n      variance.push((sum2 - (sum1 * sum1) / cols) / (cols - 1));\n    } else {\n      variance.push((sum2 - (sum1 * sum1) / cols) / cols);\n    }\n  }\n  return variance;\n}\n\nfunction varianceByColumn(matrix, unbiased, mean) {\n  const rows = matrix.rows;\n  const cols = matrix.columns;\n  const variance = [];\n\n  for (let j = 0; j < cols; j++) {\n    let sum1 = 0;\n    let sum2 = 0;\n    let x = 0;\n    for (let i = 0; i < rows; i++) {\n      x = matrix.get(i, j) - mean[j];\n      sum1 += x;\n      sum2 += x * x;\n    }\n    if (unbiased) {\n      variance.push((sum2 - (sum1 * sum1) / rows) / (rows - 1));\n    } else {\n      variance.push((sum2 - (sum1 * sum1) / rows) / rows);\n    }\n  }\n  return variance;\n}\n\nfunction varianceAll(matrix, unbiased, mean) {\n  const rows = matrix.rows;\n  const cols = matrix.columns;\n  const size = rows * cols;\n\n  let sum1 = 0;\n  let sum2 = 0;\n  let x = 0;\n  for (let i = 0; i < rows; i++) {\n    for (let j = 0; j < cols; j++) {\n      x = matrix.get(i, j) - mean;\n      sum1 += x;\n      sum2 += x * x;\n    }\n  }\n  if (unbiased) {\n    return (sum2 - (sum1 * sum1) / size) / (size - 1);\n  } else {\n    return (sum2 - (sum1 * sum1) / size) / size;\n  }\n}\n\nfunction centerByRow(matrix, mean) {\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      matrix.set(i, j, matrix.get(i, j) - mean[i]);\n    }\n  }\n}\n\nfunction centerByColumn(matrix, mean) {\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      matrix.set(i, j, matrix.get(i, j) - mean[j]);\n    }\n  }\n}\n\nfunction centerAll(matrix, mean) {\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      matrix.set(i, j, matrix.get(i, j) - mean);\n    }\n  }\n}\n\nfunction getScaleByRow(matrix) {\n  const scale = [];\n  for (let i = 0; i < matrix.rows; i++) {\n    let sum = 0;\n    for (let j = 0; j < matrix.columns; j++) {\n      sum += matrix.get(i, j) ** 2 / (matrix.columns - 1);\n    }\n    scale.push(Math.sqrt(sum));\n  }\n  return scale;\n}\n\nfunction scaleByRow(matrix, scale) {\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      matrix.set(i, j, matrix.get(i, j) / scale[i]);\n    }\n  }\n}\n\nfunction getScaleByColumn(matrix) {\n  const scale = [];\n  for (let j = 0; j < matrix.columns; j++) {\n    let sum = 0;\n    for (let i = 0; i < matrix.rows; i++) {\n      sum += matrix.get(i, j) ** 2 / (matrix.rows - 1);\n    }\n    scale.push(Math.sqrt(sum));\n  }\n  return scale;\n}\n\nfunction scaleByColumn(matrix, scale) {\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      matrix.set(i, j, matrix.get(i, j) / scale[j]);\n    }\n  }\n}\n\nfunction getScaleAll(matrix) {\n  const divider = matrix.size - 1;\n  let sum = 0;\n  for (let j = 0; j < matrix.columns; j++) {\n    for (let i = 0; i < matrix.rows; i++) {\n      sum += matrix.get(i, j) ** 2 / divider;\n    }\n  }\n  return Math.sqrt(sum);\n}\n\nfunction scaleAll(matrix, scale) {\n  for (let i = 0; i < matrix.rows; i++) {\n    for (let j = 0; j < matrix.columns; j++) {\n      matrix.set(i, j, matrix.get(i, j) / scale);\n    }\n  }\n}\n\nclass AbstractMatrix {\n  static from1DArray(newRows, newColumns, newData) {\n    let length = newRows * newColumns;\n    if (length !== newData.length) {\n      throw new RangeError('data length does not match given dimensions');\n    }\n    let newMatrix = new Matrix(newRows, newColumns);\n    for (let row = 0; row < newRows; row++) {\n      for (let column = 0; column < newColumns; column++) {\n        newMatrix.set(row, column, newData[row * newColumns + column]);\n      }\n    }\n    return newMatrix;\n  }\n\n  static rowVector(newData) {\n    let vector = new Matrix(1, newData.length);\n    for (let i = 0; i < newData.length; i++) {\n      vector.set(0, i, newData[i]);\n    }\n    return vector;\n  }\n\n  static columnVector(newData) {\n    let vector = new Matrix(newData.length, 1);\n    for (let i = 0; i < newData.length; i++) {\n      vector.set(i, 0, newData[i]);\n    }\n    return vector;\n  }\n\n  static zeros(rows, columns) {\n    return new Matrix(rows, columns);\n  }\n\n  static ones(rows, columns) {\n    return new Matrix(rows, columns).fill(1);\n  }\n\n  static rand(rows, columns, options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { random = Math.random } = options;\n    let matrix = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        matrix.set(i, j, random());\n      }\n    }\n    return matrix;\n  }\n\n  static randInt(rows, columns, options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { min = 0, max = 1000, random = Math.random } = options;\n    if (!Number.isInteger(min)) throw new TypeError('min must be an integer');\n    if (!Number.isInteger(max)) throw new TypeError('max must be an integer');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let interval = max - min;\n    let matrix = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        let value = min + Math.round(random() * interval);\n        matrix.set(i, j, value);\n      }\n    }\n    return matrix;\n  }\n\n  static eye(rows, columns, value) {\n    if (columns === undefined) columns = rows;\n    if (value === undefined) value = 1;\n    let min = Math.min(rows, columns);\n    let matrix = this.zeros(rows, columns);\n    for (let i = 0; i < min; i++) {\n      matrix.set(i, i, value);\n    }\n    return matrix;\n  }\n\n  static diag(data, rows, columns) {\n    let l = data.length;\n    if (rows === undefined) rows = l;\n    if (columns === undefined) columns = rows;\n    let min = Math.min(l, rows, columns);\n    let matrix = this.zeros(rows, columns);\n    for (let i = 0; i < min; i++) {\n      matrix.set(i, i, data[i]);\n    }\n    return matrix;\n  }\n\n  static min(matrix1, matrix2) {\n    matrix1 = this.checkMatrix(matrix1);\n    matrix2 = this.checkMatrix(matrix2);\n    let rows = matrix1.rows;\n    let columns = matrix1.columns;\n    let result = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        result.set(i, j, Math.min(matrix1.get(i, j), matrix2.get(i, j)));\n      }\n    }\n    return result;\n  }\n\n  static max(matrix1, matrix2) {\n    matrix1 = this.checkMatrix(matrix1);\n    matrix2 = this.checkMatrix(matrix2);\n    let rows = matrix1.rows;\n    let columns = matrix1.columns;\n    let result = new this(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        result.set(i, j, Math.max(matrix1.get(i, j), matrix2.get(i, j)));\n      }\n    }\n    return result;\n  }\n\n  static checkMatrix(value) {\n    return AbstractMatrix.isMatrix(value) ? value : new Matrix(value);\n  }\n\n  static isMatrix(value) {\n    return value != null && value.klass === 'Matrix';\n  }\n\n  get size() {\n    return this.rows * this.columns;\n  }\n\n  apply(callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('callback must be a function');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        callback.call(this, i, j);\n      }\n    }\n    return this;\n  }\n\n  to1DArray() {\n    let array = [];\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        array.push(this.get(i, j));\n      }\n    }\n    return array;\n  }\n\n  to2DArray() {\n    let copy = [];\n    for (let i = 0; i < this.rows; i++) {\n      copy.push([]);\n      for (let j = 0; j < this.columns; j++) {\n        copy[i].push(this.get(i, j));\n      }\n    }\n    return copy;\n  }\n\n  toJSON() {\n    return this.to2DArray();\n  }\n\n  isRowVector() {\n    return this.rows === 1;\n  }\n\n  isColumnVector() {\n    return this.columns === 1;\n  }\n\n  isVector() {\n    return this.rows === 1 || this.columns === 1;\n  }\n\n  isSquare() {\n    return this.rows === this.columns;\n  }\n\n  isEmpty() {\n    return this.rows === 0 || this.columns === 0;\n  }\n\n  isSymmetric() {\n    if (this.isSquare()) {\n      for (let i = 0; i < this.rows; i++) {\n        for (let j = 0; j <= i; j++) {\n          if (this.get(i, j) !== this.get(j, i)) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n\n  isDistance() {\n    if (!this.isSymmetric()) return false;\n\n    for (let i = 0; i < this.rows; i++) {\n      if (this.get(i, i) !== 0) return false;\n    }\n\n    return true;\n  }\n\n  isEchelonForm() {\n    let i = 0;\n    let j = 0;\n    let previousColumn = -1;\n    let isEchelonForm = true;\n    let checked = false;\n    while (i < this.rows && isEchelonForm) {\n      j = 0;\n      checked = false;\n      while (j < this.columns && checked === false) {\n        if (this.get(i, j) === 0) {\n          j++;\n        } else if (this.get(i, j) === 1 && j > previousColumn) {\n          checked = true;\n          previousColumn = j;\n        } else {\n          isEchelonForm = false;\n          checked = true;\n        }\n      }\n      i++;\n    }\n    return isEchelonForm;\n  }\n\n  isReducedEchelonForm() {\n    let i = 0;\n    let j = 0;\n    let previousColumn = -1;\n    let isReducedEchelonForm = true;\n    let checked = false;\n    while (i < this.rows && isReducedEchelonForm) {\n      j = 0;\n      checked = false;\n      while (j < this.columns && checked === false) {\n        if (this.get(i, j) === 0) {\n          j++;\n        } else if (this.get(i, j) === 1 && j > previousColumn) {\n          checked = true;\n          previousColumn = j;\n        } else {\n          isReducedEchelonForm = false;\n          checked = true;\n        }\n      }\n      for (let k = j + 1; k < this.rows; k++) {\n        if (this.get(i, k) !== 0) {\n          isReducedEchelonForm = false;\n        }\n      }\n      i++;\n    }\n    return isReducedEchelonForm;\n  }\n\n  echelonForm() {\n    let result = this.clone();\n    let h = 0;\n    let k = 0;\n    while (h < result.rows && k < result.columns) {\n      let iMax = h;\n      for (let i = h; i < result.rows; i++) {\n        if (result.get(i, k) > result.get(iMax, k)) {\n          iMax = i;\n        }\n      }\n      if (result.get(iMax, k) === 0) {\n        k++;\n      } else {\n        result.swapRows(h, iMax);\n        let tmp = result.get(h, k);\n        for (let j = k; j < result.columns; j++) {\n          result.set(h, j, result.get(h, j) / tmp);\n        }\n        for (let i = h + 1; i < result.rows; i++) {\n          let factor = result.get(i, k) / result.get(h, k);\n          result.set(i, k, 0);\n          for (let j = k + 1; j < result.columns; j++) {\n            result.set(i, j, result.get(i, j) - result.get(h, j) * factor);\n          }\n        }\n        h++;\n        k++;\n      }\n    }\n    return result;\n  }\n\n  reducedEchelonForm() {\n    let result = this.echelonForm();\n    let m = result.columns;\n    let n = result.rows;\n    let h = n - 1;\n    while (h >= 0) {\n      if (result.maxRow(h) === 0) {\n        h--;\n      } else {\n        let p = 0;\n        let pivot = false;\n        while (p < n && pivot === false) {\n          if (result.get(h, p) === 1) {\n            pivot = true;\n          } else {\n            p++;\n          }\n        }\n        for (let i = 0; i < h; i++) {\n          let factor = result.get(i, p);\n          for (let j = p; j < m; j++) {\n            let tmp = result.get(i, j) - factor * result.get(h, j);\n            result.set(i, j, tmp);\n          }\n        }\n        h--;\n      }\n    }\n    return result;\n  }\n\n  set() {\n    throw new Error('set method is unimplemented');\n  }\n\n  get() {\n    throw new Error('get method is unimplemented');\n  }\n\n  repeat(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { rows = 1, columns = 1 } = options;\n    if (!Number.isInteger(rows) || rows <= 0) {\n      throw new TypeError('rows must be a positive integer');\n    }\n    if (!Number.isInteger(columns) || columns <= 0) {\n      throw new TypeError('columns must be a positive integer');\n    }\n    let matrix = new Matrix(this.rows * rows, this.columns * columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        matrix.setSubMatrix(this, this.rows * i, this.columns * j);\n      }\n    }\n    return matrix;\n  }\n\n  fill(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, value);\n      }\n    }\n    return this;\n  }\n\n  neg() {\n    return this.mulS(-1);\n  }\n\n  getRow(index) {\n    checkRowIndex(this, index);\n    let row = [];\n    for (let i = 0; i < this.columns; i++) {\n      row.push(this.get(index, i));\n    }\n    return row;\n  }\n\n  getRowVector(index) {\n    return Matrix.rowVector(this.getRow(index));\n  }\n\n  setRow(index, array) {\n    checkRowIndex(this, index);\n    array = checkRowVector(this, array);\n    for (let i = 0; i < this.columns; i++) {\n      this.set(index, i, array[i]);\n    }\n    return this;\n  }\n\n  swapRows(row1, row2) {\n    checkRowIndex(this, row1);\n    checkRowIndex(this, row2);\n    for (let i = 0; i < this.columns; i++) {\n      let temp = this.get(row1, i);\n      this.set(row1, i, this.get(row2, i));\n      this.set(row2, i, temp);\n    }\n    return this;\n  }\n\n  getColumn(index) {\n    checkColumnIndex(this, index);\n    let column = [];\n    for (let i = 0; i < this.rows; i++) {\n      column.push(this.get(i, index));\n    }\n    return column;\n  }\n\n  getColumnVector(index) {\n    return Matrix.columnVector(this.getColumn(index));\n  }\n\n  setColumn(index, array) {\n    checkColumnIndex(this, index);\n    array = checkColumnVector(this, array);\n    for (let i = 0; i < this.rows; i++) {\n      this.set(i, index, array[i]);\n    }\n    return this;\n  }\n\n  swapColumns(column1, column2) {\n    checkColumnIndex(this, column1);\n    checkColumnIndex(this, column2);\n    for (let i = 0; i < this.rows; i++) {\n      let temp = this.get(i, column1);\n      this.set(i, column1, this.get(i, column2));\n      this.set(i, column2, temp);\n    }\n    return this;\n  }\n\n  addRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + vector[j]);\n      }\n    }\n    return this;\n  }\n\n  subRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - vector[j]);\n      }\n    }\n    return this;\n  }\n\n  mulRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * vector[j]);\n      }\n    }\n    return this;\n  }\n\n  divRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / vector[j]);\n      }\n    }\n    return this;\n  }\n\n  addColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + vector[i]);\n      }\n    }\n    return this;\n  }\n\n  subColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - vector[i]);\n      }\n    }\n    return this;\n  }\n\n  mulColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * vector[i]);\n      }\n    }\n    return this;\n  }\n\n  divColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / vector[i]);\n      }\n    }\n    return this;\n  }\n\n  mulRow(index, value) {\n    checkRowIndex(this, index);\n    for (let i = 0; i < this.columns; i++) {\n      this.set(index, i, this.get(index, i) * value);\n    }\n    return this;\n  }\n\n  mulColumn(index, value) {\n    checkColumnIndex(this, index);\n    for (let i = 0; i < this.rows; i++) {\n      this.set(i, index, this.get(i, index) * value);\n    }\n    return this;\n  }\n\n  max(by) {\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    switch (by) {\n      case 'row': {\n        const max = new Array(this.rows).fill(Number.NEGATIVE_INFINITY);\n        for (let row = 0; row < this.rows; row++) {\n          for (let column = 0; column < this.columns; column++) {\n            if (this.get(row, column) > max[row]) {\n              max[row] = this.get(row, column);\n            }\n          }\n        }\n        return max;\n      }\n      case 'column': {\n        const max = new Array(this.columns).fill(Number.NEGATIVE_INFINITY);\n        for (let row = 0; row < this.rows; row++) {\n          for (let column = 0; column < this.columns; column++) {\n            if (this.get(row, column) > max[column]) {\n              max[column] = this.get(row, column);\n            }\n          }\n        }\n        return max;\n      }\n      case undefined: {\n        let max = this.get(0, 0);\n        for (let row = 0; row < this.rows; row++) {\n          for (let column = 0; column < this.columns; column++) {\n            if (this.get(row, column) > max) {\n              max = this.get(row, column);\n            }\n          }\n        }\n        return max;\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  maxIndex() {\n    checkNonEmpty(this);\n    let v = this.get(0, 0);\n    let idx = [0, 0];\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) > v) {\n          v = this.get(i, j);\n          idx[0] = i;\n          idx[1] = j;\n        }\n      }\n    }\n    return idx;\n  }\n\n  min(by) {\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    switch (by) {\n      case 'row': {\n        const min = new Array(this.rows).fill(Number.POSITIVE_INFINITY);\n        for (let row = 0; row < this.rows; row++) {\n          for (let column = 0; column < this.columns; column++) {\n            if (this.get(row, column) < min[row]) {\n              min[row] = this.get(row, column);\n            }\n          }\n        }\n        return min;\n      }\n      case 'column': {\n        const min = new Array(this.columns).fill(Number.POSITIVE_INFINITY);\n        for (let row = 0; row < this.rows; row++) {\n          for (let column = 0; column < this.columns; column++) {\n            if (this.get(row, column) < min[column]) {\n              min[column] = this.get(row, column);\n            }\n          }\n        }\n        return min;\n      }\n      case undefined: {\n        let min = this.get(0, 0);\n        for (let row = 0; row < this.rows; row++) {\n          for (let column = 0; column < this.columns; column++) {\n            if (this.get(row, column) < min) {\n              min = this.get(row, column);\n            }\n          }\n        }\n        return min;\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  minIndex() {\n    checkNonEmpty(this);\n    let v = this.get(0, 0);\n    let idx = [0, 0];\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) < v) {\n          v = this.get(i, j);\n          idx[0] = i;\n          idx[1] = j;\n        }\n      }\n    }\n    return idx;\n  }\n\n  maxRow(row) {\n    checkRowIndex(this, row);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(row, 0);\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) > v) {\n        v = this.get(row, i);\n      }\n    }\n    return v;\n  }\n\n  maxRowIndex(row) {\n    checkRowIndex(this, row);\n    checkNonEmpty(this);\n    let v = this.get(row, 0);\n    let idx = [row, 0];\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) > v) {\n        v = this.get(row, i);\n        idx[1] = i;\n      }\n    }\n    return idx;\n  }\n\n  minRow(row) {\n    checkRowIndex(this, row);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(row, 0);\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) < v) {\n        v = this.get(row, i);\n      }\n    }\n    return v;\n  }\n\n  minRowIndex(row) {\n    checkRowIndex(this, row);\n    checkNonEmpty(this);\n    let v = this.get(row, 0);\n    let idx = [row, 0];\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) < v) {\n        v = this.get(row, i);\n        idx[1] = i;\n      }\n    }\n    return idx;\n  }\n\n  maxColumn(column) {\n    checkColumnIndex(this, column);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(0, column);\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) > v) {\n        v = this.get(i, column);\n      }\n    }\n    return v;\n  }\n\n  maxColumnIndex(column) {\n    checkColumnIndex(this, column);\n    checkNonEmpty(this);\n    let v = this.get(0, column);\n    let idx = [0, column];\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) > v) {\n        v = this.get(i, column);\n        idx[0] = i;\n      }\n    }\n    return idx;\n  }\n\n  minColumn(column) {\n    checkColumnIndex(this, column);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(0, column);\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) < v) {\n        v = this.get(i, column);\n      }\n    }\n    return v;\n  }\n\n  minColumnIndex(column) {\n    checkColumnIndex(this, column);\n    checkNonEmpty(this);\n    let v = this.get(0, column);\n    let idx = [0, column];\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) < v) {\n        v = this.get(i, column);\n        idx[0] = i;\n      }\n    }\n    return idx;\n  }\n\n  diag() {\n    let min = Math.min(this.rows, this.columns);\n    let diag = [];\n    for (let i = 0; i < min; i++) {\n      diag.push(this.get(i, i));\n    }\n    return diag;\n  }\n\n  norm(type = 'frobenius') {\n    switch (type) {\n      case 'max':\n        return this.max();\n      case 'frobenius':\n        return Math.sqrt(this.dot(this));\n      default:\n        throw new RangeError(`unknown norm type: ${type}`);\n    }\n  }\n\n  cumulativeSum() {\n    let sum = 0;\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        sum += this.get(i, j);\n        this.set(i, j, sum);\n      }\n    }\n    return this;\n  }\n\n  dot(vector2) {\n    if (AbstractMatrix.isMatrix(vector2)) vector2 = vector2.to1DArray();\n    let vector1 = this.to1DArray();\n    if (vector1.length !== vector2.length) {\n      throw new RangeError('vectors do not have the same size');\n    }\n    let dot = 0;\n    for (let i = 0; i < vector1.length; i++) {\n      dot += vector1[i] * vector2[i];\n    }\n    return dot;\n  }\n\n  mmul(other) {\n    other = Matrix.checkMatrix(other);\n\n    let m = this.rows;\n    let n = this.columns;\n    let p = other.columns;\n\n    let result = new Matrix(m, p);\n\n    let Bcolj = new Float64Array(n);\n    for (let j = 0; j < p; j++) {\n      for (let k = 0; k < n; k++) {\n        Bcolj[k] = other.get(k, j);\n      }\n\n      for (let i = 0; i < m; i++) {\n        let s = 0;\n        for (let k = 0; k < n; k++) {\n          s += this.get(i, k) * Bcolj[k];\n        }\n\n        result.set(i, j, s);\n      }\n    }\n    return result;\n  }\n\n  mpow(scalar) {\n    if (!this.isSquare()) {\n      throw new RangeError('Matrix must be square');\n    }\n    if (!Number.isInteger(scalar) || scalar < 0) {\n      throw new RangeError('Exponent must be a non-negative integer');\n    }\n    // Russian Peasant exponentiation, i.e. exponentiation by squaring\n    let result = Matrix.eye(this.rows);\n    let bb = this;\n    // Note: Don't bit shift. In JS, that would truncate at 32 bits\n    for (let e = scalar; e >= 1; e /= 2) {\n      if ((e & 1) !== 0) {\n        result = result.mmul(bb);\n      }\n      bb = bb.mmul(bb);\n    }\n    return result;\n  }\n\n  strassen2x2(other) {\n    other = Matrix.checkMatrix(other);\n    let result = new Matrix(2, 2);\n    const a11 = this.get(0, 0);\n    const b11 = other.get(0, 0);\n    const a12 = this.get(0, 1);\n    const b12 = other.get(0, 1);\n    const a21 = this.get(1, 0);\n    const b21 = other.get(1, 0);\n    const a22 = this.get(1, 1);\n    const b22 = other.get(1, 1);\n\n    // Compute intermediate values.\n    const m1 = (a11 + a22) * (b11 + b22);\n    const m2 = (a21 + a22) * b11;\n    const m3 = a11 * (b12 - b22);\n    const m4 = a22 * (b21 - b11);\n    const m5 = (a11 + a12) * b22;\n    const m6 = (a21 - a11) * (b11 + b12);\n    const m7 = (a12 - a22) * (b21 + b22);\n\n    // Combine intermediate values into the output.\n    const c00 = m1 + m4 - m5 + m7;\n    const c01 = m3 + m5;\n    const c10 = m2 + m4;\n    const c11 = m1 - m2 + m3 + m6;\n\n    result.set(0, 0, c00);\n    result.set(0, 1, c01);\n    result.set(1, 0, c10);\n    result.set(1, 1, c11);\n    return result;\n  }\n\n  strassen3x3(other) {\n    other = Matrix.checkMatrix(other);\n    let result = new Matrix(3, 3);\n\n    const a00 = this.get(0, 0);\n    const a01 = this.get(0, 1);\n    const a02 = this.get(0, 2);\n    const a10 = this.get(1, 0);\n    const a11 = this.get(1, 1);\n    const a12 = this.get(1, 2);\n    const a20 = this.get(2, 0);\n    const a21 = this.get(2, 1);\n    const a22 = this.get(2, 2);\n\n    const b00 = other.get(0, 0);\n    const b01 = other.get(0, 1);\n    const b02 = other.get(0, 2);\n    const b10 = other.get(1, 0);\n    const b11 = other.get(1, 1);\n    const b12 = other.get(1, 2);\n    const b20 = other.get(2, 0);\n    const b21 = other.get(2, 1);\n    const b22 = other.get(2, 2);\n\n    const m1 = (a00 + a01 + a02 - a10 - a11 - a21 - a22) * b11;\n    const m2 = (a00 - a10) * (-b01 + b11);\n    const m3 = a11 * (-b00 + b01 + b10 - b11 - b12 - b20 + b22);\n    const m4 = (-a00 + a10 + a11) * (b00 - b01 + b11);\n    const m5 = (a10 + a11) * (-b00 + b01);\n    const m6 = a00 * b00;\n    const m7 = (-a00 + a20 + a21) * (b00 - b02 + b12);\n    const m8 = (-a00 + a20) * (b02 - b12);\n    const m9 = (a20 + a21) * (-b00 + b02);\n    const m10 = (a00 + a01 + a02 - a11 - a12 - a20 - a21) * b12;\n    const m11 = a21 * (-b00 + b02 + b10 - b11 - b12 - b20 + b21);\n    const m12 = (-a02 + a21 + a22) * (b11 + b20 - b21);\n    const m13 = (a02 - a22) * (b11 - b21);\n    const m14 = a02 * b20;\n    const m15 = (a21 + a22) * (-b20 + b21);\n    const m16 = (-a02 + a11 + a12) * (b12 + b20 - b22);\n    const m17 = (a02 - a12) * (b12 - b22);\n    const m18 = (a11 + a12) * (-b20 + b22);\n    const m19 = a01 * b10;\n    const m20 = a12 * b21;\n    const m21 = a10 * b02;\n    const m22 = a20 * b01;\n    const m23 = a22 * b22;\n\n    const c00 = m6 + m14 + m19;\n    const c01 = m1 + m4 + m5 + m6 + m12 + m14 + m15;\n    const c02 = m6 + m7 + m9 + m10 + m14 + m16 + m18;\n    const c10 = m2 + m3 + m4 + m6 + m14 + m16 + m17;\n    const c11 = m2 + m4 + m5 + m6 + m20;\n    const c12 = m14 + m16 + m17 + m18 + m21;\n    const c20 = m6 + m7 + m8 + m11 + m12 + m13 + m14;\n    const c21 = m12 + m13 + m14 + m15 + m22;\n    const c22 = m6 + m7 + m8 + m9 + m23;\n\n    result.set(0, 0, c00);\n    result.set(0, 1, c01);\n    result.set(0, 2, c02);\n    result.set(1, 0, c10);\n    result.set(1, 1, c11);\n    result.set(1, 2, c12);\n    result.set(2, 0, c20);\n    result.set(2, 1, c21);\n    result.set(2, 2, c22);\n    return result;\n  }\n\n  mmulStrassen(y) {\n    y = Matrix.checkMatrix(y);\n    let x = this.clone();\n    let r1 = x.rows;\n    let c1 = x.columns;\n    let r2 = y.rows;\n    let c2 = y.columns;\n    if (c1 !== r2) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`,\n      );\n    }\n\n    // Put a matrix into the top left of a matrix of zeros.\n    // `rows` and `cols` are the dimensions of the output matrix.\n    function embed(mat, rows, cols) {\n      let r = mat.rows;\n      let c = mat.columns;\n      if (r === rows && c === cols) {\n        return mat;\n      } else {\n        let resultat = AbstractMatrix.zeros(rows, cols);\n        resultat = resultat.setSubMatrix(mat, 0, 0);\n        return resultat;\n      }\n    }\n\n    // Make sure both matrices are the same size.\n    // This is exclusively for simplicity:\n    // this algorithm can be implemented with matrices of different sizes.\n\n    let r = Math.max(r1, r2);\n    let c = Math.max(c1, c2);\n    x = embed(x, r, c);\n    y = embed(y, r, c);\n\n    // Our recursive multiplication function.\n    function blockMult(a, b, rows, cols) {\n      // For small matrices, resort to naive multiplication.\n      if (rows <= 512 || cols <= 512) {\n        return a.mmul(b); // a is equivalent to this\n      }\n\n      // Apply dynamic padding.\n      if (rows % 2 === 1 && cols % 2 === 1) {\n        a = embed(a, rows + 1, cols + 1);\n        b = embed(b, rows + 1, cols + 1);\n      } else if (rows % 2 === 1) {\n        a = embed(a, rows + 1, cols);\n        b = embed(b, rows + 1, cols);\n      } else if (cols % 2 === 1) {\n        a = embed(a, rows, cols + 1);\n        b = embed(b, rows, cols + 1);\n      }\n\n      let halfRows = parseInt(a.rows / 2, 10);\n      let halfCols = parseInt(a.columns / 2, 10);\n      // Subdivide input matrices.\n      let a11 = a.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n      let b11 = b.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n\n      let a12 = a.subMatrix(0, halfRows - 1, halfCols, a.columns - 1);\n      let b12 = b.subMatrix(0, halfRows - 1, halfCols, b.columns - 1);\n\n      let a21 = a.subMatrix(halfRows, a.rows - 1, 0, halfCols - 1);\n      let b21 = b.subMatrix(halfRows, b.rows - 1, 0, halfCols - 1);\n\n      let a22 = a.subMatrix(halfRows, a.rows - 1, halfCols, a.columns - 1);\n      let b22 = b.subMatrix(halfRows, b.rows - 1, halfCols, b.columns - 1);\n\n      // Compute intermediate values.\n      let m1 = blockMult(\n        AbstractMatrix.add(a11, a22),\n        AbstractMatrix.add(b11, b22),\n        halfRows,\n        halfCols,\n      );\n      let m2 = blockMult(AbstractMatrix.add(a21, a22), b11, halfRows, halfCols);\n      let m3 = blockMult(a11, AbstractMatrix.sub(b12, b22), halfRows, halfCols);\n      let m4 = blockMult(a22, AbstractMatrix.sub(b21, b11), halfRows, halfCols);\n      let m5 = blockMult(AbstractMatrix.add(a11, a12), b22, halfRows, halfCols);\n      let m6 = blockMult(\n        AbstractMatrix.sub(a21, a11),\n        AbstractMatrix.add(b11, b12),\n        halfRows,\n        halfCols,\n      );\n      let m7 = blockMult(\n        AbstractMatrix.sub(a12, a22),\n        AbstractMatrix.add(b21, b22),\n        halfRows,\n        halfCols,\n      );\n\n      // Combine intermediate values into the output.\n      let c11 = AbstractMatrix.add(m1, m4);\n      c11.sub(m5);\n      c11.add(m7);\n      let c12 = AbstractMatrix.add(m3, m5);\n      let c21 = AbstractMatrix.add(m2, m4);\n      let c22 = AbstractMatrix.sub(m1, m2);\n      c22.add(m3);\n      c22.add(m6);\n\n      // Crop output to the desired size (undo dynamic padding).\n      let result = AbstractMatrix.zeros(2 * c11.rows, 2 * c11.columns);\n      result = result.setSubMatrix(c11, 0, 0);\n      result = result.setSubMatrix(c12, c11.rows, 0);\n      result = result.setSubMatrix(c21, 0, c11.columns);\n      result = result.setSubMatrix(c22, c11.rows, c11.columns);\n      return result.subMatrix(0, rows - 1, 0, cols - 1);\n    }\n\n    return blockMult(x, y, r, c);\n  }\n\n  scaleRows(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { min = 0, max = 1 } = options;\n    if (!Number.isFinite(min)) throw new TypeError('min must be a number');\n    if (!Number.isFinite(max)) throw new TypeError('max must be a number');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let newMatrix = new Matrix(this.rows, this.columns);\n    for (let i = 0; i < this.rows; i++) {\n      const row = this.getRow(i);\n      if (row.length > 0) {\n        rescale(row, { min, max, output: row });\n      }\n      newMatrix.setRow(i, row);\n    }\n    return newMatrix;\n  }\n\n  scaleColumns(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { min = 0, max = 1 } = options;\n    if (!Number.isFinite(min)) throw new TypeError('min must be a number');\n    if (!Number.isFinite(max)) throw new TypeError('max must be a number');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let newMatrix = new Matrix(this.rows, this.columns);\n    for (let i = 0; i < this.columns; i++) {\n      const column = this.getColumn(i);\n      if (column.length) {\n        rescale(column, {\n          min,\n          max,\n          output: column,\n        });\n      }\n      newMatrix.setColumn(i, column);\n    }\n    return newMatrix;\n  }\n\n  flipRows() {\n    const middle = Math.ceil(this.columns / 2);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < middle; j++) {\n        let first = this.get(i, j);\n        let last = this.get(i, this.columns - 1 - j);\n        this.set(i, j, last);\n        this.set(i, this.columns - 1 - j, first);\n      }\n    }\n    return this;\n  }\n\n  flipColumns() {\n    const middle = Math.ceil(this.rows / 2);\n    for (let j = 0; j < this.columns; j++) {\n      for (let i = 0; i < middle; i++) {\n        let first = this.get(i, j);\n        let last = this.get(this.rows - 1 - i, j);\n        this.set(i, j, last);\n        this.set(this.rows - 1 - i, j, first);\n      }\n    }\n    return this;\n  }\n\n  kroneckerProduct(other) {\n    other = Matrix.checkMatrix(other);\n\n    let m = this.rows;\n    let n = this.columns;\n    let p = other.rows;\n    let q = other.columns;\n\n    let result = new Matrix(m * p, n * q);\n    for (let i = 0; i < m; i++) {\n      for (let j = 0; j < n; j++) {\n        for (let k = 0; k < p; k++) {\n          for (let l = 0; l < q; l++) {\n            result.set(p * i + k, q * j + l, this.get(i, j) * other.get(k, l));\n          }\n        }\n      }\n    }\n    return result;\n  }\n\n  kroneckerSum(other) {\n    other = Matrix.checkMatrix(other);\n    if (!this.isSquare() || !other.isSquare()) {\n      throw new Error('Kronecker Sum needs two Square Matrices');\n    }\n    let m = this.rows;\n    let n = other.rows;\n    let AxI = this.kroneckerProduct(Matrix.eye(n, n));\n    let IxB = Matrix.eye(m, m).kroneckerProduct(other);\n    return AxI.add(IxB);\n  }\n\n  transpose() {\n    let result = new Matrix(this.columns, this.rows);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        result.set(j, i, this.get(i, j));\n      }\n    }\n    return result;\n  }\n\n  sortRows(compareFunction = compareNumbers) {\n    for (let i = 0; i < this.rows; i++) {\n      this.setRow(i, this.getRow(i).sort(compareFunction));\n    }\n    return this;\n  }\n\n  sortColumns(compareFunction = compareNumbers) {\n    for (let i = 0; i < this.columns; i++) {\n      this.setColumn(i, this.getColumn(i).sort(compareFunction));\n    }\n    return this;\n  }\n\n  subMatrix(startRow, endRow, startColumn, endColumn) {\n    checkRange(this, startRow, endRow, startColumn, endColumn);\n    let newMatrix = new Matrix(\n      endRow - startRow + 1,\n      endColumn - startColumn + 1,\n    );\n    for (let i = startRow; i <= endRow; i++) {\n      for (let j = startColumn; j <= endColumn; j++) {\n        newMatrix.set(i - startRow, j - startColumn, this.get(i, j));\n      }\n    }\n    return newMatrix;\n  }\n\n  subMatrixRow(indices, startColumn, endColumn) {\n    if (startColumn === undefined) startColumn = 0;\n    if (endColumn === undefined) endColumn = this.columns - 1;\n    if (\n      startColumn > endColumn ||\n      startColumn < 0 ||\n      startColumn >= this.columns ||\n      endColumn < 0 ||\n      endColumn >= this.columns\n    ) {\n      throw new RangeError('Argument out of range');\n    }\n\n    let newMatrix = new Matrix(indices.length, endColumn - startColumn + 1);\n    for (let i = 0; i < indices.length; i++) {\n      for (let j = startColumn; j <= endColumn; j++) {\n        if (indices[i] < 0 || indices[i] >= this.rows) {\n          throw new RangeError(`Row index out of range: ${indices[i]}`);\n        }\n        newMatrix.set(i, j - startColumn, this.get(indices[i], j));\n      }\n    }\n    return newMatrix;\n  }\n\n  subMatrixColumn(indices, startRow, endRow) {\n    if (startRow === undefined) startRow = 0;\n    if (endRow === undefined) endRow = this.rows - 1;\n    if (\n      startRow > endRow ||\n      startRow < 0 ||\n      startRow >= this.rows ||\n      endRow < 0 ||\n      endRow >= this.rows\n    ) {\n      throw new RangeError('Argument out of range');\n    }\n\n    let newMatrix = new Matrix(endRow - startRow + 1, indices.length);\n    for (let i = 0; i < indices.length; i++) {\n      for (let j = startRow; j <= endRow; j++) {\n        if (indices[i] < 0 || indices[i] >= this.columns) {\n          throw new RangeError(`Column index out of range: ${indices[i]}`);\n        }\n        newMatrix.set(j - startRow, i, this.get(j, indices[i]));\n      }\n    }\n    return newMatrix;\n  }\n\n  setSubMatrix(matrix, startRow, startColumn) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (matrix.isEmpty()) {\n      return this;\n    }\n    let endRow = startRow + matrix.rows - 1;\n    let endColumn = startColumn + matrix.columns - 1;\n    checkRange(this, startRow, endRow, startColumn, endColumn);\n    for (let i = 0; i < matrix.rows; i++) {\n      for (let j = 0; j < matrix.columns; j++) {\n        this.set(startRow + i, startColumn + j, matrix.get(i, j));\n      }\n    }\n    return this;\n  }\n\n  selection(rowIndices, columnIndices) {\n    checkRowIndices(this, rowIndices);\n    checkColumnIndices(this, columnIndices);\n    let newMatrix = new Matrix(rowIndices.length, columnIndices.length);\n    for (let i = 0; i < rowIndices.length; i++) {\n      let rowIndex = rowIndices[i];\n      for (let j = 0; j < columnIndices.length; j++) {\n        let columnIndex = columnIndices[j];\n        newMatrix.set(i, j, this.get(rowIndex, columnIndex));\n      }\n    }\n    return newMatrix;\n  }\n\n  trace() {\n    let min = Math.min(this.rows, this.columns);\n    let trace = 0;\n    for (let i = 0; i < min; i++) {\n      trace += this.get(i, i);\n    }\n    return trace;\n  }\n\n  clone() {\n    return this.constructor.copy(this, new Matrix(this.rows, this.columns));\n  }\n\n  /**\n   * @template {AbstractMatrix} M\n   * @param {AbstractMatrix} from\n   * @param {M} to\n   * @return {M}\n   */\n  static copy(from, to) {\n    for (const [row, column, value] of from.entries()) {\n      to.set(row, column, value);\n    }\n\n    return to;\n  }\n\n  sum(by) {\n    switch (by) {\n      case 'row':\n        return sumByRow(this);\n      case 'column':\n        return sumByColumn(this);\n      case undefined:\n        return sumAll(this);\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  product(by) {\n    switch (by) {\n      case 'row':\n        return productByRow(this);\n      case 'column':\n        return productByColumn(this);\n      case undefined:\n        return productAll(this);\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  mean(by) {\n    const sum = this.sum(by);\n    switch (by) {\n      case 'row': {\n        for (let i = 0; i < this.rows; i++) {\n          sum[i] /= this.columns;\n        }\n        return sum;\n      }\n      case 'column': {\n        for (let i = 0; i < this.columns; i++) {\n          sum[i] /= this.rows;\n        }\n        return sum;\n      }\n      case undefined:\n        return sum / this.size;\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  variance(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { unbiased = true, mean = this.mean(by) } = options;\n    if (typeof unbiased !== 'boolean') {\n      throw new TypeError('unbiased must be a boolean');\n    }\n    switch (by) {\n      case 'row': {\n        if (!isAnyArray.isAnyArray(mean)) {\n          throw new TypeError('mean must be an array');\n        }\n        return varianceByRow(this, unbiased, mean);\n      }\n      case 'column': {\n        if (!isAnyArray.isAnyArray(mean)) {\n          throw new TypeError('mean must be an array');\n        }\n        return varianceByColumn(this, unbiased, mean);\n      }\n      case undefined: {\n        if (typeof mean !== 'number') {\n          throw new TypeError('mean must be a number');\n        }\n        return varianceAll(this, unbiased, mean);\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  standardDeviation(by, options) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    const variance = this.variance(by, options);\n    if (by === undefined) {\n      return Math.sqrt(variance);\n    } else {\n      for (let i = 0; i < variance.length; i++) {\n        variance[i] = Math.sqrt(variance[i]);\n      }\n      return variance;\n    }\n  }\n\n  center(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { center = this.mean(by) } = options;\n    switch (by) {\n      case 'row': {\n        if (!isAnyArray.isAnyArray(center)) {\n          throw new TypeError('center must be an array');\n        }\n        centerByRow(this, center);\n        return this;\n      }\n      case 'column': {\n        if (!isAnyArray.isAnyArray(center)) {\n          throw new TypeError('center must be an array');\n        }\n        centerByColumn(this, center);\n        return this;\n      }\n      case undefined: {\n        if (typeof center !== 'number') {\n          throw new TypeError('center must be a number');\n        }\n        centerAll(this, center);\n        return this;\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  scale(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    let scale = options.scale;\n    switch (by) {\n      case 'row': {\n        if (scale === undefined) {\n          scale = getScaleByRow(this);\n        } else if (!isAnyArray.isAnyArray(scale)) {\n          throw new TypeError('scale must be an array');\n        }\n        scaleByRow(this, scale);\n        return this;\n      }\n      case 'column': {\n        if (scale === undefined) {\n          scale = getScaleByColumn(this);\n        } else if (!isAnyArray.isAnyArray(scale)) {\n          throw new TypeError('scale must be an array');\n        }\n        scaleByColumn(this, scale);\n        return this;\n      }\n      case undefined: {\n        if (scale === undefined) {\n          scale = getScaleAll(this);\n        } else if (typeof scale !== 'number') {\n          throw new TypeError('scale must be a number');\n        }\n        scaleAll(this, scale);\n        return this;\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  toString(options) {\n    return inspectMatrixWithOptions(this, options);\n  }\n\n  [Symbol.iterator]() {\n    return this.entries();\n  }\n\n  /**\n   * iterator from left to right, from top to bottom\n   * yield [row, column, value]\n   * @returns {Generator<[number, number, number], void, void>}\n   */\n  *entries() {\n    for (let row = 0; row < this.rows; row++) {\n      for (let col = 0; col < this.columns; col++) {\n        yield [row, col, this.get(row, col)];\n      }\n    }\n  }\n\n  /**\n   * iterator from left to right, from top to bottom\n   * yield value\n   * @returns {Generator<number, void, void>}\n   */\n  *values() {\n    for (let row = 0; row < this.rows; row++) {\n      for (let col = 0; col < this.columns; col++) {\n        yield this.get(row, col);\n      }\n    }\n  }\n}\n\nAbstractMatrix.prototype.klass = 'Matrix';\nif (typeof Symbol !== 'undefined') {\n  AbstractMatrix.prototype[Symbol.for('nodejs.util.inspect.custom')] =\n    inspectMatrix;\n}\n\nfunction compareNumbers(a, b) {\n  return a - b;\n}\n\nfunction isArrayOfNumbers(array) {\n  return array.every((element) => {\n    return typeof element === 'number';\n  });\n}\n\n// Synonyms\nAbstractMatrix.random = AbstractMatrix.rand;\nAbstractMatrix.randomInt = AbstractMatrix.randInt;\nAbstractMatrix.diagonal = AbstractMatrix.diag;\nAbstractMatrix.prototype.diagonal = AbstractMatrix.prototype.diag;\nAbstractMatrix.identity = AbstractMatrix.eye;\nAbstractMatrix.prototype.negate = AbstractMatrix.prototype.neg;\nAbstractMatrix.prototype.tensorProduct =\n  AbstractMatrix.prototype.kroneckerProduct;\n\nclass Matrix extends AbstractMatrix {\n  /**\n   * @type {Float64Array[]}\n   */\n  data;\n\n  /**\n   * Init an empty matrix\n   * @param {number} nRows\n   * @param {number} nColumns\n   */\n  #initData(nRows, nColumns) {\n    this.data = [];\n\n    if (Number.isInteger(nColumns) && nColumns >= 0) {\n      for (let i = 0; i < nRows; i++) {\n        this.data.push(new Float64Array(nColumns));\n      }\n    } else {\n      throw new TypeError('nColumns must be a positive integer');\n    }\n\n    this.rows = nRows;\n    this.columns = nColumns;\n  }\n\n  constructor(nRows, nColumns) {\n    super();\n    if (Matrix.isMatrix(nRows)) {\n      this.#initData(nRows.rows, nRows.columns);\n      Matrix.copy(nRows, this);\n    } else if (Number.isInteger(nRows) && nRows >= 0) {\n      this.#initData(nRows, nColumns);\n    } else if (isAnyArray.isAnyArray(nRows)) {\n      // Copy the values from the 2D array\n      const arrayData = nRows;\n      nRows = arrayData.length;\n      nColumns = nRows ? arrayData[0].length : 0;\n      if (typeof nColumns !== 'number') {\n        throw new TypeError(\n          'Data must be a 2D array with at least one element',\n        );\n      }\n      this.data = [];\n\n      for (let i = 0; i < nRows; i++) {\n        if (arrayData[i].length !== nColumns) {\n          throw new RangeError('Inconsistent array dimensions');\n        }\n        if (!isArrayOfNumbers(arrayData[i])) {\n          throw new TypeError('Input data contains non-numeric values');\n        }\n        this.data.push(Float64Array.from(arrayData[i]));\n      }\n\n      this.rows = nRows;\n      this.columns = nColumns;\n    } else {\n      throw new TypeError(\n        'First argument must be a positive number or an array',\n      );\n    }\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.data[rowIndex][columnIndex] = value;\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.data[rowIndex][columnIndex];\n  }\n\n  removeRow(index) {\n    checkRowIndex(this, index);\n    this.data.splice(index, 1);\n    this.rows -= 1;\n    return this;\n  }\n\n  addRow(index, array) {\n    if (array === undefined) {\n      array = index;\n      index = this.rows;\n    }\n    checkRowIndex(this, index, true);\n    array = Float64Array.from(checkRowVector(this, array));\n    this.data.splice(index, 0, array);\n    this.rows += 1;\n    return this;\n  }\n\n  removeColumn(index) {\n    checkColumnIndex(this, index);\n    for (let i = 0; i < this.rows; i++) {\n      const newRow = new Float64Array(this.columns - 1);\n      for (let j = 0; j < index; j++) {\n        newRow[j] = this.data[i][j];\n      }\n      for (let j = index + 1; j < this.columns; j++) {\n        newRow[j - 1] = this.data[i][j];\n      }\n      this.data[i] = newRow;\n    }\n    this.columns -= 1;\n    return this;\n  }\n\n  addColumn(index, array) {\n    if (typeof array === 'undefined') {\n      array = index;\n      index = this.columns;\n    }\n    checkColumnIndex(this, index, true);\n    array = checkColumnVector(this, array);\n    for (let i = 0; i < this.rows; i++) {\n      const newRow = new Float64Array(this.columns + 1);\n      let j = 0;\n      for (; j < index; j++) {\n        newRow[j] = this.data[i][j];\n      }\n      newRow[j++] = array[i];\n      for (; j < this.columns + 1; j++) {\n        newRow[j] = this.data[i][j - 1];\n      }\n      this.data[i] = newRow;\n    }\n    this.columns += 1;\n    return this;\n  }\n}\n\ninstallMathOperations(AbstractMatrix, Matrix);\n\n/**\n * @typedef {0 | 1 | number | boolean} Mask\n */\n\nclass SymmetricMatrix extends AbstractMatrix {\n  /** @type {Matrix} */\n  #matrix;\n\n  get size() {\n    return this.#matrix.size;\n  }\n\n  get rows() {\n    return this.#matrix.rows;\n  }\n\n  get columns() {\n    return this.#matrix.columns;\n  }\n\n  get diagonalSize() {\n    return this.rows;\n  }\n\n  /**\n   * not the same as matrix.isSymmetric()\n   * Here is to check if it's instanceof SymmetricMatrix without bundling issues\n   *\n   * @param value\n   * @returns {boolean}\n   */\n  static isSymmetricMatrix(value) {\n    return Matrix.isMatrix(value) && value.klassType === 'SymmetricMatrix';\n  }\n\n  /**\n   * @param diagonalSize\n   * @return {SymmetricMatrix}\n   */\n  static zeros(diagonalSize) {\n    return new this(diagonalSize);\n  }\n\n  /**\n   * @param diagonalSize\n   * @return {SymmetricMatrix}\n   */\n  static ones(diagonalSize) {\n    return new this(diagonalSize).fill(1);\n  }\n\n  /**\n   * @param {number | AbstractMatrix | ArrayLike<ArrayLike<number>>} diagonalSize\n   * @return {this}\n   */\n  constructor(diagonalSize) {\n    super();\n\n    if (Matrix.isMatrix(diagonalSize)) {\n      if (!diagonalSize.isSymmetric()) {\n        throw new TypeError('not symmetric data');\n      }\n\n      this.#matrix = Matrix.copy(\n        diagonalSize,\n        new Matrix(diagonalSize.rows, diagonalSize.rows),\n      );\n    } else if (Number.isInteger(diagonalSize) && diagonalSize >= 0) {\n      this.#matrix = new Matrix(diagonalSize, diagonalSize);\n    } else {\n      this.#matrix = new Matrix(diagonalSize);\n\n      if (!this.isSymmetric()) {\n        throw new TypeError('not symmetric data');\n      }\n    }\n  }\n\n  clone() {\n    const matrix = new SymmetricMatrix(this.diagonalSize);\n\n    for (const [row, col, value] of this.upperRightEntries()) {\n      matrix.set(row, col, value);\n    }\n\n    return matrix;\n  }\n\n  toMatrix() {\n    return new Matrix(this);\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.#matrix.get(rowIndex, columnIndex);\n  }\n  set(rowIndex, columnIndex, value) {\n    // symmetric set\n    this.#matrix.set(rowIndex, columnIndex, value);\n    this.#matrix.set(columnIndex, rowIndex, value);\n\n    return this;\n  }\n\n  removeCross(index) {\n    // symmetric remove side\n    this.#matrix.removeRow(index);\n    this.#matrix.removeColumn(index);\n\n    return this;\n  }\n\n  addCross(index, array) {\n    if (array === undefined) {\n      array = index;\n      index = this.diagonalSize;\n    }\n\n    const row = array.slice();\n    row.splice(index, 1);\n\n    this.#matrix.addRow(index, row);\n    this.#matrix.addColumn(index, array);\n\n    return this;\n  }\n\n  /**\n   * @param {Mask[]} mask\n   */\n  applyMask(mask) {\n    if (mask.length !== this.diagonalSize) {\n      throw new RangeError('Mask size do not match with matrix size');\n    }\n\n    // prepare sides to remove from matrix from mask\n    /** @type {number[]} */\n    const sidesToRemove = [];\n    for (const [index, passthroughs] of mask.entries()) {\n      if (passthroughs) continue;\n      sidesToRemove.push(index);\n    }\n    // to remove from highest to lowest for no mutation shifting\n    sidesToRemove.reverse();\n\n    // remove sides\n    for (const sideIndex of sidesToRemove) {\n      this.removeCross(sideIndex);\n    }\n\n    return this;\n  }\n\n  /**\n   * Compact format upper-right corner of matrix\n   * iterate from left to right, from top to bottom.\n   *\n   * ```\n   *   A B C D\n   * A 1 2 3 4\n   * B 2 5 6 7\n   * C 3 6 8 9\n   * D 4 7 9 10\n   * ```\n   *\n   * will return compact 1D array `[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]`\n   *\n   * length is S(i=0, n=sideSize) => 10 for a 4 sideSized matrix\n   *\n   * @returns {number[]}\n   */\n  toCompact() {\n    const { diagonalSize } = this;\n\n    /** @type {number[]} */\n    const compact = new Array((diagonalSize * (diagonalSize + 1)) / 2);\n    for (let col = 0, row = 0, index = 0; index < compact.length; index++) {\n      compact[index] = this.get(row, col);\n\n      if (++col >= diagonalSize) col = ++row;\n    }\n\n    return compact;\n  }\n\n  /**\n   * @param {number[]} compact\n   * @return {SymmetricMatrix}\n   */\n  static fromCompact(compact) {\n    const compactSize = compact.length;\n    // compactSize = (sideSize * (sideSize + 1)) / 2\n    // https://mathsolver.microsoft.com/fr/solve-problem/y%20%3D%20%20x%20%60cdot%20%20%20%60frac%7B%20%20%60left(%20x%2B1%20%20%60right)%20%20%20%20%7D%7B%202%20%20%7D\n    // sideSize = (Sqrt(8 \u00D7 compactSize + 1) - 1) / 2\n    const diagonalSize = (Math.sqrt(8 * compactSize + 1) - 1) / 2;\n\n    if (!Number.isInteger(diagonalSize)) {\n      throw new TypeError(\n        `This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(\n          compact,\n        )}`,\n      );\n    }\n\n    const matrix = new SymmetricMatrix(diagonalSize);\n    for (let col = 0, row = 0, index = 0; index < compactSize; index++) {\n      matrix.set(col, row, compact[index]);\n      if (++col >= diagonalSize) col = ++row;\n    }\n\n    return matrix;\n  }\n\n  /**\n   * half iterator upper-right-corner from left to right, from top to bottom\n   * yield [row, column, value]\n   *\n   * @returns {Generator<[number, number, number], void, void>}\n   */\n  *upperRightEntries() {\n    for (let row = 0, col = 0; row < this.diagonalSize; void 0) {\n      const value = this.get(row, col);\n\n      yield [row, col, value];\n\n      // at the end of row, move cursor to next row at diagonal position\n      if (++col >= this.diagonalSize) col = ++row;\n    }\n  }\n\n  /**\n   * half iterator upper-right-corner from left to right, from top to bottom\n   * yield value\n   *\n   * @returns {Generator<[number, number, number], void, void>}\n   */\n  *upperRightValues() {\n    for (let row = 0, col = 0; row < this.diagonalSize; void 0) {\n      const value = this.get(row, col);\n\n      yield value;\n\n      // at the end of row, move cursor to next row at diagonal position\n      if (++col >= this.diagonalSize) col = ++row;\n    }\n  }\n}\nSymmetricMatrix.prototype.klassType = 'SymmetricMatrix';\n\nclass DistanceMatrix extends SymmetricMatrix {\n  /**\n   * not the same as matrix.isSymmetric()\n   * Here is to check if it's instanceof SymmetricMatrix without bundling issues\n   *\n   * @param value\n   * @returns {boolean}\n   */\n  static isDistanceMatrix(value) {\n    return (\n      SymmetricMatrix.isSymmetricMatrix(value) &&\n      value.klassSubType === 'DistanceMatrix'\n    );\n  }\n\n  constructor(sideSize) {\n    super(sideSize);\n\n    if (!this.isDistance()) {\n      throw new TypeError('Provided arguments do no produce a distance matrix');\n    }\n  }\n\n  set(rowIndex, columnIndex, value) {\n    // distance matrix diagonal is 0\n    if (rowIndex === columnIndex) value = 0;\n\n    return super.set(rowIndex, columnIndex, value);\n  }\n\n  addCross(index, array) {\n    if (array === undefined) {\n      array = index;\n      index = this.diagonalSize;\n    }\n\n    // ensure distance\n    array = array.slice();\n    array[index] = 0;\n\n    return super.addCross(index, array);\n  }\n\n  toSymmetricMatrix() {\n    return new SymmetricMatrix(this);\n  }\n\n  clone() {\n    const matrix = new DistanceMatrix(this.diagonalSize);\n\n    for (const [row, col, value] of this.upperRightEntries()) {\n      if (row === col) continue;\n      matrix.set(row, col, value);\n    }\n\n    return matrix;\n  }\n\n  /**\n   * Compact format upper-right corner of matrix\n   * no diagonal (only zeros)\n   * iterable from left to right, from top to bottom.\n   *\n   * ```\n   *   A B C D\n   * A 0 1 2 3\n   * B 1 0 4 5\n   * C 2 4 0 6\n   * D 3 5 6 0\n   * ```\n   *\n   * will return compact 1D array `[1, 2, 3, 4, 5, 6]`\n   *\n   * length is S(i=0, n=sideSize-1) => 6 for a 4 side sized matrix\n   *\n   * @returns {number[]}\n   */\n  toCompact() {\n    const { diagonalSize } = this;\n    const compactLength = ((diagonalSize - 1) * diagonalSize) / 2;\n\n    /** @type {number[]} */\n    const compact = new Array(compactLength);\n    for (let col = 1, row = 0, index = 0; index < compact.length; index++) {\n      compact[index] = this.get(row, col);\n\n      if (++col >= diagonalSize) col = ++row + 1;\n    }\n\n    return compact;\n  }\n\n  /**\n   * @param {number[]} compact\n   */\n  static fromCompact(compact) {\n    const compactSize = compact.length;\n\n    if (compactSize === 0) {\n      return new this(0);\n    }\n\n    // compactSize in Natural integer range ]0;\u221E]\n    // compactSize = (sideSize * (sideSize - 1)) / 2\n    // sideSize = (Sqrt(8 \u00D7 compactSize + 1) + 1) / 2\n    const diagonalSize = (Math.sqrt(8 * compactSize + 1) + 1) / 2;\n\n    if (!Number.isInteger(diagonalSize)) {\n      throw new TypeError(\n        `This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(\n          compact,\n        )}`,\n      );\n    }\n\n    const matrix = new this(diagonalSize);\n    for (let col = 1, row = 0, index = 0; index < compactSize; index++) {\n      matrix.set(col, row, compact[index]);\n      if (++col >= diagonalSize) col = ++row + 1;\n    }\n\n    return matrix;\n  }\n}\nDistanceMatrix.prototype.klassSubType = 'DistanceMatrix';\n\nclass BaseView extends AbstractMatrix {\n  constructor(matrix, rows, columns) {\n    super();\n    this.matrix = matrix;\n    this.rows = rows;\n    this.columns = columns;\n  }\n}\n\nclass MatrixColumnView extends BaseView {\n  constructor(matrix, column) {\n    checkColumnIndex(matrix, column);\n    super(matrix, matrix.rows, 1);\n    this.column = column;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(rowIndex, this.column, value);\n    return this;\n  }\n\n  get(rowIndex) {\n    return this.matrix.get(rowIndex, this.column);\n  }\n}\n\nclass MatrixColumnSelectionView extends BaseView {\n  constructor(matrix, columnIndices) {\n    checkColumnIndices(matrix, columnIndices);\n    super(matrix, matrix.rows, columnIndices.length);\n    this.columnIndices = columnIndices;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(rowIndex, this.columnIndices[columnIndex], value);\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(rowIndex, this.columnIndices[columnIndex]);\n  }\n}\n\nclass MatrixFlipColumnView extends BaseView {\n  constructor(matrix) {\n    super(matrix, matrix.rows, matrix.columns);\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(rowIndex, this.columns - columnIndex - 1, value);\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(rowIndex, this.columns - columnIndex - 1);\n  }\n}\n\nclass MatrixFlipRowView extends BaseView {\n  constructor(matrix) {\n    super(matrix, matrix.rows, matrix.columns);\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(this.rows - rowIndex - 1, columnIndex, value);\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(this.rows - rowIndex - 1, columnIndex);\n  }\n}\n\nclass MatrixRowView extends BaseView {\n  constructor(matrix, row) {\n    checkRowIndex(matrix, row);\n    super(matrix, 1, matrix.columns);\n    this.row = row;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(this.row, columnIndex, value);\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(this.row, columnIndex);\n  }\n}\n\nclass MatrixRowSelectionView extends BaseView {\n  constructor(matrix, rowIndices) {\n    checkRowIndices(matrix, rowIndices);\n    super(matrix, rowIndices.length, matrix.columns);\n    this.rowIndices = rowIndices;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(this.rowIndices[rowIndex], columnIndex, value);\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(this.rowIndices[rowIndex], columnIndex);\n  }\n}\n\nclass MatrixSelectionView extends BaseView {\n  constructor(matrix, rowIndices, columnIndices) {\n    checkRowIndices(matrix, rowIndices);\n    checkColumnIndices(matrix, columnIndices);\n    super(matrix, rowIndices.length, columnIndices.length);\n    this.rowIndices = rowIndices;\n    this.columnIndices = columnIndices;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(\n      this.rowIndices[rowIndex],\n      this.columnIndices[columnIndex],\n      value,\n    );\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(\n      this.rowIndices[rowIndex],\n      this.columnIndices[columnIndex],\n    );\n  }\n}\n\nclass MatrixSubView extends BaseView {\n  constructor(matrix, startRow, endRow, startColumn, endColumn) {\n    checkRange(matrix, startRow, endRow, startColumn, endColumn);\n    super(matrix, endRow - startRow + 1, endColumn - startColumn + 1);\n    this.startRow = startRow;\n    this.startColumn = startColumn;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(\n      this.startRow + rowIndex,\n      this.startColumn + columnIndex,\n      value,\n    );\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(\n      this.startRow + rowIndex,\n      this.startColumn + columnIndex,\n    );\n  }\n}\n\nclass MatrixTransposeView extends BaseView {\n  constructor(matrix) {\n    super(matrix, matrix.columns, matrix.rows);\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.matrix.set(columnIndex, rowIndex, value);\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.matrix.get(columnIndex, rowIndex);\n  }\n}\n\nclass WrapperMatrix1D extends AbstractMatrix {\n  constructor(data, options = {}) {\n    const { rows = 1 } = options;\n\n    if (data.length % rows !== 0) {\n      throw new Error('the data length is not divisible by the number of rows');\n    }\n    super();\n    this.rows = rows;\n    this.columns = data.length / rows;\n    this.data = data;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    let index = this._calculateIndex(rowIndex, columnIndex);\n    this.data[index] = value;\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    let index = this._calculateIndex(rowIndex, columnIndex);\n    return this.data[index];\n  }\n\n  _calculateIndex(row, column) {\n    return row * this.columns + column;\n  }\n}\n\nclass WrapperMatrix2D extends AbstractMatrix {\n  constructor(data) {\n    super();\n    this.data = data;\n    this.rows = data.length;\n    this.columns = data[0].length;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.data[rowIndex][columnIndex] = value;\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.data[rowIndex][columnIndex];\n  }\n}\n\nfunction wrap(array, options) {\n  if (isAnyArray.isAnyArray(array)) {\n    if (array[0] && isAnyArray.isAnyArray(array[0])) {\n      return new WrapperMatrix2D(array);\n    } else {\n      return new WrapperMatrix1D(array, options);\n    }\n  } else {\n    throw new Error('the argument is not an array');\n  }\n}\n\nclass LuDecomposition {\n  constructor(matrix) {\n    matrix = WrapperMatrix2D.checkMatrix(matrix);\n\n    let lu = matrix.clone();\n    let rows = lu.rows;\n    let columns = lu.columns;\n    let pivotVector = new Float64Array(rows);\n    let pivotSign = 1;\n    let i, j, k, p, s, t, v;\n    let LUcolj, kmax;\n\n    for (i = 0; i < rows; i++) {\n      pivotVector[i] = i;\n    }\n\n    LUcolj = new Float64Array(rows);\n\n    for (j = 0; j < columns; j++) {\n      for (i = 0; i < rows; i++) {\n        LUcolj[i] = lu.get(i, j);\n      }\n\n      for (i = 0; i < rows; i++) {\n        kmax = Math.min(i, j);\n        s = 0;\n        for (k = 0; k < kmax; k++) {\n          s += lu.get(i, k) * LUcolj[k];\n        }\n        LUcolj[i] -= s;\n        lu.set(i, j, LUcolj[i]);\n      }\n\n      p = j;\n      for (i = j + 1; i < rows; i++) {\n        if (Math.abs(LUcolj[i]) > Math.abs(LUcolj[p])) {\n          p = i;\n        }\n      }\n\n      if (p !== j) {\n        for (k = 0; k < columns; k++) {\n          t = lu.get(p, k);\n          lu.set(p, k, lu.get(j, k));\n          lu.set(j, k, t);\n        }\n\n        v = pivotVector[p];\n        pivotVector[p] = pivotVector[j];\n        pivotVector[j] = v;\n\n        pivotSign = -pivotSign;\n      }\n\n      if (j < rows && lu.get(j, j) !== 0) {\n        for (i = j + 1; i < rows; i++) {\n          lu.set(i, j, lu.get(i, j) / lu.get(j, j));\n        }\n      }\n    }\n\n    this.LU = lu;\n    this.pivotVector = pivotVector;\n    this.pivotSign = pivotSign;\n  }\n\n  isSingular() {\n    let data = this.LU;\n    let col = data.columns;\n    for (let j = 0; j < col; j++) {\n      if (data.get(j, j) === 0) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  solve(value) {\n    value = Matrix.checkMatrix(value);\n\n    let lu = this.LU;\n    let rows = lu.rows;\n\n    if (rows !== value.rows) {\n      throw new Error('Invalid matrix dimensions');\n    }\n    if (this.isSingular()) {\n      throw new Error('LU matrix is singular');\n    }\n\n    let count = value.columns;\n    let X = value.subMatrixRow(this.pivotVector, 0, count - 1);\n    let columns = lu.columns;\n    let i, j, k;\n\n    for (k = 0; k < columns; k++) {\n      for (i = k + 1; i < columns; i++) {\n        for (j = 0; j < count; j++) {\n          X.set(i, j, X.get(i, j) - X.get(k, j) * lu.get(i, k));\n        }\n      }\n    }\n    for (k = columns - 1; k >= 0; k--) {\n      for (j = 0; j < count; j++) {\n        X.set(k, j, X.get(k, j) / lu.get(k, k));\n      }\n      for (i = 0; i < k; i++) {\n        for (j = 0; j < count; j++) {\n          X.set(i, j, X.get(i, j) - X.get(k, j) * lu.get(i, k));\n        }\n      }\n    }\n    return X;\n  }\n\n  get determinant() {\n    let data = this.LU;\n    if (!data.isSquare()) {\n      throw new Error('Matrix must be square');\n    }\n    let determinant = this.pivotSign;\n    let col = data.columns;\n    for (let j = 0; j < col; j++) {\n      determinant *= data.get(j, j);\n    }\n    return determinant;\n  }\n\n  get lowerTriangularMatrix() {\n    let data = this.LU;\n    let rows = data.rows;\n    let columns = data.columns;\n    let X = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        if (i > j) {\n          X.set(i, j, data.get(i, j));\n        } else if (i === j) {\n          X.set(i, j, 1);\n        } else {\n          X.set(i, j, 0);\n        }\n      }\n    }\n    return X;\n  }\n\n  get upperTriangularMatrix() {\n    let data = this.LU;\n    let rows = data.rows;\n    let columns = data.columns;\n    let X = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        if (i <= j) {\n          X.set(i, j, data.get(i, j));\n        } else {\n          X.set(i, j, 0);\n        }\n      }\n    }\n    return X;\n  }\n\n  get pivotPermutationVector() {\n    return Array.from(this.pivotVector);\n  }\n}\n\nfunction hypotenuse(a, b) {\n  let r = 0;\n  if (Math.abs(a) > Math.abs(b)) {\n    r = b / a;\n    return Math.abs(a) * Math.sqrt(1 + r * r);\n  }\n  if (b !== 0) {\n    r = a / b;\n    return Math.abs(b) * Math.sqrt(1 + r * r);\n  }\n  return 0;\n}\n\nclass QrDecomposition {\n  constructor(value) {\n    value = WrapperMatrix2D.checkMatrix(value);\n\n    let qr = value.clone();\n    let m = value.rows;\n    let n = value.columns;\n    let rdiag = new Float64Array(n);\n    let i, j, k, s;\n\n    for (k = 0; k < n; k++) {\n      let nrm = 0;\n      for (i = k; i < m; i++) {\n        nrm = hypotenuse(nrm, qr.get(i, k));\n      }\n      if (nrm !== 0) {\n        if (qr.get(k, k) < 0) {\n          nrm = -nrm;\n        }\n        for (i = k; i < m; i++) {\n          qr.set(i, k, qr.get(i, k) / nrm);\n        }\n        qr.set(k, k, qr.get(k, k) + 1);\n        for (j = k + 1; j < n; j++) {\n          s = 0;\n          for (i = k; i < m; i++) {\n            s += qr.get(i, k) * qr.get(i, j);\n          }\n          s = -s / qr.get(k, k);\n          for (i = k; i < m; i++) {\n            qr.set(i, j, qr.get(i, j) + s * qr.get(i, k));\n          }\n        }\n      }\n      rdiag[k] = -nrm;\n    }\n\n    this.QR = qr;\n    this.Rdiag = rdiag;\n  }\n\n  solve(value) {\n    value = Matrix.checkMatrix(value);\n\n    let qr = this.QR;\n    let m = qr.rows;\n\n    if (value.rows !== m) {\n      throw new Error('Matrix row dimensions must agree');\n    }\n    if (!this.isFullRank()) {\n      throw new Error('Matrix is rank deficient');\n    }\n\n    let count = value.columns;\n    let X = value.clone();\n    let n = qr.columns;\n    let i, j, k, s;\n\n    for (k = 0; k < n; k++) {\n      for (j = 0; j < count; j++) {\n        s = 0;\n        for (i = k; i < m; i++) {\n          s += qr.get(i, k) * X.get(i, j);\n        }\n        s = -s / qr.get(k, k);\n        for (i = k; i < m; i++) {\n          X.set(i, j, X.get(i, j) + s * qr.get(i, k));\n        }\n      }\n    }\n    for (k = n - 1; k >= 0; k--) {\n      for (j = 0; j < count; j++) {\n        X.set(k, j, X.get(k, j) / this.Rdiag[k]);\n      }\n      for (i = 0; i < k; i++) {\n        for (j = 0; j < count; j++) {\n          X.set(i, j, X.get(i, j) - X.get(k, j) * qr.get(i, k));\n        }\n      }\n    }\n\n    return X.subMatrix(0, n - 1, 0, count - 1);\n  }\n\n  isFullRank() {\n    let columns = this.QR.columns;\n    for (let i = 0; i < columns; i++) {\n      if (this.Rdiag[i] === 0) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  get upperTriangularMatrix() {\n    let qr = this.QR;\n    let n = qr.columns;\n    let X = new Matrix(n, n);\n    let i, j;\n    for (i = 0; i < n; i++) {\n      for (j = 0; j < n; j++) {\n        if (i < j) {\n          X.set(i, j, qr.get(i, j));\n        } else if (i === j) {\n          X.set(i, j, this.Rdiag[i]);\n        } else {\n          X.set(i, j, 0);\n        }\n      }\n    }\n    return X;\n  }\n\n  get orthogonalMatrix() {\n    let qr = this.QR;\n    let rows = qr.rows;\n    let columns = qr.columns;\n    let X = new Matrix(rows, columns);\n    let i, j, k, s;\n\n    for (k = columns - 1; k >= 0; k--) {\n      for (i = 0; i < rows; i++) {\n        X.set(i, k, 0);\n      }\n      X.set(k, k, 1);\n      for (j = k; j < columns; j++) {\n        if (qr.get(k, k) !== 0) {\n          s = 0;\n          for (i = k; i < rows; i++) {\n            s += qr.get(i, k) * X.get(i, j);\n          }\n\n          s = -s / qr.get(k, k);\n\n          for (i = k; i < rows; i++) {\n            X.set(i, j, X.get(i, j) + s * qr.get(i, k));\n          }\n        }\n      }\n    }\n    return X;\n  }\n}\n\nclass SingularValueDecomposition {\n  constructor(value, options = {}) {\n    value = WrapperMatrix2D.checkMatrix(value);\n\n    if (value.isEmpty()) {\n      throw new Error('Matrix must be non-empty');\n    }\n\n    let m = value.rows;\n    let n = value.columns;\n\n    const {\n      computeLeftSingularVectors = true,\n      computeRightSingularVectors = true,\n      autoTranspose = false,\n    } = options;\n\n    let wantu = Boolean(computeLeftSingularVectors);\n    let wantv = Boolean(computeRightSingularVectors);\n\n    let swapped = false;\n    let a;\n    if (m < n) {\n      if (!autoTranspose) {\n        a = value.clone();\n        // eslint-disable-next-line no-console\n        console.warn(\n          'Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose',\n        );\n      } else {\n        a = value.transpose();\n        m = a.rows;\n        n = a.columns;\n        swapped = true;\n        let aux = wantu;\n        wantu = wantv;\n        wantv = aux;\n      }\n    } else {\n      a = value.clone();\n    }\n\n    let nu = Math.min(m, n);\n    let ni = Math.min(m + 1, n);\n    let s = new Float64Array(ni);\n    let U = new Matrix(m, nu);\n    let V = new Matrix(n, n);\n\n    let e = new Float64Array(n);\n    let work = new Float64Array(m);\n\n    let si = new Float64Array(ni);\n    for (let i = 0; i < ni; i++) si[i] = i;\n\n    let nct = Math.min(m - 1, n);\n    let nrt = Math.max(0, Math.min(n - 2, m));\n    let mrc = Math.max(nct, nrt);\n\n    for (let k = 0; k < mrc; k++) {\n      if (k < nct) {\n        s[k] = 0;\n        for (let i = k; i < m; i++) {\n          s[k] = hypotenuse(s[k], a.get(i, k));\n        }\n        if (s[k] !== 0) {\n          if (a.get(k, k) < 0) {\n            s[k] = -s[k];\n          }\n          for (let i = k; i < m; i++) {\n            a.set(i, k, a.get(i, k) / s[k]);\n          }\n          a.set(k, k, a.get(k, k) + 1);\n        }\n        s[k] = -s[k];\n      }\n\n      for (let j = k + 1; j < n; j++) {\n        if (k < nct && s[k] !== 0) {\n          let t = 0;\n          for (let i = k; i < m; i++) {\n            t += a.get(i, k) * a.get(i, j);\n          }\n          t = -t / a.get(k, k);\n          for (let i = k; i < m; i++) {\n            a.set(i, j, a.get(i, j) + t * a.get(i, k));\n          }\n        }\n        e[j] = a.get(k, j);\n      }\n\n      if (wantu && k < nct) {\n        for (let i = k; i < m; i++) {\n          U.set(i, k, a.get(i, k));\n        }\n      }\n\n      if (k < nrt) {\n        e[k] = 0;\n        for (let i = k + 1; i < n; i++) {\n          e[k] = hypotenuse(e[k], e[i]);\n        }\n        if (e[k] !== 0) {\n          if (e[k + 1] < 0) {\n            e[k] = 0 - e[k];\n          }\n          for (let i = k + 1; i < n; i++) {\n            e[i] /= e[k];\n          }\n          e[k + 1] += 1;\n        }\n        e[k] = -e[k];\n        if (k + 1 < m && e[k] !== 0) {\n          for (let i = k + 1; i < m; i++) {\n            work[i] = 0;\n          }\n          for (let i = k + 1; i < m; i++) {\n            for (let j = k + 1; j < n; j++) {\n              work[i] += e[j] * a.get(i, j);\n            }\n          }\n          for (let j = k + 1; j < n; j++) {\n            let t = -e[j] / e[k + 1];\n            for (let i = k + 1; i < m; i++) {\n              a.set(i, j, a.get(i, j) + t * work[i]);\n            }\n          }\n        }\n        if (wantv) {\n          for (let i = k + 1; i < n; i++) {\n            V.set(i, k, e[i]);\n          }\n        }\n      }\n    }\n\n    let p = Math.min(n, m + 1);\n    if (nct < n) {\n      s[nct] = a.get(nct, nct);\n    }\n    if (m < p) {\n      s[p - 1] = 0;\n    }\n    if (nrt + 1 < p) {\n      e[nrt] = a.get(nrt, p - 1);\n    }\n    e[p - 1] = 0;\n\n    if (wantu) {\n      for (let j = nct; j < nu; j++) {\n        for (let i = 0; i < m; i++) {\n          U.set(i, j, 0);\n        }\n        U.set(j, j, 1);\n      }\n      for (let k = nct - 1; k >= 0; k--) {\n        if (s[k] !== 0) {\n          for (let j = k + 1; j < nu; j++) {\n            let t = 0;\n            for (let i = k; i < m; i++) {\n              t += U.get(i, k) * U.get(i, j);\n            }\n            t = -t / U.get(k, k);\n            for (let i = k; i < m; i++) {\n              U.set(i, j, U.get(i, j) + t * U.get(i, k));\n            }\n          }\n          for (let i = k; i < m; i++) {\n            U.set(i, k, -U.get(i, k));\n          }\n          U.set(k, k, 1 + U.get(k, k));\n          for (let i = 0; i < k - 1; i++) {\n            U.set(i, k, 0);\n          }\n        } else {\n          for (let i = 0; i < m; i++) {\n            U.set(i, k, 0);\n          }\n          U.set(k, k, 1);\n        }\n      }\n    }\n\n    if (wantv) {\n      for (let k = n - 1; k >= 0; k--) {\n        if (k < nrt && e[k] !== 0) {\n          for (let j = k + 1; j < n; j++) {\n            let t = 0;\n            for (let i = k + 1; i < n; i++) {\n              t += V.get(i, k) * V.get(i, j);\n            }\n            t = -t / V.get(k + 1, k);\n            for (let i = k + 1; i < n; i++) {\n              V.set(i, j, V.get(i, j) + t * V.get(i, k));\n            }\n          }\n        }\n        for (let i = 0; i < n; i++) {\n          V.set(i, k, 0);\n        }\n        V.set(k, k, 1);\n      }\n    }\n\n    let pp = p - 1;\n    let eps = Number.EPSILON;\n    while (p > 0) {\n      let k, kase;\n      for (k = p - 2; k >= -1; k--) {\n        if (k === -1) {\n          break;\n        }\n        const alpha =\n          Number.MIN_VALUE + eps * Math.abs(s[k] + Math.abs(s[k + 1]));\n        if (Math.abs(e[k]) <= alpha || Number.isNaN(e[k])) {\n          e[k] = 0;\n          break;\n        }\n      }\n      if (k === p - 2) {\n        kase = 4;\n      } else {\n        let ks;\n        for (ks = p - 1; ks >= k; ks--) {\n          if (ks === k) {\n            break;\n          }\n          let t =\n            (ks !== p ? Math.abs(e[ks]) : 0) +\n            (ks !== k + 1 ? Math.abs(e[ks - 1]) : 0);\n          if (Math.abs(s[ks]) <= eps * t) {\n            s[ks] = 0;\n            break;\n          }\n        }\n        if (ks === k) {\n          kase = 3;\n        } else if (ks === p - 1) {\n          kase = 1;\n        } else {\n          kase = 2;\n          k = ks;\n        }\n      }\n\n      k++;\n\n      switch (kase) {\n        case 1: {\n          let f = e[p - 2];\n          e[p - 2] = 0;\n          for (let j = p - 2; j >= k; j--) {\n            let t = hypotenuse(s[j], f);\n            let cs = s[j] / t;\n            let sn = f / t;\n            s[j] = t;\n            if (j !== k) {\n              f = -sn * e[j - 1];\n              e[j - 1] = cs * e[j - 1];\n            }\n            if (wantv) {\n              for (let i = 0; i < n; i++) {\n                t = cs * V.get(i, j) + sn * V.get(i, p - 1);\n                V.set(i, p - 1, -sn * V.get(i, j) + cs * V.get(i, p - 1));\n                V.set(i, j, t);\n              }\n            }\n          }\n          break;\n        }\n        case 2: {\n          let f = e[k - 1];\n          e[k - 1] = 0;\n          for (let j = k; j < p; j++) {\n            let t = hypotenuse(s[j], f);\n            let cs = s[j] / t;\n            let sn = f / t;\n            s[j] = t;\n            f = -sn * e[j];\n            e[j] = cs * e[j];\n            if (wantu) {\n              for (let i = 0; i < m; i++) {\n                t = cs * U.get(i, j) + sn * U.get(i, k - 1);\n                U.set(i, k - 1, -sn * U.get(i, j) + cs * U.get(i, k - 1));\n                U.set(i, j, t);\n              }\n            }\n          }\n          break;\n        }\n        case 3: {\n          const scale = Math.max(\n            Math.abs(s[p - 1]),\n            Math.abs(s[p - 2]),\n            Math.abs(e[p - 2]),\n            Math.abs(s[k]),\n            Math.abs(e[k]),\n          );\n          const sp = s[p - 1] / scale;\n          const spm1 = s[p - 2] / scale;\n          const epm1 = e[p - 2] / scale;\n          const sk = s[k] / scale;\n          const ek = e[k] / scale;\n          const b = ((spm1 + sp) * (spm1 - sp) + epm1 * epm1) / 2;\n          const c = sp * epm1 * (sp * epm1);\n          let shift = 0;\n          if (b !== 0 || c !== 0) {\n            if (b < 0) {\n              shift = 0 - Math.sqrt(b * b + c);\n            } else {\n              shift = Math.sqrt(b * b + c);\n            }\n            shift = c / (b + shift);\n          }\n          let f = (sk + sp) * (sk - sp) + shift;\n          let g = sk * ek;\n          for (let j = k; j < p - 1; j++) {\n            let t = hypotenuse(f, g);\n            if (t === 0) t = Number.MIN_VALUE;\n            let cs = f / t;\n            let sn = g / t;\n            if (j !== k) {\n              e[j - 1] = t;\n            }\n            f = cs * s[j] + sn * e[j];\n            e[j] = cs * e[j] - sn * s[j];\n            g = sn * s[j + 1];\n            s[j + 1] = cs * s[j + 1];\n            if (wantv) {\n              for (let i = 0; i < n; i++) {\n                t = cs * V.get(i, j) + sn * V.get(i, j + 1);\n                V.set(i, j + 1, -sn * V.get(i, j) + cs * V.get(i, j + 1));\n                V.set(i, j, t);\n              }\n            }\n            t = hypotenuse(f, g);\n            if (t === 0) t = Number.MIN_VALUE;\n            cs = f / t;\n            sn = g / t;\n            s[j] = t;\n            f = cs * e[j] + sn * s[j + 1];\n            s[j + 1] = -sn * e[j] + cs * s[j + 1];\n            g = sn * e[j + 1];\n            e[j + 1] = cs * e[j + 1];\n            if (wantu && j < m - 1) {\n              for (let i = 0; i < m; i++) {\n                t = cs * U.get(i, j) + sn * U.get(i, j + 1);\n                U.set(i, j + 1, -sn * U.get(i, j) + cs * U.get(i, j + 1));\n                U.set(i, j, t);\n              }\n            }\n          }\n          e[p - 2] = f;\n          break;\n        }\n        case 4: {\n          if (s[k] <= 0) {\n            s[k] = s[k] < 0 ? -s[k] : 0;\n            if (wantv) {\n              for (let i = 0; i <= pp; i++) {\n                V.set(i, k, -V.get(i, k));\n              }\n            }\n          }\n          while (k < pp) {\n            if (s[k] >= s[k + 1]) {\n              break;\n            }\n            let t = s[k];\n            s[k] = s[k + 1];\n            s[k + 1] = t;\n            if (wantv && k < n - 1) {\n              for (let i = 0; i < n; i++) {\n                t = V.get(i, k + 1);\n                V.set(i, k + 1, V.get(i, k));\n                V.set(i, k, t);\n              }\n            }\n            if (wantu && k < m - 1) {\n              for (let i = 0; i < m; i++) {\n                t = U.get(i, k + 1);\n                U.set(i, k + 1, U.get(i, k));\n                U.set(i, k, t);\n              }\n            }\n            k++;\n          }\n          p--;\n          break;\n        }\n        // no default\n      }\n    }\n\n    if (swapped) {\n      let tmp = V;\n      V = U;\n      U = tmp;\n    }\n\n    this.m = m;\n    this.n = n;\n    this.s = s;\n    this.U = U;\n    this.V = V;\n  }\n\n  solve(value) {\n    let Y = value;\n    let e = this.threshold;\n    let scols = this.s.length;\n    let Ls = Matrix.zeros(scols, scols);\n\n    for (let i = 0; i < scols; i++) {\n      if (Math.abs(this.s[i]) <= e) {\n        Ls.set(i, i, 0);\n      } else {\n        Ls.set(i, i, 1 / this.s[i]);\n      }\n    }\n\n    let U = this.U;\n    let V = this.rightSingularVectors;\n\n    let VL = V.mmul(Ls);\n    let vrows = V.rows;\n    let urows = U.rows;\n    let VLU = Matrix.zeros(vrows, urows);\n\n    for (let i = 0; i < vrows; i++) {\n      for (let j = 0; j < urows; j++) {\n        let sum = 0;\n        for (let k = 0; k < scols; k++) {\n          sum += VL.get(i, k) * U.get(j, k);\n        }\n        VLU.set(i, j, sum);\n      }\n    }\n\n    return VLU.mmul(Y);\n  }\n\n  solveForDiagonal(value) {\n    return this.solve(Matrix.diag(value));\n  }\n\n  inverse() {\n    let V = this.V;\n    let e = this.threshold;\n    let vrows = V.rows;\n    let vcols = V.columns;\n    let X = new Matrix(vrows, this.s.length);\n\n    for (let i = 0; i < vrows; i++) {\n      for (let j = 0; j < vcols; j++) {\n        if (Math.abs(this.s[j]) > e) {\n          X.set(i, j, V.get(i, j) / this.s[j]);\n        }\n      }\n    }\n\n    let U = this.U;\n\n    let urows = U.rows;\n    let ucols = U.columns;\n    let Y = new Matrix(vrows, urows);\n\n    for (let i = 0; i < vrows; i++) {\n      for (let j = 0; j < urows; j++) {\n        let sum = 0;\n        for (let k = 0; k < ucols; k++) {\n          sum += X.get(i, k) * U.get(j, k);\n        }\n        Y.set(i, j, sum);\n      }\n    }\n\n    return Y;\n  }\n\n  get condition() {\n    return this.s[0] / this.s[Math.min(this.m, this.n) - 1];\n  }\n\n  get norm2() {\n    return this.s[0];\n  }\n\n  get rank() {\n    let tol = Math.max(this.m, this.n) * this.s[0] * Number.EPSILON;\n    let r = 0;\n    let s = this.s;\n    for (let i = 0, ii = s.length; i < ii; i++) {\n      if (s[i] > tol) {\n        r++;\n      }\n    }\n    return r;\n  }\n\n  get diagonal() {\n    return Array.from(this.s);\n  }\n\n  get threshold() {\n    return (Number.EPSILON / 2) * Math.max(this.m, this.n) * this.s[0];\n  }\n\n  get leftSingularVectors() {\n    return this.U;\n  }\n\n  get rightSingularVectors() {\n    return this.V;\n  }\n\n  get diagonalMatrix() {\n    return Matrix.diag(this.s);\n  }\n}\n\nfunction inverse(matrix, useSVD = false) {\n  matrix = WrapperMatrix2D.checkMatrix(matrix);\n  if (useSVD) {\n    return new SingularValueDecomposition(matrix).inverse();\n  } else {\n    return solve(matrix, Matrix.eye(matrix.rows));\n  }\n}\n\nfunction solve(leftHandSide, rightHandSide, useSVD = false) {\n  leftHandSide = WrapperMatrix2D.checkMatrix(leftHandSide);\n  rightHandSide = WrapperMatrix2D.checkMatrix(rightHandSide);\n  if (useSVD) {\n    return new SingularValueDecomposition(leftHandSide).solve(rightHandSide);\n  } else {\n    return leftHandSide.isSquare()\n      ? new LuDecomposition(leftHandSide).solve(rightHandSide)\n      : new QrDecomposition(leftHandSide).solve(rightHandSide);\n  }\n}\n\nfunction determinant(matrix) {\n  matrix = Matrix.checkMatrix(matrix);\n  if (matrix.isSquare()) {\n    if (matrix.columns === 0) {\n      return 1;\n    }\n\n    let a, b, c, d;\n    if (matrix.columns === 2) {\n      // 2 x 2 matrix\n      a = matrix.get(0, 0);\n      b = matrix.get(0, 1);\n      c = matrix.get(1, 0);\n      d = matrix.get(1, 1);\n\n      return a * d - b * c;\n    } else if (matrix.columns === 3) {\n      // 3 x 3 matrix\n      let subMatrix0, subMatrix1, subMatrix2;\n      subMatrix0 = new MatrixSelectionView(matrix, [1, 2], [1, 2]);\n      subMatrix1 = new MatrixSelectionView(matrix, [1, 2], [0, 2]);\n      subMatrix2 = new MatrixSelectionView(matrix, [1, 2], [0, 1]);\n      a = matrix.get(0, 0);\n      b = matrix.get(0, 1);\n      c = matrix.get(0, 2);\n\n      return (\n        a * determinant(subMatrix0) -\n        b * determinant(subMatrix1) +\n        c * determinant(subMatrix2)\n      );\n    } else {\n      // general purpose determinant using the LU decomposition\n      return new LuDecomposition(matrix).determinant;\n    }\n  } else {\n    throw Error('determinant can only be calculated for a square matrix');\n  }\n}\n\nfunction xrange(n, exception) {\n  let range = [];\n  for (let i = 0; i < n; i++) {\n    if (i !== exception) {\n      range.push(i);\n    }\n  }\n  return range;\n}\n\nfunction dependenciesOneRow(\n  error,\n  matrix,\n  index,\n  thresholdValue = 10e-10,\n  thresholdError = 10e-10,\n) {\n  if (error > thresholdError) {\n    return new Array(matrix.rows + 1).fill(0);\n  } else {\n    let returnArray = matrix.addRow(index, [0]);\n    for (let i = 0; i < returnArray.rows; i++) {\n      if (Math.abs(returnArray.get(i, 0)) < thresholdValue) {\n        returnArray.set(i, 0, 0);\n      }\n    }\n    return returnArray.to1DArray();\n  }\n}\n\nfunction linearDependencies(matrix, options = {}) {\n  const { thresholdValue = 10e-10, thresholdError = 10e-10 } = options;\n  matrix = Matrix.checkMatrix(matrix);\n\n  let n = matrix.rows;\n  let results = new Matrix(n, n);\n\n  for (let i = 0; i < n; i++) {\n    let b = Matrix.columnVector(matrix.getRow(i));\n    let Abis = matrix.subMatrixRow(xrange(n, i)).transpose();\n    let svd = new SingularValueDecomposition(Abis);\n    let x = svd.solve(b);\n    let error = Matrix.sub(b, Abis.mmul(x)).abs().max();\n    results.setRow(\n      i,\n      dependenciesOneRow(error, x, i, thresholdValue, thresholdError),\n    );\n  }\n  return results;\n}\n\nfunction pseudoInverse(matrix, threshold = Number.EPSILON) {\n  matrix = Matrix.checkMatrix(matrix);\n  if (matrix.isEmpty()) {\n    // with a zero dimension, the pseudo-inverse is the transpose, since all 0xn and nx0 matrices are singular\n    // (0xn)*(nx0)*(0xn) = 0xn\n    // (nx0)*(0xn)*(nx0) = nx0\n    return matrix.transpose();\n  }\n  let svdSolution = new SingularValueDecomposition(matrix, { autoTranspose: true });\n\n  let U = svdSolution.leftSingularVectors;\n  let V = svdSolution.rightSingularVectors;\n  let s = svdSolution.diagonal;\n\n  for (let i = 0; i < s.length; i++) {\n    if (Math.abs(s[i]) > threshold) {\n      s[i] = 1.0 / s[i];\n    } else {\n      s[i] = 0.0;\n    }\n  }\n\n  return V.mmul(Matrix.diag(s).mmul(U.transpose()));\n}\n\nfunction covariance(xMatrix, yMatrix = xMatrix, options = {}) {\n  xMatrix = new Matrix(xMatrix);\n  let yIsSame = false;\n  if (\n    typeof yMatrix === 'object' &&\n    !Matrix.isMatrix(yMatrix) &&\n    !isAnyArray.isAnyArray(yMatrix)\n  ) {\n    options = yMatrix;\n    yMatrix = xMatrix;\n    yIsSame = true;\n  } else {\n    yMatrix = new Matrix(yMatrix);\n  }\n  if (xMatrix.rows !== yMatrix.rows) {\n    throw new TypeError('Both matrices must have the same number of rows');\n  }\n  const { center = true } = options;\n  if (center) {\n    xMatrix = xMatrix.center('column');\n    if (!yIsSame) {\n      yMatrix = yMatrix.center('column');\n    }\n  }\n  const cov = xMatrix.transpose().mmul(yMatrix);\n  for (let i = 0; i < cov.rows; i++) {\n    for (let j = 0; j < cov.columns; j++) {\n      cov.set(i, j, cov.get(i, j) * (1 / (xMatrix.rows - 1)));\n    }\n  }\n  return cov;\n}\n\nfunction correlation(xMatrix, yMatrix = xMatrix, options = {}) {\n  xMatrix = new Matrix(xMatrix);\n  let yIsSame = false;\n  if (\n    typeof yMatrix === 'object' &&\n    !Matrix.isMatrix(yMatrix) &&\n    !isAnyArray.isAnyArray(yMatrix)\n  ) {\n    options = yMatrix;\n    yMatrix = xMatrix;\n    yIsSame = true;\n  } else {\n    yMatrix = new Matrix(yMatrix);\n  }\n  if (xMatrix.rows !== yMatrix.rows) {\n    throw new TypeError('Both matrices must have the same number of rows');\n  }\n\n  const { center = true, scale = true } = options;\n  if (center) {\n    xMatrix.center('column');\n    if (!yIsSame) {\n      yMatrix.center('column');\n    }\n  }\n  if (scale) {\n    xMatrix.scale('column');\n    if (!yIsSame) {\n      yMatrix.scale('column');\n    }\n  }\n\n  const sdx = xMatrix.standardDeviation('column', { unbiased: true });\n  const sdy = yIsSame\n    ? sdx\n    : yMatrix.standardDeviation('column', { unbiased: true });\n\n  const corr = xMatrix.transpose().mmul(yMatrix);\n  for (let i = 0; i < corr.rows; i++) {\n    for (let j = 0; j < corr.columns; j++) {\n      corr.set(\n        i,\n        j,\n        corr.get(i, j) * (1 / (sdx[i] * sdy[j])) * (1 / (xMatrix.rows - 1)),\n      );\n    }\n  }\n  return corr;\n}\n\nclass EigenvalueDecomposition {\n  constructor(matrix, options = {}) {\n    const { assumeSymmetric = false } = options;\n\n    matrix = WrapperMatrix2D.checkMatrix(matrix);\n    if (!matrix.isSquare()) {\n      throw new Error('Matrix is not a square matrix');\n    }\n\n    if (matrix.isEmpty()) {\n      throw new Error('Matrix must be non-empty');\n    }\n\n    let n = matrix.columns;\n    let V = new Matrix(n, n);\n    let d = new Float64Array(n);\n    let e = new Float64Array(n);\n    let value = matrix;\n    let i, j;\n\n    let isSymmetric = false;\n    if (assumeSymmetric) {\n      isSymmetric = true;\n    } else {\n      isSymmetric = matrix.isSymmetric();\n    }\n\n    if (isSymmetric) {\n      for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n          V.set(i, j, value.get(i, j));\n        }\n      }\n      tred2(n, e, d, V);\n      tql2(n, e, d, V);\n    } else {\n      let H = new Matrix(n, n);\n      let ort = new Float64Array(n);\n      for (j = 0; j < n; j++) {\n        for (i = 0; i < n; i++) {\n          H.set(i, j, value.get(i, j));\n        }\n      }\n      orthes(n, H, ort, V);\n      hqr2(n, e, d, V, H);\n    }\n\n    this.n = n;\n    this.e = e;\n    this.d = d;\n    this.V = V;\n  }\n\n  get realEigenvalues() {\n    return Array.from(this.d);\n  }\n\n  get imaginaryEigenvalues() {\n    return Array.from(this.e);\n  }\n\n  get eigenvectorMatrix() {\n    return this.V;\n  }\n\n  get diagonalMatrix() {\n    let n = this.n;\n    let e = this.e;\n    let d = this.d;\n    let X = new Matrix(n, n);\n    let i, j;\n    for (i = 0; i < n; i++) {\n      for (j = 0; j < n; j++) {\n        X.set(i, j, 0);\n      }\n      X.set(i, i, d[i]);\n      if (e[i] > 0) {\n        X.set(i, i + 1, e[i]);\n      } else if (e[i] < 0) {\n        X.set(i, i - 1, e[i]);\n      }\n    }\n    return X;\n  }\n}\n\nfunction tred2(n, e, d, V) {\n  let f, g, h, i, j, k, hh, scale;\n\n  for (j = 0; j < n; j++) {\n    d[j] = V.get(n - 1, j);\n  }\n\n  for (i = n - 1; i > 0; i--) {\n    scale = 0;\n    h = 0;\n    for (k = 0; k < i; k++) {\n      scale = scale + Math.abs(d[k]);\n    }\n\n    if (scale === 0) {\n      e[i] = d[i - 1];\n      for (j = 0; j < i; j++) {\n        d[j] = V.get(i - 1, j);\n        V.set(i, j, 0);\n        V.set(j, i, 0);\n      }\n    } else {\n      for (k = 0; k < i; k++) {\n        d[k] /= scale;\n        h += d[k] * d[k];\n      }\n\n      f = d[i - 1];\n      g = Math.sqrt(h);\n      if (f > 0) {\n        g = -g;\n      }\n\n      e[i] = scale * g;\n      h = h - f * g;\n      d[i - 1] = f - g;\n      for (j = 0; j < i; j++) {\n        e[j] = 0;\n      }\n\n      for (j = 0; j < i; j++) {\n        f = d[j];\n        V.set(j, i, f);\n        g = e[j] + V.get(j, j) * f;\n        for (k = j + 1; k <= i - 1; k++) {\n          g += V.get(k, j) * d[k];\n          e[k] += V.get(k, j) * f;\n        }\n        e[j] = g;\n      }\n\n      f = 0;\n      for (j = 0; j < i; j++) {\n        e[j] /= h;\n        f += e[j] * d[j];\n      }\n\n      hh = f / (h + h);\n      for (j = 0; j < i; j++) {\n        e[j] -= hh * d[j];\n      }\n\n      for (j = 0; j < i; j++) {\n        f = d[j];\n        g = e[j];\n        for (k = j; k <= i - 1; k++) {\n          V.set(k, j, V.get(k, j) - (f * e[k] + g * d[k]));\n        }\n        d[j] = V.get(i - 1, j);\n        V.set(i, j, 0);\n      }\n    }\n    d[i] = h;\n  }\n\n  for (i = 0; i < n - 1; i++) {\n    V.set(n - 1, i, V.get(i, i));\n    V.set(i, i, 1);\n    h = d[i + 1];\n    if (h !== 0) {\n      for (k = 0; k <= i; k++) {\n        d[k] = V.get(k, i + 1) / h;\n      }\n\n      for (j = 0; j <= i; j++) {\n        g = 0;\n        for (k = 0; k <= i; k++) {\n          g += V.get(k, i + 1) * V.get(k, j);\n        }\n        for (k = 0; k <= i; k++) {\n          V.set(k, j, V.get(k, j) - g * d[k]);\n        }\n      }\n    }\n\n    for (k = 0; k <= i; k++) {\n      V.set(k, i + 1, 0);\n    }\n  }\n\n  for (j = 0; j < n; j++) {\n    d[j] = V.get(n - 1, j);\n    V.set(n - 1, j, 0);\n  }\n\n  V.set(n - 1, n - 1, 1);\n  e[0] = 0;\n}\n\nfunction tql2(n, e, d, V) {\n  let g, h, i, j, k, l, m, p, r, dl1, c, c2, c3, el1, s, s2;\n\n  for (i = 1; i < n; i++) {\n    e[i - 1] = e[i];\n  }\n\n  e[n - 1] = 0;\n\n  let f = 0;\n  let tst1 = 0;\n  let eps = Number.EPSILON;\n\n  for (l = 0; l < n; l++) {\n    tst1 = Math.max(tst1, Math.abs(d[l]) + Math.abs(e[l]));\n    m = l;\n    while (m < n) {\n      if (Math.abs(e[m]) <= eps * tst1) {\n        break;\n      }\n      m++;\n    }\n\n    if (m > l) {\n      do {\n\n        g = d[l];\n        p = (d[l + 1] - g) / (2 * e[l]);\n        r = hypotenuse(p, 1);\n        if (p < 0) {\n          r = -r;\n        }\n\n        d[l] = e[l] / (p + r);\n        d[l + 1] = e[l] * (p + r);\n        dl1 = d[l + 1];\n        h = g - d[l];\n        for (i = l + 2; i < n; i++) {\n          d[i] -= h;\n        }\n\n        f = f + h;\n\n        p = d[m];\n        c = 1;\n        c2 = c;\n        c3 = c;\n        el1 = e[l + 1];\n        s = 0;\n        s2 = 0;\n        for (i = m - 1; i >= l; i--) {\n          c3 = c2;\n          c2 = c;\n          s2 = s;\n          g = c * e[i];\n          h = c * p;\n          r = hypotenuse(p, e[i]);\n          e[i + 1] = s * r;\n          s = e[i] / r;\n          c = p / r;\n          p = c * d[i] - s * g;\n          d[i + 1] = h + s * (c * g + s * d[i]);\n\n          for (k = 0; k < n; k++) {\n            h = V.get(k, i + 1);\n            V.set(k, i + 1, s * V.get(k, i) + c * h);\n            V.set(k, i, c * V.get(k, i) - s * h);\n          }\n        }\n\n        p = (-s * s2 * c3 * el1 * e[l]) / dl1;\n        e[l] = s * p;\n        d[l] = c * p;\n      } while (Math.abs(e[l]) > eps * tst1);\n    }\n    d[l] = d[l] + f;\n    e[l] = 0;\n  }\n\n  for (i = 0; i < n - 1; i++) {\n    k = i;\n    p = d[i];\n    for (j = i + 1; j < n; j++) {\n      if (d[j] < p) {\n        k = j;\n        p = d[j];\n      }\n    }\n\n    if (k !== i) {\n      d[k] = d[i];\n      d[i] = p;\n      for (j = 0; j < n; j++) {\n        p = V.get(j, i);\n        V.set(j, i, V.get(j, k));\n        V.set(j, k, p);\n      }\n    }\n  }\n}\n\nfunction orthes(n, H, ort, V) {\n  let low = 0;\n  let high = n - 1;\n  let f, g, h, i, j, m;\n  let scale;\n\n  for (m = low + 1; m <= high - 1; m++) {\n    scale = 0;\n    for (i = m; i <= high; i++) {\n      scale = scale + Math.abs(H.get(i, m - 1));\n    }\n\n    if (scale !== 0) {\n      h = 0;\n      for (i = high; i >= m; i--) {\n        ort[i] = H.get(i, m - 1) / scale;\n        h += ort[i] * ort[i];\n      }\n\n      g = Math.sqrt(h);\n      if (ort[m] > 0) {\n        g = -g;\n      }\n\n      h = h - ort[m] * g;\n      ort[m] = ort[m] - g;\n\n      for (j = m; j < n; j++) {\n        f = 0;\n        for (i = high; i >= m; i--) {\n          f += ort[i] * H.get(i, j);\n        }\n\n        f = f / h;\n        for (i = m; i <= high; i++) {\n          H.set(i, j, H.get(i, j) - f * ort[i]);\n        }\n      }\n\n      for (i = 0; i <= high; i++) {\n        f = 0;\n        for (j = high; j >= m; j--) {\n          f += ort[j] * H.get(i, j);\n        }\n\n        f = f / h;\n        for (j = m; j <= high; j++) {\n          H.set(i, j, H.get(i, j) - f * ort[j]);\n        }\n      }\n\n      ort[m] = scale * ort[m];\n      H.set(m, m - 1, scale * g);\n    }\n  }\n\n  for (i = 0; i < n; i++) {\n    for (j = 0; j < n; j++) {\n      V.set(i, j, i === j ? 1 : 0);\n    }\n  }\n\n  for (m = high - 1; m >= low + 1; m--) {\n    if (H.get(m, m - 1) !== 0) {\n      for (i = m + 1; i <= high; i++) {\n        ort[i] = H.get(i, m - 1);\n      }\n\n      for (j = m; j <= high; j++) {\n        g = 0;\n        for (i = m; i <= high; i++) {\n          g += ort[i] * V.get(i, j);\n        }\n\n        g = g / ort[m] / H.get(m, m - 1);\n        for (i = m; i <= high; i++) {\n          V.set(i, j, V.get(i, j) + g * ort[i]);\n        }\n      }\n    }\n  }\n}\n\nfunction hqr2(nn, e, d, V, H) {\n  let n = nn - 1;\n  let low = 0;\n  let high = nn - 1;\n  let eps = Number.EPSILON;\n  let exshift = 0;\n  let norm = 0;\n  let p = 0;\n  let q = 0;\n  let r = 0;\n  let s = 0;\n  let z = 0;\n  let iter = 0;\n  let i, j, k, l, m, t, w, x, y;\n  let ra, sa, vr, vi;\n  let notlast, cdivres;\n\n  for (i = 0; i < nn; i++) {\n    if (i < low || i > high) {\n      d[i] = H.get(i, i);\n      e[i] = 0;\n    }\n\n    for (j = Math.max(i - 1, 0); j < nn; j++) {\n      norm = norm + Math.abs(H.get(i, j));\n    }\n  }\n\n  while (n >= low) {\n    l = n;\n    while (l > low) {\n      s = Math.abs(H.get(l - 1, l - 1)) + Math.abs(H.get(l, l));\n      if (s === 0) {\n        s = norm;\n      }\n      if (Math.abs(H.get(l, l - 1)) < eps * s) {\n        break;\n      }\n      l--;\n    }\n\n    if (l === n) {\n      H.set(n, n, H.get(n, n) + exshift);\n      d[n] = H.get(n, n);\n      e[n] = 0;\n      n--;\n      iter = 0;\n    } else if (l === n - 1) {\n      w = H.get(n, n - 1) * H.get(n - 1, n);\n      p = (H.get(n - 1, n - 1) - H.get(n, n)) / 2;\n      q = p * p + w;\n      z = Math.sqrt(Math.abs(q));\n      H.set(n, n, H.get(n, n) + exshift);\n      H.set(n - 1, n - 1, H.get(n - 1, n - 1) + exshift);\n      x = H.get(n, n);\n\n      if (q >= 0) {\n        z = p >= 0 ? p + z : p - z;\n        d[n - 1] = x + z;\n        d[n] = d[n - 1];\n        if (z !== 0) {\n          d[n] = x - w / z;\n        }\n        e[n - 1] = 0;\n        e[n] = 0;\n        x = H.get(n, n - 1);\n        s = Math.abs(x) + Math.abs(z);\n        p = x / s;\n        q = z / s;\n        r = Math.sqrt(p * p + q * q);\n        p = p / r;\n        q = q / r;\n\n        for (j = n - 1; j < nn; j++) {\n          z = H.get(n - 1, j);\n          H.set(n - 1, j, q * z + p * H.get(n, j));\n          H.set(n, j, q * H.get(n, j) - p * z);\n        }\n\n        for (i = 0; i <= n; i++) {\n          z = H.get(i, n - 1);\n          H.set(i, n - 1, q * z + p * H.get(i, n));\n          H.set(i, n, q * H.get(i, n) - p * z);\n        }\n\n        for (i = low; i <= high; i++) {\n          z = V.get(i, n - 1);\n          V.set(i, n - 1, q * z + p * V.get(i, n));\n          V.set(i, n, q * V.get(i, n) - p * z);\n        }\n      } else {\n        d[n - 1] = x + p;\n        d[n] = x + p;\n        e[n - 1] = z;\n        e[n] = -z;\n      }\n\n      n = n - 2;\n      iter = 0;\n    } else {\n      x = H.get(n, n);\n      y = 0;\n      w = 0;\n      if (l < n) {\n        y = H.get(n - 1, n - 1);\n        w = H.get(n, n - 1) * H.get(n - 1, n);\n      }\n\n      if (iter === 10) {\n        exshift += x;\n        for (i = low; i <= n; i++) {\n          H.set(i, i, H.get(i, i) - x);\n        }\n        s = Math.abs(H.get(n, n - 1)) + Math.abs(H.get(n - 1, n - 2));\n        // eslint-disable-next-line no-multi-assign\n        x = y = 0.75 * s;\n        w = -0.4375 * s * s;\n      }\n\n      if (iter === 30) {\n        s = (y - x) / 2;\n        s = s * s + w;\n        if (s > 0) {\n          s = Math.sqrt(s);\n          if (y < x) {\n            s = -s;\n          }\n          s = x - w / ((y - x) / 2 + s);\n          for (i = low; i <= n; i++) {\n            H.set(i, i, H.get(i, i) - s);\n          }\n          exshift += s;\n          // eslint-disable-next-line no-multi-assign\n          x = y = w = 0.964;\n        }\n      }\n\n      iter = iter + 1;\n\n      m = n - 2;\n      while (m >= l) {\n        z = H.get(m, m);\n        r = x - z;\n        s = y - z;\n        p = (r * s - w) / H.get(m + 1, m) + H.get(m, m + 1);\n        q = H.get(m + 1, m + 1) - z - r - s;\n        r = H.get(m + 2, m + 1);\n        s = Math.abs(p) + Math.abs(q) + Math.abs(r);\n        p = p / s;\n        q = q / s;\n        r = r / s;\n        if (m === l) {\n          break;\n        }\n        if (\n          Math.abs(H.get(m, m - 1)) * (Math.abs(q) + Math.abs(r)) <\n          eps *\n            (Math.abs(p) *\n              (Math.abs(H.get(m - 1, m - 1)) +\n                Math.abs(z) +\n                Math.abs(H.get(m + 1, m + 1))))\n        ) {\n          break;\n        }\n        m--;\n      }\n\n      for (i = m + 2; i <= n; i++) {\n        H.set(i, i - 2, 0);\n        if (i > m + 2) {\n          H.set(i, i - 3, 0);\n        }\n      }\n\n      for (k = m; k <= n - 1; k++) {\n        notlast = k !== n - 1;\n        if (k !== m) {\n          p = H.get(k, k - 1);\n          q = H.get(k + 1, k - 1);\n          r = notlast ? H.get(k + 2, k - 1) : 0;\n          x = Math.abs(p) + Math.abs(q) + Math.abs(r);\n          if (x !== 0) {\n            p = p / x;\n            q = q / x;\n            r = r / x;\n          }\n        }\n\n        if (x === 0) {\n          break;\n        }\n\n        s = Math.sqrt(p * p + q * q + r * r);\n        if (p < 0) {\n          s = -s;\n        }\n\n        if (s !== 0) {\n          if (k !== m) {\n            H.set(k, k - 1, -s * x);\n          } else if (l !== m) {\n            H.set(k, k - 1, -H.get(k, k - 1));\n          }\n\n          p = p + s;\n          x = p / s;\n          y = q / s;\n          z = r / s;\n          q = q / p;\n          r = r / p;\n\n          for (j = k; j < nn; j++) {\n            p = H.get(k, j) + q * H.get(k + 1, j);\n            if (notlast) {\n              p = p + r * H.get(k + 2, j);\n              H.set(k + 2, j, H.get(k + 2, j) - p * z);\n            }\n\n            H.set(k, j, H.get(k, j) - p * x);\n            H.set(k + 1, j, H.get(k + 1, j) - p * y);\n          }\n\n          for (i = 0; i <= Math.min(n, k + 3); i++) {\n            p = x * H.get(i, k) + y * H.get(i, k + 1);\n            if (notlast) {\n              p = p + z * H.get(i, k + 2);\n              H.set(i, k + 2, H.get(i, k + 2) - p * r);\n            }\n\n            H.set(i, k, H.get(i, k) - p);\n            H.set(i, k + 1, H.get(i, k + 1) - p * q);\n          }\n\n          for (i = low; i <= high; i++) {\n            p = x * V.get(i, k) + y * V.get(i, k + 1);\n            if (notlast) {\n              p = p + z * V.get(i, k + 2);\n              V.set(i, k + 2, V.get(i, k + 2) - p * r);\n            }\n\n            V.set(i, k, V.get(i, k) - p);\n            V.set(i, k + 1, V.get(i, k + 1) - p * q);\n          }\n        }\n      }\n    }\n  }\n\n  if (norm === 0) {\n    return;\n  }\n\n  for (n = nn - 1; n >= 0; n--) {\n    p = d[n];\n    q = e[n];\n\n    if (q === 0) {\n      l = n;\n      H.set(n, n, 1);\n      for (i = n - 1; i >= 0; i--) {\n        w = H.get(i, i) - p;\n        r = 0;\n        for (j = l; j <= n; j++) {\n          r = r + H.get(i, j) * H.get(j, n);\n        }\n\n        if (e[i] < 0) {\n          z = w;\n          s = r;\n        } else {\n          l = i;\n          if (e[i] === 0) {\n            H.set(i, n, w !== 0 ? -r / w : -r / (eps * norm));\n          } else {\n            x = H.get(i, i + 1);\n            y = H.get(i + 1, i);\n            q = (d[i] - p) * (d[i] - p) + e[i] * e[i];\n            t = (x * s - z * r) / q;\n            H.set(i, n, t);\n            H.set(\n              i + 1,\n              n,\n              Math.abs(x) > Math.abs(z) ? (-r - w * t) / x : (-s - y * t) / z,\n            );\n          }\n\n          t = Math.abs(H.get(i, n));\n          if (eps * t * t > 1) {\n            for (j = i; j <= n; j++) {\n              H.set(j, n, H.get(j, n) / t);\n            }\n          }\n        }\n      }\n    } else if (q < 0) {\n      l = n - 1;\n\n      if (Math.abs(H.get(n, n - 1)) > Math.abs(H.get(n - 1, n))) {\n        H.set(n - 1, n - 1, q / H.get(n, n - 1));\n        H.set(n - 1, n, -(H.get(n, n) - p) / H.get(n, n - 1));\n      } else {\n        cdivres = cdiv(0, -H.get(n - 1, n), H.get(n - 1, n - 1) - p, q);\n        H.set(n - 1, n - 1, cdivres[0]);\n        H.set(n - 1, n, cdivres[1]);\n      }\n\n      H.set(n, n - 1, 0);\n      H.set(n, n, 1);\n      for (i = n - 2; i >= 0; i--) {\n        ra = 0;\n        sa = 0;\n        for (j = l; j <= n; j++) {\n          ra = ra + H.get(i, j) * H.get(j, n - 1);\n          sa = sa + H.get(i, j) * H.get(j, n);\n        }\n\n        w = H.get(i, i) - p;\n\n        if (e[i] < 0) {\n          z = w;\n          r = ra;\n          s = sa;\n        } else {\n          l = i;\n          if (e[i] === 0) {\n            cdivres = cdiv(-ra, -sa, w, q);\n            H.set(i, n - 1, cdivres[0]);\n            H.set(i, n, cdivres[1]);\n          } else {\n            x = H.get(i, i + 1);\n            y = H.get(i + 1, i);\n            vr = (d[i] - p) * (d[i] - p) + e[i] * e[i] - q * q;\n            vi = (d[i] - p) * 2 * q;\n            if (vr === 0 && vi === 0) {\n              vr =\n                eps *\n                norm *\n                (Math.abs(w) +\n                  Math.abs(q) +\n                  Math.abs(x) +\n                  Math.abs(y) +\n                  Math.abs(z));\n            }\n            cdivres = cdiv(\n              x * r - z * ra + q * sa,\n              x * s - z * sa - q * ra,\n              vr,\n              vi,\n            );\n            H.set(i, n - 1, cdivres[0]);\n            H.set(i, n, cdivres[1]);\n            if (Math.abs(x) > Math.abs(z) + Math.abs(q)) {\n              H.set(\n                i + 1,\n                n - 1,\n                (-ra - w * H.get(i, n - 1) + q * H.get(i, n)) / x,\n              );\n              H.set(\n                i + 1,\n                n,\n                (-sa - w * H.get(i, n) - q * H.get(i, n - 1)) / x,\n              );\n            } else {\n              cdivres = cdiv(\n                -r - y * H.get(i, n - 1),\n                -s - y * H.get(i, n),\n                z,\n                q,\n              );\n              H.set(i + 1, n - 1, cdivres[0]);\n              H.set(i + 1, n, cdivres[1]);\n            }\n          }\n\n          t = Math.max(Math.abs(H.get(i, n - 1)), Math.abs(H.get(i, n)));\n          if (eps * t * t > 1) {\n            for (j = i; j <= n; j++) {\n              H.set(j, n - 1, H.get(j, n - 1) / t);\n              H.set(j, n, H.get(j, n) / t);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  for (i = 0; i < nn; i++) {\n    if (i < low || i > high) {\n      for (j = i; j < nn; j++) {\n        V.set(i, j, H.get(i, j));\n      }\n    }\n  }\n\n  for (j = nn - 1; j >= low; j--) {\n    for (i = low; i <= high; i++) {\n      z = 0;\n      for (k = low; k <= Math.min(j, high); k++) {\n        z = z + V.get(i, k) * H.get(k, j);\n      }\n      V.set(i, j, z);\n    }\n  }\n}\n\nfunction cdiv(xr, xi, yr, yi) {\n  let r, d;\n  if (Math.abs(yr) > Math.abs(yi)) {\n    r = yi / yr;\n    d = yr + r * yi;\n    return [(xr + r * xi) / d, (xi - r * xr) / d];\n  } else {\n    r = yr / yi;\n    d = yi + r * yr;\n    return [(r * xr + xi) / d, (r * xi - xr) / d];\n  }\n}\n\nclass CholeskyDecomposition {\n  constructor(value) {\n    value = WrapperMatrix2D.checkMatrix(value);\n    if (!value.isSymmetric()) {\n      throw new Error('Matrix is not symmetric');\n    }\n\n    let a = value;\n    let dimension = a.rows;\n    let l = new Matrix(dimension, dimension);\n    let positiveDefinite = true;\n    let i, j, k;\n\n    for (j = 0; j < dimension; j++) {\n      let d = 0;\n      for (k = 0; k < j; k++) {\n        let s = 0;\n        for (i = 0; i < k; i++) {\n          s += l.get(k, i) * l.get(j, i);\n        }\n        s = (a.get(j, k) - s) / l.get(k, k);\n        l.set(j, k, s);\n        d = d + s * s;\n      }\n\n      d = a.get(j, j) - d;\n\n      positiveDefinite &&= d > 0;\n      l.set(j, j, Math.sqrt(Math.max(d, 0)));\n      for (k = j + 1; k < dimension; k++) {\n        l.set(j, k, 0);\n      }\n    }\n\n    this.L = l;\n    this.positiveDefinite = positiveDefinite;\n  }\n\n  isPositiveDefinite() {\n    return this.positiveDefinite;\n  }\n\n  solve(value) {\n    value = WrapperMatrix2D.checkMatrix(value);\n\n    let l = this.L;\n    let dimension = l.rows;\n\n    if (value.rows !== dimension) {\n      throw new Error('Matrix dimensions do not match');\n    }\n    if (this.isPositiveDefinite() === false) {\n      throw new Error('Matrix is not positive definite');\n    }\n\n    let count = value.columns;\n    let B = value.clone();\n    let i, j, k;\n\n    for (k = 0; k < dimension; k++) {\n      for (j = 0; j < count; j++) {\n        for (i = 0; i < k; i++) {\n          B.set(k, j, B.get(k, j) - B.get(i, j) * l.get(k, i));\n        }\n        B.set(k, j, B.get(k, j) / l.get(k, k));\n      }\n    }\n\n    for (k = dimension - 1; k >= 0; k--) {\n      for (j = 0; j < count; j++) {\n        for (i = k + 1; i < dimension; i++) {\n          B.set(k, j, B.get(k, j) - B.get(i, j) * l.get(i, k));\n        }\n        B.set(k, j, B.get(k, j) / l.get(k, k));\n      }\n    }\n\n    return B;\n  }\n\n  get lowerTriangularMatrix() {\n    return this.L;\n  }\n}\n\nclass nipals {\n  constructor(X, options = {}) {\n    X = WrapperMatrix2D.checkMatrix(X);\n    let { Y } = options;\n    const {\n      scaleScores = false,\n      maxIterations = 1000,\n      terminationCriteria = 1e-10,\n    } = options;\n\n    let u;\n    if (Y) {\n      if (isAnyArray.isAnyArray(Y) && typeof Y[0] === 'number') {\n        Y = Matrix.columnVector(Y);\n      } else {\n        Y = WrapperMatrix2D.checkMatrix(Y);\n      }\n      if (Y.rows !== X.rows) {\n        throw new Error('Y should have the same number of rows as X');\n      }\n      u = Y.getColumnVector(0);\n    } else {\n      u = X.getColumnVector(0);\n    }\n\n    let diff = 1;\n    let t, q, w, tOld;\n\n    for (\n      let counter = 0;\n      counter < maxIterations && diff > terminationCriteria;\n      counter++\n    ) {\n      w = X.transpose().mmul(u).div(u.transpose().mmul(u).get(0, 0));\n      w = w.div(w.norm());\n\n      t = X.mmul(w).div(w.transpose().mmul(w).get(0, 0));\n\n      if (counter > 0) {\n        diff = t.clone().sub(tOld).pow(2).sum();\n      }\n      tOld = t.clone();\n\n      if (Y) {\n        q = Y.transpose().mmul(t).div(t.transpose().mmul(t).get(0, 0));\n        q = q.div(q.norm());\n\n        u = Y.mmul(q).div(q.transpose().mmul(q).get(0, 0));\n      } else {\n        u = t;\n      }\n    }\n\n    if (Y) {\n      let p = X.transpose().mmul(t).div(t.transpose().mmul(t).get(0, 0));\n      p = p.div(p.norm());\n      let xResidual = X.clone().sub(t.clone().mmul(p.transpose()));\n      let residual = u.transpose().mmul(t).div(t.transpose().mmul(t).get(0, 0));\n      let yResidual = Y.clone().sub(\n        t.clone().mulS(residual.get(0, 0)).mmul(q.transpose()),\n      );\n\n      this.t = t;\n      this.p = p.transpose();\n      this.w = w.transpose();\n      this.q = q;\n      this.u = u;\n      this.s = t.transpose().mmul(t);\n      this.xResidual = xResidual;\n      this.yResidual = yResidual;\n      this.betas = residual;\n    } else {\n      this.w = w.transpose();\n      this.s = t.transpose().mmul(t).sqrt();\n      if (scaleScores) {\n        this.t = t.clone().div(this.s.get(0, 0));\n      } else {\n        this.t = t;\n      }\n      this.xResidual = X.sub(t.mmul(w.transpose()));\n    }\n  }\n}\n\nexports.AbstractMatrix = AbstractMatrix;\nexports.CHO = CholeskyDecomposition;\nexports.CholeskyDecomposition = CholeskyDecomposition;\nexports.DistanceMatrix = DistanceMatrix;\nexports.EVD = EigenvalueDecomposition;\nexports.EigenvalueDecomposition = EigenvalueDecomposition;\nexports.LU = LuDecomposition;\nexports.LuDecomposition = LuDecomposition;\nexports.Matrix = Matrix;\nexports.MatrixColumnSelectionView = MatrixColumnSelectionView;\nexports.MatrixColumnView = MatrixColumnView;\nexports.MatrixFlipColumnView = MatrixFlipColumnView;\nexports.MatrixFlipRowView = MatrixFlipRowView;\nexports.MatrixRowSelectionView = MatrixRowSelectionView;\nexports.MatrixRowView = MatrixRowView;\nexports.MatrixSelectionView = MatrixSelectionView;\nexports.MatrixSubView = MatrixSubView;\nexports.MatrixTransposeView = MatrixTransposeView;\nexports.NIPALS = nipals;\nexports.Nipals = nipals;\nexports.QR = QrDecomposition;\nexports.QrDecomposition = QrDecomposition;\nexports.SVD = SingularValueDecomposition;\nexports.SingularValueDecomposition = SingularValueDecomposition;\nexports.SymmetricMatrix = SymmetricMatrix;\nexports.WrapperMatrix1D = WrapperMatrix1D;\nexports.WrapperMatrix2D = WrapperMatrix2D;\nexports.correlation = correlation;\nexports.covariance = covariance;\nexports.default = Matrix;\nexports.determinant = determinant;\nexports.inverse = inverse;\nexports.linearDependencies = linearDependencies;\nexports.pseudoInverse = pseudoInverse;\nexports.solve = solve;\nexports.wrap = wrap;\n", "import {\r\n  cartesianProduct,\r\n  download,\r\n  makeUniformBuffer,\r\n  Mat4,\r\n  mulMat4,\r\n  mulMat4ByVec4,\r\n  range,\r\n  scale,\r\n  translate,\r\n  Vec2,\r\n  Vec3,\r\n} from \"r628\";\r\nimport { specifyComponent } from \"../ecs\";\r\nimport {\r\n  createDofDownsampleShaderPipeline,\r\n  createDofPositionToDepth,\r\n  createDofShaderPipeline,\r\n  runDofDownsample,\r\n  runDofPositionToDepth,\r\n  runDofShaderPipeline,\r\n} from \"../shaders/dof\";\r\nimport { createKernelShaderPipeline } from \"../shaders/kernel\";\r\nimport { createSimpleFilterPipeline } from \"../shaders/simple-filter\";\r\nimport {\r\n  blurFar,\r\n  blurNear,\r\n  generateMipmap,\r\n  maskOutFar,\r\n  maxFilterNear,\r\n} from \"../shaders/dof-post-effects\";\r\nimport { inv4 } from \"../matrix\";\r\n\r\nexport const MainCanvas = specifyComponent({\r\n  create() {\r\n    return undefined;\r\n  },\r\n  onDestroy() {},\r\n  async init() {\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.style = `\r\ntop: 0;\r\nleft: 0;\r\nposition: absolute;\r\nwidth: 100vw;\r\nheight: 100vh;    \r\n`;\r\n    canvas.width = 1024;\r\n    canvas.height = 1024;\r\n    document.body.appendChild(canvas);\r\n    return {\r\n      canvas,\r\n    };\r\n  },\r\n  brand: \"mainCanvas\",\r\n  dependencies: [],\r\n  globalDependencies: [],\r\n});\r\n\r\nexport const GBUFFER_PASS = Symbol(\"GBuffer Pass\");\r\n\r\nexport const GBUFFER_SUBMIT = Symbol(\"GBuffer Submit\");\r\n\r\nexport const LIGHTING_PASS = Symbol(\"Lighting Pass\");\r\n\r\nfunction perspectiveWebgpu(\r\n  fieldOfViewInRadians: number,\r\n  aspectRatio: number,\r\n  near: number,\r\n  far: number\r\n): Mat4 {\r\n  const f = 1.0 / Math.tan(fieldOfViewInRadians / 2);\r\n  const rangeInv = 1 / (near - far);\r\n\r\n  return [\r\n    f / aspectRatio,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    f,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    far * rangeInv,\r\n    -1,\r\n    0,\r\n    0,\r\n    near * far * rangeInv,\r\n    0,\r\n  ];\r\n}\r\n\r\nfunction createGBufferTextures(device: GPUDevice, dimensions: Vec2) {\r\n  const albedo = device.createTexture({\r\n    dimension: \"2d\",\r\n    format: \"rgba8unorm\",\r\n    label: \"albedo\",\r\n    size: dimensions,\r\n    usage:\r\n      GPUTextureUsage.COPY_DST |\r\n      GPUTextureUsage.RENDER_ATTACHMENT |\r\n      GPUTextureUsage.TEXTURE_BINDING,\r\n  });\r\n  const normal = device.createTexture({\r\n    dimension: \"2d\",\r\n    format: \"rgba16float\",\r\n    label: \"normal\",\r\n    size: dimensions,\r\n    usage:\r\n      GPUTextureUsage.COPY_DST |\r\n      GPUTextureUsage.RENDER_ATTACHMENT |\r\n      GPUTextureUsage.TEXTURE_BINDING,\r\n  });\r\n  const position = device.createTexture({\r\n    dimension: \"2d\",\r\n    format: \"rgba32float\",\r\n    label: \"position\",\r\n    size: dimensions,\r\n    usage:\r\n      GPUTextureUsage.COPY_DST |\r\n      GPUTextureUsage.RENDER_ATTACHMENT |\r\n      GPUTextureUsage.TEXTURE_BINDING |\r\n      GPUTextureUsage.STORAGE_BINDING,\r\n  });\r\n  const depth = device.createTexture({\r\n    size: dimensions,\r\n    format: \"depth24plus\",\r\n    usage: GPUTextureUsage.RENDER_ATTACHMENT,\r\n  });\r\n\r\n  return { albedo, normal, position, depth };\r\n}\r\n\r\nfunction createLightingTextures(device: GPUDevice, dimensions: Vec2) {\r\n  const screenSizedTexture = (\r\n    scaleFactor: number,\r\n    format: GPUTextureFormat,\r\n    mipLevelCount: number\r\n  ) =>\r\n    device.createTexture({\r\n      size: dimensions.map((d) => Math.ceil(d * scaleFactor)),\r\n      format,\r\n      mipLevelCount,\r\n      usage:\r\n        GPUTextureUsage.RENDER_ATTACHMENT |\r\n        GPUTextureUsage.COPY_DST |\r\n        GPUTextureUsage.TEXTURE_BINDING,\r\n    });\r\n\r\n  const color = screenSizedTexture(1, \"rgba8unorm\", 2);\r\n  const color2 = screenSizedTexture(1, \"rgba8unorm\", 1);\r\n\r\n  return {\r\n    color,\r\n    color2,\r\n    depth: screenSizedTexture(1, \"rg8unorm\", 1),\r\n    depth2: screenSizedTexture(1, \"rg8unorm\", 1),\r\n    nearField: screenSizedTexture(1, \"rgba8unorm\", 1),\r\n    nearField2: screenSizedTexture(1, \"rgba8unorm\", 1),\r\n    farField: screenSizedTexture(1, \"rgba8unorm\", 1),\r\n    farField2: screenSizedTexture(1, \"rgba8unorm\", 1),\r\n  };\r\n}\r\n\r\ntype DeferredPipelineTextures = {\r\n  gbuffer: {\r\n    albedo: GPUTexture;\r\n    normal: GPUTexture;\r\n    position: GPUTexture;\r\n    depth: GPUTexture;\r\n  };\r\n  lighting: {\r\n    depth: GPUTexture;\r\n    depth2: GPUTexture;\r\n    color: GPUTexture;\r\n    color2: GPUTexture;\r\n    nearField: GPUTexture;\r\n    nearField2: GPUTexture;\r\n    farField: GPUTexture;\r\n    farField2: GPUTexture;\r\n  };\r\n\r\n  // lightingBindGroup: GPUBindGroup;\r\n  dimensions: Vec2;\r\n};\r\n\r\nexport function createBufferFromData(\r\n  device: GPUDevice,\r\n  data: Parameters<GPUDevice[\"queue\"][\"writeBuffer\"]>[2],\r\n  usage: GPUBufferUsageFlags,\r\n  label?: string\r\n) {\r\n  const buf = device.createBuffer({\r\n    label,\r\n    usage,\r\n    size: data.byteLength,\r\n  });\r\n\r\n  device.queue.writeBuffer(buf, 0, data);\r\n\r\n  return buf;\r\n}\r\n\r\nfunction maybeUpdateTextures(\r\n  device: GPUDevice,\r\n  dimensions: Vec2,\r\n  // lightingPipeline: GPURenderPipeline,\r\n  // lightingLayout: GPUBindGroupLayout,\r\n  existing?: DeferredPipelineTextures\r\n): DeferredPipelineTextures {\r\n  const outTextures = existing\r\n    ? dimensions[0] === existing.dimensions[0] &&\r\n      dimensions[1] === existing.dimensions[1]\r\n      ? existing\r\n      : undefined\r\n    : undefined;\r\n\r\n  if (outTextures) return outTextures;\r\n\r\n  const gbuffer = createGBufferTextures(device, dimensions);\r\n\r\n  return {\r\n    gbuffer,\r\n    dimensions,\r\n    lighting: createLightingTextures(device, dimensions),\r\n    // lightingBindGroup,\r\n  };\r\n}\r\n\r\nfunction fullscreenQuad2DBuffer(device: GPUDevice) {\r\n  return createBufferFromData(\r\n    device,\r\n    new Float32Array([1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1]),\r\n    GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST,\r\n    \"fullscreen quad for blit\"\r\n  );\r\n}\r\n\r\nfunction intervalInclusive(a: number, b: number): number[] {\r\n  return range(b - a + 1).map((i) => i - a);\r\n}\r\n\r\nexport const DeferredWebgpuRenderer = specifyComponent({\r\n  create() {\r\n    return undefined;\r\n  },\r\n  onDestroy() {},\r\n  async init(waitFor) {\r\n    const canvas = (await waitFor(MainCanvas)).canvas;\r\n\r\n    const ctx = canvas.getContext(\"webgpu\");\r\n\r\n    const adapter = await navigator.gpu.requestAdapter()!;\r\n    const device = await adapter.requestDevice({\r\n      requiredFeatures: [\"float32-filterable\"],\r\n      requiredLimits: {\r\n        // maxColorAttachmentBytesPerSample: 40,\r\n      },\r\n    });\r\n\r\n    const format = navigator.gpu.getPreferredCanvasFormat();\r\n\r\n    ctx.configure({\r\n      device,\r\n      format,\r\n    });\r\n\r\n    const onResizeCallbacks = new Set<() => void>();\r\n\r\n    function resize() {\r\n      canvas.width = window.innerWidth * window.devicePixelRatio;\r\n      canvas.height = window.innerHeight * window.devicePixelRatio;\r\n      for (const cb of onResizeCallbacks) cb();\r\n      ret.textures = maybeUpdateTextures(device, [canvas.width, canvas.height]);\r\n    }\r\n\r\n    window.addEventListener(\"resize\", resize);\r\n\r\n    const ret = {\r\n      fullscreenQuad: fullscreenQuad2DBuffer(device),\r\n      textures: maybeUpdateTextures(device, [canvas.width, canvas.height]),\r\n      canvas,\r\n      ctx,\r\n      device,\r\n      projectionMatrix: translate([0, 0, 0]),\r\n      fov: 1,\r\n      aspect: 1,\r\n      near: 0.1,\r\n      far: 100,\r\n      viewMatrix: translate([0, 0, 0]),\r\n      canvasFormat: format,\r\n      onResize<T>(cb: () => T): [T, () => void] {\r\n        const value = cb();\r\n        onResizeCallbacks.add(cb);\r\n        return [\r\n          value,\r\n          () => {\r\n            onResizeCallbacks.delete(cb);\r\n          },\r\n        ] as const;\r\n      },\r\n      gBufferRenderPass: undefined as GPURenderPassEncoder,\r\n      time: 0,\r\n    };\r\n\r\n    resize();\r\n\r\n    return ret;\r\n  },\r\n\r\n  renderUpdate({ state, scheduleTask }) {\r\n    const { device, textures, fullscreenQuad } = state;\r\n\r\n    state.projectionMatrix = perspectiveWebgpu(\r\n      1,\r\n      window.innerWidth / window.innerHeight,\r\n      0.1,\r\n      200\r\n    );\r\n\r\n    const encoder = device.createCommandEncoder();\r\n    const gbufferPass = encoder.beginRenderPass({\r\n      colorAttachments: [\r\n        {\r\n          view: textures.gbuffer.position.createView(),\r\n          clearValue: [0, 0, 0, 1],\r\n          loadOp: \"clear\",\r\n          storeOp: \"store\",\r\n        },\r\n        {\r\n          view: textures.gbuffer.normal.createView(),\r\n          clearValue: [0, 0, 0, 1],\r\n          loadOp: \"clear\",\r\n          storeOp: \"store\",\r\n        },\r\n        {\r\n          view: textures.gbuffer.albedo.createView(),\r\n          clearValue: [0, 0, 0, 1],\r\n          loadOp: \"clear\",\r\n          storeOp: \"store\",\r\n        },\r\n      ],\r\n      depthStencilAttachment: {\r\n        view: textures.gbuffer.depth,\r\n        depthClearValue: 1.0,\r\n        depthLoadOp: \"clear\",\r\n        depthStoreOp: \"store\",\r\n      },\r\n    });\r\n\r\n    state.gBufferRenderPass = gbufferPass;\r\n\r\n    scheduleTask(\r\n      () => {\r\n        gbufferPass.end();\r\n        device.queue.submit([encoder.finish()]);\r\n        return Promise.resolve();\r\n      },\r\n      [GBUFFER_SUBMIT],\r\n      [GBUFFER_PASS]\r\n    );\r\n  },\r\n  brand: \"deferredWebgpuRenderer\" as const,\r\n  dependencies: [] as const,\r\n  globalDependencies: [MainCanvas] as const,\r\n});\r\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\n// implementation signature\nexport async function parseFromContext(data, loaders, options, context) {\n    return context._parse(data, loaders, options, context);\n}\n/**\n * Parses `data` synchronously using the specified loader, parse function provided via the loader context\n */\nexport function parseSyncFromContext(data, loader, options, context) {\n    if (!context._parseSync) {\n        throw new Error('parseSync');\n    }\n    return context._parseSync(data, loader, options, context);\n}\n/**\n * Parses `data` synchronously using a specified loader, parse function provided via the loader context\n */\nexport async function parseInBatchesFromContext(data, loader, options, context) {\n    if (!context._parseInBatches) {\n        throw new Error('parseInBatches');\n    }\n    return context._parseInBatches(data, loader, options, context);\n}\n", "/**\n * Throws an `Error` with the optional `message` if `condition` is falsy\n * @note Replacement for the external assert method to reduce bundle size\n */\nexport function assert(condition, message) {\n    if (!condition) {\n        throw new Error(message || 'loader assertion failed.');\n    }\n}\n", "// Purpose: include this in your module to avoid\n// dependencies on micro modules like 'global' and 'is-browser';\n/* eslint-disable no-restricted-globals */\nconst globals = {\n    self: typeof self !== 'undefined' && self,\n    window: typeof window !== 'undefined' && window,\n    global: typeof global !== 'undefined' && global,\n    document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\n/** true if running in a browser */\nexport const isBrowser = \n// @ts-ignore process does not exist on browser\nBoolean(typeof process !== 'object' || String(process) !== '[object process]' || process.browser);\n/** true if running in a worker thread */\nexport const isWorker = typeof importScripts === 'function';\n// Extract node major version\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n/** Major Node version (as a number) */\nexport const nodeVersion = (matches && parseFloat(matches[1])) || 0;\n", "// Do not name these variables the same as the global objects - will break bundling\nconst global_ = globalThis;\nconst window_ = globalThis as unknown as Window;\nconst document_ = globalThis.document || ({} as Document);\nconst process_ = globalThis.process || {};\nconst console_ = globalThis.console;\nconst navigator_ = globalThis.navigator || ({} as Navigator);\n\nexport {\n  global_ as global,\n  global_ as self,\n  window_ as window,\n  document_ as document,\n  process_ as process,\n  console_ as console,\n  navigator_ as navigator\n};\n", "// based on https://github.com/cheton/is-electron\n// https://github.com/electron/electron/issues/2288\n/* eslint-disable complexity */\nexport function isElectron(mockUserAgent?: string): boolean {\n  // Renderer process\n  // @ts-expect-error\n  if (typeof window !== 'undefined' && window.process?.type === 'renderer') {\n    return true;\n  }\n  // Main process\n  // eslint-disable-next-line\n  if (typeof process !== 'undefined' && Boolean(process.versions?.['electron'])) {\n    return true;\n  }\n  // Detect the user agent when the `nodeIntegration` option is set to true\n  const realUserAgent = typeof navigator !== 'undefined' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n  return Boolean(userAgent && userAgent.indexOf('Electron') >= 0);\n}\n", "// This function is needed in initialization stages,\n// make sure it can be imported in isolation\n\nimport {isElectron} from './is-electron';\n\n/** Check if in browser by duck-typing Node context */\nexport function isBrowser(): boolean {\n  const isNode =\n    // @ts-expect-error\n    typeof process === 'object' && String(process) === '[object process]' && !process?.browser;\n  return !isNode || isElectron();\n}\n", "// Extract injected version from package.json (injected by babel plugin)\n// @ts-expect-error\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\n\n// ENVIRONMENT\nexport {self, window, global, document, process, console} from './lib/globals';\nexport {isBrowser} from './lib/is-browser';\nexport {getBrowser, isMobile} from './lib/get-browser';\nexport {isElectron} from './lib/is-electron';\n\n// ENVIRONMENT'S ASSERT IS 5-15KB, SO WE PROVIDE OUR OWN\nexport {assert} from './utils/assert';\n\n// TODO - wish we could just export a constant\n// export const isBrowser = checkIfBrowser();\n", "// probe.gl, MIT license\n\nexport type StorageType = 'sessionStorage' | 'localStorage';\n\nfunction getStorage(type: StorageType): Storage | null {\n  try {\n    const storage: Storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\n// Store keys in local storage via simple interface\nexport class LocalStorage<Configuration extends {}> {\n  storage: Storage | null;\n  id: string;\n  config: Required<Configuration>;\n\n  constructor(\n    id: string,\n    defaultConfig: Required<Configuration>,\n    type: StorageType = 'sessionStorage'\n  ) {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n    this._loadConfiguration();\n  }\n\n  getConfiguration(): Required<Configuration> {\n    return this.config;\n  }\n\n  setConfiguration(configuration: Configuration): void {\n    Object.assign(this.config, configuration);\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  // Get config from persistent store, if available\n  _loadConfiguration() {\n    let configuration = {};\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n    Object.assign(this.config, configuration);\n    return this;\n  }\n}\n", "// probe.gl, MIT license\n\nexport type FormatValueOptions = {\n  isInteger?: boolean;\n  maxElts?: number;\n  size?: number;\n};\n\n/**\n * Format time\n */\nexport function formatTime(ms: number): string {\n  let formatted;\n  if (ms < 10) {\n    formatted = `${ms.toFixed(2)}ms`;\n  } else if (ms < 100) {\n    formatted = `${ms.toFixed(1)}ms`;\n  } else if (ms < 1000) {\n    formatted = `${ms.toFixed(0)}ms`;\n  } else {\n    formatted = `${(ms / 1000).toFixed(2)}s`;\n  }\n  return formatted;\n}\n\nexport function leftPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${' '.repeat(padLength)}${string}`;\n}\n\nexport function rightPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${string}${' '.repeat(padLength)}`;\n}\n\nexport function formatValue(v: unknown, options: FormatValueOptions = {}): string {\n  const EPSILON = 1e-16;\n  const {isInteger = false} = options;\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, options);\n  }\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n  if (isInteger) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\n/** Helper to formatValue */\nfunction formatArrayValue(v: any, options: FormatValueOptions) {\n  const {maxElts = 16, size = 1} = options;\n  let string = '[';\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += `,${i % size === 0 ? ' ' : ''}`;\n    }\n    string += formatValue(v[i], options);\n  }\n  const terminator = v.length > maxElts ? '...' : ']';\n  return `${string}${terminator}`;\n}\n", "import {isBrowser} from '@probe.gl/env';\n\nexport enum COLOR {\n  BLACK = 30,\n  RED = 31,\n  GREEN = 32,\n  YELLOW = 33,\n  BLUE = 34,\n  MAGENTA = 35,\n  CYAN = 36,\n  WHITE = 37,\n\n  BRIGHT_BLACK = 90,\n  BRIGHT_RED = 91,\n  BRIGHT_GREEN = 92,\n  BRIGHT_YELLOW = 93,\n  BRIGHT_BLUE = 94,\n  BRIGHT_MAGENTA = 95,\n  BRIGHT_CYAN = 96,\n  BRIGHT_WHITE = 97\n}\n\nconst BACKGROUND_INCREMENT = 10;\n\nfunction getColor(color: string | COLOR): number {\n  if (typeof color !== 'string') {\n    return color;\n  }\n  color = color.toUpperCase();\n  return COLOR[color] || COLOR.WHITE;\n}\n\nexport function addColor(\n  string: string,\n  color: string | COLOR,\n  background?: string | COLOR\n): string {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      const colorCode = getColor(color);\n      string = `\\u001b[${colorCode}m${string}\\u001b[39m`;\n    }\n    if (background) {\n      // background colors values are +10\n      const colorCode = getColor(background);\n      string = `\\u001b[${colorCode + BACKGROUND_INCREMENT}m${string}\\u001b[49m`;\n    }\n  }\n  return string;\n}\n", "// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/**\n * Binds the \"this\" argument of all functions on a class instance to the instance\n * @param obj - class instance (typically a react component)\n */\nexport function autobind(obj: object, predefined = ['constructor']): void {\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  const object = obj as Record<string, unknown>;\n  for (const key of propNames) {\n    const value = object[key];\n    if (typeof value === 'function') {\n      if (!predefined.find((name) => key === name)) {\n        object[key] = value.bind(obj);\n      }\n    }\n  }\n}\n", "export default function assert(condition: unknown, message?: string): asserts condition {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n", "// probe.gl, MIT license\n\nimport {window, process, isBrowser} from '@probe.gl/env';\n\n/** Get best timer available. */\nexport function getHiResTimestamp() {\n  let timestamp;\n  if (isBrowser() && window.performance) {\n    timestamp = window?.performance?.now?.();\n  } else if ('hrtime' in process) {\n    // @ts-ignore\n    const timeParts = process?.hrtime?.();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n", "// probe.gl, MIT license\n\n/* eslint-disable no-console,prefer-rest-params */\nimport {VERSION, isBrowser} from '@probe.gl/env';\nimport {LocalStorage} from './utils/local-storage';\nimport {formatTime, leftPad} from './utils/formatters';\nimport {addColor} from './utils/color';\nimport {autobind} from './utils/autobind';\nimport assert from './utils/assert';\nimport {getHiResTimestamp} from './utils/hi-res-timestamp';\n\n/** \"Global\" log configuration settings */\ntype LogConfiguration = {\n  enabled?: boolean;\n  level?: number;\n  [key: string]: unknown;\n};\n\n/** Options when logging a message */\ntype LogOptions = {\n  method?: Function;\n  time?: boolean;\n  total?: number;\n  delta?: number;\n  tag?: string;\n  message?: string;\n  once?: boolean;\n  nothrottle?: boolean;\n  args?: any;\n};\n\ntype LogFunction = () => void;\n\ntype Table = Record<string, any>;\n\n// Instrumentation in other packages may override console methods, so preserve them here\nconst originalConsole = {\n  debug: isBrowser() ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\n\nconst DEFAULT_LOG_CONFIGURATION: Required<LogConfiguration> = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {} // eslint-disable-line @typescript-eslint/no-empty-function\n\nconst cache = {};\nconst ONCE = {once: true};\n\n/** A console wrapper */\n\nexport class Log {\n  static VERSION = VERSION;\n\n  id: string;\n  VERSION: string = VERSION;\n  _startTs: number = getHiResTimestamp();\n  _deltaTs: number = getHiResTimestamp();\n  _storage: LocalStorage<LogConfiguration>;\n  userData = {};\n\n  // TODO - fix support from throttling groups\n  LOG_THROTTLE_TIMEOUT: number = 0; // Time before throttled messages are logged again\n\n  constructor({id} = {id: ''}) {\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage<LogConfiguration>(\n      `__probe-${this.id}__`,\n      DEFAULT_LOG_CONFIGURATION\n    );\n\n    this.timeStamp(`${this.id} started`);\n\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel: number) {\n    this.setLevel(newLevel);\n  }\n\n  get level(): number {\n    return this.getLevel();\n  }\n\n  isEnabled(): boolean {\n    return this._storage.config.enabled;\n  }\n\n  getLevel(): number {\n    return this._storage.config.level;\n  }\n\n  /** @return milliseconds, with fractions */\n  getTotal(): number {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  /** @return milliseconds, with fractions */\n  getDelta(): number {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  /** @deprecated use logLevel */\n  set priority(newPriority: number) {\n    this.level = newPriority;\n  }\n\n  /** @deprecated use logLevel */\n  get priority(): number {\n    return this.level;\n  }\n\n  /** @deprecated use logLevel */\n  getPriority(): number {\n    return this.level;\n  }\n\n  // Configure\n\n  enable(enabled: boolean = true): this {\n    this._storage.setConfiguration({enabled});\n    return this;\n  }\n\n  setLevel(level: number): this {\n    this._storage.setConfiguration({level});\n    return this;\n  }\n\n  /** return the current status of the setting */\n  get(setting: string): any {\n    return this._storage.config[setting];\n  }\n\n  // update the status of the setting\n  set(setting: string, value: any): void {\n    this._storage.setConfiguration({[setting]: value});\n  }\n\n  /** Logs the current settings as a table */\n  settings(): void {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  // Unconditional logging\n\n  assert(condition: unknown, message?: string): asserts condition {\n    if (!condition) {\n      throw new Error(message || 'Assertion failed');\n    }\n  }\n\n  /** Warn, but only once, no console flooding */\n  warn(message: string, ...args: unknown[]): LogFunction;\n  warn(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  /** Print an error */\n  error(message: string, ...args: unknown[]): LogFunction;\n  error(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  /** Print a deprecation warning */\n  deprecated(oldUsage: string, newUsage: string): LogFunction {\n    return this.warn(`\\`${oldUsage}\\` is deprecated and will be removed \\\nin a later version. Use \\`${newUsage}\\` instead`);\n  }\n\n  /** Print a removal warning */\n  removed(oldUsage: string, newUsage: string): LogFunction {\n    return this.error(`\\`${oldUsage}\\` has been removed. Use \\`${newUsage}\\` instead`);\n  }\n\n  // Conditional logging\n\n  /** Log to a group */\n  probe(logLevel, message?, ...args: unknown[]): LogFunction;\n  probe(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  /** Log a debug message */\n  log(logLevel, message?, ...args: unknown[]): LogFunction;\n  log(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  /** Log a normal message */\n  info(logLevel, message?, ...args: unknown[]): LogFunction;\n  info(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  /** Log a normal message, but only once, no console flooding */\n  once(logLevel, message?, ...args: unknown[]): LogFunction;\n  once(logLevel, message?) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      originalConsole.debug || originalConsole.info,\n      arguments,\n      ONCE\n    );\n  }\n\n  /** Logs an object as a table */\n  table(logLevel, table?, columns?): LogFunction {\n    if (table) {\n      return this._getLogFunction(\n        logLevel,\n        table,\n        console.table || noop,\n        (columns && [columns]) as unknown as IArguments,\n        {\n          tag: getTableHeader(table)\n        }\n      );\n    }\n    return noop;\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      console.timeEnd ? console.timeEnd : console.info\n    );\n  }\n\n  timeStamp(logLevel, message?) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message, opts = {collapsed: false}) {\n    const options = normalizeArguments({logLevel, message, opts});\n    const {collapsed} = opts;\n    // @ts-expect-error\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message, opts = {}) {\n    return this.group(logLevel, message, Object.assign({}, opts, {collapsed: true}));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  // EXPERIMENTAL\n\n  withGroup(logLevel: number, message: string, func: Function): void {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace(): void {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  // PRIVATE METHODS\n\n  /** Deduces log level from a variety of arguments */\n  _shouldLog(logLevel: unknown): boolean {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(\n    logLevel: unknown,\n    message?: unknown,\n    method?: Function,\n    args?: IArguments,\n    opts?: LogOptions\n  ): LogFunction {\n    if (this._shouldLog(logLevel)) {\n      // normalized opts + timings\n      opts = normalizeArguments({logLevel, message, args, opts});\n      method = method || opts.method;\n      assert(method);\n\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      // reset delta timer\n      this._deltaTs = getHiResTimestamp();\n\n      const tag = opts.tag || opts.message;\n\n      if (opts.once && tag) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      // TODO - Make throttling work with groups\n      // if (opts.nothrottle || !throttle(tag, this.LOG_THROTTLE_TIMEOUT)) {\n      //   return noop;\n      // }\n\n      message = decorateMessage(this.id, opts.message, opts);\n\n      // Bind console function so that it can be called after being returned\n      return method.bind(console, message, ...opts.args);\n    }\n    return noop;\n  }\n}\n\n/**\n * Get logLevel from first argument:\n * - log(logLevel, message, args) => logLevel\n * - log(message, args) => 0\n * - log({logLevel, ...}, message, args) => logLevel\n * - log({logLevel, message, args}) => logLevel\n */\nfunction normalizeLogLevel(logLevel: unknown): number {\n  if (!logLevel) {\n    return 0;\n  }\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      // Backward compatibility\n      // TODO - deprecate `priority`\n      // @ts-expect-error\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n  // 'log level must be a number'\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n\n  return resolvedLevel;\n}\n\n/**\n * \"Normalizes\" the various argument patterns into an object with known types\n * - log(logLevel, message, args) => {logLevel, message, args}\n * - log(message, args) => {logLevel: 0, message, args}\n * - log({logLevel, ...}, message, args) => {logLevel, message, args}\n * - log({logLevel, message, args}) => {logLevel, message, args}\n */\nexport function normalizeArguments(opts: {\n  logLevel;\n  message;\n  collapsed?: boolean;\n  args?: IArguments | undefined;\n  opts?;\n}): {\n  logLevel: number;\n  message: string;\n  args: any[];\n} {\n  const {logLevel, message} = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n\n  // We use `arguments` instead of rest parameters (...args) because IE\n  // does not support the syntax. Rest parameters is transpiled to code with\n  // perf impact. Doing it here instead avoids constructing args when logging is\n  // disabled.\n  // TODO - remove when/if IE support is dropped\n  const args: any[] = opts.args ? Array.from(opts.args) : [];\n  // args should only contain arguments that appear after `message`\n  // eslint-disable-next-line no-empty\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  // Resolve functions into strings by calling them\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n  const messageType = typeof opts.message;\n  // 'log message must be a string' or object\n  assert(messageType === 'string' || messageType === 'object');\n\n  // original opts + normalized opts + opts arg + fixed up message\n  return Object.assign(opts, {args}, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? `${id}: ${time}  ${message}` : `${id}: ${message}`;\n    message = addColor(message, opts.color, opts.background);\n  }\n  return message;\n}\n\nfunction getTableHeader(table: Table): string {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n  return 'empty';\n}\n", "// @ts-nocheck\n/* eslint-disable */\nglobalThis.probe = {};\n", "import {Log} from './log';\n\n// DEFAULT EXPORT IS A LOG INSTANCE\nexport default new Log({id: '@probe.gl/log'});\n\n// LOGGING\nexport {Log} from './log';\nexport {COLOR} from './utils/color';\n\n// UTILITIES\nexport {addColor} from './utils/color';\nexport {leftPad, rightPad} from './utils/formatters';\nexport {autobind} from './utils/autobind';\nexport {LocalStorage} from './utils/local-storage';\nexport {getHiResTimestamp} from './utils/hi-res-timestamp';\n\nimport './init';\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Log } from '@probe.gl/log';\n// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nexport const VERSION = typeof \"4.3.3\" !== 'undefined' ? \"4.3.3\" : 'latest';\nconst version = VERSION[0] >= '0' && VERSION[0] <= '9' ? `v${VERSION}` : '';\n// Make sure we set the global variable\nfunction createLog() {\n    const log = new Log({ id: 'loaders.gl' });\n    globalThis.loaders = globalThis.loaders || {};\n    globalThis.loaders.log = log;\n    globalThis.loaders.version = version;\n    globalThis.probe = globalThis.probe || {};\n    globalThis.probe.loaders = log;\n    return log;\n}\nexport const log = createLog();\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/**\n *\n * @param baseOptions Can be undefined, in which case a fresh options object will be minted\n * @param newOptions\n * @returns\n */\nexport function mergeLoaderOptions(baseOptions, newOptions) {\n    return mergeOptionsRecursively(baseOptions || {}, newOptions);\n}\nfunction mergeOptionsRecursively(baseOptions, newOptions, level = 0) {\n    // Sanity check (jest test runner overwrites the console object which can lead to infinite recursion)\n    if (level > 3) {\n        return newOptions;\n    }\n    const options = { ...baseOptions };\n    for (const [key, newValue] of Object.entries(newOptions)) {\n        if (newValue && typeof newValue === 'object' && !Array.isArray(newValue)) {\n            options[key] = mergeOptionsRecursively(options[key] || {}, newOptions[key], level + 1);\n            // Object.assign(options[key] as object, newOptions[key]);\n        }\n        else {\n            options[key] = newOptions[key];\n        }\n    }\n    return options;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { log } from \"../log-utils/log.js\";\n/**\n * Register application-imported modules\n * These modules are typically to big to bundle, or may have issues on some bundlers/environments\n */\nexport function registerJSModules(modules) {\n    globalThis.loaders ||= {};\n    globalThis.loaders.modules ||= {};\n    Object.assign(globalThis.loaders.modules, modules);\n}\n/**\n * Get a pre-registered application-imported module, warn if not present\n */\nexport function checkJSModule(name, caller) {\n    const module = globalThis.loaders?.modules?.[name];\n    if (!module) {\n        log.warn(`${caller}: ${name} library not installed`)();\n    }\n}\n/**\n * Get a pre-registered application-imported module, throw if not present\n */\nexport function getJSModule(name, caller) {\n    const module = globalThis.loaders?.modules?.[name];\n    if (!module) {\n        throw new Error(`${caller}: ${name} library not installed`);\n    }\n    return module;\n}\n/**\n * Get a pre-registered application-imported module, return null if not present\n */\nexport function getJSModuleOrNull(name) {\n    const module = globalThis.loaders?.modules?.[name];\n    return module || null;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n/**\n * TODO - unpkg.com doesn't seem to have a `latest` specifier for alpha releases...\n * 'beta' on beta branch, 'latest' on prod branch\n */\nexport const NPM_TAG = 'latest';\nfunction getVersion() {\n    if (!globalThis._loadersgl_?.version) {\n        globalThis._loadersgl_ = globalThis._loadersgl_ || {};\n        // __VERSION__ is injected by babel-plugin-version-inline\n        if (typeof \"4.3.3\" === 'undefined') {\n            // eslint-disable-next-line\n            console.warn('loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN.');\n            globalThis._loadersgl_.version = NPM_TAG;\n        }\n        else {\n            globalThis._loadersgl_.version = \"4.3.3\";\n        }\n    }\n    return globalThis._loadersgl_.version;\n}\nexport const VERSION = getVersion();\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Replacement for the external assert method to reduce bundle size\n// Note: We don't use the second \"message\" argument in calling code,\n// so no need to support it here\n/** Throws an `Error` with the optional `message` if `condition` is falsy */\nexport function assert(condition, message) {\n    if (!condition) {\n        throw new Error(message || 'loaders.gl assertion failed.');\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Purpose: include this in your module to avoids adding dependencies on\n// micro modules like 'global' and 'is-browser';\n/* eslint-disable no-restricted-globals */\nconst globals = {\n    self: typeof self !== 'undefined' && self,\n    window: typeof window !== 'undefined' && window,\n    global: typeof global !== 'undefined' && global,\n    document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\n/** true if running in the browser, false if running in Node.js */\nexport const isBrowser = \n// @ts-ignore process.browser\ntypeof process !== 'object' || String(process) !== '[object process]' || process.browser;\n/** true if running on a worker thread */\nexport const isWorker = typeof importScripts === 'function';\n/** true if running on a mobile device */\nexport const isMobile = typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\n// Extract node major version\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n/** Version of Node.js if running under Node, otherwise 0 */\nexport const nodeVersion = (matches && parseFloat(matches[1])) || 0;\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../env-utils/assert.js\";\n/**\n * Represents one Job handled by a WorkerPool or WorkerFarm\n */\nexport default class WorkerJob {\n    name;\n    workerThread;\n    isRunning = true;\n    /** Promise that resolves when Job is done */\n    result;\n    _resolve = () => { };\n    _reject = () => { };\n    constructor(jobName, workerThread) {\n        this.name = jobName;\n        this.workerThread = workerThread;\n        this.result = new Promise((resolve, reject) => {\n            this._resolve = resolve;\n            this._reject = reject;\n        });\n    }\n    /**\n     * Send a message to the job's worker thread\n     * @param data any data structure, ideally consisting mostly of transferrable objects\n     */\n    postMessage(type, payload) {\n        this.workerThread.postMessage({\n            source: 'loaders.gl', // Lets worker ignore unrelated messages\n            type,\n            payload\n        });\n    }\n    /**\n     * Call to resolve the `result` Promise with the supplied value\n     */\n    done(value) {\n        assert(this.isRunning);\n        this.isRunning = false;\n        this._resolve(value);\n    }\n    /**\n     * Call to reject the `result` Promise with the supplied error\n     */\n    error(error) {\n        assert(this.isRunning);\n        this.isRunning = false;\n        this._reject(error);\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/** Browser polyfill for Node.js built-in `worker_threads` module.\n * These fills are non-functional, and just intended to ensure that\n * `import 'worker_threads` doesn't break browser builds.\n * The replacement is done in package.json browser field\n */\nexport class NodeWorker {\n    terminate() { }\n}\nexport const parentPort = null;\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../env-utils/assert.js\";\nconst workerURLCache = new Map();\n/**\n * Creates a loadable URL from worker source or URL\n * that can be used to create `Worker` instances.\n * Due to CORS issues it may be necessary to wrap a URL in a small importScripts\n * @param props\n * @param props.source Worker source\n * @param props.url Worker URL\n * @returns loadable url\n */\nexport function getLoadableWorkerURL(props) {\n    assert((props.source && !props.url) || (!props.source && props.url)); // Either source or url must be defined\n    let workerURL = workerURLCache.get(props.source || props.url);\n    if (!workerURL) {\n        // Differentiate worker urls from worker source code\n        if (props.url) {\n            workerURL = getLoadableWorkerURLFromURL(props.url);\n            workerURLCache.set(props.url, workerURL);\n        }\n        if (props.source) {\n            workerURL = getLoadableWorkerURLFromSource(props.source);\n            workerURLCache.set(props.source, workerURL);\n        }\n    }\n    assert(workerURL);\n    return workerURL;\n}\n/**\n * Build a loadable worker URL from worker URL\n * @param url\n * @returns loadable URL\n */\nfunction getLoadableWorkerURLFromURL(url) {\n    // A local script url, we can use it to initialize a Worker directly\n    if (!url.startsWith('http')) {\n        return url;\n    }\n    // A remote script, we need to use `importScripts` to load from different origin\n    const workerSource = buildScriptSource(url);\n    return getLoadableWorkerURLFromSource(workerSource);\n}\n/**\n * Build a loadable worker URL from worker source\n * @param workerSource\n * @returns loadable url\n */\nfunction getLoadableWorkerURLFromSource(workerSource) {\n    const blob = new Blob([workerSource], { type: 'application/javascript' });\n    return URL.createObjectURL(blob);\n}\n/**\n * Per spec, worker cannot be initialized with a script from a different origin\n * However a local worker script can still import scripts from other origins,\n * so we simply build a wrapper script.\n *\n * @param workerUrl\n * @returns source\n */\nfunction buildScriptSource(workerUrl) {\n    return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// NOTE - there is a copy of this function is both in core and loader-utils\n// core does not need all the utils in loader-utils, just this one.\n/**\n * Returns an array of Transferrable objects that can be used with postMessage\n * https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage\n * @param object data to be sent via postMessage\n * @param recursive - not for application use\n * @param transfers - not for application use\n * @returns a transfer list that can be passed to postMessage\n */\nexport function getTransferList(object, recursive = true, transfers) {\n    // Make sure that items in the transfer list is unique\n    const transfersSet = transfers || new Set();\n    if (!object) {\n        // ignore\n    }\n    else if (isTransferable(object)) {\n        transfersSet.add(object);\n    }\n    else if (isTransferable(object.buffer)) {\n        // Typed array\n        transfersSet.add(object.buffer);\n    }\n    else if (ArrayBuffer.isView(object)) {\n        // object is a TypeArray viewing into a SharedArrayBuffer (not transferable)\n        // Do not iterate through the content in this case\n    }\n    else if (recursive && typeof object === 'object') {\n        for (const key in object) {\n            // Avoid perf hit - only go one level deep\n            getTransferList(object[key], recursive, transfersSet);\n        }\n    }\n    // If transfers is defined, is internal recursive call\n    // Otherwise it's called by the user\n    return transfers === undefined ? Array.from(transfersSet) : [];\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/Transferable\nfunction isTransferable(object) {\n    if (!object) {\n        return false;\n    }\n    if (object instanceof ArrayBuffer) {\n        return true;\n    }\n    if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n        return true;\n    }\n    if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n        return true;\n    }\n    // @ts-ignore\n    if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n        return true;\n    }\n    return false;\n}\n/**\n * Recursively drop non serializable values like functions and regexps.\n * @param object\n */\nexport function getTransferListForWriter(object) {\n    if (object === null) {\n        return {};\n    }\n    const clone = Object.assign({}, object);\n    Object.keys(clone).forEach((key) => {\n        // Typed Arrays and Arrays are passed with no change\n        if (typeof object[key] === 'object' &&\n            !ArrayBuffer.isView(object[key]) &&\n            !(object[key] instanceof Array)) {\n            clone[key] = getTransferListForWriter(object[key]);\n        }\n        else if (typeof clone[key] === 'function' || clone[key] instanceof RegExp) {\n            clone[key] = {};\n        }\n        else {\n            clone[key] = object[key];\n        }\n    });\n    return clone;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { NodeWorker } from \"../node/worker_threads.js\";\nimport { isBrowser } from \"../env-utils/globals.js\";\nimport { assert } from \"../env-utils/assert.js\";\nimport { getLoadableWorkerURL } from \"../worker-utils/get-loadable-worker-url.js\";\nimport { getTransferList } from \"../worker-utils/get-transfer-list.js\";\nconst NOOP = () => { };\n/**\n * Represents one worker thread\n */\nexport default class WorkerThread {\n    name;\n    source;\n    url;\n    terminated = false;\n    worker;\n    onMessage;\n    onError;\n    _loadableURL = '';\n    /** Checks if workers are supported on this platform */\n    static isSupported() {\n        return ((typeof Worker !== 'undefined' && isBrowser) ||\n            (typeof NodeWorker !== 'undefined' && !isBrowser));\n    }\n    constructor(props) {\n        const { name, source, url } = props;\n        assert(source || url); // Either source or url must be defined\n        this.name = name;\n        this.source = source;\n        this.url = url;\n        this.onMessage = NOOP;\n        this.onError = (error) => console.log(error); // eslint-disable-line\n        this.worker = isBrowser ? this._createBrowserWorker() : this._createNodeWorker();\n    }\n    /**\n     * Terminate this worker thread\n     * @note Can free up significant memory\n     */\n    destroy() {\n        this.onMessage = NOOP;\n        this.onError = NOOP;\n        this.worker.terminate(); // eslint-disable-line @typescript-eslint/no-floating-promises\n        this.terminated = true;\n    }\n    get isRunning() {\n        return Boolean(this.onMessage);\n    }\n    /**\n     * Send a message to this worker thread\n     * @param data any data structure, ideally consisting mostly of transferrable objects\n     * @param transferList If not supplied, calculated automatically by traversing data\n     */\n    postMessage(data, transferList) {\n        transferList = transferList || getTransferList(data);\n        // @ts-ignore\n        this.worker.postMessage(data, transferList);\n    }\n    // PRIVATE\n    /**\n     * Generate a standard Error from an ErrorEvent\n     * @param event\n     */\n    _getErrorFromErrorEvent(event) {\n        // Note Error object does not have the expected fields if loading failed completely\n        // https://developer.mozilla.org/en-US/docs/Web/API/Worker#Event_handlers\n        // https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n        let message = 'Failed to load ';\n        message += `worker ${this.name} from ${this.url}. `;\n        if (event.message) {\n            message += `${event.message} in `;\n        }\n        // const hasFilename = event.filename && !event.filename.startsWith('blob:');\n        // message += hasFilename ? event.filename : this.source.slice(0, 100);\n        if (event.lineno) {\n            message += `:${event.lineno}:${event.colno}`;\n        }\n        return new Error(message);\n    }\n    /**\n     * Creates a worker thread on the browser\n     */\n    _createBrowserWorker() {\n        this._loadableURL = getLoadableWorkerURL({ source: this.source, url: this.url });\n        const worker = new Worker(this._loadableURL, { name: this.name });\n        worker.onmessage = (event) => {\n            if (!event.data) {\n                this.onError(new Error('No data received'));\n            }\n            else {\n                this.onMessage(event.data);\n            }\n        };\n        // This callback represents an uncaught exception in the worker thread\n        worker.onerror = (error) => {\n            this.onError(this._getErrorFromErrorEvent(error));\n            this.terminated = true;\n        };\n        // TODO - not clear when this would be called, for now just log in case it happens\n        worker.onmessageerror = (event) => console.error(event); // eslint-disable-line\n        return worker;\n    }\n    /**\n     * Creates a worker thread in node.js\n     * @todo https://nodejs.org/api/async_hooks.html#async-resource-worker-pool\n     */\n    _createNodeWorker() {\n        let worker;\n        if (this.url) {\n            // Make sure relative URLs start with './'\n            const absolute = this.url.includes(':/') || this.url.startsWith('/');\n            const url = absolute ? this.url : `./${this.url}`;\n            // console.log('Starting work from', url);\n            worker = new NodeWorker(url, { eval: false });\n        }\n        else if (this.source) {\n            worker = new NodeWorker(this.source, { eval: true });\n        }\n        else {\n            throw new Error('no worker');\n        }\n        worker.on('message', (data) => {\n            // console.error('message', data);\n            this.onMessage(data);\n        });\n        worker.on('error', (error) => {\n            // console.error('error', error);\n            this.onError(error);\n        });\n        worker.on('exit', (code) => {\n            // console.error('exit', code);\n        });\n        return worker;\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isMobile, isBrowser } from \"../env-utils/globals.js\";\nimport WorkerThread from \"./worker-thread.js\";\nimport WorkerJob from \"./worker-job.js\";\n/**\n * Process multiple data messages with small pool of identical workers\n */\nexport default class WorkerPool {\n    name = 'unnamed';\n    source; // | Function;\n    url;\n    maxConcurrency = 1;\n    maxMobileConcurrency = 1;\n    onDebug = () => { };\n    reuseWorkers = true;\n    props = {};\n    jobQueue = [];\n    idleQueue = [];\n    count = 0;\n    isDestroyed = false;\n    /** Checks if workers are supported on this platform */\n    static isSupported() {\n        return WorkerThread.isSupported();\n    }\n    /**\n     * @param processor - worker function\n     * @param maxConcurrency - max count of workers\n     */\n    constructor(props) {\n        this.source = props.source;\n        this.url = props.url;\n        this.setProps(props);\n    }\n    /**\n     * Terminates all workers in the pool\n     * @note Can free up significant memory\n     */\n    destroy() {\n        // Destroy idle workers, active Workers will be destroyed on completion\n        this.idleQueue.forEach((worker) => worker.destroy());\n        this.isDestroyed = true;\n    }\n    setProps(props) {\n        this.props = { ...this.props, ...props };\n        if (props.name !== undefined) {\n            this.name = props.name;\n        }\n        if (props.maxConcurrency !== undefined) {\n            this.maxConcurrency = props.maxConcurrency;\n        }\n        if (props.maxMobileConcurrency !== undefined) {\n            this.maxMobileConcurrency = props.maxMobileConcurrency;\n        }\n        if (props.reuseWorkers !== undefined) {\n            this.reuseWorkers = props.reuseWorkers;\n        }\n        if (props.onDebug !== undefined) {\n            this.onDebug = props.onDebug;\n        }\n    }\n    async startJob(name, onMessage = (job, type, data) => job.done(data), onError = (job, error) => job.error(error)) {\n        // Promise resolves when thread starts working on this job\n        const startPromise = new Promise((onStart) => {\n            // Promise resolves when thread completes or fails working on this job\n            this.jobQueue.push({ name, onMessage, onError, onStart });\n            return this;\n        });\n        this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n        return await startPromise;\n    }\n    // PRIVATE\n    /**\n     * Starts first queued job if worker is available or can be created\n     * Called when job is started and whenever a worker returns to the idleQueue\n     */\n    async _startQueuedJob() {\n        if (!this.jobQueue.length) {\n            return;\n        }\n        const workerThread = this._getAvailableWorker();\n        if (!workerThread) {\n            return;\n        }\n        // We have a worker, dequeue and start the job\n        const queuedJob = this.jobQueue.shift();\n        if (queuedJob) {\n            // Emit a debug event\n            // @ts-ignore\n            this.onDebug({\n                message: 'Starting job',\n                name: queuedJob.name,\n                workerThread,\n                backlog: this.jobQueue.length\n            });\n            // Create a worker job to let the app access thread and manage job completion\n            const job = new WorkerJob(queuedJob.name, workerThread);\n            // Set the worker thread's message handlers\n            workerThread.onMessage = (data) => queuedJob.onMessage(job, data.type, data.payload);\n            workerThread.onError = (error) => queuedJob.onError(job, error);\n            // Resolve the start promise so that the app can start sending messages to worker\n            queuedJob.onStart(job);\n            // Wait for the app to signal that the job is complete, then return worker to queue\n            try {\n                await job.result;\n            }\n            catch (error) {\n                // eslint-disable-next-line no-console\n                console.error(`Worker exception: ${error}`);\n            }\n            finally {\n                this.returnWorkerToQueue(workerThread);\n            }\n        }\n    }\n    /**\n     * Returns a worker to the idle queue\n     * Destroys the worker if\n     *  - pool is destroyed\n     *  - if this pool doesn't reuse workers\n     *  - if maxConcurrency has been lowered\n     * @param worker\n     */\n    returnWorkerToQueue(worker) {\n        const shouldDestroyWorker = \n        // Workers on Node.js prevent the process from exiting.\n        // Until we figure out how to close them before exit, we always destroy them\n        !isBrowser ||\n            // If the pool is destroyed, there is no reason to keep the worker around\n            this.isDestroyed ||\n            // If the app has disabled worker reuse, any completed workers should be destroyed\n            !this.reuseWorkers ||\n            // If concurrency has been lowered, this worker might be surplus to requirements\n            this.count > this._getMaxConcurrency();\n        if (shouldDestroyWorker) {\n            worker.destroy();\n            this.count--;\n        }\n        else {\n            this.idleQueue.push(worker);\n        }\n        if (!this.isDestroyed) {\n            this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n        }\n    }\n    /**\n     * Returns idle worker or creates new worker if maxConcurrency has not been reached\n     */\n    _getAvailableWorker() {\n        // If a worker has completed and returned to the queue, it can be used\n        if (this.idleQueue.length > 0) {\n            return this.idleQueue.shift() || null;\n        }\n        // Create fresh worker if we haven't yet created the max amount of worker threads for this worker source\n        if (this.count < this._getMaxConcurrency()) {\n            this.count++;\n            const name = `${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;\n            return new WorkerThread({ name, source: this.source, url: this.url });\n        }\n        // No worker available, have to wait\n        return null;\n    }\n    _getMaxConcurrency() {\n        return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport WorkerPool from \"./worker-pool.js\";\nimport WorkerThread from \"./worker-thread.js\";\nconst DEFAULT_PROPS = {\n    maxConcurrency: 3,\n    maxMobileConcurrency: 1,\n    reuseWorkers: true,\n    onDebug: () => { }\n};\n/**\n * Process multiple jobs with a \"farm\" of different workers in worker pools.\n */\nexport default class WorkerFarm {\n    props;\n    workerPools = new Map();\n    // singleton\n    static _workerFarm;\n    /** Checks if workers are supported on this platform */\n    static isSupported() {\n        return WorkerThread.isSupported();\n    }\n    /** Get the singleton instance of the global worker farm */\n    static getWorkerFarm(props = {}) {\n        WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n        WorkerFarm._workerFarm.setProps(props);\n        return WorkerFarm._workerFarm;\n    }\n    /** get global instance with WorkerFarm.getWorkerFarm() */\n    constructor(props) {\n        this.props = { ...DEFAULT_PROPS };\n        this.setProps(props);\n        /** @type Map<string, WorkerPool>} */\n        this.workerPools = new Map();\n    }\n    /**\n     * Terminate all workers in the farm\n     * @note Can free up significant memory\n     */\n    destroy() {\n        for (const workerPool of this.workerPools.values()) {\n            workerPool.destroy();\n        }\n        this.workerPools = new Map();\n    }\n    /**\n     * Set props used when initializing worker pools\n     * @param props\n     */\n    setProps(props) {\n        this.props = { ...this.props, ...props };\n        // Update worker pool props\n        for (const workerPool of this.workerPools.values()) {\n            workerPool.setProps(this._getWorkerPoolProps());\n        }\n    }\n    /**\n     * Returns a worker pool for the specified worker\n     * @param options - only used first time for a specific worker name\n     * @param options.name - the name of the worker - used to identify worker pool\n     * @param options.url -\n     * @param options.source -\n     * @example\n     *   const job = WorkerFarm.getWorkerFarm().getWorkerPool({name, url}).startJob(...);\n     */\n    getWorkerPool(options) {\n        const { name, source, url } = options;\n        let workerPool = this.workerPools.get(name);\n        if (!workerPool) {\n            workerPool = new WorkerPool({\n                name,\n                source,\n                url\n            });\n            workerPool.setProps(this._getWorkerPoolProps());\n            this.workerPools.set(name, workerPool);\n        }\n        return workerPool;\n    }\n    _getWorkerPoolProps() {\n        return {\n            maxConcurrency: this.props.maxConcurrency,\n            maxMobileConcurrency: this.props.maxMobileConcurrency,\n            reuseWorkers: this.props.reuseWorkers,\n            onDebug: this.props.onDebug\n        };\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../env-utils/assert.js\";\nimport { isBrowser } from \"../env-utils/globals.js\";\nimport { VERSION, NPM_TAG } from \"../env-utils/version.js\";\n/**\n * Gets worker object's name (for debugging in Chrome thread inspector window)\n */\nexport function getWorkerName(worker) {\n    const warning = worker.version !== VERSION ? ` (worker-utils@${VERSION})` : '';\n    return `${worker.name}@${worker.version}${warning}`;\n}\n/**\n * Generate a worker URL based on worker object and options\n * @returns A URL to one of the following:\n * - a published worker on unpkg CDN\n * - a local test worker\n * - a URL provided by the user in options\n */\nexport function getWorkerURL(worker, options = {}) {\n    const workerOptions = options[worker.id] || {};\n    const workerFile = isBrowser ? `${worker.id}-worker.js` : `${worker.id}-worker-node.js`;\n    let url = workerOptions.workerUrl;\n    // HACK: Allow for non-nested workerUrl for the CompressionWorker.\n    // For the compression worker, workerOptions is currently not nested correctly. For most loaders,\n    // you'd have options within an object, i.e. `{mvt: {coordinates: ...}}` but the CompressionWorker\n    // puts options at the top level, not within a `compression` key (its `id`). For this reason, the\n    // above `workerOptions` will always be a string (i.e. `'gzip'`) for the CompressionWorker. To not\n    // break backwards compatibility, we allow the CompressionWorker to have options at the top level.\n    if (!url && worker.id === 'compression') {\n        url = options.workerUrl;\n    }\n    // If URL is test, generate local loaders.gl url\n    // @ts-ignore _workerType\n    if (options._workerType === 'test') {\n        if (isBrowser) {\n            url = `modules/${worker.module}/dist/${workerFile}`;\n        }\n        else {\n            // In the test environment the ts-node loader requires TypeScript code\n            url = `modules/${worker.module}/src/workers/${worker.id}-worker-node.ts`;\n        }\n    }\n    // If url override is not provided, generate a URL to published version on npm CDN unpkg.com\n    if (!url) {\n        // GENERATE\n        let version = worker.version;\n        // On master we need to load npm alpha releases published with the `beta` tag\n        if (version === 'latest') {\n            // throw new Error('latest worker version specified');\n            version = NPM_TAG;\n        }\n        const versionTag = version ? `@${version}` : '';\n        url = `https://unpkg.com/@loaders.gl/${worker.module}${versionTag}/dist/${workerFile}`;\n    }\n    assert(url);\n    // Allow user to override location\n    return url;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../env-utils/assert.js\";\nimport { VERSION } from \"../env-utils/version.js\";\n/**\n * Check if worker is compatible with this library version\n * @param worker\n * @param libVersion\n * @returns `true` if the two versions are compatible\n */\nexport function validateWorkerVersion(worker, coreVersion = VERSION) {\n    assert(worker, 'no worker provided');\n    const workerVersion = worker.version;\n    if (!coreVersion || !workerVersion) {\n        return false;\n    }\n    // TODO enable when fix the __version__ injection\n    // const coreVersions = parseVersion(coreVersion);\n    // const workerVersions = parseVersion(workerVersion);\n    // assert(\n    //   coreVersion.major === workerVersion.major && coreVersion.minor <= workerVersion.minor,\n    //   `worker: ${worker.name} is not compatible. ${coreVersion.major}.${\n    //     coreVersion.minor\n    //   }+ is required.`\n    // );\n    return true;\n}\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction parseVersion(version) {\n    const parts = version.split('.').map(Number);\n    return { major: parts[0], minor: parts[1] };\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/* global importScripts */\nimport { isBrowser, isWorker } from \"../env-utils/globals.js\";\nimport { assert } from \"../env-utils/assert.js\";\nimport { VERSION } from \"../env-utils/version.js\";\nconst loadLibraryPromises = {}; // promises\n/**\n * Dynamically loads a library (\"module\")\n *\n * - wasm library: Array buffer is returned\n * - js library: Parse JS is returned\n *\n * Method depends on environment\n * - browser - script element is created and installed on document\n * - worker - eval is called on global context\n * - node - file is required\n *\n * @param libraryUrl\n * @param moduleName\n * @param options\n */\nexport async function loadLibrary(libraryUrl, moduleName = null, options = {}, libraryName = null) {\n    if (moduleName) {\n        libraryUrl = getLibraryUrl(libraryUrl, moduleName, options, libraryName);\n    }\n    // Ensure libraries are only loaded once\n    loadLibraryPromises[libraryUrl] =\n        // eslint-disable-next-line @typescript-eslint/no-misused-promises\n        loadLibraryPromises[libraryUrl] || loadLibraryFromFile(libraryUrl);\n    return await loadLibraryPromises[libraryUrl];\n}\n// TODO - sort out how to resolve paths for main/worker and dev/prod\nexport function getLibraryUrl(library, moduleName, options = {}, libraryName = null) {\n    // Check if already a URL\n    if (!options.useLocalLibraries && library.startsWith('http')) {\n        return library;\n    }\n    libraryName = libraryName || library;\n    // Allow application to import and supply libraries through `options.modules`\n    // TODO - See js-module-utils in loader-utils\n    const modules = options.modules || {};\n    if (modules[libraryName]) {\n        return modules[libraryName];\n    }\n    // Load from local files, not from CDN scripts in Node.js\n    // TODO - needs to locate the modules directory when installed!\n    if (!isBrowser) {\n        return `modules/${moduleName}/dist/libs/${libraryName}`;\n    }\n    // In browser, load from external scripts\n    if (options.CDN) {\n        assert(options.CDN.startsWith('http'));\n        return `${options.CDN}/${moduleName}@${VERSION}/dist/libs/${libraryName}`;\n    }\n    // TODO - loading inside workers requires paths relative to worker script location...\n    if (isWorker) {\n        return `../src/libs/${libraryName}`;\n    }\n    return `modules/${moduleName}/src/libs/${libraryName}`;\n}\nasync function loadLibraryFromFile(libraryUrl) {\n    if (libraryUrl.endsWith('wasm')) {\n        return await loadAsArrayBuffer(libraryUrl);\n    }\n    if (!isBrowser) {\n        // TODO - Node doesn't yet support dynamic import from https URLs\n        // try {\n        //   return await import(libraryUrl);\n        // } catch (error) {\n        //   console.error(error);\n        // }\n        try {\n            const { requireFromFile } = globalThis.loaders || {};\n            return await requireFromFile?.(libraryUrl);\n        }\n        catch (error) {\n            console.error(error); // eslint-disable-line no-console\n            return null;\n        }\n    }\n    if (isWorker) {\n        return importScripts(libraryUrl);\n    }\n    // TODO - fix - should be more secure than string parsing since observes CORS\n    // if (isBrowser) {\n    //   return await loadScriptFromFile(libraryUrl);\n    // }\n    const scriptSource = await loadAsText(libraryUrl);\n    return loadLibraryFromString(scriptSource, libraryUrl);\n}\n/*\nasync function loadScriptFromFile(libraryUrl) {\n  const script = document.createElement('script');\n  script.src = libraryUrl;\n  return await new Promise((resolve, reject) => {\n    script.onload = data => {\n      resolve(data);\n    };\n    script.onerror = reject;\n  });\n}\n*/\n// TODO - Needs security audit...\n//  - Raw eval call\n//  - Potentially bypasses CORS\n// Upside is that this separates fetching and parsing\n// we could create a`LibraryLoader` or`ModuleLoader`\nfunction loadLibraryFromString(scriptSource, id) {\n    if (!isBrowser) {\n        const { requireFromString } = globalThis.loaders || {};\n        return requireFromString?.(scriptSource, id);\n    }\n    if (isWorker) {\n        // Use lvalue trick to make eval run in global scope\n        eval.call(globalThis, scriptSource); // eslint-disable-line no-eval\n        // https://stackoverflow.com/questions/9107240/1-evalthis-vs-evalthis-in-javascript\n        // http://perfectionkills.com/global-eval-what-are-the-options/\n        return null;\n    }\n    const script = document.createElement('script');\n    script.id = id;\n    // most browsers like a separate text node but some throw an error. The second method covers those.\n    try {\n        script.appendChild(document.createTextNode(scriptSource));\n    }\n    catch (e) {\n        script.text = scriptSource;\n    }\n    document.body.appendChild(script);\n    return null;\n}\n// TODO - technique for module injection into worker, from THREE.DracoLoader...\n/*\nfunction combineWorkerWithLibrary(worker, jsContent) {\n  var fn = wWorker.toString();\n  var body = [\n    '// injected',\n    jsContent,\n    '',\n    '// worker',\n    fn.substring(fn.indexOf('{') + 1, fn.lastIndexOf('}'))\n  ].join('\\n');\n  this.workerSourceURL = URL.createObjectURL(new Blob([body]));\n}\n*/\nasync function loadAsArrayBuffer(url) {\n    const { readFileAsArrayBuffer } = globalThis.loaders || {};\n    if (isBrowser || !readFileAsArrayBuffer || url.startsWith('http')) {\n        const response = await fetch(url);\n        return await response.arrayBuffer();\n    }\n    return await readFileAsArrayBuffer(url);\n}\n/**\n * Load a file from local file system\n * @param filename\n * @returns\n */\nasync function loadAsText(url) {\n    const { readFileAsText } = globalThis.loaders || {};\n    if (isBrowser || !readFileAsText || url.startsWith('http')) {\n        const response = await fetch(url);\n        return await response.text();\n    }\n    return await readFileAsText(url);\n}\n", "import { isBrowser, WorkerFarm, getWorkerURL } from '@loaders.gl/worker-utils';\n/**\n * Determines if a loader can parse with worker\n * @param loader\n * @param options\n */\nexport function canParseWithWorker(loader, options) {\n    if (!WorkerFarm.isSupported()) {\n        return false;\n    }\n    // Node workers are still experimental\n    if (!isBrowser && !options?._nodeWorkers) {\n        return false;\n    }\n    return loader.worker && options?.worker;\n}\n/**\n * this function expects that the worker function sends certain messages,\n * this can be automated if the worker is wrapper by a call to createLoaderWorker in @loaders.gl/loader-utils.\n */\nexport async function parseWithWorker(loader, data, options, context, parseOnMainThread) {\n    const name = loader.id; // TODO\n    const url = getWorkerURL(loader, options);\n    const workerFarm = WorkerFarm.getWorkerFarm(options);\n    const workerPool = workerFarm.getWorkerPool({ name, url });\n    // options.log object contains functions which cannot be transferred\n    // context.fetch & context.parse functions cannot be transferred\n    // TODO - decide how to handle logging on workers\n    options = JSON.parse(JSON.stringify(options));\n    context = JSON.parse(JSON.stringify(context || {}));\n    const job = await workerPool.startJob('process-on-worker', \n    // @ts-expect-error\n    onMessage.bind(null, parseOnMainThread) // eslint-disable-line @typescript-eslint/no-misused-promises\n    );\n    job.postMessage('process', {\n        // @ts-ignore\n        input: data,\n        options,\n        context\n    });\n    const result = await job.result;\n    // TODO - what is going on here?\n    return await result.result;\n}\n/**\n * Handle worker's responses to the main thread\n * @param job\n * @param type\n * @param payload\n */\nasync function onMessage(parseOnMainThread, job, type, payload) {\n    switch (type) {\n        case 'done':\n            job.done(payload);\n            break;\n        case 'error':\n            job.error(new Error(payload.error));\n            break;\n        case 'process':\n            // Worker is asking for main thread to parseO\n            const { id, input, options } = payload;\n            try {\n                const result = await parseOnMainThread(input, options);\n                job.postMessage('done', { id, result });\n            }\n            catch (error) {\n                const message = error instanceof Error ? error.message : 'unknown error';\n                job.postMessage('error', { id, error: message });\n            }\n            break;\n        default:\n            // eslint-disable-next-line\n            console.warn(`parse-with-worker unknown message ${type}`);\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/**\n * Get the first characters from a binary file (interpret the first bytes as an ASCII string)\n * @param data\n * @param length\n * @returns\n */\nexport function getFirstCharacters(data, length = 5) {\n    if (typeof data === 'string') {\n        return data.slice(0, length);\n    }\n    else if (ArrayBuffer.isView(data)) {\n        // Typed Arrays can have offsets into underlying buffer\n        return getMagicString(data.buffer, data.byteOffset, length);\n    }\n    else if (data instanceof ArrayBuffer) {\n        const byteOffset = 0;\n        return getMagicString(data, byteOffset, length);\n    }\n    return '';\n}\n/**\n * Gets a magic string from a \"file\"\n * Typically used to check or detect file format\n * @param arrayBuffer\n * @param byteOffset\n * @param length\n * @returns\n */\nexport function getMagicString(arrayBuffer, byteOffset, length) {\n    if (arrayBuffer.byteLength <= byteOffset + length) {\n        return '';\n    }\n    const dataView = new DataView(arrayBuffer);\n    let magic = '';\n    for (let i = 0; i < length; i++) {\n        magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n    }\n    return magic;\n}\n", "import { getFirstCharacters } from \"../binary-utils/get-first-characters.js\";\n/**\n * Minimal JSON parser that throws more meaningful error messages\n */\nexport function parseJSON(string) {\n    try {\n        return JSON.parse(string);\n    }\n    catch (_) {\n        throw new Error(`Failed to parse JSON from data starting with \"${getFirstCharacters(string)}\"`);\n    }\n}\n", "/**\n * compare two binary arrays for equality\n * @param a\n * @param b\n * @param byteLength\n */\nexport function compareArrayBuffers(arrayBuffer1, arrayBuffer2, byteLength) {\n    byteLength = byteLength || arrayBuffer1.byteLength;\n    if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n        return false;\n    }\n    const array1 = new Uint8Array(arrayBuffer1);\n    const array2 = new Uint8Array(arrayBuffer2);\n    for (let i = 0; i < array1.length; ++i) {\n        if (array1[i] !== array2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Concatenate a sequence of ArrayBuffers from arguments\n * @return A concatenated ArrayBuffer\n */\nexport function concatenateArrayBuffers(...sources) {\n    return concatenateArrayBuffersFromArray(sources);\n}\n/**\n * Concatenate a sequence of ArrayBuffers from array\n * @return A concatenated ArrayBuffer\n */\nexport function concatenateArrayBuffersFromArray(sources) {\n    // Make sure all inputs are wrapped in typed arrays\n    const sourceArrays = sources.map((source2) => source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2);\n    // Get length of all inputs\n    const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n    // Allocate array with space for all inputs\n    const result = new Uint8Array(byteLength);\n    // Copy the subarrays\n    let offset = 0;\n    for (const sourceArray of sourceArrays) {\n        result.set(sourceArray, offset);\n        offset += sourceArray.byteLength;\n    }\n    // We work with ArrayBuffers, discard the typed array wrapper\n    return result.buffer;\n}\n/**\n * Concatenate arbitrary count of typed arrays\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays\n * @param - list of arrays. All arrays should be the same type\n * @return A concatenated TypedArray\n */\nexport function concatenateTypedArrays(...typedArrays) {\n    // @ts-ignore\n    const arrays = typedArrays;\n    // @ts-ignore\n    const TypedArrayConstructor = (arrays && arrays.length > 1 && arrays[0].constructor) || null;\n    if (!TypedArrayConstructor) {\n        throw new Error('\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types');\n    }\n    const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n    // @ts-ignore typescript does not like dynamic constructors\n    const result = new TypedArrayConstructor(sumLength);\n    let offset = 0;\n    for (const array of arrays) {\n        result.set(array, offset);\n        offset += array.length;\n    }\n    return result;\n}\n/**\n * Copy a view of an ArrayBuffer into new ArrayBuffer with byteOffset = 0\n * @param arrayBuffer\n * @param byteOffset\n * @param byteLength\n */\nexport function sliceArrayBuffer(arrayBuffer, byteOffset, byteLength) {\n    const subArray = byteLength !== undefined\n        ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength)\n        : new Uint8Array(arrayBuffer).subarray(byteOffset);\n    const arrayCopy = new Uint8Array(subArray);\n    return arrayCopy.buffer;\n}\n", "import { assert } from \"../env-utils/assert.js\";\n/**\n * Calculate new size of an arrayBuffer to be aligned to an n-byte boundary\n * This function increases `byteLength` by the minimum delta,\n * allowing the total length to be divided by `padding`\n * @param byteLength\n * @param padding\n */\nexport function padToNBytes(byteLength, padding) {\n    assert(byteLength >= 0); // `Incorrect 'byteLength' value: ${byteLength}`\n    assert(padding > 0); // `Incorrect 'padding' value: ${padding}`\n    return (byteLength + (padding - 1)) & ~(padding - 1);\n}\n/**\n * Creates a new Uint8Array based on two different ArrayBuffers\n * @param targetBuffer The first buffer.\n * @param sourceBuffer The second buffer.\n * @return The new ArrayBuffer created out of the two.\n */\nexport function copyArrayBuffer(targetBuffer, sourceBuffer, byteOffset, byteLength = sourceBuffer.byteLength) {\n    const targetArray = new Uint8Array(targetBuffer, byteOffset, byteLength);\n    const sourceArray = new Uint8Array(sourceBuffer);\n    targetArray.set(sourceArray);\n    return targetBuffer;\n}\n/**\n * Copy from source to target at the targetOffset\n *\n * @param source - The data to copy\n * @param target - The destination to copy data into\n * @param targetOffset - The start offset into target to place the copied data\n * @returns the new offset taking into account proper padding\n */\nexport function copyToArray(source, target, targetOffset) {\n    let sourceArray;\n    if (source instanceof ArrayBuffer) {\n        sourceArray = new Uint8Array(source);\n    }\n    else {\n        // Pack buffer onto the big target array\n        //\n        // 'source.data.buffer' could be a view onto a larger buffer.\n        // We MUST use this constructor to ensure the byteOffset and byteLength is\n        // set to correct values from 'source.data' and not the underlying\n        // buffer for target.set() to work properly.\n        const srcByteOffset = source.byteOffset;\n        const srcByteLength = source.byteLength;\n        // In gltf parser it is set as \"arrayBuffer\" instead of \"buffer\"\n        // https://github.com/visgl/loaders.gl/blob/1e3a82a0a65d7b6a67b1e60633453e5edda2960a/modules/gltf/src/lib/parse-gltf.js#L85\n        sourceArray = new Uint8Array(source.buffer || source.arrayBuffer, srcByteOffset, srcByteLength);\n    }\n    // Pack buffer onto the big target array\n    target.set(sourceArray, targetOffset);\n    return targetOffset + padToNBytes(sourceArray.byteLength, 4);\n}\n", "import { concatenateArrayBuffers } from \"../binary-utils/array-buffer-utils.js\";\n// GENERAL UTILITIES\n/**\n * Iterate over async iterator, without resetting iterator if end is not reached\n * - forEach intentionally does not reset iterator if exiting loop prematurely\n *   so that iteration can continue in a second loop\n * - It is recommended to use a standard for-await as last loop to ensure\n *   iterator gets properly reset\n *\n * TODO - optimize using sync iteration if argument is an Iterable?\n *\n * @param iterator\n * @param visitor\n */\nexport async function forEach(iterator, visitor) {\n    // eslint-disable-next-line\n    while (true) {\n        const { done, value } = await iterator.next();\n        if (done) {\n            iterator.return();\n            return;\n        }\n        const cancel = visitor(value);\n        if (cancel) {\n            return;\n        }\n    }\n}\n// Breaking big data into iterable chunks, concatenating iterable chunks into big data objects\n/**\n * Concatenates all data chunks yielded by an (async) iterator\n * This function can e.g. be used to enable atomic parsers to work on (async) iterator inputs\n */\nexport async function concatenateArrayBuffersAsync(asyncIterator) {\n    const arrayBuffers = [];\n    for await (const chunk of asyncIterator) {\n        arrayBuffers.push(chunk);\n    }\n    return concatenateArrayBuffers(...arrayBuffers);\n}\nexport async function concatenateStringsAsync(asyncIterator) {\n    const strings = [];\n    for await (const chunk of asyncIterator) {\n        strings.push(chunk);\n    }\n    return strings.join('');\n}\n", "// Simple file alias mechanisms for tests.\nlet pathPrefix = '';\nconst fileAliases = {};\n/*\n * Set a relative path prefix\n */\nexport function setPathPrefix(prefix) {\n    pathPrefix = prefix;\n}\n/*\n * Get the relative path prefix\n */\nexport function getPathPrefix() {\n    return pathPrefix;\n}\n/**\n *\n * @param aliases\n *\n * Note: addAliases are an experimental export, they are only for testing of loaders.gl loaders\n * not intended as a generic aliasing mechanism\n */\nexport function addAliases(aliases) {\n    Object.assign(fileAliases, aliases);\n}\n/**\n * Resolves aliases and adds path-prefix to paths\n */\nexport function resolvePath(filename) {\n    for (const alias in fileAliases) {\n        if (filename.startsWith(alias)) {\n            const replacement = fileAliases[alias];\n            filename = filename.replace(alias, replacement);\n        }\n    }\n    if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n        filename = `${pathPrefix}${filename}`;\n    }\n    return filename;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport * as node from \"../node/buffer.js\";\n/**\n * Check for Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n */\nexport function isBuffer(value) {\n    return value && typeof value === 'object' && value.isBuffer;\n}\n/**\n * Converts to Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function toBuffer(data) {\n    return node.toBuffer ? node.toBuffer(data) : data;\n}\n/**\n * Convert an object to an array buffer\n */\nexport function toArrayBuffer(data) {\n    // Note: Should be called first, Buffers can trigger other detections below\n    if (isBuffer(data)) {\n        return node.toArrayBuffer(data);\n    }\n    if (data instanceof ArrayBuffer) {\n        return data;\n    }\n    // Careful - Node Buffers look like Uint8Arrays (keep after isBuffer)\n    if (ArrayBuffer.isView(data)) {\n        if (data.byteOffset === 0 && data.byteLength === data.buffer.byteLength) {\n            return data.buffer;\n        }\n        return data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n    }\n    if (typeof data === 'string') {\n        const text = data;\n        const uint8Array = new TextEncoder().encode(text);\n        return uint8Array.buffer;\n    }\n    // HACK to support Blob polyfill\n    if (data && typeof data === 'object' && data._toArrayBuffer) {\n        return data._toArrayBuffer();\n    }\n    throw new Error('toArrayBuffer');\n}\n", "// Beginning of a minimal implementation of the Node.js path API, that doesn't pull in big polyfills.\nimport { getCWD } from \"./get-cwd.js\";\n/**\n * Replacement for Node.js path.filename\n * @param url\n */\nexport function filename(url) {\n    const slashIndex = url ? url.lastIndexOf('/') : -1;\n    return slashIndex >= 0 ? url.substr(slashIndex + 1) : '';\n}\n/**\n * Replacement for Node.js path.dirname\n * @param url\n */\nexport function dirname(url) {\n    const slashIndex = url ? url.lastIndexOf('/') : -1;\n    return slashIndex >= 0 ? url.substr(0, slashIndex) : '';\n}\n/**\n * Replacement for Node.js path.join\n * @param parts\n */\nexport function join(...parts) {\n    const separator = '/';\n    parts = parts.map((part, index) => {\n        if (index) {\n            part = part.replace(new RegExp(`^${separator}`), '');\n        }\n        if (index !== parts.length - 1) {\n            part = part.replace(new RegExp(`${separator}$`), '');\n        }\n        return part;\n    });\n    return parts.join(separator);\n}\n/* eslint-disable no-continue */\n/**\n * https://nodejs.org/api/path.html#path_path_resolve_paths\n * @param paths A sequence of paths or path segments.\n * @return resolved path\n * Forked from BTOdell/path-resolve under MIT license\n * @see https://github.com/BTOdell/path-resolve/blob/master/LICENSE\n */\nexport function resolve(...components) {\n    const paths = [];\n    for (let _i = 0; _i < components.length; _i++) {\n        paths[_i] = components[_i];\n    }\n    let resolvedPath = '';\n    let resolvedAbsolute = false;\n    let cwd;\n    for (let i = paths.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n        let path;\n        if (i >= 0) {\n            path = paths[i];\n        }\n        else {\n            if (cwd === undefined) {\n                cwd = getCWD();\n            }\n            path = cwd;\n        }\n        // Skip empty entries\n        if (path.length === 0) {\n            continue;\n        }\n        resolvedPath = `${path}/${resolvedPath}`;\n        resolvedAbsolute = path.charCodeAt(0) === SLASH;\n    }\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n    // Normalize the path (removes leading slash)\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n    if (resolvedAbsolute) {\n        return `/${resolvedPath}`;\n    }\n    else if (resolvedPath.length > 0) {\n        return resolvedPath;\n    }\n    return '.';\n}\nconst SLASH = 47;\nconst DOT = 46;\n/**\n * Resolves . and .. elements in a path with directory names\n * Forked from BTOdell/path-resolve under MIT license\n * @see https://github.com/BTOdell/path-resolve/blob/master/LICENSE\n */\n/* eslint-disable max-depth */\n// eslint-disable-next-line complexity, max-statements\nfunction normalizeStringPosix(path, allowAboveRoot) {\n    let res = '';\n    let lastSlash = -1;\n    let dots = 0;\n    let code;\n    let isAboveRoot = false;\n    for (let i = 0; i <= path.length; ++i) {\n        if (i < path.length) {\n            code = path.charCodeAt(i);\n        }\n        else if (code === SLASH) {\n            break;\n        }\n        else {\n            code = SLASH;\n        }\n        if (code === SLASH) {\n            if (lastSlash === i - 1 || dots === 1) {\n                // NOOP\n            }\n            else if (lastSlash !== i - 1 && dots === 2) {\n                if (res.length < 2 ||\n                    !isAboveRoot ||\n                    res.charCodeAt(res.length - 1) !== DOT ||\n                    res.charCodeAt(res.length - 2) !== DOT) {\n                    if (res.length > 2) {\n                        const start = res.length - 1;\n                        let j = start;\n                        for (; j >= 0; --j) {\n                            if (res.charCodeAt(j) === SLASH) {\n                                break;\n                            }\n                        }\n                        if (j !== start) {\n                            res = j === -1 ? '' : res.slice(0, j);\n                            lastSlash = i;\n                            dots = 0;\n                            isAboveRoot = false;\n                            continue;\n                        }\n                    }\n                    else if (res.length === 2 || res.length === 1) {\n                        res = '';\n                        lastSlash = i;\n                        dots = 0;\n                        isAboveRoot = false;\n                        continue;\n                    }\n                }\n                if (allowAboveRoot) {\n                    if (res.length > 0) {\n                        res += '/..';\n                    }\n                    else {\n                        res = '..';\n                    }\n                    isAboveRoot = true;\n                }\n            }\n            else {\n                const slice = path.slice(lastSlash + 1, i);\n                if (res.length > 0) {\n                    res += `/${slice}`;\n                }\n                else {\n                    res = slice;\n                }\n                isAboveRoot = false;\n            }\n            lastSlash = i;\n            dots = 0;\n        }\n        else if (code === DOT && dots !== -1) {\n            ++dots;\n        }\n        else {\n            dots = -1;\n        }\n    }\n    return res;\n}\n", "// loaders.gl MIT license\nexport function getCWD() {\n    if (typeof process !== 'undefined' && typeof process.cwd !== 'undefined') {\n        return process.cwd();\n    }\n    const pathname = window.location?.pathname;\n    return pathname?.slice(0, pathname.lastIndexOf('/') + 1) || '';\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst isBoolean = (x) => typeof x === 'boolean';\nconst isFunction = (x) => typeof x === 'function';\nexport const isObject = (x) => x !== null && typeof x === 'object';\nexport const isPureObject = (x) => isObject(x) && x.constructor === {}.constructor;\nexport const isPromise = (x) => isObject(x) && isFunction(x.then);\nexport const isIterable = (x) => Boolean(x) && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable = (x) => x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator = (x) => x && isFunction(x.next);\nexport const isResponse = (x) => (typeof Response !== 'undefined' && x instanceof Response) ||\n    (x && x.arrayBuffer && x.text && x.json);\nexport const isFile = (x) => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob = (x) => typeof Blob !== 'undefined' && x instanceof Blob;\n/** Check for Node.js `Buffer` without triggering bundler to include buffer polyfill */\nexport const isBuffer = (x) => x && typeof x === 'object' && x.isBuffer;\nexport const isWritableDOMStream = (x) => isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\nexport const isReadableDOMStream = (x) => (typeof ReadableStream !== 'undefined' && x instanceof ReadableStream) ||\n    (isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader));\n// Not implemented in Firefox: && isFunction(x.pipeTo)\nexport const isWritableNodeStream = (x) => isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream = (x) => isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream = (x) => isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream = (x) => isWritableDOMStream(x) || isWritableNodeStream(x);\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nexport class FetchError extends Error {\n    constructor(message, info) {\n        super(message);\n        this.reason = info.reason;\n        this.url = info.url;\n        this.response = info.response;\n    }\n    /** A best effort reason for why the fetch failed */\n    reason;\n    /** The URL that failed to load. Empty string if not available. */\n    url;\n    /** The Response object, if any. */\n    response;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// TODO - build/integrate proper MIME type parsing\n// https://mimesniff.spec.whatwg.org/\nconst DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\n/**\n * Compare two MIME types, case insensitively etc.\n * @param mimeType1\n * @param mimeType2\n * @returns true if the MIME types are equivalent\n * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#structure_of_a_mime_type\n */\nexport function compareMIMETypes(mimeType1, mimeType2) {\n    if (mimeType1.toLowerCase() === mimeType2.toLowerCase()) {\n        return true;\n    }\n    return false;\n}\n/**\n * Remove extra data like `charset` from MIME types\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMEType(mimeString) {\n    // If resource is a data url, extract any embedded mime type\n    const matches = MIME_TYPE_PATTERN.exec(mimeString);\n    if (matches) {\n        return matches[1];\n    }\n    return mimeString;\n}\n/**\n * Extract MIME type from data URL\n *\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMETypeFromURL(url) {\n    // If resource is a data URL, extract any embedded mime type\n    const matches = DATA_URL_PATTERN.exec(url);\n    if (matches) {\n        return matches[1];\n    }\n    return '';\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst QUERY_STRING_PATTERN = /\\?.*/;\nexport function extractQueryString(url) {\n    const matches = url.match(QUERY_STRING_PATTERN);\n    return matches && matches[0];\n}\nexport function stripQueryString(url) {\n    return url.replace(QUERY_STRING_PATTERN, '');\n}\nexport function shortenUrlForDisplay(url) {\n    if (url.length < 50) {\n        return url;\n    }\n    const urlEnd = url.slice(url.length - 15);\n    const urlStart = url.substr(0, 32);\n    return `${urlStart}...${urlEnd}`;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isResponse, isBlob } from \"../../javascript-utils/is-type.js\";\nimport { parseMIMEType, parseMIMETypeFromURL } from \"./mime-type-utils.js\";\nimport { stripQueryString } from \"./url-utils.js\";\n/**\n * Returns the URL associated with this resource.\n * The returned value may include a query string and need further processing.\n * If it cannot determine url, the corresponding value will be an empty string\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceUrl(resource) {\n    // If resource is a `Response`, it contains the information directly as a field\n    if (isResponse(resource)) {\n        const response = resource;\n        return response.url;\n    }\n    // If the resource is a Blob or a File (subclass of Blob)\n    if (isBlob(resource)) {\n        const blob = resource;\n        // File objects have a \"name\" property. Blob objects don't have any\n        // url (name) information\n        return blob.name || '';\n    }\n    if (typeof resource === 'string') {\n        return resource;\n    }\n    // Unknown\n    return '';\n}\n/**\n * Returns the URL associated with this resource.\n * The returned value may include a query string and need further processing.\n * If it cannot determine url, the corresponding value will be an empty string\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceMIMEType(resource) {\n    // If resource is a response, it contains the information directly\n    if (isResponse(resource)) {\n        const response = resource;\n        const contentTypeHeader = response.headers.get('content-type') || '';\n        const noQueryUrl = stripQueryString(response.url);\n        return parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(noQueryUrl);\n    }\n    // If the resource is a Blob or a File (subclass of Blob)\n    if (isBlob(resource)) {\n        const blob = resource;\n        return blob.type || '';\n    }\n    if (typeof resource === 'string') {\n        return parseMIMETypeFromURL(resource);\n    }\n    // Unknown\n    return '';\n}\n/**\n  * Returns (approximate) content length for a resource if it can be determined.\n  * Returns -1 if content length cannot be determined.\n  * @param resource\n\n  * @note string parameters are NOT assumed to be URLs\n  */\nexport function getResourceContentLength(resource) {\n    if (isResponse(resource)) {\n        const response = resource;\n        return response.headers['content-length'] || -1;\n    }\n    if (isBlob(resource)) {\n        const blob = resource;\n        return blob.size;\n    }\n    if (typeof resource === 'string') {\n        // TODO - handle data URL?\n        return resource.length;\n    }\n    if (resource instanceof ArrayBuffer) {\n        return resource.byteLength;\n    }\n    if (ArrayBuffer.isView(resource)) {\n        return resource.byteLength;\n    }\n    return -1;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isResponse } from \"../../javascript-utils/is-type.js\";\nimport { FetchError } from \"../fetch/fetch-error.js\";\nimport { getResourceContentLength, getResourceUrl, getResourceMIMEType } from \"./resource-utils.js\";\nimport { shortenUrlForDisplay } from \"./url-utils.js\";\n/**\n * Returns a Response object\n * Adds content-length header when possible\n *\n * @param resource\n */\nexport async function makeResponse(resource) {\n    if (isResponse(resource)) {\n        return resource;\n    }\n    // Add content-length header if possible\n    const headers = {};\n    const contentLength = getResourceContentLength(resource);\n    if (contentLength >= 0) {\n        headers['content-length'] = String(contentLength);\n    }\n    // `new Response(File)` does not preserve content-type and URL\n    // so we add them here\n    const url = getResourceUrl(resource);\n    const type = getResourceMIMEType(resource);\n    if (type) {\n        headers['content-type'] = type;\n    }\n    // Add a custom header with initial bytes if available\n    const initialDataUrl = await getInitialDataUrl(resource);\n    if (initialDataUrl) {\n        headers['x-first-bytes'] = initialDataUrl;\n    }\n    // TODO - is this the best way of handling strings?\n    // Maybe package as data URL instead?\n    if (typeof resource === 'string') {\n        // Convert to ArrayBuffer to avoid Response treating it as a URL\n        resource = new TextEncoder().encode(resource);\n    }\n    // Attempt to create a Response from the resource, adding headers and setting url\n    const response = new Response(resource, { headers });\n    // We can't control `Response.url` via constructor, use a property override to record URL.\n    Object.defineProperty(response, 'url', { value: url });\n    return response;\n}\n/**\n * Checks response status (async) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport async function checkResponse(response) {\n    if (!response.ok) {\n        const error = await getResponseError(response);\n        throw error;\n    }\n}\n/**\n * Checks response status (sync) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport function checkResponseSync(response) {\n    if (!response.ok) {\n        let message = `${response.status} ${response.statusText}`;\n        message = message.length > 60 ? `${message.slice(0, 60)}...` : message;\n        throw new Error(message);\n    }\n}\n// HELPERS\nasync function getResponseError(response) {\n    const shortUrl = shortenUrlForDisplay(response.url);\n    let message = `Failed to fetch resource (${response.status}) ${response.statusText}: ${shortUrl}`;\n    message = message.length > 100 ? `${message.slice(0, 100)}...` : message;\n    const info = {\n        reason: response.statusText,\n        url: response.url,\n        response\n    };\n    // See if we got an error message in the body\n    try {\n        const contentType = response.headers.get('Content-Type');\n        info.reason =\n            !response.bodyUsed && contentType?.includes('application/json')\n                ? await response.json()\n                : await response.text();\n    }\n    catch (error) {\n        // eslint forbids return in a finally statement, so we just catch here\n    }\n    return new FetchError(message, info);\n}\nasync function getInitialDataUrl(resource) {\n    const INITIAL_DATA_LENGTH = 5;\n    if (typeof resource === 'string') {\n        return `data:,${resource.slice(0, INITIAL_DATA_LENGTH)}`;\n    }\n    if (resource instanceof Blob) {\n        const blobSlice = resource.slice(0, 5);\n        return await new Promise((resolve) => {\n            const reader = new FileReader();\n            reader.onload = (event) => resolve(event?.target?.result);\n            reader.readAsDataURL(blobSlice);\n        });\n    }\n    if (resource instanceof ArrayBuffer) {\n        const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n        const base64 = arrayBufferToBase64(slice);\n        return `data:base64,${base64}`;\n    }\n    return null;\n}\n// https://stackoverflow.com/questions/9267899/arraybuffer-to-base64-encoded-string\nfunction arrayBufferToBase64(buffer) {\n    let binary = '';\n    const bytes = new Uint8Array(buffer);\n    for (let i = 0; i < bytes.byteLength; i++) {\n        binary += String.fromCharCode(bytes[i]);\n    }\n    return btoa(binary);\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { resolvePath } from '@loaders.gl/loader-utils';\nimport { makeResponse } from \"../utils/response-utils.js\";\n// import {FetchError} from './fetch-error';\nexport function isNodePath(url) {\n    return !isRequestURL(url) && !isDataURL(url);\n}\nexport function isRequestURL(url) {\n    return url.startsWith('http:') || url.startsWith('https:');\n}\nexport function isDataURL(url) {\n    return url.startsWith('data:');\n}\n/**\n * fetch API compatible function\n * - Supports fetching from Node.js local file system paths\n * - Respects pathPrefix and file aliases\n */\nexport async function fetchFile(urlOrData, fetchOptions) {\n    if (typeof urlOrData === 'string') {\n        const url = resolvePath(urlOrData);\n        // Support fetching from local file system\n        if (isNodePath(url)) {\n            if (globalThis.loaders?.fetchNode) {\n                return globalThis.loaders?.fetchNode(url, fetchOptions);\n            }\n            // throw new Error(\n            //   'fetchFile: globalThis.loaders.fetchNode not defined. Install @loaders.gl/polyfills'\n            // );\n        }\n        // Call global fetch\n        return await fetch(url, fetchOptions);\n    }\n    // TODO - should we still call fetch on non-URL inputs?\n    return await makeResponse(urlOrData);\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// probe.gl Log compatible loggers\nimport { Log } from '@probe.gl/log';\nexport const probeLog = new Log({ id: 'loaders.gl' });\n// Logs nothing\nexport class NullLog {\n    log() {\n        return () => { };\n    }\n    info() {\n        return () => { };\n    }\n    warn() {\n        return () => { };\n    }\n    error() {\n        return () => { };\n    }\n}\n// Logs to console\nexport class ConsoleLog {\n    console;\n    constructor() {\n        this.console = console; // eslint-disable-line\n    }\n    log(...args) {\n        return this.console.log.bind(this.console, ...args);\n    }\n    info(...args) {\n        return this.console.info.bind(this.console, ...args);\n    }\n    warn(...args) {\n        return this.console.warn.bind(this.console, ...args);\n    }\n    error(...args) {\n        return this.console.error.bind(this.console, ...args);\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isBrowser } from '@loaders.gl/loader-utils';\nimport { ConsoleLog } from \"./loggers.js\";\nexport const DEFAULT_LOADER_OPTIONS = {\n    // baseUri\n    fetch: null,\n    mimeType: undefined,\n    nothrow: false,\n    log: new ConsoleLog(), // A probe.gl compatible (`log.log()()` syntax) that just logs to console\n    useLocalLibraries: false,\n    CDN: 'https://unpkg.com/@loaders.gl',\n    worker: true, // By default, use worker if provided by loader.\n    maxConcurrency: 3, // How many worker instances should be created for each loader.\n    maxMobileConcurrency: 1, // How many worker instances should be created for each loader on mobile devices.\n    reuseWorkers: isBrowser, // By default reuse workers in browser (Node.js refuses to terminate if browsers are running)\n    _nodeWorkers: false, // By default do not support node workers\n    _workerType: '', // 'test' to use locally generated workers\n    limit: 0,\n    _limitMB: 0,\n    batchSize: 'auto',\n    batchDebounceMs: 0,\n    metadata: false, // TODO - currently only implemented for parseInBatches, adds initial metadata batch,\n    transforms: []\n};\nexport const REMOVED_LOADER_OPTIONS = {\n    throws: 'nothrow',\n    dataType: '(no longer used)',\n    uri: 'baseUri',\n    // Warn if fetch options are used on top-level\n    method: 'fetch.method',\n    headers: 'fetch.headers',\n    body: 'fetch.body',\n    mode: 'fetch.mode',\n    credentials: 'fetch.credentials',\n    cache: 'fetch.cache',\n    redirect: 'fetch.redirect',\n    referrer: 'fetch.referrer',\n    referrerPolicy: 'fetch.referrerPolicy',\n    integrity: 'fetch.integrity',\n    keepalive: 'fetch.keepalive',\n    signal: 'fetch.signal'\n};\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { registerJSModules } from '@loaders.gl/loader-utils';\nimport { isPureObject, isObject } from \"../../javascript-utils/is-type.js\";\nimport { probeLog, NullLog } from \"./loggers.js\";\nimport { DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS } from \"./option-defaults.js\";\n/**\n * Helper for safely accessing global loaders.gl variables\n * Wraps initialization of global variable in function to defeat overly aggressive tree-shakers\n */\nexport function getGlobalLoaderState() {\n    // @ts-ignore\n    globalThis.loaders = globalThis.loaders || {};\n    // @ts-ignore\n    const { loaders } = globalThis;\n    // Add _state object to keep separate from modules added to globalThis.loaders\n    if (!loaders._state) {\n        loaders._state = {};\n    }\n    return loaders._state;\n}\n/**\n * Store global loader options on the global object to increase chances of cross loaders-version interoperability\n * NOTE: This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\n * @returns global loader options merged with default loader options\n */\nexport function getGlobalLoaderOptions() {\n    const state = getGlobalLoaderState();\n    // Ensure all default loader options from this library are mentioned\n    state.globalOptions = state.globalOptions || { ...DEFAULT_LOADER_OPTIONS };\n    return state.globalOptions;\n}\n/**\n * Set global loader options\n * @param options\n */\nexport function setGlobalOptions(options) {\n    const state = getGlobalLoaderState();\n    const globalOptions = getGlobalLoaderOptions();\n    // @ts-expect-error First param looks incorrect\n    state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n    // Make sure any new modules are registered\n    registerJSModules(options.modules);\n}\n/**\n * Merges options with global opts and loader defaults, also injects baseUri\n * @param options\n * @param loader\n * @param loaders\n * @param url\n */\nexport function normalizeOptions(options, loader, loaders, url) {\n    loaders = loaders || [];\n    loaders = Array.isArray(loaders) ? loaders : [loaders];\n    validateOptions(options, loaders);\n    return normalizeOptionsInternal(loader, options, url);\n}\n// VALIDATE OPTIONS\n/**\n * Warn for unsupported options\n * @param options\n * @param loaders\n */\nfunction validateOptions(options, loaders) {\n    // Check top level options\n    validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n    for (const loader of loaders) {\n        // Get the scoped, loader specific options from the user supplied options\n        const idOptions = ((options && options[loader.id]) || {});\n        // Get scoped, loader specific default and deprecated options from the selected loader\n        const loaderOptions = (loader.options && loader.options[loader.id]) || {};\n        const deprecatedOptions = (loader.deprecatedOptions && loader.deprecatedOptions[loader.id]) || {};\n        // Validate loader specific options\n        // @ts-ignore\n        validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n    }\n}\n// eslint-disable-next-line max-params, complexity\nfunction validateOptionsObject(options, id, defaultOptions, deprecatedOptions, loaders) {\n    const loaderName = id || 'Top level';\n    const prefix = id ? `${id}.` : '';\n    for (const key in options) {\n        // If top level option value is an object it could options for a loader, so ignore\n        const isSubOptions = !id && isObject(options[key]);\n        const isBaseUriOption = key === 'baseUri' && !id;\n        const isWorkerUrlOption = key === 'workerUrl' && id;\n        // <loader>.workerUrl requires special handling as it is now auto-generated and no longer specified as a default option.\n        if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n            // Issue deprecation warnings\n            if (key in deprecatedOptions) {\n                probeLog.warn(`${loaderName} loader option \\'${prefix}${key}\\' no longer supported, use \\'${deprecatedOptions[key]}\\'`)();\n            }\n            else if (!isSubOptions) {\n                const suggestion = findSimilarOption(key, loaders);\n                probeLog.warn(`${loaderName} loader option \\'${prefix}${key}\\' not recognized. ${suggestion}`)();\n            }\n        }\n    }\n}\nfunction findSimilarOption(optionKey, loaders) {\n    const lowerCaseOptionKey = optionKey.toLowerCase();\n    let bestSuggestion = '';\n    for (const loader of loaders) {\n        for (const key in loader.options) {\n            if (optionKey === key) {\n                return `Did you mean \\'${loader.id}.${key}\\'?`;\n            }\n            const lowerCaseKey = key.toLowerCase();\n            const isPartialMatch = lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n            if (isPartialMatch) {\n                bestSuggestion = bestSuggestion || `Did you mean \\'${loader.id}.${key}\\'?`;\n            }\n        }\n    }\n    return bestSuggestion;\n}\nfunction normalizeOptionsInternal(loader, options, url) {\n    const loaderDefaultOptions = loader.options || {};\n    const mergedOptions = { ...loaderDefaultOptions };\n    addUrlOptions(mergedOptions, url);\n    // LOGGING: options.log can be set to `null` to defeat logging\n    if (mergedOptions.log === null) {\n        mergedOptions.log = new NullLog();\n    }\n    mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n    mergeNestedFields(mergedOptions, options);\n    return mergedOptions;\n}\n// Merge nested options objects\nfunction mergeNestedFields(mergedOptions, options) {\n    for (const key in options) {\n        // Check for nested options\n        // object in options => either no key in defaultOptions or object in defaultOptions\n        if (key in options) {\n            const value = options[key];\n            if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n                mergedOptions[key] = {\n                    ...mergedOptions[key],\n                    ...options[key]\n                };\n            }\n            else {\n                mergedOptions[key] = options[key];\n            }\n        }\n        // else: No need to merge nested opts, and the initial merge already copied over the nested options\n    }\n}\n/**\n * Harvest information from the url\n * @deprecated This is mainly there to support a hack in the GLTFLoader\n * TODO - baseUri should be a directory, i.e. remove file component from baseUri\n * TODO - extract extension?\n * TODO - extract query parameters?\n * TODO - should these be injected on context instead of options?\n */\nfunction addUrlOptions(options, url) {\n    if (url && !('baseUri' in options)) {\n        options.baseUri = url;\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from '@loaders.gl/loader-utils';\nexport function isLoaderObject(loader) {\n    if (!loader) {\n        return false;\n    }\n    if (Array.isArray(loader)) {\n        loader = loader[0];\n    }\n    const hasExtensions = Array.isArray(loader?.extensions);\n    /* Now handled by types and worker loaders do not have these\n    let hasParser =\n      loader.parseTextSync ||\n      loader.parseSync ||\n      loader.parse ||\n      loader.parseStream || // TODO Remove, Replace with parseInBatches\n      loader.parseInBatches;\n    */\n    return hasExtensions;\n}\nexport function normalizeLoader(loader) {\n    // This error is fairly easy to trigger by mixing up import statements etc\n    // So we make an exception and add a developer error message for this case\n    // To help new users from getting stuck here\n    assert(loader, 'null loader');\n    assert(isLoaderObject(loader), 'invalid loader');\n    // NORMALIZE [LOADER, OPTIONS] => LOADER\n    // If [loader, options], create a new loaders object with options merged in\n    let options;\n    if (Array.isArray(loader)) {\n        options = loader[1];\n        loader = loader[0];\n        loader = {\n            ...loader,\n            options: { ...loader.options, ...options }\n        };\n    }\n    // NORMALIZE text and binary flags\n    // Ensure at least one of text/binary flags are properly set\n    // @ts-expect-error\n    if (loader?.parseTextSync || loader?.parseText) {\n        loader.text = true;\n    }\n    if (!loader.text) {\n        loader.binary = true;\n    }\n    return loader;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { normalizeLoader } from \"../loader-utils/normalize-loader.js\";\nimport { getGlobalLoaderState } from \"../loader-utils/option-utils.js\";\n/**\n * Store global registered loaders on the global object to increase chances of cross loaders-version interoperability\n * This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\n */\nconst getGlobalLoaderRegistry = () => {\n    const state = getGlobalLoaderState();\n    state.loaderRegistry = state.loaderRegistry || [];\n    return state.loaderRegistry;\n};\n/**\n * Register a list of global loaders\n * @note Registration erases loader type information.\n * @deprecated It is recommended that applications manage loader registration. This function will likely be remove in loaders.gl v5\n */\nexport function registerLoaders(loaders) {\n    const loaderRegistry = getGlobalLoaderRegistry();\n    loaders = Array.isArray(loaders) ? loaders : [loaders];\n    for (const loader of loaders) {\n        const normalizedLoader = normalizeLoader(loader);\n        if (!loaderRegistry.find((registeredLoader) => normalizedLoader === registeredLoader)) {\n            // add to the beginning of the loaderRegistry, so the last registeredLoader get picked\n            loaderRegistry.unshift(normalizedLoader);\n        }\n    }\n}\n/**\n * @deprecated It is recommended that applications manage loader registration. This function will likely be remove in loaders.gl v5\n */\nexport function getRegisteredLoaders() {\n    return getGlobalLoaderRegistry();\n}\n/** @deprecated For testing only  */\nexport function _unregisterLoaders() {\n    const state = getGlobalLoaderState();\n    state.loaderRegistry = [];\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { compareArrayBuffers, path, log } from '@loaders.gl/loader-utils';\nimport { normalizeLoader } from \"../loader-utils/normalize-loader.js\";\nimport { getResourceUrl, getResourceMIMEType } from \"../utils/resource-utils.js\";\nimport { compareMIMETypes } from \"../utils/mime-type-utils.js\";\nimport { getRegisteredLoaders } from \"./register-loaders.js\";\nimport { isBlob } from \"../../javascript-utils/is-type.js\";\nimport { stripQueryString } from \"../utils/url-utils.js\";\nconst EXT_PATTERN = /\\.([^.]+)$/;\n// TODO - Need a variant that peeks at streams for parseInBatches\n// TODO - Detect multiple matching loaders? Use heuristics to grade matches?\n// TODO - Allow apps to pass context to disambiguate between multiple matches (e.g. multiple .json formats)?\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport async function selectLoader(data, loaders = [], options, context) {\n    if (!validHTTPResponse(data)) {\n        return null;\n    }\n    // First make a sync attempt, disabling exceptions\n    let loader = selectLoaderSync(data, loaders, { ...options, nothrow: true }, context);\n    if (loader) {\n        return loader;\n    }\n    // For Blobs and Files, try to asynchronously read a small initial slice and test again with that\n    // to see if we can detect by initial content\n    if (isBlob(data)) {\n        data = await data.slice(0, 10).arrayBuffer();\n        loader = selectLoaderSync(data, loaders, options, context);\n    }\n    // no loader available\n    if (!loader && !options?.nothrow) {\n        throw new Error(getNoValidLoaderMessage(data));\n    }\n    return loader;\n}\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport function selectLoaderSync(data, loaders = [], options, context) {\n    if (!validHTTPResponse(data)) {\n        return null;\n    }\n    // eslint-disable-next-line complexity\n    // if only a single loader was provided (not as array), force its use\n    // TODO - Should this behavior be kept and documented?\n    if (loaders && !Array.isArray(loaders)) {\n        // TODO - remove support for legacy loaders\n        return normalizeLoader(loaders);\n    }\n    // Build list of candidate loaders that will be searched in order for a match\n    let candidateLoaders = [];\n    // First search supplied loaders\n    if (loaders) {\n        candidateLoaders = candidateLoaders.concat(loaders);\n    }\n    // Then fall back to registered loaders\n    if (!options?.ignoreRegisteredLoaders) {\n        candidateLoaders.push(...getRegisteredLoaders());\n    }\n    // TODO - remove support for legacy loaders\n    normalizeLoaders(candidateLoaders);\n    const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n    // no loader available\n    if (!loader && !options?.nothrow) {\n        throw new Error(getNoValidLoaderMessage(data));\n    }\n    return loader;\n}\n/** Implements loaders selection logic */\n// eslint-disable-next-line complexity\nfunction selectLoaderInternal(data, loaders, options, context) {\n    const url = getResourceUrl(data);\n    const type = getResourceMIMEType(data);\n    const testUrl = stripQueryString(url) || context?.url;\n    let loader = null;\n    let reason = '';\n    // if options.mimeType is supplied, it takes precedence\n    if (options?.mimeType) {\n        loader = findLoaderByMIMEType(loaders, options?.mimeType);\n        reason = `match forced by supplied MIME type ${options?.mimeType}`;\n    }\n    // Look up loader by url\n    loader = loader || findLoaderByUrl(loaders, testUrl);\n    reason = reason || (loader ? `matched url ${testUrl}` : '');\n    // Look up loader by mime type\n    loader = loader || findLoaderByMIMEType(loaders, type);\n    reason = reason || (loader ? `matched MIME type ${type}` : '');\n    // Look for loader via initial bytes (Note: not always accessible (e.g. Response, stream, async iterator)\n    // @ts-ignore Blob | Response\n    loader = loader || findLoaderByInitialBytes(loaders, data);\n    // @ts-ignore Blob | Response\n    reason = reason || (loader ? `matched initial data ${getFirstCharacters(data)}` : '');\n    // Look up loader by fallback mime type\n    if (options?.fallbackMimeType) {\n        loader = loader || findLoaderByMIMEType(loaders, options?.fallbackMimeType);\n        reason = reason || (loader ? `matched fallback MIME type ${type}` : '');\n    }\n    if (reason) {\n        log.log(1, `selectLoader selected ${loader?.name}: ${reason}.`);\n    }\n    return loader;\n}\n/** Check HTTP Response */\nfunction validHTTPResponse(data) {\n    // HANDLE HTTP status\n    if (data instanceof Response) {\n        // 204 - NO CONTENT. This handles cases where e.g. a tile server responds with 204 for a missing tile\n        if (data.status === 204) {\n            return false;\n        }\n    }\n    return true;\n}\n/** Generate a helpful message to help explain why loader selection failed. */\nfunction getNoValidLoaderMessage(data) {\n    const url = getResourceUrl(data);\n    const type = getResourceMIMEType(data);\n    let message = 'No valid loader found (';\n    message += url ? `${path.filename(url)}, ` : 'no url provided, ';\n    message += `MIME type: ${type ? `\"${type}\"` : 'not provided'}, `;\n    // First characters are only accessible when called on data (string or arrayBuffer).\n    // @ts-ignore Blob | Response\n    const firstCharacters = data ? getFirstCharacters(data) : '';\n    message += firstCharacters ? ` first bytes: \"${firstCharacters}\"` : 'first bytes: not available';\n    message += ')';\n    return message;\n}\nfunction normalizeLoaders(loaders) {\n    for (const loader of loaders) {\n        normalizeLoader(loader);\n    }\n}\n// TODO - Would be nice to support http://example.com/file.glb?parameter=1\n// E.g: x = new URL('http://example.com/file.glb?load=1'; x.pathname\nfunction findLoaderByUrl(loaders, url) {\n    // Get extension\n    const match = url && EXT_PATTERN.exec(url);\n    const extension = match && match[1];\n    return extension ? findLoaderByExtension(loaders, extension) : null;\n}\nfunction findLoaderByExtension(loaders, extension) {\n    extension = extension.toLowerCase();\n    for (const loader of loaders) {\n        for (const loaderExtension of loader.extensions) {\n            if (loaderExtension.toLowerCase() === extension) {\n                return loader;\n            }\n        }\n    }\n    return null;\n}\nfunction findLoaderByMIMEType(loaders, mimeType) {\n    for (const loader of loaders) {\n        if (loader.mimeTypes?.some((mimeType1) => compareMIMETypes(mimeType, mimeType1))) {\n            return loader;\n        }\n        // Support referring to loaders using the \"unregistered tree\"\n        // https://en.wikipedia.org/wiki/Media_type#Unregistered_tree\n        if (compareMIMETypes(mimeType, `application/x.${loader.id}`)) {\n            return loader;\n        }\n    }\n    return null;\n}\nfunction findLoaderByInitialBytes(loaders, data) {\n    if (!data) {\n        return null;\n    }\n    for (const loader of loaders) {\n        if (typeof data === 'string') {\n            if (testDataAgainstText(data, loader)) {\n                return loader;\n            }\n        }\n        else if (ArrayBuffer.isView(data)) {\n            // Typed Arrays can have offsets into underlying buffer\n            if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n                return loader;\n            }\n        }\n        else if (data instanceof ArrayBuffer) {\n            const byteOffset = 0;\n            if (testDataAgainstBinary(data, byteOffset, loader)) {\n                return loader;\n            }\n        }\n        // TODO Handle streaming case (requires creating a new AsyncIterator)\n    }\n    return null;\n}\nfunction testDataAgainstText(data, loader) {\n    if (loader.testText) {\n        return loader.testText(data);\n    }\n    const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n    return tests.some((test) => data.startsWith(test));\n}\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n    const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n    return tests.some((test) => testBinary(data, byteOffset, loader, test));\n}\nfunction testBinary(data, byteOffset, loader, test) {\n    if (test instanceof ArrayBuffer) {\n        return compareArrayBuffers(test, data, test.byteLength);\n    }\n    switch (typeof test) {\n        case 'function':\n            return test(data);\n        case 'string':\n            // Magic bytes check: If `test` is a string, check if binary data starts with that strings\n            const magic = getMagicString(data, byteOffset, test.length);\n            return test === magic;\n        default:\n            return false;\n    }\n}\nfunction getFirstCharacters(data, length = 5) {\n    if (typeof data === 'string') {\n        return data.slice(0, length);\n    }\n    else if (ArrayBuffer.isView(data)) {\n        // Typed Arrays can have offsets into underlying buffer\n        return getMagicString(data.buffer, data.byteOffset, length);\n    }\n    else if (data instanceof ArrayBuffer) {\n        const byteOffset = 0;\n        return getMagicString(data, byteOffset, length);\n    }\n    return '';\n}\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n    if (arrayBuffer.byteLength < byteOffset + length) {\n        return '';\n    }\n    const dataView = new DataView(arrayBuffer);\n    let magic = '';\n    for (let i = 0; i < length; i++) {\n        magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n    }\n    return magic;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n/**\n * Returns an iterator that breaks a big string into chunks and yields them one-by-one as ArrayBuffers\n * @param blob string to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeStringIterator(string, options) {\n    const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n    let offset = 0;\n    const textEncoder = new TextEncoder();\n    while (offset < string.length) {\n        // Create a chunk of the right size\n        const chunkLength = Math.min(string.length - offset, chunkSize);\n        const chunk = string.slice(offset, offset + chunkLength);\n        offset += chunkLength;\n        // yield an ArrayBuffer chunk\n        yield textEncoder.encode(chunk);\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n/**\n * Returns an iterator that breaks a big ArrayBuffer into chunks and yields them one-by-one\n * @param blob ArrayBuffer to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeArrayBufferIterator(arrayBuffer, options = {}) {\n    const { chunkSize = DEFAULT_CHUNK_SIZE } = options;\n    let byteOffset = 0;\n    while (byteOffset < arrayBuffer.byteLength) {\n        // Create a chunk of the right size\n        const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n        const chunk = new ArrayBuffer(chunkByteLength);\n        // Copy data from the big chunk\n        const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n        const chunkArray = new Uint8Array(chunk);\n        chunkArray.set(sourceArray);\n        // yield the chunk\n        byteOffset += chunkByteLength;\n        yield chunk;\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst DEFAULT_CHUNK_SIZE = 1024 * 1024; // 1MB \u2014 biggest value that keeps UI responsive\n/**\n * Returns an iterator that breaks a big Blob into chunks and yields them one-by-one\n * @param blob Blob or File object\n * @param options\n * @param options.chunkSize\n */\nexport async function* makeBlobIterator(blob, options) {\n    const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n    let offset = 0;\n    while (offset < blob.size) {\n        const end = offset + chunkSize;\n        const chunk = await blob.slice(offset, end).arrayBuffer();\n        offset = end;\n        yield chunk;\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isBrowser, toArrayBuffer } from '@loaders.gl/loader-utils';\n/**\n * Returns an async iterable that reads from a stream (works in both Node.js and browsers)\n * @param stream stream to iterator over\n */\nexport function makeStreamIterator(stream, options) {\n    return isBrowser\n        ? makeBrowserStreamIterator(stream, options)\n        : makeNodeStreamIterator(stream, options);\n}\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @see https://jakearchibald.com/2017/async-iterators-and-generators/#making-streams-iterate\n */\nasync function* makeBrowserStreamIterator(stream, options) {\n    // WhatWG: stream is supposed to have a `getIterator` method\n    // if (typeof stream.getIterator === 'function') {\n    //   return stream.getIterator();\n    // }\n    // if (typeof stream[Symbol.asyncIterator] === 'function') {\n    //   return makeToArrayBufferIterator(stream);\n    // }\n    // In the browser, we first need to get a lock on the stream\n    const reader = stream.getReader();\n    let nextBatchPromise;\n    try {\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n            const currentBatchPromise = nextBatchPromise || reader.read();\n            // Issue a read for an additional batch, while we await the next batch\n            // Idea is to make fetching happen in parallel with processing / parsing\n            if (options?._streamReadAhead) {\n                nextBatchPromise = reader.read();\n            }\n            // Read from the stream\n            // value is a Uint8Array\n            const { done, value } = await currentBatchPromise;\n            // Exit if we're done\n            if (done) {\n                return;\n            }\n            // Else yield the chunk\n            yield toArrayBuffer(value);\n        }\n    }\n    catch (error) {\n        // TODO - examples makes it look like this should always be called,\n        // but that generates exceptions so only call it if we do not reach the end\n        reader.releaseLock();\n    }\n}\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @note Requires Node.js >= 10\n */\nasync function* makeNodeStreamIterator(stream, options) {\n    // Hacky test for node version to ensure we don't call bad polyfills\n    // NODE 10+: stream is an asyncIterator\n    for await (const chunk of stream) {\n        yield toArrayBuffer(chunk); // Coerce each chunk to ArrayBuffer\n    }\n}\n/* TODO - remove NODE < 10\n * @see https://github.com/bustle/streaming-iterables, MIT license\n *\n  if (typeof stream[Symbol.asyncIterator] === 'function') {\n    return;\n  }\n\n  // TODO - check if is this ever used in Node 10+?\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const data = stream.read();\n    if (data !== null) {\n      yield toArrayBuffer(data);\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    if (stream._readableState?.ended) {\n      return;\n    }\n    await onceReadable(stream);\n  }\n\nasync function onceReadable(stream: Readable): Promise<any> {\n  return new Promise((resolve) => {\n    stream.once('readable', resolve);\n  });\n}\n  */\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { makeStringIterator } from \"./make-string-iterator.js\";\nimport { makeArrayBufferIterator } from \"./make-array-buffer-iterator.js\";\nimport { makeBlobIterator } from \"./make-blob-iterator.js\";\nimport { makeStreamIterator } from \"./make-stream-iterator.js\";\nimport { isBlob, isReadableStream, isResponse } from \"../../javascript-utils/is-type.js\";\n/**\n * Returns an iterator that breaks its input into chunks and yields them one-by-one.\n * @param data\n * @param options\n * @returns\n * This function can e.g. be used to enable data sources that can only be read atomically\n * (such as `Blob` and `File` via `FileReader`) to still be parsed in batches.\n */\nexport function makeIterator(data, options) {\n    if (typeof data === 'string') {\n        // Note: Converts string chunks to binary\n        return makeStringIterator(data, options);\n    }\n    if (data instanceof ArrayBuffer) {\n        return makeArrayBufferIterator(data, options);\n    }\n    if (isBlob(data)) {\n        return makeBlobIterator(data, options);\n    }\n    if (isReadableStream(data)) {\n        return makeStreamIterator(data, options);\n    }\n    if (isResponse(data)) {\n        const response = data;\n        return makeStreamIterator(response.body, options);\n    }\n    throw new Error('makeIterator');\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { concatenateArrayBuffersAsync } from '@loaders.gl/loader-utils';\nimport { isResponse, isReadableStream, isAsyncIterable, isIterable, isIterator, isBlob, isBuffer } from \"../../javascript-utils/is-type.js\";\nimport { makeIterator } from \"../../iterators/make-iterator/make-iterator.js\";\nimport { checkResponse, makeResponse } from \"../utils/response-utils.js\";\nconst ERR_DATA = 'Cannot convert supplied data type';\n// eslint-disable-next-line complexity\nexport function getArrayBufferOrStringFromDataSync(data, loader, options) {\n    if (loader.text && typeof data === 'string') {\n        return data;\n    }\n    if (isBuffer(data)) {\n        // @ts-ignore\n        data = data.buffer;\n    }\n    if (data instanceof ArrayBuffer) {\n        const arrayBuffer = data;\n        if (loader.text && !loader.binary) {\n            const textDecoder = new TextDecoder('utf8');\n            return textDecoder.decode(arrayBuffer);\n        }\n        return arrayBuffer;\n    }\n    // We may need to handle offsets\n    if (ArrayBuffer.isView(data)) {\n        // TextDecoder is invoked on typed arrays and will handle offsets\n        if (loader.text && !loader.binary) {\n            const textDecoder = new TextDecoder('utf8');\n            return textDecoder.decode(data);\n        }\n        let arrayBuffer = data.buffer;\n        // Since we are returning the underlying arrayBuffer, we must create a new copy\n        // if this typed array / Buffer is a partial view into the ArryayBuffer\n        // TODO - this is a potentially unnecessary copy\n        const byteLength = data.byteLength || data.length;\n        if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n            // console.warn(`loaders.gl copying arraybuffer of length ${byteLength}`);\n            arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n        }\n        return arrayBuffer;\n    }\n    throw new Error(ERR_DATA);\n}\n// Convert async iterator to a promise\nexport async function getArrayBufferOrStringFromData(data, loader, options) {\n    const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n    if (typeof data === 'string' || isArrayBuffer) {\n        return getArrayBufferOrStringFromDataSync(data, loader, options);\n    }\n    // Blobs and files are FileReader compatible\n    if (isBlob(data)) {\n        data = await makeResponse(data);\n    }\n    if (isResponse(data)) {\n        const response = data;\n        await checkResponse(response);\n        return loader.binary ? await response.arrayBuffer() : await response.text();\n    }\n    if (isReadableStream(data)) {\n        // @ts-expect-error TS2559 options type\n        data = makeIterator(data, options);\n    }\n    if (isIterable(data) || isAsyncIterable(data)) {\n        // Assume arrayBuffer iterator - attempt to concatenate\n        return concatenateArrayBuffersAsync(data);\n    }\n    throw new Error(ERR_DATA);\n}\nexport async function getAsyncIterableFromData(data, options) {\n    if (isIterator(data)) {\n        return data;\n    }\n    if (isResponse(data)) {\n        const response = data;\n        // Note Since this function is not async, we currently can't load error message, just status\n        await checkResponse(response);\n        // TODO - bug in polyfill, body can be a Promise under Node.js\n        // eslint-disable-next-line @typescript-eslint/await-thenable\n        const body = await response.body;\n        // TODO - body can be null?\n        return makeIterator(body, options);\n    }\n    if (isBlob(data) || isReadableStream(data)) {\n        return makeIterator(data, options);\n    }\n    if (isAsyncIterable(data)) {\n        return data;\n    }\n    return getIterableFromData(data);\n}\nexport async function getReadableStream(data) {\n    if (isReadableStream(data)) {\n        return data;\n    }\n    if (isResponse(data)) {\n        // @ts-ignore\n        return data.body;\n    }\n    const response = await makeResponse(data);\n    // @ts-ignore\n    return response.body;\n}\n// HELPERS\nfunction getIterableFromData(data) {\n    // generate an iterator that emits a single chunk\n    if (ArrayBuffer.isView(data)) {\n        return (function* oneChunk() {\n            yield data.buffer;\n        })();\n    }\n    if (data instanceof ArrayBuffer) {\n        return (function* oneChunk() {\n            yield data;\n        })();\n    }\n    if (isIterator(data)) {\n        return data;\n    }\n    if (isIterable(data)) {\n        return data[Symbol.iterator]();\n    }\n    throw new Error(ERR_DATA);\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isObject } from \"../../javascript-utils/is-type.js\";\nimport { fetchFile } from \"../fetch/fetch-file.js\";\nimport { getGlobalLoaderOptions } from \"./option-utils.js\";\n/**\n * Gets the current fetch function from options and context\n * @param options\n * @param context\n */\nexport function getFetchFunction(options, context) {\n    const globalOptions = getGlobalLoaderOptions();\n    const loaderOptions = options || globalOptions;\n    // options.fetch can be a function\n    if (typeof loaderOptions.fetch === 'function') {\n        return loaderOptions.fetch;\n    }\n    // options.fetch can be an options object\n    if (isObject(loaderOptions.fetch)) {\n        return (url) => fetchFile(url, loaderOptions.fetch);\n    }\n    // else refer to context (from parent loader) if available\n    if (context?.fetch) {\n        return context?.fetch;\n    }\n    // else return the default fetch function\n    return fetchFile;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { getFetchFunction } from \"./get-fetch-function.js\";\nimport { extractQueryString, stripQueryString } from \"../utils/url-utils.js\";\nimport { path } from '@loaders.gl/loader-utils';\n/**\n * \"sub\" loaders invoked by other loaders get a \"context\" injected on `this`\n * The context will inject core methods like `parse` and contain information\n * about loaders and options passed in to the top-level `parse` call.\n *\n * @param context\n * @param options\n * @param previousContext\n */\nexport function getLoaderContext(context, options, parentContext) {\n    // For recursive calls, we already have a context\n    // TODO - add any additional loaders to context?\n    if (parentContext) {\n        return parentContext;\n    }\n    const newContext = {\n        fetch: getFetchFunction(options, context),\n        ...context\n    };\n    // Parse URLs so that subloaders can easily generate correct strings\n    if (newContext.url) {\n        const baseUrl = stripQueryString(newContext.url);\n        newContext.baseUrl = baseUrl;\n        newContext.queryString = extractQueryString(newContext.url);\n        newContext.filename = path.filename(baseUrl);\n        newContext.baseUrl = path.dirname(baseUrl);\n    }\n    // Recursive loading does not use single loader\n    if (!Array.isArray(newContext.loaders)) {\n        newContext.loaders = null;\n    }\n    return newContext;\n}\n// eslint-disable-next-line complexity\nexport function getLoadersFromContext(loaders, context) {\n    // A single loader (non-array) indicates no selection desired. Force select.\n    if (loaders && !Array.isArray(loaders)) {\n        return loaders;\n    }\n    // Create a merged list\n    let candidateLoaders;\n    if (loaders) {\n        candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n    }\n    if (context && context.loaders) {\n        const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n        candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n    }\n    // If no loaders, return null to look in globally registered loaders\n    return candidateLoaders && candidateLoaders.length ? candidateLoaders : undefined;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { parseWithWorker, canParseWithWorker, mergeLoaderOptions } from '@loaders.gl/loader-utils';\nimport { assert, validateWorkerVersion } from '@loaders.gl/worker-utils';\nimport { isLoaderObject } from \"../loader-utils/normalize-loader.js\";\nimport { isResponse } from \"../../javascript-utils/is-type.js\";\nimport { normalizeOptions } from \"../loader-utils/option-utils.js\";\nimport { getArrayBufferOrStringFromData } from \"../loader-utils/get-data.js\";\nimport { getLoaderContext, getLoadersFromContext } from \"../loader-utils/loader-context.js\";\nimport { getResourceUrl } from \"../utils/resource-utils.js\";\nimport { selectLoader } from \"./select-loader.js\";\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\n// implementation signature\nexport async function parse(data, loaders, options, context) {\n    // Signature: parse(data, options, context | url)\n    // Uses registered loaders\n    if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n        context = undefined; // context not supported in short signature\n        options = loaders;\n        loaders = undefined;\n    }\n    data = await data; // Resolve any promise\n    options = options || {}; // Could be invalid...\n    // Extract a url for auto detection\n    const url = getResourceUrl(data);\n    // Chooses a loader (and normalizes it)\n    // Also use any loaders in the context, new loaders take priority\n    const typedLoaders = loaders;\n    const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n    // todo hacky type cast\n    const loader = await selectLoader(data, candidateLoaders, options);\n    // Note: if no loader was found, if so just return null\n    if (!loader) {\n        return null;\n    }\n    // Normalize options\n    // @ts-expect-error\n    options = normalizeOptions(options, loader, candidateLoaders, url); // Could be invalid...\n    // Get a context (if already present, will be unchanged)\n    context = getLoaderContext(\n    // @ts-expect-error\n    { url, _parse: parse, loaders: candidateLoaders }, options, context || null);\n    return await parseWithLoader(loader, data, options, context);\n}\n// TODO: support progress and abort\n// TODO - should accept loader.parseAsyncIterator and concatenate.\nasync function parseWithLoader(loader, data, options, context) {\n    validateWorkerVersion(loader);\n    options = mergeLoaderOptions(loader.options, options);\n    if (isResponse(data)) {\n        // Serialize to support passing the response to web worker\n        const response = data;\n        const { ok, redirected, status, statusText, type, url } = response;\n        const headers = Object.fromEntries(response.headers.entries());\n        // @ts-expect-error TODO - fix this\n        context.response = { headers, ok, redirected, status, statusText, type, url };\n    }\n    data = await getArrayBufferOrStringFromData(data, loader, options);\n    const loaderWithParser = loader;\n    // First check for synchronous text parser, wrap results in promises\n    if (loaderWithParser.parseTextSync && typeof data === 'string') {\n        return loaderWithParser.parseTextSync(data, options, context);\n    }\n    // If we have a workerUrl and the loader can parse the given options efficiently in a worker\n    if (canParseWithWorker(loader, options)) {\n        return await parseWithWorker(loader, data, options, context, parse);\n    }\n    // Check for asynchronous parser\n    if (loaderWithParser.parseText && typeof data === 'string') {\n        return await loaderWithParser.parseText(data, options, context);\n    }\n    if (loaderWithParser.parse) {\n        return await loaderWithParser.parse(data, options, context);\n    }\n    // This should not happen, all sync loaders should also offer `parse` function\n    assert(!loaderWithParser.parseSync);\n    // TBD - If asynchronous parser not available, return null\n    throw new Error(`${loader.id} loader - no parser found and worker is disabled`);\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/** Deduce column types from values */\nexport function getDataTypeFromValue(value, defaultNumberType = 'float32') {\n    if (value instanceof Date) {\n        return 'date-millisecond';\n    }\n    if (value instanceof Number) {\n        return defaultNumberType;\n    }\n    if (typeof value === 'string') {\n        return 'utf8';\n    }\n    if (value === null || value === 'undefined') {\n        return 'null';\n    }\n    return 'null';\n}\n/**\n * Deduces a simple data type \"descriptor from a typed array instance\n */\nexport function getDataTypeFromArray(array) {\n    let type = getDataTypeFromTypedArray(array);\n    if (type !== 'null') {\n        return { type, nullable: false };\n    }\n    if (array.length > 0) {\n        type = getDataTypeFromValue(array[0]);\n        return { type, nullable: true };\n    }\n    return { type: 'null', nullable: true };\n}\n/**\n * Deduces a simple data type \"descriptor from a typed array instance\n */\nexport function getDataTypeFromTypedArray(array) {\n    switch (array.constructor) {\n        case Int8Array:\n            return 'int8';\n        case Uint8Array:\n        case Uint8ClampedArray:\n            return 'uint8';\n        case Int16Array:\n            return 'int16';\n        case Uint16Array:\n            return 'uint16';\n        case Int32Array:\n            return 'int32';\n        case Uint32Array:\n            return 'uint32';\n        case Float32Array:\n            return 'float32';\n        case Float64Array:\n            return 'float64';\n        default:\n            return 'null';\n    }\n}\nexport function getArrayTypeFromDataType(type, nullable) {\n    if (!nullable) {\n        switch (type) {\n            case 'int8':\n                return Int8Array;\n            case 'uint8':\n                return Uint8Array;\n            case 'int16':\n                return Int16Array;\n            case 'uint16':\n                return Uint16Array;\n            case 'int32':\n                return Int32Array;\n            case 'uint32':\n                return Uint32Array;\n            case 'float32':\n                return Float32Array;\n            case 'float64':\n                return Float64Array;\n            default:\n                break;\n        }\n    }\n    // if (typeof BigInt64Array !== 'undefined') {\n    //   TYPED_ARRAY_TO_TYPE.BigInt64Array = new Int64();\n    //   TYPED_ARRAY_TO_TYPE.BigUint64Array = new Uint64();\n    // }\n    return Array;\n}\n", "/**\n * Get number of vertices in mesh\n * @param attributes\n */\nexport function getMeshSize(attributes) {\n    let size = 0;\n    for (const attributeName in attributes) {\n        const attribute = attributes[attributeName];\n        if (ArrayBuffer.isView(attribute)) {\n            // @ts-ignore DataView doesn't have BYTES_PER_ELEMENT\n            size += attribute.byteLength * attribute.BYTES_PER_ELEMENT;\n        }\n    }\n    return size;\n}\n/**\n * Get the (axis aligned) bounding box of a mesh\n * @param attributes\n * @returns array of two vectors representing the axis aligned bounding box\n */\n// eslint-disable-next-line complexity\nexport function getMeshBoundingBox(attributes) {\n    let minX = Infinity;\n    let minY = Infinity;\n    let minZ = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n    let maxZ = -Infinity;\n    const positions = attributes.POSITION ? attributes.POSITION.value : [];\n    const len = positions && positions.length;\n    for (let i = 0; i < len; i += 3) {\n        const x = positions[i];\n        const y = positions[i + 1];\n        const z = positions[i + 2];\n        minX = x < minX ? x : minX;\n        minY = y < minY ? y : minY;\n        minZ = z < minZ ? z : minZ;\n        maxX = x > maxX ? x : maxX;\n        maxY = y > maxY ? y : maxY;\n        maxZ = z > maxZ ? z : maxZ;\n    }\n    return [\n        [minX, minY, minZ],\n        [maxX, maxY, maxZ]\n    ];\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { getDataTypeFromTypedArray } from \"../table/simple-table/data-type.js\";\n/**\n * Create a schema for mesh attributes data\n * @param attributes\n * @param metadata\n * @returns\n */\nexport function deduceMeshSchema(attributes, metadata = {}) {\n    const fields = deduceMeshFields(attributes);\n    return { fields, metadata };\n}\n/**\n * Create arrow-like schema field for mesh attribute\n * @param attributeName\n * @param attribute\n * @param optionalMetadata\n * @returns\n */\nexport function deduceMeshField(name, attribute, optionalMetadata) {\n    const type = getDataTypeFromTypedArray(attribute.value);\n    const metadata = optionalMetadata ? optionalMetadata : makeMeshAttributeMetadata(attribute);\n    return {\n        name,\n        type: { type: 'fixed-size-list', listSize: attribute.size, children: [{ name: 'value', type }] },\n        nullable: false,\n        metadata\n    };\n}\n/**\n * Create fields array for mesh attributes\n * @param attributes\n * @returns\n */\nfunction deduceMeshFields(attributes) {\n    const fields = [];\n    for (const attributeName in attributes) {\n        const attribute = attributes[attributeName];\n        fields.push(deduceMeshField(attributeName, attribute));\n    }\n    return fields;\n}\n/**\n * Make metadata by mesh attribute properties\n * @param attribute\n * @returns\n */\nexport function makeMeshAttributeMetadata(attribute) {\n    const result = {};\n    if ('byteOffset' in attribute) {\n        result.byteOffset = attribute.byteOffset.toString(10);\n    }\n    if ('byteStride' in attribute) {\n        result.byteStride = attribute.byteStride.toString(10);\n    }\n    if ('normalized' in attribute) {\n        result.normalized = attribute.normalized.toString();\n    }\n    return result;\n}\n", "import { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nimport { getPrimitiveTextureData } from \"./utils/3d-tiles-utils.js\";\nimport { getComponentTypeFromArray } from \"../gltf-utils/gltf-utils.js\";\nconst EXT_MESH_FEATURES_NAME = 'EXT_mesh_features';\nexport const name = EXT_MESH_FEATURES_NAME;\nexport async function decode(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    decodeExtMeshFeatures(scenegraph, options);\n}\nexport function encode(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    encodeExtMeshFeatures(scenegraph, options);\n    scenegraph.createBinaryChunk();\n    return scenegraph.gltf;\n}\n/**\n * Decodes feature metadata from extension.\n * @param {GLTFScenegraph} scenegraph - Instance of the class for structured access to GLTF data.\n * @param {GLTFLoaderOptions} options - GLTFLoader options.\n */\nfunction decodeExtMeshFeatures(scenegraph, options) {\n    const json = scenegraph.gltf.json;\n    if (!json.meshes) {\n        return;\n    }\n    // Iterate through all meshes/primitives.\n    for (const mesh of json.meshes) {\n        for (const primitive of mesh.primitives) {\n            processMeshPrimitiveFeatures(scenegraph, primitive, options);\n        }\n    }\n}\n/**\n * Takes data from EXT_mesh_features and store it in 'data' property of featureIds.\n * If combined with EXT_structural_metadata, corresponding data are taken from the property tables of that extension.\n * @param {GLTFScenegraph} scenegraph - Instance of the class for structured access to GLTF data.\n * @param {GLTFMeshPrimitive} primitive - Primitive that contains extensions.\n * @param {GLTFLoaderOptions} options - GLTFLoader options.\n */\nfunction processMeshPrimitiveFeatures(scenegraph, primitive, options) {\n    // Processing of mesh primitive features requires buffers to be loaded.\n    if (!options?.gltf?.loadBuffers) {\n        return;\n    }\n    const extension = primitive.extensions?.[EXT_MESH_FEATURES_NAME];\n    const featureIds = extension?.featureIds;\n    if (!featureIds) {\n        return;\n    }\n    for (const featureId of featureIds) {\n        let featureIdData;\n        // Process \"Feature ID by Vertex\"\n        if (typeof featureId.attribute !== 'undefined') {\n            const accessorKey = `_FEATURE_ID_${featureId.attribute}`;\n            const accessorIndex = primitive.attributes[accessorKey];\n            featureIdData = scenegraph.getTypedArrayForAccessor(accessorIndex);\n        }\n        // Process \"Feature ID by Texture Coordinates\"\n        else if (typeof featureId.texture !== 'undefined' && options?.gltf?.loadImages) {\n            featureIdData = getPrimitiveTextureData(scenegraph, featureId.texture, primitive);\n        }\n        // Process \"Feature ID by Index\"\n        else {\n            /*\n            When both featureId.attribute and featureId.texture are undefined,\n            then the feature ID value for each vertex is given implicitly, via the index of the vertex.\n            In this case, the featureCount must match the number of vertices of the mesh primitive.\n            */\n            // TODO: At the moment of writing we don't have a tileset with the data of that kind. Implement it later.\n            featureIdData = [];\n        }\n        featureId.data = featureIdData;\n    }\n}\n/*\n  Encoding data\n*/\nfunction encodeExtMeshFeatures(scenegraph, options) {\n    const meshes = scenegraph.gltf.json.meshes;\n    if (!meshes) {\n        return;\n    }\n    // Iterate through all meshes/primitives.\n    for (const mesh of meshes) {\n        for (const primitive of mesh.primitives) {\n            encodeExtMeshFeaturesForPrimitive(scenegraph, primitive);\n        }\n    }\n}\n/**\n * Creates ExtMeshFeatures, creates a featureId containing feature ids provided.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param primitive - target primitive instance that will contain the extension\n * @param featureIdArray - Array of feature id\n * @param propertyTableIndex - index of the property table created by the ExtStructuralMetadata (optional).\n */\nexport function createExtMeshFeatures(scenegraph, primitive, featureIdArray, propertyTableIndex) {\n    if (!primitive.extensions) {\n        primitive.extensions = {};\n    }\n    let extension = primitive.extensions[EXT_MESH_FEATURES_NAME];\n    if (!extension) {\n        extension = { featureIds: [] };\n        primitive.extensions[EXT_MESH_FEATURES_NAME] = extension;\n    }\n    const { featureIds } = extension;\n    const featureId = {\n        featureCount: featureIdArray.length,\n        propertyTable: propertyTableIndex,\n        data: featureIdArray\n    };\n    featureIds.push(featureId);\n    scenegraph.addObjectExtension(primitive, EXT_MESH_FEATURES_NAME, extension);\n}\n/**\n * Encodes a feature ID set to extension.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param primitive - Primitive that the data encoded belongs to.\n * @see https://github.com/CesiumGS/glTF/tree/3d-tiles-next/extensions/2.0/Vendor/EXT_mesh_features\n */\nfunction encodeExtMeshFeaturesForPrimitive(scenegraph, primitive) {\n    const extension = primitive.extensions?.[EXT_MESH_FEATURES_NAME];\n    if (!extension) {\n        return;\n    }\n    const featureIds = extension.featureIds;\n    featureIds.forEach((featureId, elementIndex) => {\n        if (featureId.data) {\n            const { accessorKey, index } = createAccessorKey(primitive.attributes);\n            const typedArray = new Uint32Array(featureId.data);\n            // Clean up featureId object.\n            // Everything that could come from the original extension in case of round-trip decode/encode operations should be deleted.\n            // We need make sure the featureId object is clean.\n            featureIds[elementIndex] = {\n                featureCount: typedArray.length,\n                propertyTable: featureId.propertyTable,\n                attribute: index\n            };\n            scenegraph.gltf.buffers.push({\n                arrayBuffer: typedArray.buffer,\n                byteOffset: typedArray.byteOffset,\n                byteLength: typedArray.byteLength\n            });\n            const bufferViewIndex = scenegraph.addBufferView(typedArray);\n            const accessorIndex = scenegraph.addAccessor(bufferViewIndex, {\n                size: 1,\n                componentType: getComponentTypeFromArray(typedArray),\n                count: typedArray.length\n            });\n            primitive.attributes[accessorKey] = accessorIndex;\n        }\n    });\n}\n/**\n * Creates an accessor key for the attribute array provided.\n * The generated key has a suffix (number) that is the next consequtive in the list of existing accessors.\n * @param attributes - attribute array\n * @returns accessor key and the key suffix (number) used in the key.\n */\nfunction createAccessorKey(attributes) {\n    const prefix = '_FEATURE_ID_';\n    // Search for all \"_FEATURE_ID_n\" attribures in the primitive provided if any.\n    // If there are some, e.g. \"_FEATURE_ID_0\", \"_FEATURE_ID_1\",\n    // we will add a new one with the name \"_FEATURE_ID_2\"\n    const attrs = Object.keys(attributes).filter((item) => item.indexOf(prefix) === 0);\n    let max = -1;\n    for (const a of attrs) {\n        const n = Number(a.substring(prefix.length));\n        if (n > max) {\n            max = n;\n        }\n    }\n    max++;\n    const accessorKey = `${prefix}${max}`;\n    return { accessorKey, index: max };\n}\n", "// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nexport const VERSION = typeof \"4.3.3\" !== 'undefined' ? \"4.3.3\" : 'latest';\n", "import { isBrowser } from '@loaders.gl/loader-utils';\n// @ts-ignore TS2339: Property does not exist on type\nconst parseImageNode = globalThis.loaders?.parseImageNode;\nconst IMAGE_SUPPORTED = typeof Image !== 'undefined'; // NOTE: \"false\" positives if jsdom is installed\nconst IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nconst NODE_IMAGE_SUPPORTED = Boolean(parseImageNode);\nconst DATA_SUPPORTED = isBrowser ? true : NODE_IMAGE_SUPPORTED;\n/**\n * Checks if a loaders.gl image type is supported\n * @param type image type string\n */\nexport function isImageTypeSupported(type) {\n    switch (type) {\n        case 'auto':\n            // Should only ever be false in Node.js, if polyfills have not been installed...\n            return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || DATA_SUPPORTED;\n        case 'imagebitmap':\n            return IMAGE_BITMAP_SUPPORTED;\n        case 'image':\n            return IMAGE_SUPPORTED;\n        case 'data':\n            return DATA_SUPPORTED;\n        default:\n            throw new Error(`@loaders.gl/images: image ${type} not supported in this environment`);\n    }\n}\n/**\n * Returns the \"most performant\" supported image type on this platform\n * @returns image type string\n */\nexport function getDefaultImageType() {\n    if (IMAGE_BITMAP_SUPPORTED) {\n        return 'imagebitmap';\n    }\n    if (IMAGE_SUPPORTED) {\n        return 'image';\n    }\n    if (DATA_SUPPORTED) {\n        return 'data';\n    }\n    // This should only happen in Node.js\n    throw new Error('Install \\'@loaders.gl/polyfills\\' to parse images under Node.js');\n}\n", "export function isImage(image) {\n    return Boolean(getImageTypeOrNull(image));\n}\nexport function deleteImage(image) {\n    switch (getImageType(image)) {\n        case 'imagebitmap':\n            image.close();\n            break;\n        default:\n        // Nothing to do for images and image data objects\n    }\n}\nexport function getImageType(image) {\n    const format = getImageTypeOrNull(image);\n    if (!format) {\n        throw new Error('Not an image');\n    }\n    return format;\n}\nexport function getImageSize(image) {\n    return getImageData(image);\n}\nexport function getImageData(image) {\n    switch (getImageType(image)) {\n        case 'data':\n            return image;\n        case 'image':\n        case 'imagebitmap':\n            // Extract the image data from the image via a canvas\n            const canvas = document.createElement('canvas');\n            // TODO - reuse the canvas?\n            const context = canvas.getContext('2d');\n            if (!context) {\n                throw new Error('getImageData');\n            }\n            // @ts-ignore\n            canvas.width = image.width;\n            // @ts-ignore\n            canvas.height = image.height;\n            // @ts-ignore\n            context.drawImage(image, 0, 0);\n            // @ts-ignore\n            return context.getImageData(0, 0, image.width, image.height);\n        default:\n            throw new Error('getImageData');\n    }\n}\n// PRIVATE\n// eslint-disable-next-line complexity\nfunction getImageTypeOrNull(image) {\n    if (typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap) {\n        return 'imagebitmap';\n    }\n    if (typeof Image !== 'undefined' && image instanceof Image) {\n        return 'image';\n    }\n    if (image && typeof image === 'object' && image.data && image.width && image.height) {\n        return 'data';\n    }\n    return null;\n}\n", "// SVG parsing has limitations, e.g:\n// https://bugs.chromium.org/p/chromium/issues/detail?id=606319\nconst SVG_DATA_URL_PATTERN = /^data:image\\/svg\\+xml/;\nconst SVG_URL_PATTERN = /\\.svg((\\?|#).*)?$/;\nexport function isSVG(url) {\n    return url && (SVG_DATA_URL_PATTERN.test(url) || SVG_URL_PATTERN.test(url));\n}\nexport function getBlobOrSVGDataUrl(arrayBuffer, url) {\n    if (isSVG(url)) {\n        // Prepare a properly tagged data URL, and load using normal mechanism\n        const textDecoder = new TextDecoder();\n        let xmlText = textDecoder.decode(arrayBuffer);\n        // TODO Escape in browser to support e.g. Chinese characters\n        try {\n            if (typeof unescape === 'function' && typeof encodeURIComponent === 'function') {\n                xmlText = unescape(encodeURIComponent(xmlText));\n            }\n        }\n        catch (error) {\n            throw new Error(error.message);\n        }\n        // base64 encoding is safer. utf-8 fails in some browsers\n        const src = `data:image/svg+xml;base64,${btoa(xmlText)}`;\n        return src;\n    }\n    return getBlob(arrayBuffer, url);\n}\nexport function getBlob(arrayBuffer, url) {\n    if (isSVG(url)) {\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=606319\n        // return new Blob([new Uint8Array(arrayBuffer)], {type: 'image/svg+xml'});\n        throw new Error('SVG cannot be parsed directly to imagebitmap');\n    }\n    // TODO - how to determine mime type? Param? Sniff here?\n    return new Blob([new Uint8Array(arrayBuffer)]); // MIME type not needed?\n}\n", "import { getBlobOrSVGDataUrl } from \"./svg-utils.js\";\n// Parses html image from array buffer\nexport async function parseToImage(arrayBuffer, options, url) {\n    // Note: image parsing requires conversion to Blob (for createObjectURL).\n    // Potentially inefficient for not using `response.blob()` (and for File / Blob inputs)...\n    // But presumably not worth adding 'blob' flag to loader objects?\n    const blobOrDataUrl = getBlobOrSVGDataUrl(arrayBuffer, url);\n    const URL = self.URL || self.webkitURL;\n    const objectUrl = typeof blobOrDataUrl !== 'string' && URL.createObjectURL(blobOrDataUrl);\n    try {\n        return await loadToImage(objectUrl || blobOrDataUrl, options);\n    }\n    finally {\n        if (objectUrl) {\n            URL.revokeObjectURL(objectUrl);\n        }\n    }\n}\nexport async function loadToImage(url, options) {\n    const image = new Image();\n    image.src = url;\n    // The `image.onload()` callback does not guarantee that the image has been decoded\n    // so a main thread \"freeze\" can be incurred when using the image for the first time.\n    // `Image.decode()` returns a promise that completes when image is decoded.\n    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/decode\n    // Note: When calling `img.decode()`, we do not need to wait for `img.onload()`\n    // Note: `HTMLImageElement.decode()` is not available in Edge and IE11\n    if (options.image && options.image.decode && image.decode) {\n        await image.decode();\n        return image;\n    }\n    // Create a promise that tracks onload/onerror callbacks\n    return await new Promise((resolve, reject) => {\n        try {\n            image.onload = () => resolve(image);\n            image.onerror = (error) => {\n                const message = error instanceof Error ? error.message : 'error';\n                reject(new Error(message));\n            };\n        }\n        catch (error) {\n            reject(error);\n        }\n    });\n}\n", "import { isSVG, getBlob } from \"./svg-utils.js\";\nimport { parseToImage } from \"./parse-to-image.js\";\nconst EMPTY_OBJECT = {};\nlet imagebitmapOptionsSupported = true;\n/**\n * Asynchronously parses an array buffer into an ImageBitmap - this contains the decoded data\n * ImageBitmaps are supported on worker threads, but not supported on Edge, IE11 and Safari\n * https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap#Browser_compatibility\n *\n * TODO - createImageBitmap supports source rect (5 param overload), pass through?\n */\nexport async function parseToImageBitmap(arrayBuffer, options, url) {\n    let blob;\n    // Cannot parse SVG directly to ImageBitmap, parse to Image first\n    if (isSVG(url)) {\n        // Note: this only works on main thread\n        const image = await parseToImage(arrayBuffer, options, url);\n        blob = image;\n    }\n    else {\n        // Create blob from the array buffer\n        blob = getBlob(arrayBuffer, url);\n    }\n    const imagebitmapOptions = options && options.imagebitmap;\n    return await safeCreateImageBitmap(blob, imagebitmapOptions);\n}\n/**\n * Safely creates an imageBitmap with options\n * *\n * Firefox crashes if imagebitmapOptions is supplied\n * Avoid supplying if not provided or supported, remember if not supported\n */\nasync function safeCreateImageBitmap(blob, imagebitmapOptions = null) {\n    if (isEmptyObject(imagebitmapOptions) || !imagebitmapOptionsSupported) {\n        imagebitmapOptions = null;\n    }\n    if (imagebitmapOptions) {\n        try {\n            // @ts-ignore Options\n            return await createImageBitmap(blob, imagebitmapOptions);\n        }\n        catch (error) {\n            console.warn(error); // eslint-disable-line\n            imagebitmapOptionsSupported = false;\n        }\n    }\n    return await createImageBitmap(blob);\n}\nfunction isEmptyObject(object) {\n    // @ts-ignore\n    for (const key in object || EMPTY_OBJECT) {\n        return false;\n    }\n    return true;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// code adapted from https://github.com/sindresorhus/file-type under MIT license\n/**\n * Tests if a buffer is in ISO base media file format (ISOBMFF) @see https://en.wikipedia.org/wiki/ISO_base_media_file_format\n * (ISOBMFF is a media container standard based on the Apple QuickTime container format)\n */\nexport function getISOBMFFMediaType(buffer) {\n    // Almost all ISO base media files start with `ftyp` box. (It's not required to be first, but it's recommended to be.)\n    if (!checkString(buffer, 'ftyp', 4)) {\n        return null;\n    }\n    // Extra check: test for 8859-1 printable characters (for simplicity, it's a mask which also catches one non-printable character).\n    if ((buffer[8] & 0x60) === 0x00) {\n        return null;\n    }\n    // `ftyp` box must contain a brand major identifier, which must consist of ISO 8859-1 printable characters.\n    return decodeMajorBrand(buffer);\n}\n/**\n * brands explained @see https://github.com/strukturag/libheif/issues/83\n * code adapted from @see https://github.com/sindresorhus/file-type/blob/main/core.js#L489-L492\n */\nexport function decodeMajorBrand(buffer) {\n    const brandMajor = getUTF8String(buffer, 8, 12).replace('\\0', ' ').trim();\n    switch (brandMajor) {\n        case 'avif':\n        case 'avis':\n            return { extension: 'avif', mimeType: 'image/avif' };\n        default:\n            return null;\n    }\n    // We don't need these now, but they are easy to add\n    // case 'mif1':\n    //   return {extension: 'heic', mimeType: 'image/heif'};\n    // case 'msf1':\n    //   return {extension: 'heic', mimeType: 'image/heif-sequence'};\n    // case 'heic':\n    // case 'heix':\n    //   return {extension: 'heic', mimeType: 'image/heic'};\n    // case 'hevc':\n    // case 'hevx':\n    //   return {extension: 'heic', mimeType: 'image/heic-sequence'};\n    // case 'qt':\n    //   return {ext: 'mov', mime: 'video/quicktime'};\n    // case 'M4V':\n    // case 'M4VH':\n    // case 'M4VP':\n    //   return {ext: 'm4v', mime: 'video/x-m4v'};\n    // case 'M4P':\n    //   return {ext: 'm4p', mime: 'video/mp4'};\n    // case 'M4B':\n    //   return {ext: 'm4b', mime: 'audio/mp4'};\n    // case 'M4A':\n    //   return {ext: 'm4a', mime: 'audio/x-m4a'};\n    // case 'F4V':\n    //   return {ext: 'f4v', mime: 'video/mp4'};\n    // case 'F4P':\n    //   return {ext: 'f4p', mime: 'video/mp4'};\n    // case 'F4A':\n    //   return {ext: 'f4a', mime: 'audio/mp4'};\n    // case 'F4B':\n    //   return {ext: 'f4b', mime: 'audio/mp4'};\n    // case 'crx':\n    //   return {ext: 'cr3', mime: 'image/x-canon-cr3'};\n    // default:\n    // if (brandMajor.startsWith('3g')) {\n    //   if (brandMajor.startsWith('3g2')) {\n    //     return {ext: '3g2', mime: 'video/3gpp2'};\n    //   }\n    //   return {ext: '3gp', mime: 'video/3gpp'};\n    // }\n    // return {ext: 'mp4', mime: 'video/mp4'};\n}\n/** Interpret a chunk of bytes as a UTF8 string */\nfunction getUTF8String(array, start, end) {\n    return String.fromCharCode(...array.slice(start, end));\n}\nfunction stringToBytes(string) {\n    return [...string].map((character) => character.charCodeAt(0));\n}\nfunction checkString(buffer, header, offset = 0) {\n    const headerBytes = stringToBytes(header);\n    for (let i = 0; i < headerBytes.length; ++i) {\n        if (headerBytes[i] !== buffer[i + offset]) {\n            return false;\n        }\n    }\n    return true;\n}\n", "// Attributions\n// * Based on binary-gltf-utils under MIT license: Copyright (c) 2016-17 Karl Cheng\nimport { getISOBMFFMediaType } from \"./parse-isobmff-binary.js\";\nconst BIG_ENDIAN = false;\nconst LITTLE_ENDIAN = true;\n/**\n * Extracts `{mimeType, width and height}` from a memory buffer containing a known image format\n * Currently supports `image/png`, `image/jpeg`, `image/bmp` and `image/gif`.\n * @param binaryData: DataView | ArrayBuffer image file memory to parse\n * @returns metadata or null if memory is not a valid image file format layout.\n */\nexport function getBinaryImageMetadata(binaryData) {\n    const dataView = toDataView(binaryData);\n    return (getPngMetadata(dataView) ||\n        getJpegMetadata(dataView) ||\n        getGifMetadata(dataView) ||\n        getBmpMetadata(dataView) ||\n        getISOBMFFMetadata(dataView));\n}\n// ISOBMFF\nfunction getISOBMFFMetadata(binaryData) {\n    const buffer = new Uint8Array(binaryData instanceof DataView ? binaryData.buffer : binaryData);\n    const mediaType = getISOBMFFMediaType(buffer);\n    if (!mediaType) {\n        return null;\n    }\n    return {\n        mimeType: mediaType.mimeType,\n        // TODO - decode width and height\n        width: 0,\n        height: 0\n    };\n}\n// PNG\nfunction getPngMetadata(binaryData) {\n    const dataView = toDataView(binaryData);\n    // Check file contains the first 4 bytes of the PNG signature.\n    const isPng = dataView.byteLength >= 24 && dataView.getUint32(0, BIG_ENDIAN) === 0x89504e47;\n    if (!isPng) {\n        return null;\n    }\n    // Extract size from a binary PNG file\n    return {\n        mimeType: 'image/png',\n        width: dataView.getUint32(16, BIG_ENDIAN),\n        height: dataView.getUint32(20, BIG_ENDIAN)\n    };\n}\n// GIF\n// Extract size from a binary GIF file\n// TODO: GIF is not this simple\nfunction getGifMetadata(binaryData) {\n    const dataView = toDataView(binaryData);\n    // Check first 4 bytes of the GIF signature (\"GIF8\").\n    const isGif = dataView.byteLength >= 10 && dataView.getUint32(0, BIG_ENDIAN) === 0x47494638;\n    if (!isGif) {\n        return null;\n    }\n    // GIF is little endian.\n    return {\n        mimeType: 'image/gif',\n        width: dataView.getUint16(6, LITTLE_ENDIAN),\n        height: dataView.getUint16(8, LITTLE_ENDIAN)\n    };\n}\n// BMP\n// TODO: BMP is not this simple\nexport function getBmpMetadata(binaryData) {\n    const dataView = toDataView(binaryData);\n    // Check magic number is valid (first 2 characters should be \"BM\").\n    // The mandatory bitmap file header is 14 bytes long.\n    const isBmp = dataView.byteLength >= 14 &&\n        dataView.getUint16(0, BIG_ENDIAN) === 0x424d &&\n        dataView.getUint32(2, LITTLE_ENDIAN) === dataView.byteLength;\n    if (!isBmp) {\n        return null;\n    }\n    // BMP is little endian.\n    return {\n        mimeType: 'image/bmp',\n        width: dataView.getUint32(18, LITTLE_ENDIAN),\n        height: dataView.getUint32(22, LITTLE_ENDIAN)\n    };\n}\n// JPEG\n// Extract width and height from a binary JPEG file\nfunction getJpegMetadata(binaryData) {\n    const dataView = toDataView(binaryData);\n    // Check file contains the JPEG \"start of image\" (SOI) marker\n    // followed by another marker.\n    const isJpeg = dataView.byteLength >= 3 &&\n        dataView.getUint16(0, BIG_ENDIAN) === 0xffd8 &&\n        dataView.getUint8(2) === 0xff;\n    if (!isJpeg) {\n        return null;\n    }\n    const { tableMarkers, sofMarkers } = getJpegMarkers();\n    // Exclude the two byte SOI marker.\n    let i = 2;\n    while (i + 9 < dataView.byteLength) {\n        const marker = dataView.getUint16(i, BIG_ENDIAN);\n        // The frame that contains the width and height of the JPEG image.\n        if (sofMarkers.has(marker)) {\n            return {\n                mimeType: 'image/jpeg',\n                height: dataView.getUint16(i + 5, BIG_ENDIAN), // Number of lines\n                width: dataView.getUint16(i + 7, BIG_ENDIAN) // Number of pixels per line\n            };\n        }\n        // Miscellaneous tables/data preceding the frame header.\n        if (!tableMarkers.has(marker)) {\n            return null;\n        }\n        // Length includes size of length parameter but not the two byte header.\n        i += 2;\n        i += dataView.getUint16(i, BIG_ENDIAN);\n    }\n    return null;\n}\nfunction getJpegMarkers() {\n    // Tables/misc header markers.\n    // DQT, DHT, DAC, DRI, COM, APP_n\n    const tableMarkers = new Set([0xffdb, 0xffc4, 0xffcc, 0xffdd, 0xfffe]);\n    for (let i = 0xffe0; i < 0xfff0; ++i) {\n        tableMarkers.add(i);\n    }\n    // SOF markers and DHP marker.\n    // These markers are after tables/misc data.\n    const sofMarkers = new Set([\n        0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc9, 0xffca, 0xffcb, 0xffcd, 0xffce,\n        0xffcf, 0xffde\n    ]);\n    return { tableMarkers, sofMarkers };\n}\n// TODO - move into image module?\nfunction toDataView(data) {\n    if (data instanceof DataView) {\n        return data;\n    }\n    if (ArrayBuffer.isView(data)) {\n        return new DataView(data.buffer);\n    }\n    // TODO: make these functions work for Node.js buffers?\n    // if (bufferToArrayBuffer) {\n    //   data = bufferToArrayBuffer(data);\n    // }\n    // Careful - Node Buffers will look like ArrayBuffers (keep after isBuffer)\n    if (data instanceof ArrayBuffer) {\n        return new DataView(data);\n    }\n    throw new Error('toDataView');\n}\n", "import { assert } from '@loaders.gl/loader-utils';\nimport { getBinaryImageMetadata } from \"../category-api/binary-image-api.js\";\n// Use polyfills if installed to parsed image using get-pixels\nexport async function parseToNodeImage(arrayBuffer, options) {\n    const { mimeType } = getBinaryImageMetadata(arrayBuffer) || {};\n    // @ts-ignore\n    const parseImageNode = globalThis.loaders?.parseImageNode;\n    assert(parseImageNode); // '@loaders.gl/polyfills not installed'\n    // @ts-expect-error TODO should we throw error in this case?\n    return await parseImageNode(arrayBuffer, mimeType);\n}\n", "import { assert } from '@loaders.gl/loader-utils';\nimport { isImageTypeSupported, getDefaultImageType } from \"../category-api/image-type.js\";\nimport { getImageData } from \"../category-api/parsed-image-api.js\";\nimport { parseToImage } from \"./parse-to-image.js\";\nimport { parseToImageBitmap } from \"./parse-to-image-bitmap.js\";\nimport { parseToNodeImage } from \"./parse-to-node-image.js\";\n// Parse to platform defined image type (data on node, ImageBitmap or HTMLImage on browser)\n// eslint-disable-next-line complexity\nexport async function parseImage(arrayBuffer, options, context) {\n    options = options || {};\n    const imageOptions = options.image || {};\n    // The user can request a specific output format via `options.image.type`\n    const imageType = imageOptions.type || 'auto';\n    const { url } = context || {};\n    // Note: For options.image.type === `data`, we may still need to load as `image` or `imagebitmap`\n    const loadType = getLoadableImageType(imageType);\n    let image;\n    switch (loadType) {\n        case 'imagebitmap':\n            image = await parseToImageBitmap(arrayBuffer, options, url);\n            break;\n        case 'image':\n            image = await parseToImage(arrayBuffer, options, url);\n            break;\n        case 'data':\n            // Node.js loads imagedata directly\n            image = await parseToNodeImage(arrayBuffer, options);\n            break;\n        default:\n            assert(false);\n    }\n    // Browser: if options.image.type === 'data', we can now extract data from the loaded image\n    if (imageType === 'data') {\n        image = getImageData(image);\n    }\n    return image;\n}\n// Get a loadable image type from image type\nfunction getLoadableImageType(type) {\n    switch (type) {\n        case 'auto':\n        case 'data':\n            // Browser: For image data we need still need to load using an image format\n            // Node: the default image type is `data`.\n            return getDefaultImageType();\n        default:\n            // Throw an error if not supported\n            isImageTypeSupported(type);\n            return type;\n    }\n}\n", "// import type { ImageType } from '@loaders.gl/schema';\nimport { VERSION } from \"./lib/utils/version.js\";\nimport { parseImage } from \"./lib/parsers/parse-image.js\";\nimport { getBinaryImageMetadata } from \"./lib/category-api/binary-image-api.js\";\nconst EXTENSIONS = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp', 'ico', 'svg', 'avif'];\nconst MIME_TYPES = [\n    'image/png',\n    'image/jpeg',\n    'image/gif',\n    'image/webp',\n    'image/avif',\n    'image/bmp',\n    'image/vnd.microsoft.icon',\n    'image/svg+xml'\n];\nconst DEFAULT_IMAGE_LOADER_OPTIONS = {\n    image: {\n        type: 'auto',\n        decode: true // if format is HTML\n    }\n    // imagebitmap: {} - passes (platform dependent) parameters to ImageBitmap constructor\n};\n/**\n * Loads a platform-specific image type\n * Note: This type can be used as input data to WebGL texture creation\n */\nexport const ImageLoader = {\n    dataType: null,\n    batchType: null,\n    id: 'image',\n    module: 'images',\n    name: 'Images',\n    version: VERSION,\n    mimeTypes: MIME_TYPES,\n    extensions: EXTENSIONS,\n    parse: parseImage,\n    // TODO: byteOffset, byteLength;\n    tests: [(arrayBuffer) => Boolean(getBinaryImageMetadata(new DataView(arrayBuffer)))],\n    options: DEFAULT_IMAGE_LOADER_OPTIONS\n};\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isBrowser } from '@loaders.gl/loader-utils';\nconst MIME_TYPES = [\n    'image/png',\n    'image/jpeg',\n    'image/gif',\n    'image/webp',\n    'image/avif',\n    'image/tiff',\n    // TODO - what is the correct type for SVG\n    'image/svg',\n    'image/svg+xml',\n    'image/bmp',\n    'image/vnd.microsoft.icon'\n];\n/** Only one round of tests is performed */\nconst mimeTypeSupportedPromise = null;\n/** Run-time browser detection of file formats requires async tests for most precise results */\nexport async function getSupportedImageFormats() {\n    if (mimeTypeSupportedPromise) {\n        return await mimeTypeSupportedPromise;\n    }\n    const supportedMimeTypes = new Set();\n    for (const mimeType of MIME_TYPES) {\n        const supported = isBrowser\n            ? await checkBrowserImageFormatSupportAsync(mimeType)\n            : checkNodeImageFormatSupport(mimeType);\n        if (supported) {\n            supportedMimeTypes.add(mimeType);\n        }\n    }\n    return supportedMimeTypes;\n}\n/** Cache sync values for speed */\nconst mimeTypeSupportedSync = {};\n/**\n * Check if image MIME type is supported. Result is cached to avoid repeated tests.\n */\nexport function isImageFormatSupported(mimeType) {\n    if (mimeTypeSupportedSync[mimeType] === undefined) {\n        const supported = isBrowser\n            ? checkBrowserImageFormatSupport(mimeType)\n            : checkNodeImageFormatSupport(mimeType);\n        mimeTypeSupportedSync[mimeType] = supported;\n    }\n    return mimeTypeSupportedSync[mimeType];\n}\n/**\n * Checks that polyfills are installed and that mimeType is supported by polyfills\n * @todo Ideally polyfills should declare what formats they support, instead of storing that data here.\n */\nfunction checkNodeImageFormatSupport(mimeType) {\n    const NODE_FORMAT_SUPPORT = ['image/png', 'image/jpeg', 'image/gif'];\n    const imageFormatsNode = globalThis.loaders?.imageFormatsNode || NODE_FORMAT_SUPPORT;\n    const parseImageNode = globalThis.loaders?.parseImageNode;\n    return Boolean(parseImageNode) && imageFormatsNode.includes(mimeType);\n}\n/** Checks image format support synchronously.\n * @note Unreliable, fails on AVIF\n */\nfunction checkBrowserImageFormatSupport(mimeType) {\n    switch (mimeType) {\n        case 'image/avif': // Will fail\n        case 'image/webp':\n            return testBrowserImageFormatSupport(mimeType);\n        default:\n            return true;\n    }\n}\nconst TEST_IMAGE = {\n    'image/avif': 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=',\n    // Lossy test image. Support for lossy images doesn't guarantee support for all WebP images.\n    'image/webp': 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA'\n};\n/** Checks WebP and AVIF support asynchronously */\nasync function checkBrowserImageFormatSupportAsync(mimeType) {\n    const dataURL = TEST_IMAGE[mimeType];\n    return dataURL ? await testBrowserImageFormatSupportAsync(dataURL) : true;\n}\n/**\n * Checks browser synchronously\n * Checks if toDataURL supports the mimeType.\n * @note Imperfect testOn Chrome this is true for WebP but not for AVIF\n */\nfunction testBrowserImageFormatSupport(mimeType) {\n    try {\n        const element = document.createElement('canvas');\n        const dataURL = element.toDataURL(mimeType);\n        return dataURL.indexOf(`data:${mimeType}`) === 0;\n    }\n    catch {\n        // Probably Safari...\n        return false;\n    }\n}\n// Check WebPSupport asynchronously\nasync function testBrowserImageFormatSupportAsync(testImageDataURL) {\n    return new Promise((resolve) => {\n        const image = new Image();\n        image.src = testImageDataURL;\n        image.onload = () => resolve(image.height > 0);\n        image.onerror = () => resolve(false);\n    });\n}\n", "// Replacement for the external assert method to reduce bundle size\n// Note: We don't use the second \"message\" argument in calling code,\n// so no need to support it here\nexport function assert(condition, message) {\n    if (!condition) {\n        throw new Error(message || 'assert failed: gltf');\n    }\n}\n", "export const COMPONENTS = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16\n};\nexport const BYTES = {\n    5120: 1, // BYTE\n    5121: 1, // UNSIGNED_BYTE\n    5122: 2, // SHORT\n    5123: 2, // UNSIGNED_SHORT\n    5125: 4, // UNSIGNED_INT\n    5126: 4 // FLOAT\n};\n// ENUM LOOKUP\nexport function getBytesFromComponentType(componentType) {\n    return BYTES[componentType];\n}\nexport function getSizeFromAccessorType(type) {\n    return COMPONENTS[type];\n}\nexport function getGLEnumFromSamplerParameter(parameter) {\n    const GL_TEXTURE_MAG_FILTER = 0x2800;\n    const GL_TEXTURE_MIN_FILTER = 0x2801;\n    const GL_TEXTURE_WRAP_S = 0x2802;\n    const GL_TEXTURE_WRAP_T = 0x2803;\n    const PARAMETER_MAP = {\n        magFilter: GL_TEXTURE_MAG_FILTER,\n        minFilter: GL_TEXTURE_MIN_FILTER,\n        wrapS: GL_TEXTURE_WRAP_S,\n        wrapT: GL_TEXTURE_WRAP_T\n    };\n    return PARAMETER_MAP[parameter];\n}\n", "import { assert } from \"../utils/assert.js\";\nimport { BYTES, COMPONENTS } from \"../gltf-utils/gltf-constants.js\";\n/**\n * Memory needed to store texture and all mipmap levels 1 + 1/4 + 1/16 + 1/64 + ...\n * Minimum 1.33, but due to GPU layout may be 1.5\n */\nconst MIPMAP_FACTOR = 1.33;\nconst TYPES = ['SCALAR', 'VEC2', 'VEC3', 'VEC4'];\nconst ARRAY_CONSTRUCTOR_TO_WEBGL_CONSTANT = [\n    [Int8Array, 5120],\n    [Uint8Array, 5121],\n    [Int16Array, 5122],\n    [Uint16Array, 5123],\n    [Uint32Array, 5125],\n    [Float32Array, 5126],\n    [Float64Array, 5130]\n];\nconst ARRAY_TO_COMPONENT_TYPE = new Map(ARRAY_CONSTRUCTOR_TO_WEBGL_CONSTANT);\nconst ATTRIBUTE_TYPE_TO_COMPONENTS = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16\n};\nconst ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE = {\n    5120: 1,\n    5121: 1,\n    5122: 2,\n    5123: 2,\n    5125: 4,\n    5126: 4\n};\nconst ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY = {\n    5120: Int8Array,\n    5121: Uint8Array,\n    5122: Int16Array,\n    5123: Uint16Array,\n    5125: Uint32Array,\n    5126: Float32Array\n};\nexport function getAccessorTypeFromSize(size) {\n    const type = TYPES[size - 1];\n    return type || TYPES[0];\n}\nexport function getComponentTypeFromArray(typedArray) {\n    const componentType = ARRAY_TO_COMPONENT_TYPE.get(typedArray.constructor);\n    if (!componentType) {\n        throw new Error('Illegal typed array');\n    }\n    return componentType;\n}\nexport function getAccessorArrayTypeAndLength(accessor, bufferView) {\n    const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[accessor.componentType];\n    const components = ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type];\n    const bytesPerComponent = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[accessor.componentType];\n    const length = accessor.count * components;\n    const byteLength = accessor.count * components * bytesPerComponent;\n    assert(byteLength >= 0 && byteLength <= bufferView.byteLength);\n    const componentByteSize = BYTES[accessor.componentType];\n    const numberOfComponentsInElement = COMPONENTS[accessor.type];\n    return { ArrayType, length, byteLength, componentByteSize, numberOfComponentsInElement };\n}\n/**\n * Calculate the GPU memory used by a GLTF tile, for both buffer and texture memory\n * @param gltf - the gltf content of a GLTF tile\n * @returns - total memory usage in bytes\n */\nexport function getMemoryUsageGLTF(gltf) {\n    let { images, bufferViews } = gltf;\n    images = images || [];\n    bufferViews = bufferViews || [];\n    const imageBufferViews = images.map((i) => i.bufferView);\n    bufferViews = bufferViews.filter((view) => !imageBufferViews.includes(view));\n    const bufferMemory = bufferViews.reduce((acc, view) => acc + view.byteLength, 0);\n    // Assume each pixel of the texture is 4 channel with mimmaps (which add 33%)\n    // TODO correctly handle compressed textures\n    const pixelCount = images.reduce((acc, image) => {\n        // @ts-ignore\n        const { width, height } = image.image;\n        return acc + width * height;\n    }, 0);\n    return bufferMemory + Math.ceil(4 * pixelCount * MIPMAP_FACTOR);\n}\n", "// TODO - GLTFScenegraph should use these\nimport { assert } from \"../utils/assert.js\";\nimport { getAccessorArrayTypeAndLength } from \"./gltf-utils.js\";\n// accepts buffer view index or buffer view object\n// returns a `Uint8Array`\nexport function getTypedArrayForBufferView(json, buffers, bufferViewIndex) {\n    const bufferView = json.bufferViews[bufferViewIndex];\n    assert(bufferView);\n    // Get hold of the arrayBuffer\n    const bufferIndex = bufferView.buffer;\n    const binChunk = buffers[bufferIndex];\n    assert(binChunk);\n    const byteOffset = (bufferView.byteOffset || 0) + binChunk.byteOffset;\n    return new Uint8Array(binChunk.arrayBuffer, byteOffset, bufferView.byteLength);\n}\n// accepts accessor index or accessor object\n// returns a `Uint8Array`\nexport function getTypedArrayForImageData(json, buffers, imageIndex) {\n    const image = json.images[imageIndex];\n    const bufferViewIndex = json.bufferViews[image.bufferView];\n    return getTypedArrayForBufferView(json, buffers, bufferViewIndex);\n}\n/**\n * Gets data pointed by the accessor.\n * @param json - json part of gltf content of a GLTF tile.\n * @param buffers - Array containing buffers of data.\n * @param accessor - accepts accessor index or accessor object.\n * @returns {TypedArray} Typed array with type matching the type of data poited by the accessor.\n */\n// eslint-disable-next-line complexity\nexport function getTypedArrayForAccessor(json, buffers, accessor) {\n    const gltfAccessor = typeof accessor === 'number' ? json.accessors?.[accessor] : accessor;\n    if (!gltfAccessor) {\n        throw new Error(`No gltf accessor ${JSON.stringify(accessor)}`);\n    }\n    const bufferView = json.bufferViews?.[gltfAccessor.bufferView || 0];\n    if (!bufferView) {\n        throw new Error(`No gltf buffer view for accessor ${bufferView}`);\n    }\n    // Get `arrayBuffer` the `bufferView` looks at\n    const { arrayBuffer, byteOffset: bufferByteOffset } = buffers[bufferView.buffer];\n    // Resulting byteOffset is sum of the buffer, accessor and bufferView byte offsets\n    const byteOffset = (bufferByteOffset || 0) + (gltfAccessor.byteOffset || 0) + (bufferView.byteOffset || 0);\n    // Deduce TypedArray type and its length from `accessor` and `bufferView` data\n    const { ArrayType, length, componentByteSize, numberOfComponentsInElement } = getAccessorArrayTypeAndLength(gltfAccessor, bufferView);\n    // 'length' is a whole number of components of all elements in the buffer pointed by the accessor\n    // Multiplier to calculate the address of the element in the arrayBuffer\n    const elementByteSize = componentByteSize * numberOfComponentsInElement;\n    const elementAddressScale = bufferView.byteStride || elementByteSize;\n    // Creare an array of component's type where all components (not just elements) will reside\n    if (typeof bufferView.byteStride === 'undefined' || bufferView.byteStride === elementByteSize) {\n        // No iterleaving\n        const result = new ArrayType(arrayBuffer, byteOffset, length);\n        return result;\n    }\n    // Iterleaving\n    const result = new ArrayType(length);\n    for (let i = 0; i < gltfAccessor.count; i++) {\n        const values = new ArrayType(arrayBuffer, byteOffset + i * elementAddressScale, numberOfComponentsInElement);\n        result.set(values, i * numberOfComponentsInElement);\n    }\n    return result;\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { getBinaryImageMetadata } from '@loaders.gl/images';\nimport { padToNBytes, copyToArray } from '@loaders.gl/loader-utils';\nimport { assert } from \"../utils/assert.js\";\nimport { getAccessorTypeFromSize, getComponentTypeFromArray } from \"../gltf-utils/gltf-utils.js\";\nimport { getTypedArrayForAccessor as _getTypedArrayForAccessor } from \"../gltf-utils/get-typed-array.js\";\nfunction makeDefaultGLTFJson() {\n    return {\n        asset: {\n            version: '2.0',\n            generator: 'loaders.gl'\n        },\n        buffers: [],\n        extensions: {},\n        extensionsRequired: [],\n        extensionsUsed: []\n    };\n}\n/**\n * Class for structured access to GLTF data\n */\nexport class GLTFScenegraph {\n    // internal\n    gltf;\n    sourceBuffers;\n    byteLength;\n    // TODO - why is this not GLTFWithBuffers - what happens to images?\n    constructor(gltf) {\n        // Declare locally so\n        this.gltf = {\n            json: gltf?.json || makeDefaultGLTFJson(),\n            buffers: gltf?.buffers || [],\n            images: gltf?.images || []\n        };\n        this.sourceBuffers = [];\n        this.byteLength = 0;\n        // Initialize buffers\n        if (this.gltf.buffers && this.gltf.buffers[0]) {\n            this.byteLength = this.gltf.buffers[0].byteLength;\n            this.sourceBuffers = [this.gltf.buffers[0]];\n        }\n    }\n    // Accessors\n    get json() {\n        return this.gltf.json;\n    }\n    getApplicationData(key) {\n        // TODO - Data is already unpacked by GLBParser\n        const data = this.json[key];\n        return data;\n    }\n    getExtraData(key) {\n        // TODO - Data is already unpacked by GLBParser\n        const extras = (this.json.extras || {});\n        return extras[key];\n    }\n    hasExtension(extensionName) {\n        const isUsedExtension = this.getUsedExtensions().find((name) => name === extensionName);\n        const isRequiredExtension = this.getRequiredExtensions().find((name) => name === extensionName);\n        return typeof isUsedExtension === 'string' || typeof isRequiredExtension === 'string';\n    }\n    getExtension(extensionName) {\n        const isExtension = this.getUsedExtensions().find((name) => name === extensionName);\n        const extensions = this.json.extensions || {};\n        return isExtension ? extensions[extensionName] : null;\n    }\n    getRequiredExtension(extensionName) {\n        const isRequired = this.getRequiredExtensions().find((name) => name === extensionName);\n        return isRequired ? this.getExtension(extensionName) : null;\n    }\n    getRequiredExtensions() {\n        return this.json.extensionsRequired || [];\n    }\n    getUsedExtensions() {\n        return this.json.extensionsUsed || [];\n    }\n    getRemovedExtensions() {\n        return (this.json.extensionsRemoved || []);\n    }\n    getObjectExtension(object, extensionName) {\n        const extensions = object.extensions || {};\n        return extensions[extensionName];\n    }\n    getScene(index) {\n        return this.getObject('scenes', index);\n    }\n    getNode(index) {\n        return this.getObject('nodes', index);\n    }\n    getSkin(index) {\n        return this.getObject('skins', index);\n    }\n    getMesh(index) {\n        return this.getObject('meshes', index);\n    }\n    getMaterial(index) {\n        return this.getObject('materials', index);\n    }\n    getAccessor(index) {\n        return this.getObject('accessors', index);\n    }\n    // getCamera(index: number): object | null {\n    //   return null; // TODO: fix thi: object  as null;\n    // }\n    getTexture(index) {\n        return this.getObject('textures', index);\n    }\n    getSampler(index) {\n        return this.getObject('samplers', index);\n    }\n    getImage(index) {\n        return this.getObject('images', index);\n    }\n    getBufferView(index) {\n        return this.getObject('bufferViews', index);\n    }\n    getBuffer(index) {\n        return this.getObject('buffers', index);\n    }\n    getObject(array, index) {\n        // check if already resolved\n        if (typeof index === 'object') {\n            return index;\n        }\n        const object = this.json[array] && this.json[array][index];\n        if (!object) {\n            throw new Error(`glTF file error: Could not find ${array}[${index}]`); // eslint-disable-line\n        }\n        return object;\n    }\n    /**\n     * Accepts buffer view index or buffer view object\n     * @returns a `Uint8Array`\n     */\n    getTypedArrayForBufferView(bufferView) {\n        bufferView = this.getBufferView(bufferView);\n        // @ts-ignore\n        const bufferIndex = bufferView.buffer;\n        // Get hold of the arrayBuffer\n        // const buffer = this.getBuffer(bufferIndex);\n        const binChunk = this.gltf.buffers[bufferIndex];\n        assert(binChunk);\n        // @ts-ignore\n        const byteOffset = (bufferView.byteOffset || 0) + binChunk.byteOffset;\n        // @ts-ignore\n        return new Uint8Array(binChunk.arrayBuffer, byteOffset, bufferView.byteLength);\n    }\n    /** Accepts accessor index or accessor object\n     * @returns a typed array with type that matches the types\n     */\n    getTypedArrayForAccessor(accessor) {\n        // @ts-ignore\n        const gltfAccessor = this.getAccessor(accessor);\n        return _getTypedArrayForAccessor(this.gltf.json, this.gltf.buffers, gltfAccessor);\n    }\n    /** accepts accessor index or accessor object\n     * returns a `Uint8Array`\n     */\n    getTypedArrayForImageData(image) {\n        // @ts-ignore\n        image = this.getAccessor(image);\n        // @ts-ignore\n        const bufferView = this.getBufferView(image.bufferView);\n        const buffer = this.getBuffer(bufferView.buffer);\n        // @ts-ignore\n        const arrayBuffer = buffer.data;\n        const byteOffset = bufferView.byteOffset || 0;\n        return new Uint8Array(arrayBuffer, byteOffset, bufferView.byteLength);\n    }\n    // MODIFERS\n    /**\n     * Add an extra application-defined key to the top-level data structure\n     */\n    addApplicationData(key, data) {\n        this.json[key] = data;\n        return this;\n    }\n    /**\n     * `extras` - Standard GLTF field for storing application specific data\n     */\n    addExtraData(key, data) {\n        this.json.extras = this.json.extras || {};\n        this.json.extras[key] = data;\n        return this;\n    }\n    addObjectExtension(object, extensionName, data) {\n        // @ts-ignore\n        object.extensions = object.extensions || {};\n        // TODO - clobber or merge?\n        // @ts-ignore\n        object.extensions[extensionName] = data;\n        this.registerUsedExtension(extensionName);\n        return this;\n    }\n    setObjectExtension(object, extensionName, data) {\n        const extensions = object.extensions || {};\n        extensions[extensionName] = data;\n        // TODO - add to usedExtensions...\n    }\n    removeObjectExtension(object, extensionName) {\n        const extensions = object?.extensions || {};\n        if (extensions[extensionName]) {\n            this.json.extensionsRemoved = this.json.extensionsRemoved || [];\n            const extensionsRemoved = this.json.extensionsRemoved;\n            if (!extensionsRemoved.includes(extensionName)) {\n                extensionsRemoved.push(extensionName);\n            }\n        }\n        delete extensions[extensionName];\n    }\n    /**\n     * Add to standard GLTF top level extension object, mark as used\n     */\n    addExtension(extensionName, extensionData = {}) {\n        assert(extensionData);\n        this.json.extensions = this.json.extensions || {};\n        this.json.extensions[extensionName] = extensionData;\n        this.registerUsedExtension(extensionName);\n        return extensionData;\n    }\n    /**\n     * Standard GLTF top level extension object, mark as used and required\n     */\n    addRequiredExtension(extensionName, extensionData = {}) {\n        assert(extensionData);\n        this.addExtension(extensionName, extensionData);\n        this.registerRequiredExtension(extensionName);\n        return extensionData;\n    }\n    /**\n     * Add extensionName to list of used extensions\n     */\n    registerUsedExtension(extensionName) {\n        this.json.extensionsUsed = this.json.extensionsUsed || [];\n        if (!this.json.extensionsUsed.find((ext) => ext === extensionName)) {\n            this.json.extensionsUsed.push(extensionName);\n        }\n    }\n    /**\n     * Add extensionName to list of required extensions\n     */\n    registerRequiredExtension(extensionName) {\n        this.registerUsedExtension(extensionName);\n        this.json.extensionsRequired = this.json.extensionsRequired || [];\n        if (!this.json.extensionsRequired.find((ext) => ext === extensionName)) {\n            this.json.extensionsRequired.push(extensionName);\n        }\n    }\n    /**\n     * Removes an extension from the top-level list\n     */\n    removeExtension(extensionName) {\n        if (this.json.extensions?.[extensionName]) {\n            this.json.extensionsRemoved = this.json.extensionsRemoved || [];\n            const extensionsRemoved = this.json.extensionsRemoved;\n            if (!extensionsRemoved.includes(extensionName)) {\n                extensionsRemoved.push(extensionName);\n            }\n        }\n        if (this.json.extensions) {\n            delete this.json.extensions[extensionName];\n        }\n        if (this.json.extensionsRequired) {\n            this._removeStringFromArray(this.json.extensionsRequired, extensionName);\n        }\n        if (this.json.extensionsUsed) {\n            this._removeStringFromArray(this.json.extensionsUsed, extensionName);\n        }\n    }\n    /**\n     *  Set default scene which is to be displayed at load time\n     */\n    setDefaultScene(sceneIndex) {\n        this.json.scene = sceneIndex;\n    }\n    /**\n     * @todo: add more properties for scene initialization:\n     *   name`, `extensions`, `extras`\n     *   https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#reference-scene\n     */\n    addScene(scene) {\n        const { nodeIndices } = scene;\n        this.json.scenes = this.json.scenes || [];\n        this.json.scenes.push({ nodes: nodeIndices });\n        return this.json.scenes.length - 1;\n    }\n    /**\n     * @todo: add more properties for node initialization:\n     *   `name`, `extensions`, `extras`, `camera`, `children`, `skin`, `rotation`, `scale`, `translation`, `weights`\n     *   https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#node\n     */\n    addNode(node) {\n        const { meshIndex, matrix } = node;\n        this.json.nodes = this.json.nodes || [];\n        const nodeData = { mesh: meshIndex };\n        if (matrix) {\n            // @ts-ignore\n            nodeData.matrix = matrix;\n        }\n        this.json.nodes.push(nodeData);\n        return this.json.nodes.length - 1;\n    }\n    /** Adds a mesh to the json part */\n    addMesh(mesh) {\n        const { attributes, indices, material, mode = 4 } = mesh;\n        const accessors = this._addAttributes(attributes);\n        const glTFMesh = {\n            primitives: [\n                {\n                    attributes: accessors,\n                    mode\n                }\n            ]\n        };\n        if (indices) {\n            const indicesAccessor = this._addIndices(indices);\n            // @ts-ignore\n            glTFMesh.primitives[0].indices = indicesAccessor;\n        }\n        if (Number.isFinite(material)) {\n            // @ts-ignore\n            glTFMesh.primitives[0].material = material;\n        }\n        this.json.meshes = this.json.meshes || [];\n        this.json.meshes.push(glTFMesh);\n        return this.json.meshes.length - 1;\n    }\n    addPointCloud(attributes) {\n        // @ts-ignore\n        const accessorIndices = this._addAttributes(attributes);\n        const glTFMesh = {\n            primitives: [\n                {\n                    attributes: accessorIndices,\n                    mode: 0 // GL.POINTS\n                }\n            ]\n        };\n        this.json.meshes = this.json.meshes || [];\n        this.json.meshes.push(glTFMesh);\n        return this.json.meshes.length - 1;\n    }\n    /**\n     * Adds a binary image. Builds glTF \"JSON metadata\" and saves buffer reference\n     * Buffer will be copied into BIN chunk during \"pack\"\n     * Currently encodes as glTF image\n     * @param imageData\n     * @param mimeType\n     */\n    addImage(imageData, mimeTypeOpt) {\n        // If image is referencing a bufferView instead of URI, mimeType must be defined:\n        //   https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#images\n        //   \"a reference to a bufferView; in that case mimeType must be defined.\"\n        const metadata = getBinaryImageMetadata(imageData);\n        const mimeType = mimeTypeOpt || metadata?.mimeType;\n        const bufferViewIndex = this.addBufferView(imageData);\n        const glTFImage = {\n            bufferView: bufferViewIndex,\n            mimeType\n        };\n        this.json.images = this.json.images || [];\n        this.json.images.push(glTFImage);\n        return this.json.images.length - 1;\n    }\n    /**\n     * Add one untyped source buffer, create a matching glTF `bufferView`, and return its index\n     * @param buffer\n     */\n    addBufferView(buffer, bufferIndex = 0, byteOffset = this.byteLength) {\n        const byteLength = buffer.byteLength;\n        assert(Number.isFinite(byteLength));\n        // Add this buffer to the list of buffers to be written to the body.\n        this.sourceBuffers = this.sourceBuffers || [];\n        this.sourceBuffers.push(buffer);\n        const glTFBufferView = {\n            buffer: bufferIndex,\n            // Write offset from the start of the binary body\n            byteOffset,\n            byteLength\n        };\n        // We've now added the contents to the body, so update the total length\n        // Every sub-chunk needs to be 4-byte align ed\n        this.byteLength += padToNBytes(byteLength, 4);\n        // Add a bufferView indicating start and length of this binary sub-chunk\n        this.json.bufferViews = this.json.bufferViews || [];\n        this.json.bufferViews.push(glTFBufferView);\n        return this.json.bufferViews.length - 1;\n    }\n    /**\n     * Adds an accessor to a bufferView\n     * @param bufferViewIndex\n     * @param accessor\n     */\n    addAccessor(bufferViewIndex, accessor) {\n        const glTFAccessor = {\n            bufferView: bufferViewIndex,\n            // @ts-ignore\n            type: getAccessorTypeFromSize(accessor.size),\n            // @ts-ignore\n            componentType: accessor.componentType,\n            // @ts-ignore\n            count: accessor.count,\n            // @ts-ignore\n            max: accessor.max,\n            // @ts-ignore\n            min: accessor.min\n        };\n        this.json.accessors = this.json.accessors || [];\n        this.json.accessors.push(glTFAccessor);\n        return this.json.accessors.length - 1;\n    }\n    /**\n     * Add a binary buffer. Builds glTF \"JSON metadata\" and saves buffer reference\n     * Buffer will be copied into BIN chunk during \"pack\"\n     * Currently encodes buffers as glTF accessors, but this could be optimized\n     * @param sourceBuffer\n     * @param accessor\n     */\n    addBinaryBuffer(sourceBuffer, accessor = { size: 3 }) {\n        const bufferViewIndex = this.addBufferView(sourceBuffer);\n        // @ts-ignore\n        let minMax = { min: accessor.min, max: accessor.max };\n        if (!minMax.min || !minMax.max) {\n            // @ts-ignore\n            minMax = this._getAccessorMinMax(sourceBuffer, accessor.size);\n        }\n        const accessorDefaults = {\n            // @ts-ignore\n            size: accessor.size,\n            componentType: getComponentTypeFromArray(sourceBuffer),\n            // @ts-ignore\n            count: Math.round(sourceBuffer.length / accessor.size),\n            min: minMax.min,\n            max: minMax.max\n        };\n        return this.addAccessor(bufferViewIndex, Object.assign(accessorDefaults, accessor));\n    }\n    /**\n     * Adds a texture to the json part\n     * @todo: add more properties for texture initialization\n     * `sampler`, `name`, `extensions`, `extras`\n     * https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#texture\n     */\n    addTexture(texture) {\n        const { imageIndex } = texture;\n        const glTFTexture = {\n            source: imageIndex\n        };\n        this.json.textures = this.json.textures || [];\n        this.json.textures.push(glTFTexture);\n        return this.json.textures.length - 1;\n    }\n    /** Adds a material to the json part */\n    addMaterial(pbrMaterialInfo) {\n        this.json.materials = this.json.materials || [];\n        this.json.materials.push(pbrMaterialInfo);\n        return this.json.materials.length - 1;\n    }\n    /** Pack the binary chunk */\n    createBinaryChunk() {\n        // Allocate total array\n        const totalByteLength = this.byteLength;\n        const arrayBuffer = new ArrayBuffer(totalByteLength);\n        const targetArray = new Uint8Array(arrayBuffer);\n        // Copy each array into\n        let dstByteOffset = 0;\n        for (const sourceBuffer of this.sourceBuffers || []) {\n            dstByteOffset = copyToArray(sourceBuffer, targetArray, dstByteOffset);\n        }\n        // Update the glTF BIN CHUNK byte length\n        if (this.json?.buffers?.[0]) {\n            this.json.buffers[0].byteLength = totalByteLength;\n        }\n        else {\n            this.json.buffers = [{ byteLength: totalByteLength }];\n        }\n        // Save generated arrayBuffer\n        this.gltf.binary = arrayBuffer;\n        // Put arrayBuffer to sourceBuffers for possible additional writing data in the chunk\n        this.sourceBuffers = [arrayBuffer];\n        this.gltf.buffers = [{ arrayBuffer, byteOffset: 0, byteLength: arrayBuffer.byteLength }];\n    }\n    // PRIVATE\n    _removeStringFromArray(array, string) {\n        let found = true;\n        while (found) {\n            const index = array.indexOf(string);\n            if (index > -1) {\n                array.splice(index, 1);\n            }\n            else {\n                found = false;\n            }\n        }\n    }\n    /**\n     * Add attributes to buffers and create `attributes` object which is part of `mesh`\n     */\n    _addAttributes(attributes = {}) {\n        const result = {};\n        for (const attributeKey in attributes) {\n            const attributeData = attributes[attributeKey];\n            const attrName = this._getGltfAttributeName(attributeKey);\n            const accessor = this.addBinaryBuffer(attributeData.value, attributeData);\n            result[attrName] = accessor;\n        }\n        return result;\n    }\n    /**\n     * Add indices to buffers\n     */\n    _addIndices(indices) {\n        return this.addBinaryBuffer(indices, { size: 1 });\n    }\n    /**\n     * Deduce gltf specific attribue name from input attribute name\n     */\n    _getGltfAttributeName(attributeName) {\n        switch (attributeName.toLowerCase()) {\n            case 'position':\n            case 'positions':\n            case 'vertices':\n                return 'POSITION';\n            case 'normal':\n            case 'normals':\n                return 'NORMAL';\n            case 'color':\n            case 'colors':\n                return 'COLOR_0';\n            case 'texcoord':\n            case 'texcoords':\n                return 'TEXCOORD_0';\n            default:\n                return attributeName;\n        }\n    }\n    /**\n     * Calculate `min` and `max` arrays of accessor according to spec:\n     * https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#reference-accessor\n     */\n    _getAccessorMinMax(buffer, size) {\n        const result = { min: null, max: null };\n        if (buffer.length < size) {\n            return result;\n        }\n        // @ts-ignore\n        result.min = [];\n        // @ts-ignore\n        result.max = [];\n        const initValues = buffer.subarray(0, size);\n        for (const value of initValues) {\n            // @ts-ignore\n            result.min.push(value);\n            // @ts-ignore\n            result.max.push(value);\n        }\n        for (let index = size; index < buffer.length; index += size) {\n            for (let componentIndex = 0; componentIndex < size; componentIndex++) {\n                // @ts-ignore\n                result.min[0 + componentIndex] = Math.min(\n                // @ts-ignore\n                result.min[0 + componentIndex], buffer[index + componentIndex]);\n                // @ts-ignore\n                result.max[0 + componentIndex] = Math.max(\n                // @ts-ignore\n                result.max[0 + componentIndex], buffer[index + componentIndex]);\n            }\n        }\n        return result;\n    }\n}\n", "/**\n * loaders.gl, MIT license\n *\n * Shared code for 3DTiles extensions:\n * * EXT_feature_metadata\n * * EXT_mesh_features\n * * EXT_structural_metadata\n */\nimport { getComponentTypeFromArray } from \"../../gltf-utils/gltf-utils.js\";\nimport { getImageData } from '@loaders.gl/images';\nfunction emod(n) {\n    return ((n % 1) + 1) % 1;\n}\nconst ATTRIBUTE_TYPE_TO_COMPONENTS = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16,\n    BOOLEAN: 1,\n    STRING: 1,\n    ENUM: 1\n};\nconst ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY = {\n    INT8: Int8Array,\n    UINT8: Uint8Array,\n    INT16: Int16Array,\n    UINT16: Uint16Array,\n    INT32: Int32Array,\n    UINT32: Uint32Array,\n    INT64: BigInt64Array,\n    UINT64: BigUint64Array,\n    FLOAT32: Float32Array,\n    FLOAT64: Float64Array\n};\nconst ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE = {\n    INT8: 1,\n    UINT8: 1,\n    INT16: 2,\n    UINT16: 2,\n    INT32: 4,\n    UINT32: 4,\n    INT64: 8,\n    UINT64: 8,\n    FLOAT32: 4,\n    FLOAT64: 8\n};\nexport function getArrayElementByteSize(attributeType, componentType) {\n    return (ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[componentType] *\n        ATTRIBUTE_TYPE_TO_COMPONENTS[attributeType]);\n}\n/**\n * Gets offset array from `arrayOffsets` or `stringOffsets`.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param bufferViewIndex - Buffer view index\n * @param offsetType - The type of values in `arrayOffsets` or `stringOffsets`.\n * @param numberOfElements - The number of elements in each property array.\n * @returns Array of values offsets. The number of offsets in the array is equal to `numberOfElements` plus one.\n */\nexport function getOffsetsForProperty(scenegraph, bufferViewIndex, offsetType, numberOfElements) {\n    if (offsetType !== 'UINT8' &&\n        offsetType !== 'UINT16' &&\n        offsetType !== 'UINT32' &&\n        offsetType !== 'UINT64') {\n        return null;\n    }\n    const arrayOffsetsBytes = scenegraph.getTypedArrayForBufferView(bufferViewIndex);\n    const arrayOffsets = convertRawBufferToMetadataArray(arrayOffsetsBytes, 'SCALAR', // offsets consist of ONE component\n    offsetType, numberOfElements + 1 // The number of offsets is equal to the property table `count` plus one.\n    );\n    // We don't support BigInt offsets at the moment. It requires additional logic and potential issues in Safari\n    if (arrayOffsets instanceof BigInt64Array || arrayOffsets instanceof BigUint64Array) {\n        return null;\n    }\n    return arrayOffsets;\n}\n/**\n * Converts raw bytes that are in the buffer to an array of the type defined by the schema.\n * @param data - Raw bytes in the buffer.\n * @param attributeType - SCALAR, VECN, MATN.\n * @param componentType - Type of the component in elements, e.g. 'UINT8' or 'FLOAT32'.\n * @param elementCount - Number of elements in the array. Default value is 1.\n * @returns Data array\n */\nexport function convertRawBufferToMetadataArray(data, attributeType, componentType, elementCount = 1) {\n    const numberOfComponents = ATTRIBUTE_TYPE_TO_COMPONENTS[attributeType];\n    const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[componentType];\n    const size = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[componentType];\n    const length = elementCount * numberOfComponents;\n    const byteLength = length * size;\n    let buffer = data.buffer;\n    let offset = data.byteOffset;\n    if (offset % size !== 0) {\n        const bufferArray = new Uint8Array(buffer);\n        buffer = bufferArray.slice(offset, offset + byteLength).buffer;\n        offset = 0;\n    }\n    return new ArrayType(buffer, offset, length);\n}\n/**\n * Processes data encoded in the texture associated with the primitive.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param textureInfo - Reference to the texture where extension data are stored.\n * @param primitive - Primitive object in the mesh.\n * @returns Array of data taken. Null if data can't be taken from the texture.\n */\nexport function getPrimitiveTextureData(scenegraph, textureInfo, primitive) {\n    /*\n      texture.index is an index for the \"textures\" array.\n      The texture object referenced by this index looks like this:\n      {\n      \"sampler\": 0,\n      \"source\": 0\n      }\n      \"sampler\" is an index for the \"samplers\" array\n      \"source\" is an index for the \"images\" array that contains data stored in rgba channels of the image.\n  \n      texture.texCoord is a number-suffix (like 1) for an attribute like \"TEXCOORD_1\" in meshes.primitives\n      The value of \"TEXCOORD_1\" is an accessor that is used to get coordinates.\n      These coordinates are being used to get data from the image.\n      \n      Default for texture.texCoord is 0\n      @see https://github.com/CesiumGS/glTF/blob/3d-tiles-next/specification/2.0/schema/textureInfo.schema.json\n    */\n    const texCoordAccessorKey = `TEXCOORD_${textureInfo.texCoord || 0}`;\n    const texCoordAccessorIndex = primitive.attributes[texCoordAccessorKey];\n    const textureCoordinates = scenegraph.getTypedArrayForAccessor(texCoordAccessorIndex);\n    const json = scenegraph.gltf.json;\n    const textureIndex = textureInfo.index;\n    const imageIndex = json.textures?.[textureIndex]?.source;\n    if (typeof imageIndex !== 'undefined') {\n        const mimeType = json.images?.[imageIndex]?.mimeType;\n        const parsedImage = scenegraph.gltf.images?.[imageIndex];\n        // Checking for width is to prevent handling Un-processed images (e.g. [analyze] stage, where loadImages option is set to false)\n        if (parsedImage && typeof parsedImage.width !== 'undefined') {\n            const textureData = [];\n            for (let index = 0; index < textureCoordinates.length; index += 2) {\n                const value = getImageValueByCoordinates(parsedImage, mimeType, textureCoordinates, index, textureInfo.channels);\n                textureData.push(value);\n            }\n            return textureData;\n        }\n    }\n    return [];\n}\n/**\n * Puts property data to attributes.\n * It creates corresponding buffer, bufferView and accessor\n * so the data can be accessed like regular data stored in buffers.\n * @param scenegraph - Scenegraph object.\n * @param attributeName - Name of the attribute.\n * @param propertyData - Property data to store.\n * @param featureTable - Array where unique data from the property data are being stored.\n * @param primitive - Primitive object.\n */\nexport function primitivePropertyDataToAttributes(scenegraph, attributeName, propertyData, featureTable, primitive) {\n    // No reason to create an empty buffer if there is no property data to store.\n    if (!propertyData?.length) {\n        return;\n    }\n    /*\n      featureTable will contain unique values, e.g.\n      propertyData = [24, 35, 28, 24]\n      featureTable = [24, 35, 28]\n      featureIndices will contain indices that refer featureTextureTable, e.g.\n      featureIndices = [0, 1, 2, 0]\n    */\n    const featureIndices = [];\n    for (const texelData of propertyData) {\n        let index = featureTable.findIndex((item) => item === texelData);\n        if (index === -1) {\n            index = featureTable.push(texelData) - 1;\n        }\n        featureIndices.push(index);\n    }\n    const typedArray = new Uint32Array(featureIndices);\n    const bufferIndex = scenegraph.gltf.buffers.push({\n        arrayBuffer: typedArray.buffer,\n        byteOffset: typedArray.byteOffset,\n        byteLength: typedArray.byteLength\n    }) - 1;\n    const bufferViewIndex = scenegraph.addBufferView(typedArray, bufferIndex, 0);\n    const accessorIndex = scenegraph.addAccessor(bufferViewIndex, {\n        size: 1,\n        componentType: getComponentTypeFromArray(typedArray),\n        count: typedArray.length\n    });\n    primitive.attributes[attributeName] = accessorIndex;\n}\n/**\n * Gets the value from the texture by coordinates provided.\n * @param parsedImage - Image where the data are stored.\n * @param mimeType - MIME type.\n * @param textureCoordinates - uv coordinates to access data in the image.\n * @param index - Index of uv coordinates in the array textureCoordinates.\n * @param channels - Image channels where data are stored.\n *  Channels of an RGBA texture are numbered 0..3 respectively.\n *  For Ext_mesh_features and EXT_strucural_metadata the channels default is [0]\n *  @see https://github.com/CesiumGS/glTF/blob/3d-tiles-next/extensions/2.0/Vendor/EXT_mesh_features/schema/featureIdTexture.schema.json\n *  @see https://github.com/CesiumGS/glTF/blob/3d-tiles-next/extensions/2.0/Vendor/EXT_structural_metadata/schema/propertyTexture.property.schema.json\n * @returns Value taken from the image.\n */\nfunction getImageValueByCoordinates(parsedImage, mimeType, textureCoordinates, index, channels = [0]) {\n    const CHANNELS_MAP = {\n        r: { offset: 0, shift: 0 },\n        g: { offset: 1, shift: 8 },\n        b: { offset: 2, shift: 16 },\n        a: { offset: 3, shift: 24 }\n    };\n    const u = textureCoordinates[index];\n    const v = textureCoordinates[index + 1];\n    let components = 1;\n    if (mimeType && (mimeType.indexOf('image/jpeg') !== -1 || mimeType.indexOf('image/png') !== -1))\n        components = 4;\n    const offset = coordinatesToOffset(u, v, parsedImage, components);\n    let value = 0;\n    for (const c of channels) {\n        /*\n        According to the EXT_feature_metadata extension specification:\n          Channels are labeled by rgba and are swizzled with a string of 1-4 characters.\n        According to the EXT_mesh_features extension specification:\n          The channels array contains non-negative integer values corresponding to channels of the source texture that the feature ID consists of.\n          Channels of an RGBA texture are numbered 0\u20133 respectively.\n        Function getImageValueByCoordinates is used to process both extensions.\n        So, there should be possible to get the element of CHANNELS_MAP by either index (0, 1, 2, 3) or key (r, g, b, a).\n        */\n        const map = typeof c === 'number' ? Object.values(CHANNELS_MAP)[c] : CHANNELS_MAP[c];\n        const imageOffset = offset + map.offset;\n        const imageData = getImageData(parsedImage);\n        if (imageData.data.length <= imageOffset) {\n            throw new Error(`${imageData.data.length} <= ${imageOffset}`);\n        }\n        const imageValue = imageData.data[imageOffset];\n        value |= imageValue << map.shift;\n    }\n    return value;\n}\n/**\n * Retrieves the offset in the image where the data are stored.\n * @param u - u-coordinate.\n * @param v - v-coordinate.\n * @param parsedImage - Image where the data are stored.\n * @param componentsCount - Number of components the data consists of.\n * @returns Offset in the image where the data are stored.\n */\nfunction coordinatesToOffset(u, v, parsedImage, componentsCount = 1) {\n    const w = parsedImage.width;\n    const iX = emod(u) * (w - 1);\n    const indX = Math.round(iX);\n    const h = parsedImage.height;\n    const iY = emod(v) * (h - 1);\n    const indY = Math.round(iY);\n    const components = parsedImage.components ? parsedImage.components : componentsCount;\n    // components is a number of channels in the image\n    const offset = (indY * w + indX) * components;\n    return offset;\n}\n/**\n * Parses variable-length array data.\n * In this case every value of the property in the table will be an array\n * of arbitrary length.\n * @param valuesData - Values in a flat typed array.\n * @param numberOfElements - Number of rows in the property table.\n * @param arrayOffsets - Offsets of nested arrays in the flat values array.\n * @param valuesDataBytesLength - Data byte length.\n * @param valueSize - Value size in bytes.\n * @returns Array of typed arrays.\n */\nexport function parseVariableLengthArrayNumeric(valuesData, numberOfElements, arrayOffsets, valuesDataBytesLength, valueSize) {\n    const attributeValueArray = [];\n    for (let index = 0; index < numberOfElements; index++) {\n        const arrayOffset = arrayOffsets[index];\n        const arrayByteSize = arrayOffsets[index + 1] - arrayOffsets[index];\n        if (arrayByteSize + arrayOffset > valuesDataBytesLength) {\n            break;\n        }\n        const typedArrayOffset = arrayOffset / valueSize;\n        const elementCount = arrayByteSize / valueSize;\n        attributeValueArray.push(valuesData.slice(typedArrayOffset, typedArrayOffset + elementCount));\n    }\n    return attributeValueArray;\n}\n/**\n * Parses fixed-length array data.\n * In this case every value of the property in the table will be an array\n * of constant length equal to `arrayCount`.\n * @param valuesData - Values in a flat typed array.\n * @param numberOfElements - Number of rows in the property table.\n * @param arrayCount - Nested arrays length.\n * @returns Array of typed arrays.\n */\nexport function parseFixedLengthArrayNumeric(valuesData, numberOfElements, arrayCount) {\n    const attributeValueArray = [];\n    for (let index = 0; index < numberOfElements; index++) {\n        const elementOffset = index * arrayCount;\n        attributeValueArray.push(valuesData.slice(elementOffset, elementOffset + arrayCount));\n    }\n    return attributeValueArray;\n}\n/**\n * Decodes properties of string type from binary source.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param valuesDataBytes - Data taken from values property of the property table property.\n * @param arrayOffsets - Offsets for variable-length arrays. It's null for fixed-length arrays or scalar types.\n * @param stringOffsets - Index of the buffer view containing offsets for strings. It should be available for string type.\n * @returns String property values\n */\nexport function getPropertyDataString(numberOfElements, valuesDataBytes, arrayOffsets, stringOffsets) {\n    if (arrayOffsets) {\n        // TODO: implement it as soon as we have the corresponding tileset\n        throw new Error('Not implemented - arrayOffsets for strings is specified');\n    }\n    if (stringOffsets) {\n        const stringsArray = [];\n        const textDecoder = new TextDecoder('utf8');\n        let stringOffset = 0;\n        for (let index = 0; index < numberOfElements; index++) {\n            const stringByteSize = stringOffsets[index + 1] - stringOffsets[index];\n            if (stringByteSize + stringOffset <= valuesDataBytes.length) {\n                const stringData = valuesDataBytes.subarray(stringOffset, stringByteSize + stringOffset);\n                const stringAttribute = textDecoder.decode(stringData);\n                stringsArray.push(stringAttribute);\n                stringOffset += stringByteSize;\n            }\n        }\n        return stringsArray;\n    }\n    return [];\n}\n", "import { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nimport { convertRawBufferToMetadataArray, getPrimitiveTextureData, primitivePropertyDataToAttributes, getArrayElementByteSize, getOffsetsForProperty, parseVariableLengthArrayNumeric, parseFixedLengthArrayNumeric, getPropertyDataString } from \"./utils/3d-tiles-utils.js\";\nconst EXT_STRUCTURAL_METADATA_NAME = 'EXT_structural_metadata';\nexport const name = EXT_STRUCTURAL_METADATA_NAME;\nexport async function decode(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    decodeExtStructuralMetadata(scenegraph, options);\n}\nexport function encode(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    encodeExtStructuralMetadata(scenegraph, options);\n    scenegraph.createBinaryChunk();\n    return scenegraph.gltf;\n}\n/*\n// Example of the extension.\n// See more info at https://github.com/CesiumGS/glTF/tree/3d-tiles-next/extensions/2.0/Vendor/EXT_structural_metadata\nconst extensions = {\n  \"extensions\": {\n    \"EXT_structural_metadata\": {\n      \"schema\": {\n        \"classes\": {\n          \"tree\": {\n            \"name\": \"Tree\",\n            \"description\": \"Woody, perennial plant.\",\n            \"properties\": {\n              \"species\": {\n                \"description\": \"Type of tree.\",\n                \"type\": \"ENUM\",\n                \"enumType\": \"speciesEnum\",\n                \"required\": true\n              },\n              \"age\": {\n                \"description\": \"The age of the tree, in years\",\n                \"type\": \"SCALAR\",\n                \"componentType\": \"UINT8\",\n                \"required\": true\n              }\n            }\n          }\n        },\n        \"enums\": {\n          \"speciesEnum\": {\n            \"name\": \"Species\",\n            \"description\": \"An example enum for tree species.\",\n            // valueType is not defined here. Default is \"UINT16\"\n            \"values\": [\n              { \"name\": \"Unspecified\", \"value\": 0 },\n              { \"name\": \"Oak\", \"value\": 1 }\n            ]\n          }\n        }\n      },\n      \"propertyTables\": [{\n        \"name\": \"tree_survey_2021-09-29\",\n        \"class\": \"tree\",\n        \"count\": 10,  // The number of elements in each property array (in `species`, in `age`).\n        \"properties\": {\n          \"species\": {\n            \"values\": 0, // It's an index of the buffer view containing property values.\n          },\n          \"age\": {\n            \"values\": 1\n          }\n        }\n      }]\n    }\n  }\n}\n*/\n/**\n * Decodes feature metadata from extension.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param options - GLTFLoader options.\n */\nfunction decodeExtStructuralMetadata(scenegraph, options) {\n    // Decoding metadata involves buffers processing.\n    // So, if buffers have not been loaded, there is no reason to process metadata.\n    if (!options.gltf?.loadBuffers) {\n        return;\n    }\n    const extension = scenegraph.getExtension(EXT_STRUCTURAL_METADATA_NAME);\n    if (!extension) {\n        return;\n    }\n    if (options.gltf?.loadImages) {\n        decodePropertyTextures(scenegraph, extension);\n    }\n    decodePropertyTables(scenegraph, extension);\n}\n/**\n * Processes the data stored in the textures\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param extension - Top-level extension.\n */\nfunction decodePropertyTextures(scenegraph, extension) {\n    const propertyTextures = extension.propertyTextures;\n    const json = scenegraph.gltf.json;\n    if (propertyTextures && json.meshes) {\n        // Iterate through all meshes/primitives.\n        for (const mesh of json.meshes) {\n            for (const primitive of mesh.primitives) {\n                processPrimitivePropertyTextures(scenegraph, propertyTextures, primitive, extension);\n            }\n        }\n    }\n}\n/**\n * Processes the data stored in the property tables.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param extension - Top-level extension.\n */\nfunction decodePropertyTables(scenegraph, extension) {\n    const schema = extension.schema;\n    if (!schema) {\n        return;\n    }\n    const schemaClasses = schema.classes;\n    const propertyTables = extension.propertyTables;\n    if (schemaClasses && propertyTables) {\n        for (const schemaName in schemaClasses) {\n            const propertyTable = findPropertyTableByClass(propertyTables, schemaName);\n            if (propertyTable) {\n                processPropertyTable(scenegraph, schema, propertyTable);\n            }\n        }\n    }\n}\n/**\n * Finds the property table by class name.\n * @param propertyTables - propertyTable definition taken from the top-level extension.\n * @param schemaClassName - class name in the extension schema.\n */\nfunction findPropertyTableByClass(propertyTables, schemaClassName) {\n    for (const propertyTable of propertyTables) {\n        if (propertyTable.class === schemaClassName) {\n            return propertyTable;\n        }\n    }\n    return null;\n}\n/**\n * Takes data from property textures reffered by the primitive.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param propertyTextures - propertyTexture definition taken from the top-level extention.\n * @param primitive - Primitive object.\n * @param extension - Top-level extension.\n */\nfunction processPrimitivePropertyTextures(scenegraph, propertyTextures, primitive, extension) {\n    if (!propertyTextures) {\n        return;\n    }\n    const primitiveExtension = primitive.extensions?.[EXT_STRUCTURAL_METADATA_NAME];\n    const primitivePropertyTextureIndices = primitiveExtension?.propertyTextures;\n    if (!primitivePropertyTextureIndices) {\n        return;\n    }\n    for (const primitivePropertyTextureIndex of primitivePropertyTextureIndices) {\n        const propertyTexture = propertyTextures[primitivePropertyTextureIndex];\n        processPrimitivePropertyTexture(scenegraph, propertyTexture, primitive, extension);\n    }\n}\n/**\n * Takes property data from the texture pointed by the primitive and appends them to `exension.data`.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param propertyTexture - propertyTexture definition taken from the top-level extension.\n * @param primitive - Primitive object.\n * @param extension - Top-level extension.\n */\nfunction processPrimitivePropertyTexture(scenegraph, propertyTexture, primitive, extension) {\n    if (!propertyTexture.properties) {\n        return;\n    }\n    if (!extension.dataAttributeNames) {\n        extension.dataAttributeNames = [];\n    }\n    /* Iterate through all properties defined in propertyTexture, e.g. \"speed\" and \"direction\":\n      {\n        \"class\": \"wind\",\n        \"properties\": {\n          \"speed\": {\n            \"index\": 0,\n            \"texCoord\": 0,\n            \"channels\": [0]\n          },\n          \"direction\": {\n            \"index\": 0,\n            \"texCoord\": 0,\n            \"channels\": [1, 2]\n          }\n        }\n      }\n    */\n    const className = propertyTexture.class;\n    for (const propertyName in propertyTexture.properties) {\n        // propertyName has values like \"speed\", \"direction\"\n        // Make attributeName as a combination of the class name and the propertyName like \"wind_speed\" or \"wind_direction\"\n        const attributeName = `${className}_${propertyName}`;\n        const textureInfoTopLevel = propertyTexture.properties?.[propertyName];\n        if (!textureInfoTopLevel) {\n            // eslint-disable-next-line no-continue\n            continue;\n        }\n        // The data taken from all meshes/primitives (the same property, e.g. \"speed\" or \"direction\") will be combined into one array and saved in textureInfoTopLevel.data\n        // Initially textureInfoTopLevel.data will be initialized with an empty array.\n        if (!textureInfoTopLevel.data) {\n            textureInfoTopLevel.data = [];\n        }\n        const featureTextureTable = textureInfoTopLevel.data;\n        const propertyData = getPrimitiveTextureData(scenegraph, textureInfoTopLevel, primitive);\n        if (propertyData === null) {\n            // eslint-disable-next-line no-continue\n            continue;\n        }\n        primitivePropertyDataToAttributes(scenegraph, attributeName, propertyData, featureTextureTable, primitive);\n        textureInfoTopLevel.data = featureTextureTable;\n        extension.dataAttributeNames.push(attributeName);\n    }\n}\n/**\n * Navigates through all properies in the property table, gets properties data,\n * and put the data to `propertyTable.data` as an array.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param schema - schema object.\n * @param propertyTable - propertyTable definition taken from the top-level extension.\n */\nfunction processPropertyTable(scenegraph, schema, propertyTable) {\n    const schemaClass = schema.classes?.[propertyTable.class];\n    if (!schemaClass) {\n        throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${propertyTable.class}`);\n    }\n    const numberOfElements = propertyTable.count; // `propertyTable.count` is a number of elements in each property array.\n    for (const propertyName in schemaClass.properties) {\n        const classProperty = schemaClass.properties[propertyName];\n        const propertyTableProperty = propertyTable.properties?.[propertyName];\n        if (propertyTableProperty) {\n            // Getting all elements (`numberOfElements`) of the array in the `propertyTableProperty`\n            const data = getPropertyDataFromBinarySource(scenegraph, schema, classProperty, numberOfElements, propertyTableProperty);\n            propertyTableProperty.data = data;\n        }\n    }\n}\n/**\n * Decodes a propertyTable column from binary source based on property type.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param schema - Schema object.\n * @param classProperty - class property object.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param propertyTableProperty - propertyTable's property metadata.\n * @returns {string[] | number[] | string[][] | number[][]}\n */\nfunction getPropertyDataFromBinarySource(scenegraph, schema, classProperty, numberOfElements, propertyTableProperty) {\n    let data = [];\n    const valuesBufferView = propertyTableProperty.values;\n    const valuesDataBytes = scenegraph.getTypedArrayForBufferView(valuesBufferView);\n    const arrayOffsets = getArrayOffsetsForProperty(scenegraph, classProperty, propertyTableProperty, numberOfElements);\n    const stringOffsets = getStringOffsetsForProperty(scenegraph, propertyTableProperty, numberOfElements);\n    switch (classProperty.type) {\n        case 'SCALAR':\n        case 'VEC2':\n        case 'VEC3':\n        case 'VEC4':\n        case 'MAT2':\n        case 'MAT3':\n        case 'MAT4': {\n            data = getPropertyDataNumeric(classProperty, numberOfElements, valuesDataBytes, arrayOffsets);\n            break;\n        }\n        case 'BOOLEAN': {\n            // TODO: implement it as soon as we have the corresponding tileset\n            throw new Error(`Not implemented - classProperty.type=${classProperty.type}`);\n        }\n        case 'STRING': {\n            data = getPropertyDataString(numberOfElements, valuesDataBytes, arrayOffsets, stringOffsets);\n            break;\n        }\n        case 'ENUM': {\n            data = getPropertyDataENUM(schema, classProperty, numberOfElements, valuesDataBytes, arrayOffsets);\n            break;\n        }\n        default:\n            throw new Error(`Unknown classProperty type ${classProperty.type}`);\n    }\n    return data;\n}\n/**\n * Parses propertyTable.property.arrayOffsets that are offsets of sub-arrays in a flatten array of values.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param classProperty - class property object.\n * @param propertyTableProperty - propertyTable's property metadata.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @returns Typed array with offset values.\n * @see https://github.com/CesiumGS/glTF/blob/2976f1183343a47a29e4059a70961371cd2fcee8/extensions/2.0/Vendor/EXT_structural_metadata/schema/propertyTable.property.schema.json#L21\n */\nfunction getArrayOffsetsForProperty(scenegraph, classProperty, propertyTableProperty, numberOfElements) {\n    if (classProperty.array &&\n        // `count` is a number of array elements. May only be defined when `array` is true.\n        // If `count` is NOT defined, it's a VARIABLE-length array\n        typeof classProperty.count === 'undefined' &&\n        // `arrayOffsets` is an index of the buffer view containing offsets for variable-length arrays.\n        typeof propertyTableProperty.arrayOffsets !== 'undefined') {\n        // Data are in a VARIABLE-length array\n        return getOffsetsForProperty(scenegraph, propertyTableProperty.arrayOffsets, propertyTableProperty.arrayOffsetType || 'UINT32', numberOfElements);\n    }\n    return null;\n}\n/**\n * Parses propertyTable.property.stringOffsets.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param propertyTableProperty - propertyTable's property metadata.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @returns Typed array with offset values.\n * @see https://github.com/CesiumGS/glTF/blob/2976f1183343a47a29e4059a70961371cd2fcee8/extensions/2.0/Vendor/EXT_structural_metadata/schema/propertyTable.property.schema.json#L29C10-L29C23\n */\nfunction getStringOffsetsForProperty(scenegraph, propertyTableProperty, numberOfElements) {\n    if (typeof propertyTableProperty.stringOffsets !== 'undefined' // `stringOffsets` is an index of the buffer view containing offsets for strings.\n    ) {\n        // Data are in a FIXED-length array\n        return getOffsetsForProperty(scenegraph, propertyTableProperty.stringOffsets, propertyTableProperty.stringOffsetType || 'UINT32', numberOfElements);\n    }\n    return null;\n}\n/**\n * Decodes properties of SCALAR, VEC-N, MAT-N types from binary sourse.\n * @param classProperty - class property object.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param valuesDataBytes - Data taken from values property of the property table property.\n * @param arrayOffsets - Offsets for variable-length arrays. It's null for fixed-length arrays or scalar types.\n * @returns Property values in a typed array or in an array of typed arrays.\n */\nfunction getPropertyDataNumeric(classProperty, numberOfElements, valuesDataBytes, arrayOffsets) {\n    const isArray = classProperty.array;\n    const arrayCount = classProperty.count;\n    const elementSize = getArrayElementByteSize(classProperty.type, classProperty.componentType);\n    const elementCount = valuesDataBytes.byteLength / elementSize;\n    let valuesData;\n    if (classProperty.componentType) {\n        valuesData = convertRawBufferToMetadataArray(valuesDataBytes, classProperty.type, \n        // The datatype of the element's components. Only applicable to `SCALAR`, `VECN`, and `MATN` types.\n        classProperty.componentType, elementCount);\n    }\n    else {\n        // The spec doesn't provide any info what to do if componentType is not set.\n        valuesData = valuesDataBytes;\n    }\n    if (isArray) {\n        if (arrayOffsets) {\n            // VARIABLE-length array\n            return parseVariableLengthArrayNumeric(valuesData, numberOfElements, arrayOffsets, valuesDataBytes.length, elementSize);\n        }\n        if (arrayCount) {\n            // FIXED-length array\n            return parseFixedLengthArrayNumeric(valuesData, numberOfElements, arrayCount);\n        }\n        return [];\n    }\n    return valuesData;\n}\n/**\n * Decodes properties of enum type from binary source.\n * @param schema - Schema object.\n * @param classProperty - Class property object.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param valuesDataBytes - Data taken from values property of the property table property.\n * @param arrayOffsets - Offsets for variable-length arrays. It's null for fixed-length arrays or scalar types.\n * @returns Strings array of nested strings array.\n */\nfunction getPropertyDataENUM(schema, classProperty, numberOfElements, valuesDataBytes, arrayOffsets) {\n    const enumType = classProperty.enumType;\n    // Enum ID as declared in the `enums` dictionary. Required when `type` is `ENUM`.\n    if (!enumType) {\n        throw new Error('Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM');\n    }\n    const enumEntry = schema.enums?.[enumType];\n    if (!enumEntry) {\n        throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${enumType}`);\n    }\n    const enumValueType = enumEntry.valueType || 'UINT16';\n    const elementSize = getArrayElementByteSize(classProperty.type, enumValueType);\n    const elementCount = valuesDataBytes.byteLength / elementSize;\n    let valuesData = convertRawBufferToMetadataArray(valuesDataBytes, classProperty.type, enumValueType, elementCount);\n    if (!valuesData) {\n        valuesData = valuesDataBytes;\n    }\n    if (classProperty.array) {\n        if (arrayOffsets) {\n            // VARIABLE-length array\n            return parseVariableLengthArrayENUM({\n                valuesData,\n                numberOfElements,\n                arrayOffsets,\n                valuesDataBytesLength: valuesDataBytes.length,\n                elementSize,\n                enumEntry\n            });\n        }\n        const arrayCount = classProperty.count;\n        if (arrayCount) {\n            // FIXED-length array\n            return parseFixedLengthArrayENUM(valuesData, numberOfElements, arrayCount, enumEntry);\n        }\n        return [];\n    }\n    // Single value (not an array)\n    return getEnumsArray(valuesData, 0, numberOfElements, enumEntry);\n}\n/**\n * Parses variable length nested ENUM arrays.\n * @param params.valuesData - Values in a flat typed array.\n * @param params.numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param params.arrayOffsets - Offsets for variable-length arrays. It's null for fixed-length arrays or scalar types.\n * @param params.valuesDataBytesLength - Byte length of values array.\n * @param params.elementSize - Single element byte size.\n * @param params.enumEntry - Enums dictionary.\n * @returns Nested strings array.\n */\nfunction parseVariableLengthArrayENUM(params) {\n    const { valuesData, numberOfElements, arrayOffsets, valuesDataBytesLength, elementSize, enumEntry } = params;\n    const attributeValueArray = [];\n    for (let index = 0; index < numberOfElements; index++) {\n        const arrayOffset = arrayOffsets[index];\n        const arrayByteSize = arrayOffsets[index + 1] - arrayOffsets[index];\n        if (arrayByteSize + arrayOffset > valuesDataBytesLength) {\n            break;\n        }\n        const typedArrayOffset = arrayOffset / elementSize;\n        const elementCount = arrayByteSize / elementSize;\n        const array = getEnumsArray(valuesData, typedArrayOffset, elementCount, enumEntry);\n        attributeValueArray.push(array);\n    }\n    return attributeValueArray;\n}\n/**\n * Parses fixed length ENUM arrays.\n * @param valuesData - Values in a flat typed array.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param arrayCount - Nested arrays length.\n * @param enumEntry - Enums dictionary.\n * @returns Nested strings array.\n */\nfunction parseFixedLengthArrayENUM(valuesData, numberOfElements, arrayCount, enumEntry) {\n    const attributeValueArray = [];\n    for (let index = 0; index < numberOfElements; index++) {\n        const elementOffset = arrayCount * index;\n        const array = getEnumsArray(valuesData, elementOffset, arrayCount, enumEntry);\n        attributeValueArray.push(array);\n    }\n    return attributeValueArray;\n}\n/**\n * Parses ENUM values into a string array.\n * @param valuesData - Values in a flat typed array.\n * @param offset - Offset to start parse from.\n * @param count - Values length to parse.\n * @param enumEntry - Enums dictionary.\n * @returns Array of strings with parsed ENUM names.\n */\nfunction getEnumsArray(valuesData, offset, count, enumEntry) {\n    const array = [];\n    for (let i = 0; i < count; i++) {\n        // At the moment we don't support BigInt. It requires additional calculations logic\n        // and might be an issue in Safari\n        if (valuesData instanceof BigInt64Array || valuesData instanceof BigUint64Array) {\n            array.push('');\n        }\n        else {\n            const value = valuesData[offset + i];\n            const enumObject = getEnumByValue(enumEntry, value);\n            if (enumObject) {\n                array.push(enumObject.name);\n            }\n            else {\n                array.push('');\n            }\n        }\n    }\n    return array;\n}\n/**\n * Looks up ENUM whose `value` property matches the specified number in the parameter `value`.\n * @param {GLTF_EXT_structural_metadata_Enum} enumEntry - ENUM entry containing the array of possible enums.\n * @param {number} value - The value of the ENUM to locate.\n * @returns {GLTF_EXT_structural_metadata_EnumValue | null} ENUM matcihng the specified value or null of no ENUM object was found.\n */\nfunction getEnumByValue(enumEntry, value) {\n    for (const enumValue of enumEntry.values) {\n        if (enumValue.value === value) {\n            return enumValue;\n        }\n    }\n    return null;\n}\nconst SCHEMA_CLASS_ID_DEFAULT = 'schemaClassId';\nfunction encodeExtStructuralMetadata(scenegraph, options) {\n    const extension = scenegraph.getExtension(EXT_STRUCTURAL_METADATA_NAME);\n    if (!extension) {\n        return;\n    }\n    if (extension.propertyTables) {\n        for (const table of extension.propertyTables) {\n            const classId = table.class;\n            const schemaClass = extension.schema?.classes?.[classId];\n            if (table.properties && schemaClass) {\n                encodeProperties(table, schemaClass, scenegraph);\n            }\n        }\n    }\n}\nfunction encodeProperties(table, schemaClass, scenegraph) {\n    for (const propertyName in table.properties) {\n        const data = table.properties[propertyName].data;\n        if (data) {\n            const classProperty = schemaClass.properties[propertyName];\n            if (classProperty) {\n                const tableProperty = createPropertyTableProperty(data, classProperty, scenegraph);\n                // Override table property that came with \"data\"\n                table.properties[propertyName] = tableProperty;\n            }\n        }\n    }\n}\n/**\n * Creates ExtStructuralMetadata, creates the schema and creates a property table containing feature data provided.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param propertyAttributes - property attributes\n * @param classId - classId to use for encoding metadata.\n * @returns Index of the table created.\n */\nexport function createExtStructuralMetadata(scenegraph, propertyAttributes, classId = SCHEMA_CLASS_ID_DEFAULT) {\n    let extension = scenegraph.getExtension(EXT_STRUCTURAL_METADATA_NAME);\n    if (!extension) {\n        extension = scenegraph.addExtension(EXT_STRUCTURAL_METADATA_NAME);\n    }\n    extension.schema = createSchema(propertyAttributes, classId, extension.schema);\n    const table = createPropertyTable(propertyAttributes, classId, extension.schema);\n    if (!extension.propertyTables) {\n        extension.propertyTables = [];\n    }\n    return extension.propertyTables.push(table) - 1; // index of the table\n}\nfunction createSchema(propertyAttributes, classId, schemaToUpdate) {\n    const schema = schemaToUpdate ?? {\n        id: 'schema_id'\n    };\n    const schemaClass = {\n        properties: {}\n    };\n    for (const attribute of propertyAttributes) {\n        const classProperty = {\n            type: attribute.elementType,\n            componentType: attribute.componentType\n        };\n        schemaClass.properties[attribute.name] = classProperty;\n    }\n    schema.classes = {};\n    schema.classes[classId] = schemaClass;\n    return schema;\n}\nfunction createPropertyTable(propertyAttributes, classId, schema) {\n    const table = {\n        class: classId,\n        count: 0\n    };\n    // count is a number of rows in the table\n    let count = 0;\n    const schemaClass = schema.classes?.[classId];\n    for (const attribute of propertyAttributes) {\n        if (count === 0) {\n            count = attribute.values.length;\n        }\n        // The number of elements in all propertyAttributes must be the same\n        if (count !== attribute.values.length && attribute.values.length) {\n            throw new Error('Illegal values in attributes');\n        }\n        const classProperty = schemaClass?.properties[attribute.name];\n        if (classProperty) {\n            // const tableProperty = createPropertyTableProperty(attribute, classProperty, scenegraph);\n            if (!table.properties) {\n                table.properties = {};\n            }\n            // values is a required field. Its real value will be set while encoding data\n            table.properties[attribute.name] = { values: 0, data: attribute.values };\n        }\n    }\n    table.count = count;\n    return table;\n}\nfunction createPropertyTableProperty(\n// attribute: PropertyAttribute,\nvalues, classProperty, scenegraph) {\n    const prop = { values: 0 };\n    if (classProperty.type === 'STRING') {\n        const { stringData, stringOffsets } = createPropertyDataString(values);\n        prop.stringOffsets = createBufferView(stringOffsets, scenegraph);\n        prop.values = createBufferView(stringData, scenegraph);\n    }\n    else if (classProperty.type === 'SCALAR' && classProperty.componentType) {\n        const data = createPropertyDataScalar(values, classProperty.componentType);\n        prop.values = createBufferView(data, scenegraph);\n    }\n    return prop;\n}\nconst COMPONENT_TYPE_TO_ARRAY_CONSTRUCTOR = {\n    INT8: Int8Array,\n    UINT8: Uint8Array,\n    INT16: Int16Array,\n    UINT16: Uint16Array,\n    INT32: Int32Array,\n    UINT32: Uint32Array,\n    INT64: Int32Array,\n    UINT64: Uint32Array,\n    FLOAT32: Float32Array,\n    FLOAT64: Float64Array\n};\nfunction createPropertyDataScalar(array, componentType) {\n    const numberArray = [];\n    for (const value of array) {\n        numberArray.push(Number(value));\n    }\n    const Construct = COMPONENT_TYPE_TO_ARRAY_CONSTRUCTOR[componentType];\n    if (!Construct) {\n        throw new Error('Illegal component type');\n    }\n    return new Construct(numberArray);\n}\nfunction createPropertyDataString(strings) {\n    const utf8Encode = new TextEncoder();\n    const arr = [];\n    let len = 0;\n    for (const str of strings) {\n        const uint8Array = utf8Encode.encode(str);\n        len += uint8Array.length;\n        arr.push(uint8Array);\n    }\n    const strArray = new Uint8Array(len);\n    const strOffsets = [];\n    let offset = 0;\n    for (const str of arr) {\n        strArray.set(str, offset);\n        strOffsets.push(offset);\n        offset += str.length;\n    }\n    strOffsets.push(offset); // The last offset represents the byte offset after the last string.\n    const stringOffsetsTypedArray = new Uint32Array(strOffsets); // Its length = len+1\n    return { stringData: strArray, stringOffsets: stringOffsetsTypedArray };\n}\nfunction createBufferView(typedArray, scenegraph) {\n    scenegraph.gltf.buffers.push({\n        arrayBuffer: typedArray.buffer,\n        byteOffset: typedArray.byteOffset,\n        byteLength: typedArray.byteLength\n    });\n    return scenegraph.addBufferView(typedArray);\n}\n", "import { GLTFScenegraph } from \"../../api/gltf-scenegraph.js\";\nimport { convertRawBufferToMetadataArray, getPrimitiveTextureData, primitivePropertyDataToAttributes, getArrayElementByteSize, getOffsetsForProperty, parseVariableLengthArrayNumeric, parseFixedLengthArrayNumeric, getPropertyDataString } from \"../utils/3d-tiles-utils.js\";\n/** Extension name */\nconst EXT_FEATURE_METADATA_NAME = 'EXT_feature_metadata';\nexport const name = EXT_FEATURE_METADATA_NAME;\nexport async function decode(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    decodeExtFeatureMetadata(scenegraph, options);\n}\n/**\n * Decodes feature metadata from extension.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param options - GLTFLoader options.\n */\nfunction decodeExtFeatureMetadata(scenegraph, options) {\n    // Decoding metadata involves buffers processing.\n    // So, if buffers have not been loaded, there is no reason to process metadata.\n    if (!options.gltf?.loadBuffers) {\n        return;\n    }\n    const extension = scenegraph.getExtension(EXT_FEATURE_METADATA_NAME);\n    if (!extension) {\n        return;\n    }\n    if (options.gltf?.loadImages) {\n        decodePropertyTextures(scenegraph, extension);\n    }\n    decodePropertyTables(scenegraph, extension);\n}\n/**\n * Processes the data stored in the textures\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param extension - Top-level extension.\n */\nfunction decodePropertyTextures(scenegraph, extension) {\n    const schema = extension.schema;\n    if (!schema) {\n        return;\n    }\n    const schemaClasses = schema.classes;\n    const { featureTextures } = extension;\n    if (schemaClasses && featureTextures) {\n        for (const schemaName in schemaClasses) {\n            const schemaClass = schemaClasses[schemaName];\n            const featureTexture = findFeatureTextureByClass(featureTextures, schemaName);\n            if (featureTexture) {\n                handleFeatureTextureProperties(scenegraph, featureTexture, schemaClass);\n            }\n        }\n    }\n}\n/**\n * Processes the data stored in the property tables.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param extension - Top-level extension.\n */\nfunction decodePropertyTables(scenegraph, extension) {\n    const schema = extension.schema;\n    if (!schema) {\n        return;\n    }\n    const schemaClasses = schema.classes;\n    const propertyTables = extension.featureTables;\n    if (schemaClasses && propertyTables) {\n        for (const schemaName in schemaClasses) {\n            const propertyTable = findPropertyTableByClass(propertyTables, schemaName);\n            if (propertyTable) {\n                processPropertyTable(scenegraph, schema, propertyTable);\n            }\n        }\n    }\n}\n/**\n * Finds the property table by class name.\n * @param propertyTables - propertyTable definition taken from the top-level extension.\n * @param schemaClassName - class name in the extension schema.\n */\nfunction findPropertyTableByClass(propertyTables, schemaClassName) {\n    for (const propertyTableName in propertyTables) {\n        const propertyTable = propertyTables[propertyTableName];\n        if (propertyTable.class === schemaClassName) {\n            return propertyTable;\n        }\n    }\n    return null;\n}\nfunction findFeatureTextureByClass(featureTextures, schemaClassName) {\n    for (const featureTexturesName in featureTextures) {\n        const featureTable = featureTextures[featureTexturesName];\n        if (featureTable.class === schemaClassName) {\n            return featureTable;\n        }\n    }\n    return null;\n}\n/**\n * Navigates through all properies in the property table, gets properties data,\n * and put the data to `propertyTable.data` as an array.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param schema - schema object.\n * @param propertyTable - propertyTable definition taken from the top-level extension.\n */\nfunction processPropertyTable(scenegraph, schema, propertyTable) {\n    // Though 'class' is not required by spec, it doesn't make any scence when it's not provided.\n    // So, bale out here.\n    if (!propertyTable.class) {\n        return;\n    }\n    const schemaClass = schema.classes?.[propertyTable.class];\n    if (!schemaClass) {\n        throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${propertyTable.class}`);\n    }\n    const numberOfElements = propertyTable.count; // `propertyTable.count` is a number of elements in each property array.\n    for (const propertyName in schemaClass.properties) {\n        const classProperty = schemaClass.properties[propertyName];\n        const propertyTableProperty = propertyTable.properties?.[propertyName];\n        if (propertyTableProperty) {\n            // Getting all elements (`numberOfElements`) of the array in the `propertyTableProperty`\n            const data = getPropertyDataFromBinarySource(scenegraph, schema, classProperty, numberOfElements, propertyTableProperty);\n            propertyTableProperty.data = data;\n        }\n    }\n}\n/**\n * Navigates through all properies in feature texture and gets properties data.\n * Data will be stored in featureTexture.properties[propertyName].data.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param featureTexture\n * @param schemaClass\n */\nfunction handleFeatureTextureProperties(scenegraph, featureTexture, schemaClass) {\n    const attributeName = featureTexture.class;\n    for (const propertyName in schemaClass.properties) {\n        const featureTextureProperty = featureTexture?.properties?.[propertyName];\n        if (featureTextureProperty) {\n            const data = getPropertyDataFromTexture(scenegraph, featureTextureProperty, attributeName);\n            featureTextureProperty.data = data;\n        }\n    }\n}\n/**\n * Decodes properties from binary sourse based on property type.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param schemaProperty\n * @param numberOfFeatures\n * @param featureTableProperty\n */\nfunction getPropertyDataFromBinarySource(scenegraph, schema, classProperty, numberOfFeatures, featureTableProperty) {\n    let data = [];\n    const bufferView = featureTableProperty.bufferView;\n    const dataArray = scenegraph.getTypedArrayForBufferView(bufferView);\n    const arrayOffsets = getArrayOffsetsForProperty(scenegraph, classProperty, featureTableProperty, numberOfFeatures);\n    const stringOffsets = getStringOffsetsForProperty(scenegraph, classProperty, featureTableProperty, numberOfFeatures);\n    if (classProperty.type === 'STRING' || classProperty.componentType === 'STRING') {\n        data = getPropertyDataString(numberOfFeatures, dataArray, arrayOffsets, stringOffsets);\n    }\n    else if (isNumericProperty(classProperty)) {\n        data = getPropertyDataNumeric(classProperty, numberOfFeatures, dataArray, arrayOffsets);\n    }\n    return data;\n}\n/**\n * Parses propertyTable.property.arrayOffsets that are offsets of sub-arrays in a flatten array of values.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param classProperty - class property object.\n * @param propertyTableProperty - propertyTable's property metadata.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @returns Typed array with offset values.\n * @see https://github.com/CesiumGS/glTF/blob/2976f1183343a47a29e4059a70961371cd2fcee8/extensions/2.0/Vendor/EXT_structural_metadata/schema/propertyTable.property.schema.json#L21\n */\nfunction getArrayOffsetsForProperty(scenegraph, classProperty, propertyTableProperty, numberOfElements) {\n    /*\n     If ARRAY is used, then componentType must also be specified.\n     ARRAY is a fixed-length array when componentCount is defined, and variable-length otherwise.\n  */\n    if (classProperty.type === 'ARRAY' &&\n        // `componentCount` is a number of fixed-length array elements.\n        // If `componentCount` is NOT defined, it's a VARIABLE-length array\n        typeof classProperty.componentCount === 'undefined' &&\n        // `arrayOffsetBufferView` is an index of the buffer view containing offsets for variable-length arrays.\n        typeof propertyTableProperty.arrayOffsetBufferView !== 'undefined') {\n        // Data are in a VARIABLE-length array\n        return getOffsetsForProperty(scenegraph, propertyTableProperty.arrayOffsetBufferView, propertyTableProperty.offsetType || 'UINT32', // offsetType is used both for stringOffsetBufferView and arrayOffsetBufferView\n        numberOfElements);\n    }\n    return null;\n}\n/**\n * Parses featureTable.property.stringOffsetBufferView.\n * String offsets is an array of offsets of strings in the united array of characters.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param propertyTableProperty - propertyTable's property metadata.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @returns Typed array of offset values. The number of offsets in the array is equal to `numberOfElements` plus one.\n * @see https://github.com/CesiumGS/glTF/blob/c38f7f37e894004353c15cd0481bc5b7381ce841/extensions/2.0/Vendor/EXT_feature_metadata/schema/featureTable.property.schema.json#L50C10-L50C32\n */\nfunction getStringOffsetsForProperty(scenegraph, classProperty, propertyTableProperty, numberOfElements) {\n    if (typeof propertyTableProperty.stringOffsetBufferView !== 'undefined' // `stringOffsetBufferView` is an index of the buffer view containing offsets for strings.\n    ) {\n        // Data are in a FIXED-length array\n        return getOffsetsForProperty(scenegraph, propertyTableProperty.stringOffsetBufferView, propertyTableProperty.offsetType || 'UINT32', // offsetType is used both for stringOffsetBufferView and arrayOffsetBufferView\n        numberOfElements);\n    }\n    return null;\n}\n/**\n * Checks if the feature table property is of numeric type.\n * @param schemaPropertyType - feature table property\n * @returns true if property is numeric, else - false\n */\nfunction isNumericProperty(schemaProperty) {\n    const types = [\n        'UINT8',\n        'INT16',\n        'UINT16',\n        'INT32',\n        'UINT32',\n        'INT64',\n        'UINT64',\n        'FLOAT32',\n        'FLOAT64'\n    ];\n    return (types.includes(schemaProperty.type) ||\n        (typeof schemaProperty.componentType !== 'undefined' &&\n            types.includes(schemaProperty.componentType)));\n}\n/**\n * Decodes properties of numeric types from binary sourse.\n * @param classProperty - class property object.\n * @param numberOfElements - The number of elements in each property array that propertyTableProperty contains. It's a number of rows in the table.\n * @param valuesDataBytes - Data taken from values property of the property table property.\n * @param arrayOffsets - Offsets for variable-length arrays. It's null for fixed-length arrays or scalar types.\n * @returns Property values in a typed array or in an array of typed arrays.\n */\nfunction getPropertyDataNumeric(classProperty, numberOfElements, valuesDataBytes, arrayOffsets) {\n    const isArray = classProperty.type === 'ARRAY';\n    const arrayCount = classProperty.componentCount;\n    /*\n    We are getting Numeric data. So,\n      the component type can be one of NumericComponentType,\n      the attribute type should be 'SCALAR'\n    */\n    const attributeType = 'SCALAR';\n    const componentType = classProperty.componentType || classProperty.type;\n    const elementSize = getArrayElementByteSize(attributeType, componentType);\n    const elementCount = valuesDataBytes.byteLength / elementSize;\n    const valuesData = convertRawBufferToMetadataArray(valuesDataBytes, attributeType, componentType, elementCount);\n    if (isArray) {\n        if (arrayOffsets) {\n            // VARIABLE-length array\n            return parseVariableLengthArrayNumeric(valuesData, numberOfElements, arrayOffsets, valuesDataBytes.length, elementSize);\n        }\n        if (arrayCount) {\n            // FIXED-length array\n            return parseFixedLengthArrayNumeric(valuesData, numberOfElements, arrayCount);\n        }\n        return [];\n    }\n    return valuesData;\n}\n/**\n * Gets properties from texture associated with all mesh primitives.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param featureTextureProperty\n * @param attributeName\n * @returns Feature texture data\n */\nfunction getPropertyDataFromTexture(scenegraph, featureTextureProperty, attributeName) {\n    const json = scenegraph.gltf.json;\n    if (!json.meshes) {\n        return [];\n    }\n    const featureTextureTable = [];\n    for (const mesh of json.meshes) {\n        for (const primitive of mesh.primitives) {\n            processPrimitiveTextures(scenegraph, attributeName, featureTextureProperty, featureTextureTable, primitive);\n        }\n    }\n    return featureTextureTable;\n}\n/**\n * Processes data encoded in the texture associated with the primitive. This data will be accessible through the attributes.\n * @param scenegraph - Instance of the class for structured access to GLTF data.\n * @param attributeName\n * @param featureTextureProperty\n * @param featureTextureTable\n * @param primitive\n */\nfunction processPrimitiveTextures(scenegraph, attributeName, featureTextureProperty, featureTextureTable, primitive) {\n    const textureInfoTopLevel = {\n        channels: featureTextureProperty.channels,\n        ...featureTextureProperty.texture\n    };\n    const propertyData = getPrimitiveTextureData(scenegraph, textureInfoTopLevel, primitive);\n    if (!propertyData) {\n        return;\n    }\n    primitivePropertyDataToAttributes(scenegraph, attributeName, propertyData, featureTextureTable, primitive);\n}\n", "// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nexport const VERSION = typeof \"4.3.3\" !== 'undefined' ? \"4.3.3\" : 'latest';\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nexport const VERSION = typeof \"4.3.3\" !== 'undefined' ? \"4.3.3\" : 'latest';\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { registerJSModules, getJSModuleOrNull } from '@loaders.gl/loader-utils';\nimport { loadLibrary } from '@loaders.gl/worker-utils';\nexport const BASIS_EXTERNAL_LIBRARIES = {\n    /** Basis transcoder, javascript wrapper part */\n    TRANSCODER: 'basis_transcoder.js',\n    /** Basis transcoder, compiled web assembly part */\n    TRANSCODER_WASM: 'basis_transcoder.wasm',\n    /** Basis encoder, javascript wrapper part */\n    ENCODER: 'basis_encoder.js',\n    /** Basis encoder, compiled web assembly part */\n    ENCODER_WASM: 'basis_encoder.wasm'\n};\nlet loadBasisTranscoderPromise;\n/**\n * Loads wasm transcoder module\n * @param options\n * @returns {BasisFile} promise\n */\nexport async function loadBasisTranscoderModule(options) {\n    registerJSModules(options.modules);\n    const basis = getJSModuleOrNull('basis');\n    if (basis) {\n        return basis;\n    }\n    loadBasisTranscoderPromise ||= loadBasisTranscoder(options);\n    return await loadBasisTranscoderPromise;\n}\n/**\n * Loads wasm transcoder module\n * @param options\n * @returns {BasisFile} promise\n */\nasync function loadBasisTranscoder(options) {\n    let BASIS = null;\n    let wasmBinary = null;\n    [BASIS, wasmBinary] = await Promise.all([\n        await loadLibrary(BASIS_EXTERNAL_LIBRARIES.TRANSCODER, 'textures', options),\n        await loadLibrary(BASIS_EXTERNAL_LIBRARIES.TRANSCODER_WASM, 'textures', options)\n    ]);\n    // Depends on how import happened...\n    // @ts-ignore TS2339: Property does not exist on type\n    BASIS = BASIS || globalThis.BASIS;\n    return await initializeBasisTranscoderModule(BASIS, wasmBinary);\n}\n/**\n * Initialize wasm transcoder module\n * @param BasisModule - js part of the module\n * @param wasmBinary - wasm part of the module\n * @returns {BasisFile} promise\n */\nfunction initializeBasisTranscoderModule(BasisModule, wasmBinary) {\n    const options = {};\n    if (wasmBinary) {\n        options.wasmBinary = wasmBinary;\n    }\n    return new Promise((resolve) => {\n        // if you try to return BasisModule the browser crashes!\n        BasisModule(options).then((module) => {\n            const { BasisFile, initializeBasis } = module;\n            initializeBasis();\n            resolve({ BasisFile });\n        });\n    });\n}\nlet loadBasisEncoderPromise;\n/**\n * Loads wasm encoder module\n * @param options\n * @returns {BasisFile, KTX2File} promise\n */\nexport async function loadBasisEncoderModule(options) {\n    const modules = options.modules || {};\n    if (modules.basisEncoder) {\n        return modules.basisEncoder;\n    }\n    loadBasisEncoderPromise = loadBasisEncoderPromise || loadBasisEncoder(options);\n    return await loadBasisEncoderPromise;\n}\n/**\n * Loads wasm encoder module\n * @param options\n * @returns {BasisFile, KTX2File} promise\n */\nasync function loadBasisEncoder(options) {\n    let BASIS_ENCODER = null;\n    let wasmBinary = null;\n    [BASIS_ENCODER, wasmBinary] = await Promise.all([\n        await loadLibrary(BASIS_EXTERNAL_LIBRARIES.ENCODER, 'textures', options),\n        await loadLibrary(BASIS_EXTERNAL_LIBRARIES.ENCODER_WASM, 'textures', options)\n    ]);\n    // Depends on how import happened...\n    // @ts-ignore TS2339: Property does not exist on type\n    BASIS_ENCODER = BASIS_ENCODER || globalThis.BASIS;\n    return await initializeBasisEncoderModule(BASIS_ENCODER, wasmBinary);\n}\n/**\n * Initialize wasm transcoder module\n * @param BasisEncoderModule - js part of the module\n * @param wasmBinary - wasm part of the module\n * @returns {BasisFile, KTX2File} promise\n */\nfunction initializeBasisEncoderModule(BasisEncoderModule, wasmBinary) {\n    const options = {};\n    if (wasmBinary) {\n        options.wasmBinary = wasmBinary;\n    }\n    return new Promise((resolve) => {\n        // if you try to return BasisModule the browser crashes!\n        BasisEncoderModule(options).then((module) => {\n            const { BasisFile, KTX2File, initializeBasis, BasisEncoder } = module;\n            initializeBasis();\n            resolve({ BasisFile, KTX2File, BasisEncoder });\n        });\n    });\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/* eslint-disable camelcase */\nexport const GL_EXTENSIONS_CONSTANTS = {\n    // WEBGL_compressed_texture_s3tc\n    COMPRESSED_RGB_S3TC_DXT1_EXT: 0x83f0,\n    COMPRESSED_RGBA_S3TC_DXT1_EXT: 0x83f1,\n    COMPRESSED_RGBA_S3TC_DXT3_EXT: 0x83f2,\n    COMPRESSED_RGBA_S3TC_DXT5_EXT: 0x83f3,\n    // WEBGL_compressed_texture_es3\n    COMPRESSED_R11_EAC: 0x9270,\n    COMPRESSED_SIGNED_R11_EAC: 0x9271,\n    COMPRESSED_RG11_EAC: 0x9272,\n    COMPRESSED_SIGNED_RG11_EAC: 0x9273,\n    COMPRESSED_RGB8_ETC2: 0x9274,\n    COMPRESSED_RGBA8_ETC2_EAC: 0x9275,\n    COMPRESSED_SRGB8_ETC2: 0x9276,\n    COMPRESSED_SRGB8_ALPHA8_ETC2_EAC: 0x9277,\n    COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2: 0x9278,\n    COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2: 0x9279,\n    // WEBGL_compressed_texture_pvrtc\n    COMPRESSED_RGB_PVRTC_4BPPV1_IMG: 0x8c00,\n    COMPRESSED_RGBA_PVRTC_4BPPV1_IMG: 0x8c02,\n    COMPRESSED_RGB_PVRTC_2BPPV1_IMG: 0x8c01,\n    COMPRESSED_RGBA_PVRTC_2BPPV1_IMG: 0x8c03,\n    // WEBGL_compressed_texture_etc1\n    COMPRESSED_RGB_ETC1_WEBGL: 0x8d64,\n    // WEBGL_compressed_texture_atc\n    COMPRESSED_RGB_ATC_WEBGL: 0x8c92,\n    COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL: 0x8c93,\n    COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL: 0x87ee,\n    // WEBGL_compressed_texture_astc\n    COMPRESSED_RGBA_ASTC_4X4_KHR: 0x93b0,\n    COMPRESSED_RGBA_ASTC_5X4_KHR: 0x93b1,\n    COMPRESSED_RGBA_ASTC_5X5_KHR: 0x93b2,\n    COMPRESSED_RGBA_ASTC_6X5_KHR: 0x93b3,\n    COMPRESSED_RGBA_ASTC_6X6_KHR: 0x93b4,\n    COMPRESSED_RGBA_ASTC_8X5_KHR: 0x93b5,\n    COMPRESSED_RGBA_ASTC_8X6_KHR: 0x93b6,\n    COMPRESSED_RGBA_ASTC_8X8_KHR: 0x93b7,\n    COMPRESSED_RGBA_ASTC_10X5_KHR: 0x93b8,\n    COMPRESSED_RGBA_ASTC_10X6_KHR: 0x93b9,\n    COMPRESSED_RGBA_ASTC_10X8_KHR: 0x93ba,\n    COMPRESSED_RGBA_ASTC_10X10_KHR: 0x93bb,\n    COMPRESSED_RGBA_ASTC_12X10_KHR: 0x93bc,\n    COMPRESSED_RGBA_ASTC_12X12_KHR: 0x93bd,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR: 0x93d0,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR: 0x93d1,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR: 0x93d2,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR: 0x93d3,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR: 0x93d4,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR: 0x93d5,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR: 0x93d6,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR: 0x93d7,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR: 0x93d8,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR: 0x93d9,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR: 0x93da,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR: 0x93db,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR: 0x93dc,\n    COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR: 0x93dd,\n    // EXT_texture_compression_rgtc\n    COMPRESSED_RED_RGTC1_EXT: 0x8dbb,\n    COMPRESSED_SIGNED_RED_RGTC1_EXT: 0x8dbc,\n    COMPRESSED_RED_GREEN_RGTC2_EXT: 0x8dbd,\n    COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT: 0x8dbe,\n    // WEBGL_compressed_texture_s3tc_srgb\n    COMPRESSED_SRGB_S3TC_DXT1_EXT: 0x8c4c,\n    COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT: 0x8c4d,\n    COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT: 0x8c4e,\n    COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT: 0x8c4f\n};\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst BROWSER_PREFIXES = ['', 'WEBKIT_', 'MOZ_'];\nconst WEBGL_EXTENSIONS = {\n    /* eslint-disable camelcase */\n    WEBGL_compressed_texture_s3tc: 'dxt',\n    WEBGL_compressed_texture_s3tc_srgb: 'dxt-srgb',\n    WEBGL_compressed_texture_etc1: 'etc1',\n    WEBGL_compressed_texture_etc: 'etc2',\n    WEBGL_compressed_texture_pvrtc: 'pvrtc',\n    WEBGL_compressed_texture_atc: 'atc',\n    WEBGL_compressed_texture_astc: 'astc',\n    EXT_texture_compression_rgtc: 'rgtc'\n    /* eslint-enable camelcase */\n};\nlet formats = null;\n/**\n * Returns a list of formats.\n * Creates a temporary WebGLRenderingContext if none is provided.\n *\n * @param gl - Optional context.\n */\nexport function getSupportedGPUTextureFormats(gl) {\n    if (!formats) {\n        gl = gl || getWebGLContext() || undefined;\n        formats = new Set();\n        for (const prefix of BROWSER_PREFIXES) {\n            for (const extension in WEBGL_EXTENSIONS) {\n                if (gl && gl.getExtension(`${prefix}${extension}`)) {\n                    const gpuTextureFormat = WEBGL_EXTENSIONS[extension];\n                    formats.add(gpuTextureFormat);\n                }\n            }\n        }\n    }\n    return formats;\n}\n/**\n * @returns {WebGLRenderingContext?}\n */\nfunction getWebGLContext() {\n    try {\n        const canvas = document.createElement('canvas');\n        return canvas.getContext('webgl');\n    }\n    catch (error) {\n        return null;\n    }\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { read } from 'ktx-parse';\nimport { extractMipmapImages } from \"../utils/extract-mipmap-images.js\";\nimport { mapVkFormatToWebGL } from \"../utils/ktx-format-helper.js\";\nconst KTX2_ID = [\n    // '\u00B4', 'K', 'T', 'X', '2', '0', '\u00AA', '\\r', '\\n', '\\x1A', '\\n'\n    0xab, 0x4b, 0x54, 0x58, 0x20, 0x32, 0x30, 0xbb, 0x0d, 0x0a, 0x1a, 0x0a\n];\n// eslint-disable-next-line complexity\nexport function isKTX(data) {\n    // const id = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    const id = new Uint8Array(data);\n    const notKTX = id.byteLength < KTX2_ID.length ||\n        id[0] !== KTX2_ID[0] || // '\u00B4'\n        id[1] !== KTX2_ID[1] || // 'K'\n        id[2] !== KTX2_ID[2] || // 'T'\n        id[3] !== KTX2_ID[3] || // 'X'\n        id[4] !== KTX2_ID[4] || // ' '\n        id[5] !== KTX2_ID[5] || // '2'\n        id[6] !== KTX2_ID[6] || // '0'\n        id[7] !== KTX2_ID[7] || // '\u00AA'\n        id[8] !== KTX2_ID[8] || // '\\r'\n        id[9] !== KTX2_ID[9] || // '\\n'\n        id[10] !== KTX2_ID[10] || // '\\x1A'\n        id[11] !== KTX2_ID[11]; // '\\n'\n    return !notKTX;\n}\nexport function parseKTX(arrayBuffer) {\n    const uint8Array = new Uint8Array(arrayBuffer);\n    const ktx = read(uint8Array);\n    const mipMapLevels = Math.max(1, ktx.levels.length);\n    const width = ktx.pixelWidth;\n    const height = ktx.pixelHeight;\n    const internalFormat = mapVkFormatToWebGL(ktx.vkFormat);\n    return extractMipmapImages(ktx.levels, {\n        mipMapLevels,\n        width,\n        height,\n        sizeFunction: (level) => level.uncompressedByteLength,\n        internalFormat\n    });\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { loadBasisEncoderModule, loadBasisTranscoderModule } from \"./basis-module-loader.js\";\nimport { GL_EXTENSIONS_CONSTANTS } from \"../gl-extensions.js\";\nimport { getSupportedGPUTextureFormats } from \"../utils/texture-formats.js\";\nimport { isKTX } from \"./parse-ktx.js\";\nconst OutputFormat = {\n    etc1: {\n        basisFormat: 0,\n        compressed: true,\n        format: GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_ETC1_WEBGL\n    },\n    etc2: { basisFormat: 1, compressed: true },\n    bc1: {\n        basisFormat: 2,\n        compressed: true,\n        format: GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_S3TC_DXT1_EXT\n    },\n    bc3: {\n        basisFormat: 3,\n        compressed: true,\n        format: GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT5_EXT\n    },\n    bc4: { basisFormat: 4, compressed: true },\n    bc5: { basisFormat: 5, compressed: true },\n    'bc7-m6-opaque-only': { basisFormat: 6, compressed: true },\n    'bc7-m5': { basisFormat: 7, compressed: true },\n    'pvrtc1-4-rgb': {\n        basisFormat: 8,\n        compressed: true,\n        format: GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG\n    },\n    'pvrtc1-4-rgba': {\n        basisFormat: 9,\n        compressed: true,\n        format: GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\n    },\n    'astc-4x4': {\n        basisFormat: 10,\n        compressed: true,\n        format: GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_4X4_KHR\n    },\n    'atc-rgb': { basisFormat: 11, compressed: true },\n    'atc-rgba-interpolated-alpha': { basisFormat: 12, compressed: true },\n    rgba32: { basisFormat: 13, compressed: false },\n    rgb565: { basisFormat: 14, compressed: false },\n    bgr565: { basisFormat: 15, compressed: false },\n    rgba4444: { basisFormat: 16, compressed: false }\n};\n/**\n * parse data with a Binomial Basis_Universal module\n * @param data\n * @param options\n * @returns compressed texture data\n */\nexport async function parseBasis(data, options) {\n    if (options.basis.containerFormat === 'auto') {\n        if (isKTX(data)) {\n            const fileConstructors = await loadBasisEncoderModule(options);\n            return parseKTX2File(fileConstructors.KTX2File, data, options);\n        }\n        const { BasisFile } = await loadBasisTranscoderModule(options);\n        return parseBasisFile(BasisFile, data, options);\n    }\n    switch (options.basis.module) {\n        case 'encoder':\n            const fileConstructors = await loadBasisEncoderModule(options);\n            switch (options.basis.containerFormat) {\n                case 'ktx2':\n                    return parseKTX2File(fileConstructors.KTX2File, data, options);\n                case 'basis':\n                default:\n                    return parseBasisFile(fileConstructors.BasisFile, data, options);\n            }\n        case 'transcoder':\n        default:\n            const { BasisFile } = await loadBasisTranscoderModule(options);\n            return parseBasisFile(BasisFile, data, options);\n    }\n}\n/**\n * Parse *.basis file data\n * @param BasisFile - initialized transcoder module\n * @param data\n * @param options\n * @returns compressed texture data\n */\nfunction parseBasisFile(BasisFile, data, options) {\n    const basisFile = new BasisFile(new Uint8Array(data));\n    try {\n        if (!basisFile.startTranscoding()) {\n            throw new Error('Failed to start basis transcoding');\n        }\n        const imageCount = basisFile.getNumImages();\n        const images = [];\n        for (let imageIndex = 0; imageIndex < imageCount; imageIndex++) {\n            const levelsCount = basisFile.getNumLevels(imageIndex);\n            const levels = [];\n            for (let levelIndex = 0; levelIndex < levelsCount; levelIndex++) {\n                levels.push(transcodeImage(basisFile, imageIndex, levelIndex, options));\n            }\n            images.push(levels);\n        }\n        return images;\n    }\n    finally {\n        basisFile.close();\n        basisFile.delete();\n    }\n}\n/**\n * Parse the particular level image of a basis file\n * @param basisFile\n * @param imageIndex\n * @param levelIndex\n * @param options\n * @returns compressed texture data\n */\nfunction transcodeImage(basisFile, imageIndex, levelIndex, options) {\n    const width = basisFile.getImageWidth(imageIndex, levelIndex);\n    const height = basisFile.getImageHeight(imageIndex, levelIndex);\n    // See https://github.com/BinomialLLC/basis_universal/pull/83\n    const hasAlpha = basisFile.getHasAlpha( /* imageIndex, levelIndex */);\n    // Check options for output format etc\n    const { compressed, format, basisFormat } = getBasisOptions(options, hasAlpha);\n    const decodedSize = basisFile.getImageTranscodedSizeInBytes(imageIndex, levelIndex, basisFormat);\n    const decodedData = new Uint8Array(decodedSize);\n    if (!basisFile.transcodeImage(decodedData, imageIndex, levelIndex, basisFormat, 0, 0)) {\n        throw new Error('failed to start Basis transcoding');\n    }\n    return {\n        // standard loaders.gl image category payload\n        width,\n        height,\n        data: decodedData,\n        compressed,\n        format,\n        // Additional fields\n        // Add levelSize field.\n        hasAlpha\n    };\n}\n/**\n * Parse *.ktx2 file data\n * @param KTX2File\n * @param data\n * @param options\n * @returns compressed texture data\n */\nfunction parseKTX2File(KTX2File, data, options) {\n    const ktx2File = new KTX2File(new Uint8Array(data));\n    try {\n        if (!ktx2File.startTranscoding()) {\n            throw new Error('failed to start KTX2 transcoding');\n        }\n        const levelsCount = ktx2File.getLevels();\n        const levels = [];\n        for (let levelIndex = 0; levelIndex < levelsCount; levelIndex++) {\n            levels.push(transcodeKTX2Image(ktx2File, levelIndex, options));\n        }\n        return [levels];\n    }\n    finally {\n        ktx2File.close();\n        ktx2File.delete();\n    }\n}\n/**\n * Parse the particular level image of a ktx2 file\n * @param ktx2File\n * @param levelIndex\n * @param options\n * @returns\n */\nfunction transcodeKTX2Image(ktx2File, levelIndex, options) {\n    const { alphaFlag, height, width } = ktx2File.getImageLevelInfo(levelIndex, 0, 0);\n    // Check options for output format etc\n    const { compressed, format, basisFormat } = getBasisOptions(options, alphaFlag);\n    const decodedSize = ktx2File.getImageTranscodedSizeInBytes(levelIndex, 0 /* layerIndex */, 0 /* faceIndex */, basisFormat);\n    const decodedData = new Uint8Array(decodedSize);\n    if (!ktx2File.transcodeImage(decodedData, levelIndex, 0 /* layerIndex */, 0 /* faceIndex */, basisFormat, 0, -1 /* channel0 */, -1 /* channel1 */)) {\n        throw new Error('Failed to transcode KTX2 image');\n    }\n    return {\n        // standard loaders.gl image category payload\n        width,\n        height,\n        data: decodedData,\n        compressed,\n        // Additional fields\n        levelSize: decodedSize,\n        hasAlpha: alphaFlag,\n        format\n    };\n}\n/**\n * Get BasisFormat by loader format option\n * @param options\n * @param hasAlpha\n * @returns BasisFormat data\n */\nfunction getBasisOptions(options, hasAlpha) {\n    let format = options && options.basis && options.basis.format;\n    if (format === 'auto') {\n        format = selectSupportedBasisFormat();\n    }\n    if (typeof format === 'object') {\n        format = hasAlpha ? format.alpha : format.noAlpha;\n    }\n    format = format.toLowerCase();\n    return OutputFormat[format];\n}\n/**\n * Select transcode format from the list of supported formats\n * @returns key for OutputFormat map\n */\nexport function selectSupportedBasisFormat() {\n    const supportedFormats = getSupportedGPUTextureFormats();\n    if (supportedFormats.has('astc')) {\n        return 'astc-4x4';\n    }\n    else if (supportedFormats.has('dxt')) {\n        return {\n            alpha: 'bc3',\n            noAlpha: 'bc1'\n        };\n    }\n    else if (supportedFormats.has('pvrtc')) {\n        return {\n            alpha: 'pvrtc1-4-rgba',\n            noAlpha: 'pvrtc1-4-rgb'\n        };\n    }\n    else if (supportedFormats.has('etc1')) {\n        return 'etc1';\n    }\n    else if (supportedFormats.has('etc2')) {\n        return 'etc2';\n    }\n    return 'rgb565';\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { VERSION } from \"./lib/utils/version.js\";\nimport { parseBasis } from \"./lib/parsers/parse-basis.js\";\n/**\n * Worker loader for Basis super compressed textures\n */\nexport const BasisWorkerLoader = {\n    dataType: null,\n    batchType: null,\n    name: 'Basis',\n    id: 'basis',\n    module: 'textures',\n    version: VERSION,\n    worker: true,\n    extensions: ['basis', 'ktx2'],\n    mimeTypes: ['application/octet-stream', 'image/ktx2'],\n    tests: ['sB'],\n    binary: true,\n    options: {\n        basis: {\n            format: 'auto',\n            libraryPath: 'libs/',\n            containerFormat: 'auto',\n            module: 'transcoder'\n        }\n    }\n};\n/**\n * Loader for Basis super compressed textures\n */\nexport const BasisLoader = {\n    ...BasisWorkerLoader,\n    parse: parseBasis\n};\n", "import { padToNBytes, assert } from '@loaders.gl/loader-utils';\n/** Binary GLTF is little endian. */\nconst LITTLE_ENDIAN = true;\n/** 'glTF' in Big-Endian ASCII */\nconst MAGIC_glTF = 0x676c5446;\nconst GLB_FILE_HEADER_SIZE = 12;\nconst GLB_CHUNK_HEADER_SIZE = 8;\nconst GLB_CHUNK_TYPE_JSON = 0x4e4f534a;\nconst GLB_CHUNK_TYPE_BIN = 0x004e4942;\nconst GLB_V1_CONTENT_FORMAT_JSON = 0x0;\n/** @deprecated - Backward compatibility for old xviz files */\nconst GLB_CHUNK_TYPE_JSON_XVIZ_DEPRECATED = 0;\n/** @deprecated - Backward compatibility for old xviz files */\nconst GLB_CHUNK_TYPE_BIX_XVIZ_DEPRECATED = 1;\nfunction getMagicString(dataView, byteOffset = 0) {\n    return `\\\n${String.fromCharCode(dataView.getUint8(byteOffset + 0))}\\\n${String.fromCharCode(dataView.getUint8(byteOffset + 1))}\\\n${String.fromCharCode(dataView.getUint8(byteOffset + 2))}\\\n${String.fromCharCode(dataView.getUint8(byteOffset + 3))}`;\n}\n/** Check if the contents of an array buffer contains GLB byte markers */\nexport function isGLB(arrayBuffer, byteOffset = 0, options = {}) {\n    const dataView = new DataView(arrayBuffer);\n    // Check that GLB Header starts with the magic number\n    const { magic = MAGIC_glTF } = options;\n    const magic1 = dataView.getUint32(byteOffset, false);\n    return magic1 === magic || magic1 === MAGIC_glTF;\n}\n/**\n * Synchronously parse a GLB\n * @param glb - Target, Output is stored there\n * @param arrayBuffer - Input data\n * @param byteOffset - Offset into arrayBuffer to start parsing from (for \"embedded\" GLBs, e.g. in 3D tiles)\n * @param options\n * @returns\n */\nexport function parseGLBSync(glb, arrayBuffer, byteOffset = 0, options = {}) {\n    // Check that GLB Header starts with the magic number\n    const dataView = new DataView(arrayBuffer);\n    // Compare format with GLBLoader documentation\n    const type = getMagicString(dataView, byteOffset + 0);\n    const version = dataView.getUint32(byteOffset + 4, LITTLE_ENDIAN); // Version 2 of binary glTF container format\n    const byteLength = dataView.getUint32(byteOffset + 8, LITTLE_ENDIAN); // Total byte length of binary file\n    Object.assign(glb, {\n        // Put less important stuff in a header, to avoid clutter\n        header: {\n            byteOffset, // Byte offset into the initial arrayBuffer\n            byteLength,\n            hasBinChunk: false\n        },\n        type,\n        version,\n        json: {},\n        binChunks: []\n    });\n    byteOffset += GLB_FILE_HEADER_SIZE;\n    switch (glb.version) {\n        case 1:\n            return parseGLBV1(glb, dataView, byteOffset);\n        case 2:\n            return parseGLBV2(glb, dataView, byteOffset, (options = {}));\n        default:\n            throw new Error(`Invalid GLB version ${glb.version}. Only supports version 1 and 2.`);\n    }\n}\n/**\n * Parse a V1 GLB\n * @param glb - target, output is stored in this object\n * @param dataView - Input, memory to be parsed\n * @param byteOffset - Offset of first byte of GLB data in the data view\n * @returns Number of bytes parsed (there could be additional non-GLB data after the GLB)\n */\nfunction parseGLBV1(glb, dataView, byteOffset) {\n    // Sanity: ensure file is big enough to hold at least the headers\n    assert(glb.header.byteLength > GLB_FILE_HEADER_SIZE + GLB_CHUNK_HEADER_SIZE);\n    // Explanation of GLB structure:\n    // https://cloud.githubusercontent.com/assets/3479527/22600725/36b87122-ea55-11e6-9d40-6fd42819fcab.png\n    const contentLength = dataView.getUint32(byteOffset + 0, LITTLE_ENDIAN); // Byte length of chunk\n    const contentFormat = dataView.getUint32(byteOffset + 4, LITTLE_ENDIAN); // Chunk format as uint32\n    byteOffset += GLB_CHUNK_HEADER_SIZE;\n    // GLB v1 only supports a single chunk type\n    assert(contentFormat === GLB_V1_CONTENT_FORMAT_JSON);\n    parseJSONChunk(glb, dataView, byteOffset, contentLength);\n    // No need to call the function padToBytes() from parseJSONChunk()\n    byteOffset += contentLength;\n    byteOffset += parseBINChunk(glb, dataView, byteOffset, glb.header.byteLength);\n    return byteOffset;\n}\n/**\n * Parse a V2 GLB\n * @param glb - target, output is stored in this object\n * @param dataView - Input, memory to be parsed\n * @param byteOffset - Offset of first byte of GLB data in the data view\n * @returns Number of bytes parsed (there could be additional non-GLB data after the GLB)\n */\nfunction parseGLBV2(glb, dataView, byteOffset, options) {\n    // Sanity: ensure file is big enough to hold at least the first chunk header\n    assert(glb.header.byteLength > GLB_FILE_HEADER_SIZE + GLB_CHUNK_HEADER_SIZE);\n    parseGLBChunksSync(glb, dataView, byteOffset, options);\n    return byteOffset + glb.header.byteLength;\n}\n/** Iterate over GLB chunks and parse them */\nfunction parseGLBChunksSync(glb, dataView, byteOffset, options) {\n    // Per spec we must iterate over chunks, ignoring all except JSON and BIN\n    // Iterate as long as there is space left for another chunk header\n    while (byteOffset + 8 <= glb.header.byteLength) {\n        const chunkLength = dataView.getUint32(byteOffset + 0, LITTLE_ENDIAN); // Byte length of chunk\n        const chunkFormat = dataView.getUint32(byteOffset + 4, LITTLE_ENDIAN); // Chunk format as uint32\n        byteOffset += GLB_CHUNK_HEADER_SIZE;\n        // Per spec we must iterate over chunks, ignoring all except JSON and BIN\n        switch (chunkFormat) {\n            case GLB_CHUNK_TYPE_JSON:\n                parseJSONChunk(glb, dataView, byteOffset, chunkLength);\n                break;\n            case GLB_CHUNK_TYPE_BIN:\n                parseBINChunk(glb, dataView, byteOffset, chunkLength);\n                break;\n            // Backward compatibility for very old xviz files\n            case GLB_CHUNK_TYPE_JSON_XVIZ_DEPRECATED:\n                if (!options.strict) {\n                    parseJSONChunk(glb, dataView, byteOffset, chunkLength);\n                }\n                break;\n            case GLB_CHUNK_TYPE_BIX_XVIZ_DEPRECATED:\n                if (!options.strict) {\n                    parseBINChunk(glb, dataView, byteOffset, chunkLength);\n                }\n                break;\n            default:\n                // Ignore, per spec\n                // console.warn(`Unknown GLB chunk type`); // eslint-disable-line\n                break;\n        }\n        byteOffset += padToNBytes(chunkLength, 4);\n    }\n    return byteOffset;\n}\n/* Parse a GLB JSON chunk */\nfunction parseJSONChunk(glb, dataView, byteOffset, chunkLength) {\n    // 1. Create a \"view\" of the binary encoded JSON data inside the GLB\n    const jsonChunk = new Uint8Array(dataView.buffer, byteOffset, chunkLength);\n    // 2. Decode the JSON binary array into clear text\n    const textDecoder = new TextDecoder('utf8');\n    const jsonText = textDecoder.decode(jsonChunk);\n    // 3. Parse the JSON text into a JavaScript data structure\n    glb.json = JSON.parse(jsonText);\n    return padToNBytes(chunkLength, 4);\n}\n/** Parse a GLB BIN chunk */\nfunction parseBINChunk(glb, dataView, byteOffset, chunkLength) {\n    // Note: BIN chunk can be optional\n    glb.header.hasBinChunk = true;\n    glb.binChunks.push({\n        byteOffset,\n        byteLength: chunkLength,\n        arrayBuffer: dataView.buffer\n        // TODO - copy, or create typed array view?\n    });\n    return padToNBytes(chunkLength, 4);\n}\n", "// Resolves a relative url against a baseUrl\n// If url is absolute, return it unchanged\nexport function resolveUrl(url, options) {\n    // TODO: Use better logic to handle all protocols plus not delay on data\n    const absolute = url.startsWith('data:') || url.startsWith('http:') || url.startsWith('https:');\n    if (absolute) {\n        return url;\n    }\n    const baseUrl = options.baseUri || options.uri;\n    if (!baseUrl) {\n        throw new Error(`'baseUri' must be provided to resolve relative url ${url}`);\n    }\n    return baseUrl.substr(0, baseUrl.lastIndexOf('/') + 1) + url;\n}\n", "import { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nimport { meshoptDecodeGltfBuffer } from \"../../meshopt/meshopt-decoder.js\";\n// @ts-ignore\n// eslint-disable-next-line\nconst DEFAULT_MESHOPT_OPTIONS = {\n    byteOffset: 0,\n    filter: 'NONE'\n};\n/** Extension name */\nconst EXT_MESHOPT_COMPRESSION = 'EXT_meshopt_compression';\nexport const name = EXT_MESHOPT_COMPRESSION;\nexport async function decode(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    if (!options?.gltf?.decompressMeshes || !options.gltf?.loadBuffers) {\n        return;\n    }\n    const promises = [];\n    for (const bufferViewIndex of gltfData.json.bufferViews || []) {\n        promises.push(decodeMeshoptBufferView(scenegraph, bufferViewIndex));\n    }\n    // Decompress meshes in parallel\n    await Promise.all(promises);\n    // We have now decompressed all primitives, so remove the top-level extension\n    scenegraph.removeExtension(EXT_MESHOPT_COMPRESSION);\n}\n/** Decode one meshopt buffer view */\nasync function decodeMeshoptBufferView(scenegraph, bufferView) {\n    const meshoptExtension = scenegraph.getObjectExtension(bufferView, EXT_MESHOPT_COMPRESSION);\n    if (meshoptExtension) {\n        const { byteOffset = 0, byteLength = 0, byteStride, count, mode, filter = 'NONE', buffer: bufferIndex } = meshoptExtension;\n        const buffer = scenegraph.gltf.buffers[bufferIndex];\n        const source = new Uint8Array(buffer.arrayBuffer, buffer.byteOffset + byteOffset, byteLength);\n        const result = new Uint8Array(scenegraph.gltf.buffers[bufferView.buffer].arrayBuffer, bufferView.byteOffset, bufferView.byteLength);\n        await meshoptDecodeGltfBuffer(result, count, byteStride, source, mode, filter);\n        scenegraph.removeObjectExtension(bufferView, EXT_MESHOPT_COMPRESSION);\n    }\n}\n", "// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2021, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\n/* eslint-disable camelcase */\nconst isWebAssemblySupported = typeof WebAssembly !== 'object';\n// Built with clang version 11.0.0 (https://github.com/llvm/llvm-project.git 0160ad802e899c2922bc9b29564080c22eb0908c)\n// Built from meshoptimizer 0.16\nconst wasm_base = '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';\nconst wasm_simd = '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';\n// Uses bulk-memory and simd extensions\nconst detector = new Uint8Array([\n    0, 97, 115, 109, 1, 0, 0, 0, 1, 4, 1, 96, 0, 0, 3, 3, 2, 0, 0, 5, 3, 1, 0, 1, 12, 1, 0, 10, 22, 2,\n    12, 0, 65, 0, 65, 0, 65, 0, 252, 10, 0, 0, 11, 7, 0, 65, 0, 253, 15, 26, 11\n]);\n// Used to unpack wasm\nconst wasmpack = new Uint8Array([\n    32, 0, 65, 253, 3, 1, 2, 34, 4, 106, 6, 5, 11, 8, 7, 20, 13, 33, 12, 16, 128, 9, 116, 64, 19, 113,\n    127, 15, 10, 21, 22, 14, 255, 66, 24, 54, 136, 107, 18, 23, 192, 26, 114, 118, 132, 17, 77, 101,\n    130, 144, 27, 87, 131, 44, 45, 74, 156, 154, 70, 167\n]);\nconst FILTERS = {\n    // legacy index-based enums for glTF\n    0: '',\n    1: 'meshopt_decodeFilterOct',\n    2: 'meshopt_decodeFilterQuat',\n    3: 'meshopt_decodeFilterExp',\n    // string-based enums for glTF\n    NONE: '',\n    OCTAHEDRAL: 'meshopt_decodeFilterOct',\n    QUATERNION: 'meshopt_decodeFilterQuat',\n    EXPONENTIAL: 'meshopt_decodeFilterExp'\n};\nconst DECODERS = {\n    // legacy index-based enums for glTF\n    0: 'meshopt_decodeVertexBuffer',\n    1: 'meshopt_decodeIndexBuffer',\n    2: 'meshopt_decodeIndexSequence',\n    // string-based enums for glTF\n    ATTRIBUTES: 'meshopt_decodeVertexBuffer',\n    TRIANGLES: 'meshopt_decodeIndexBuffer',\n    INDICES: 'meshopt_decodeIndexSequence'\n};\nexport function isMeshoptSupported() {\n    return isWebAssemblySupported;\n}\nexport async function meshoptDecodeVertexBuffer(target, count, size, source, filter = 'NONE') {\n    const instance = await loadWasmInstance();\n    decode(instance, instance.exports.meshopt_decodeVertexBuffer, target, count, size, source, instance.exports[FILTERS[filter]]);\n}\nexport async function meshoptDecodeIndexBuffer(target, count, size, source) {\n    const instance = await loadWasmInstance();\n    decode(instance, instance.exports.meshopt_decodeIndexBuffer, target, count, size, source);\n}\nexport async function meshoptDecodeIndexSequence(target, count, size, source) {\n    const instance = await loadWasmInstance();\n    decode(instance, instance.exports.meshopt_decodeIndexSequence, target, count, size, source);\n}\n// eslint-disable-next-line max-params\nexport async function meshoptDecodeGltfBuffer(target, count, size, source, mode, filter = 'NONE') {\n    const instance = await loadWasmInstance();\n    decode(instance, instance.exports[DECODERS[mode]], target, count, size, source, instance.exports[FILTERS[filter || 'NONE']]);\n}\nlet wasmPromise;\nasync function loadWasmInstance() {\n    // eslint-disable-next-line\n    if (!wasmPromise) {\n        wasmPromise = loadWasmModule();\n    }\n    return wasmPromise;\n}\nasync function loadWasmModule() {\n    let wasm = wasm_base;\n    if (WebAssembly.validate(detector)) {\n        wasm = wasm_simd;\n        // eslint-disable-next-line no-console\n        console.log('Warning: meshopt_decoder is using experimental SIMD support');\n    }\n    const result = await WebAssembly.instantiate(unpack(wasm), {});\n    await result.instance.exports.__wasm_call_ctors();\n    return result.instance;\n}\nfunction unpack(data) {\n    const result = new Uint8Array(data.length);\n    for (let i = 0; i < data.length; ++i) {\n        const ch = data.charCodeAt(i);\n        result[i] = ch > 96 ? ch - 71 : ch > 64 ? ch - 65 : ch > 47 ? ch + 4 : ch > 46 ? 63 : 62;\n    }\n    let write = 0;\n    for (let i = 0; i < data.length; ++i) {\n        result[write++] = result[i] < 60 ? wasmpack[result[i]] : (result[i] - 60) * 64 + result[++i];\n    }\n    return result.buffer.slice(0, write);\n}\n// eslint-disable-next-line max-params\nfunction decode(instance, fun, target, count, size, source, filter) {\n    const sbrk = instance.exports.sbrk;\n    const count4 = (count + 3) & ~3; // pad for SIMD filter\n    const tp = sbrk(count4 * size);\n    const sp = sbrk(source.length);\n    const heap = new Uint8Array(instance.exports.memory.buffer);\n    heap.set(source, sp);\n    const res = fun(tp, count, size, sp, source.length);\n    if (res === 0 && filter) {\n        filter(tp, count4, size);\n    }\n    target.set(heap.subarray(tp, tp + count * size));\n    sbrk(tp - sbrk(0));\n    if (res !== 0) {\n        throw new Error(`Malformed buffer data: ${res}`);\n    }\n}\n", "// GLTF EXTENSION: EXT_TEXTURE_WEBP\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_TEXTURE_WEBP\n/* eslint-disable camelcase */\nimport { isImageFormatSupported } from '@loaders.gl/images';\nimport { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nconst EXT_TEXTURE_WEBP = 'EXT_texture_webp';\n/** Extension name */\nexport const name = EXT_TEXTURE_WEBP;\n/**\n * Replaces a texture source reference with the extension texture\n * Done in preprocess() to prevent load of default image\n */\nexport function preprocess(gltfData, options) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    if (!isImageFormatSupported('image/webp')) {\n        if (scenegraph.getRequiredExtensions().includes(EXT_TEXTURE_WEBP)) {\n            throw new Error(`gltf: Required extension ${EXT_TEXTURE_WEBP} not supported by browser`);\n        }\n        return;\n    }\n    const { json } = scenegraph;\n    for (const texture of json.textures || []) {\n        const extension = scenegraph.getObjectExtension(texture, EXT_TEXTURE_WEBP);\n        if (extension) {\n            // TODO - if multiple texture extensions are present which one wins?\n            texture.source = extension.source;\n        }\n        scenegraph.removeObjectExtension(texture, EXT_TEXTURE_WEBP);\n    }\n    // Remove the top-level extension\n    scenegraph.removeExtension(EXT_TEXTURE_WEBP);\n}\n", "// GLTF EXTENSION: KHR_texture_basisu\n// https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_texture_basisu\n/* eslint-disable camelcase */\nimport { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nconst KHR_TEXTURE_BASISU = 'KHR_texture_basisu';\n/** Extension name */\nexport const name = KHR_TEXTURE_BASISU;\n/**\n * Replaces a texture source reference with the extension texture\n * Done in preprocess() to prevent load of default image\n */\nexport function preprocess(gltfData, options) {\n    const scene = new GLTFScenegraph(gltfData);\n    const { json } = scene;\n    for (const texture of json.textures || []) {\n        const extension = scene.getObjectExtension(texture, KHR_TEXTURE_BASISU);\n        if (extension) {\n            // TODO - if multiple texture extensions are present which one wins?\n            texture.source = extension.source;\n            scene.removeObjectExtension(texture, KHR_TEXTURE_BASISU);\n        }\n    }\n    // Remove the top-level extension\n    scene.removeExtension(KHR_TEXTURE_BASISU);\n}\n", "// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n// Only TRIANGLES: 0x0004 and TRIANGLE_STRIP: 0x0005 are supported\n/* eslint-disable camelcase */\nimport { sliceArrayBuffer, parseFromContext } from '@loaders.gl/loader-utils';\nimport { DracoLoader } from '@loaders.gl/draco';\nimport { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nimport { getGLTFAccessors, getGLTFAccessor } from \"../gltf-utils/gltf-attribute-utils.js\";\nconst KHR_DRACO_MESH_COMPRESSION = 'KHR_draco_mesh_compression';\n/** Extension name */\nexport const name = KHR_DRACO_MESH_COMPRESSION;\nexport function preprocess(gltfData, options, context) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    for (const primitive of makeMeshPrimitiveIterator(scenegraph)) {\n        if (scenegraph.getObjectExtension(primitive, KHR_DRACO_MESH_COMPRESSION)) {\n            // TODO - Remove fallback accessors to make sure we don't load unnecessary buffers\n        }\n    }\n}\nexport async function decode(gltfData, options, context) {\n    if (!options?.gltf?.decompressMeshes) {\n        return;\n    }\n    const scenegraph = new GLTFScenegraph(gltfData);\n    const promises = [];\n    for (const primitive of makeMeshPrimitiveIterator(scenegraph)) {\n        if (scenegraph.getObjectExtension(primitive, KHR_DRACO_MESH_COMPRESSION)) {\n            promises.push(decompressPrimitive(scenegraph, primitive, options, context));\n        }\n    }\n    // Decompress meshes in parallel\n    await Promise.all(promises);\n    // We have now decompressed all primitives, so remove the top-level extension\n    scenegraph.removeExtension(KHR_DRACO_MESH_COMPRESSION);\n}\nexport function encode(gltfData, options = {}) {\n    const scenegraph = new GLTFScenegraph(gltfData);\n    for (const mesh of scenegraph.json.meshes || []) {\n        // eslint-disable-next-line camelcase\n        // @ts-ignore\n        compressMesh(mesh, options);\n        // NOTE: Only add the extension if something was actually compressed\n        scenegraph.addRequiredExtension(KHR_DRACO_MESH_COMPRESSION);\n    }\n}\n// DECODE\n// Unpacks one mesh primitive and removes the extension from the primitive\n// DracoDecoder needs to be imported and registered by app\n// Returns: Promise that resolves when all pending draco decoder jobs for this mesh complete\n// TODO - Implement fallback behavior per KHR_DRACO_MESH_COMPRESSION spec\nasync function decompressPrimitive(scenegraph, primitive, options, context) {\n    const dracoExtension = scenegraph.getObjectExtension(primitive, KHR_DRACO_MESH_COMPRESSION);\n    if (!dracoExtension) {\n        return;\n    }\n    const buffer = scenegraph.getTypedArrayForBufferView(dracoExtension.bufferView);\n    // TODO - parse does not yet deal well with byte offsets embedded in typed arrays. Copy buffer\n    // TODO - remove when `parse` is fixed to handle `byteOffset`s\n    const bufferCopy = sliceArrayBuffer(buffer.buffer, buffer.byteOffset); // , buffer.byteLength);\n    const dracoOptions = { ...options };\n    // TODO - remove hack: The entire tileset might be included, too expensive to serialize\n    delete dracoOptions['3d-tiles'];\n    const decodedData = await parseFromContext(bufferCopy, DracoLoader, dracoOptions, context);\n    const decodedAttributes = getGLTFAccessors(decodedData.attributes);\n    // Restore min/max values\n    for (const [attributeName, decodedAttribute] of Object.entries(decodedAttributes)) {\n        if (attributeName in primitive.attributes) {\n            const accessorIndex = primitive.attributes[attributeName];\n            const accessor = scenegraph.getAccessor(accessorIndex);\n            if (accessor?.min && accessor?.max) {\n                decodedAttribute.min = accessor.min;\n                decodedAttribute.max = accessor.max;\n            }\n        }\n    }\n    // @ts-ignore\n    primitive.attributes = decodedAttributes;\n    if (decodedData.indices) {\n        // @ts-ignore\n        primitive.indices = getGLTFAccessor(decodedData.indices);\n    }\n    // Extension has been processed, delete it\n    scenegraph.removeObjectExtension(primitive, KHR_DRACO_MESH_COMPRESSION);\n    checkPrimitive(primitive);\n}\n// ENCODE\n// eslint-disable-next-line max-len\n// Only TRIANGLES: 0x0004 and TRIANGLE_STRIP: 0x0005 are supported\nfunction compressMesh(attributes, indices, mode = 4, options, context) {\n    if (!options.DracoWriter) {\n        throw new Error('options.gltf.DracoWriter not provided');\n    }\n    // TODO - use DracoWriter using encode w/ registered DracoWriter...\n    const compressedData = options.DracoWriter.encodeSync({ attributes });\n    // Draco compression may change the order and number of vertices in a mesh.\n    // To satisfy the requirement that accessors properties be correct for both\n    // compressed and uncompressed data, generators should create uncompressed\n    // attributes and indices using data that has been decompressed from the Draco buffer,\n    // rather than the original source data.\n    // @ts-ignore TODO this needs to be fixed\n    const decodedData = context?.parseSync?.({ attributes });\n    const fauxAccessors = options._addFauxAttributes(decodedData.attributes);\n    const bufferViewIndex = options.addBufferView(compressedData);\n    const glTFMesh = {\n        primitives: [\n            {\n                attributes: fauxAccessors, // TODO - verify with spec\n                mode, // GL.POINTS\n                extensions: {\n                    [KHR_DRACO_MESH_COMPRESSION]: {\n                        bufferView: bufferViewIndex,\n                        attributes: fauxAccessors // TODO - verify with spec\n                    }\n                }\n            }\n        ]\n    };\n    return glTFMesh;\n}\n// UTILS\nfunction checkPrimitive(primitive) {\n    if (!primitive.attributes && Object.keys(primitive.attributes).length > 0) {\n        throw new Error('glTF: Empty primitive detected: Draco decompression failure?');\n    }\n}\nfunction* makeMeshPrimitiveIterator(scenegraph) {\n    for (const mesh of scenegraph.json.meshes || []) {\n        for (const primitive of mesh.primitives) {\n            yield primitive;\n        }\n    }\n}\n", "// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nexport const VERSION = typeof \"4.3.3\" !== 'undefined' ? \"4.3.3\" : 'latest';\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { VERSION } from \"./lib/utils/version.js\";\n/**\n * Worker loader for Draco3D compressed geometries\n */\nexport const DracoLoader = {\n    dataType: null,\n    batchType: null,\n    name: 'Draco',\n    id: 'draco',\n    module: 'draco',\n    // shapes: ['mesh'],\n    version: VERSION,\n    worker: true,\n    extensions: ['drc'],\n    mimeTypes: ['application/octet-stream'],\n    binary: true,\n    tests: ['DRACO'],\n    options: {\n        draco: {\n            decoderType: typeof WebAssembly === 'object' ? 'wasm' : 'js', // 'js' for IE11\n            libraryPath: 'libs/',\n            extraAttributes: {},\n            attributeNameEntry: undefined\n        }\n    }\n};\n", "import { deduceMeshField } from '@loaders.gl/schema';\n/** Extract an arrow-like schema from a Draco mesh */\nexport function getDracoSchema(attributes, loaderData, indices) {\n    const metadata = makeMetadata(loaderData.metadata);\n    const fields = [];\n    const namedLoaderDataAttributes = transformAttributesLoaderData(loaderData.attributes);\n    for (const attributeName in attributes) {\n        const attribute = attributes[attributeName];\n        const field = getArrowFieldFromAttribute(attributeName, attribute, namedLoaderDataAttributes[attributeName]);\n        fields.push(field);\n    }\n    if (indices) {\n        const indicesField = getArrowFieldFromAttribute('indices', indices);\n        fields.push(indicesField);\n    }\n    return { fields, metadata };\n}\nfunction transformAttributesLoaderData(loaderData) {\n    const result = {};\n    for (const key in loaderData) {\n        const dracoAttribute = loaderData[key];\n        result[dracoAttribute.name || 'undefined'] = dracoAttribute;\n    }\n    return result;\n}\nfunction getArrowFieldFromAttribute(attributeName, attribute, loaderData) {\n    const metadataMap = loaderData ? makeMetadata(loaderData.metadata) : undefined;\n    const field = deduceMeshField(attributeName, attribute, metadataMap);\n    return field;\n}\nfunction makeMetadata(metadata) {\n    Object.entries(metadata);\n    const serializedMetadata = {};\n    for (const key in metadata) {\n        serializedMetadata[`${key}.string`] = JSON.stringify(metadata[key]);\n    }\n    return serializedMetadata;\n}\n", "/* eslint-disable camelcase */\nimport { getMeshBoundingBox } from '@loaders.gl/schema';\nimport { getDracoSchema } from \"./utils/get-draco-schema.js\";\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst GEOMETRY_TYPE = {\n    TRIANGULAR_MESH: 0,\n    POINT_CLOUD: 1\n};\n// Native Draco attribute names to GLTF attribute names.\nconst DRACO_TO_GLTF_ATTRIBUTE_NAME_MAP = {\n    POSITION: 'POSITION',\n    NORMAL: 'NORMAL',\n    COLOR: 'COLOR_0',\n    TEX_COORD: 'TEXCOORD_0'\n};\nconst DRACO_DATA_TYPE_TO_TYPED_ARRAY_MAP = {\n    1: Int8Array,\n    2: Uint8Array,\n    3: Int16Array,\n    4: Uint16Array,\n    5: Int32Array,\n    6: Uint32Array,\n    // 7: BigInt64Array,\n    // 8: BigUint64Array,\n    9: Float32Array\n    // 10: Float64Array\n    // 11: BOOL - What array type do we use for this?\n};\nconst INDEX_ITEM_SIZE = 4;\nexport default class DracoParser {\n    draco;\n    decoder;\n    metadataQuerier;\n    // draco - the draco decoder, either import `draco3d` or load dynamically\n    constructor(draco) {\n        this.draco = draco;\n        this.decoder = new this.draco.Decoder();\n        this.metadataQuerier = new this.draco.MetadataQuerier();\n    }\n    /**\n     * Destroy draco resources\n     */\n    destroy() {\n        this.draco.destroy(this.decoder);\n        this.draco.destroy(this.metadataQuerier);\n    }\n    /**\n     * NOTE: caller must call `destroyGeometry` on the return value after using it\n     * @param arrayBuffer\n     * @param options\n     */\n    parseSync(arrayBuffer, options = {}) {\n        const buffer = new this.draco.DecoderBuffer();\n        buffer.Init(new Int8Array(arrayBuffer), arrayBuffer.byteLength);\n        this._disableAttributeTransforms(options);\n        const geometry_type = this.decoder.GetEncodedGeometryType(buffer);\n        const dracoGeometry = geometry_type === this.draco.TRIANGULAR_MESH\n            ? new this.draco.Mesh()\n            : new this.draco.PointCloud();\n        try {\n            let dracoStatus;\n            switch (geometry_type) {\n                case this.draco.TRIANGULAR_MESH:\n                    dracoStatus = this.decoder.DecodeBufferToMesh(buffer, dracoGeometry);\n                    break;\n                case this.draco.POINT_CLOUD:\n                    dracoStatus = this.decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\n                    break;\n                default:\n                    throw new Error('DRACO: Unknown geometry type.');\n            }\n            if (!dracoStatus.ok() || !dracoGeometry.ptr) {\n                const message = `DRACO decompression failed: ${dracoStatus.error_msg()}`;\n                // console.error(message);\n                throw new Error(message);\n            }\n            const loaderData = this._getDracoLoaderData(dracoGeometry, geometry_type, options);\n            const geometry = this._getMeshData(dracoGeometry, loaderData, options);\n            const boundingBox = getMeshBoundingBox(geometry.attributes);\n            const schema = getDracoSchema(geometry.attributes, loaderData, geometry.indices);\n            const data = {\n                loader: 'draco',\n                loaderData,\n                header: {\n                    vertexCount: dracoGeometry.num_points(),\n                    boundingBox\n                },\n                ...geometry,\n                schema\n            };\n            return data;\n        }\n        finally {\n            this.draco.destroy(buffer);\n            if (dracoGeometry) {\n                this.draco.destroy(dracoGeometry);\n            }\n        }\n    }\n    // Draco specific \"loader data\"\n    /**\n     * Extract\n     * @param dracoGeometry\n     * @param geometry_type\n     * @param options\n     * @returns\n     */\n    _getDracoLoaderData(dracoGeometry, geometry_type, options) {\n        const metadata = this._getTopLevelMetadata(dracoGeometry);\n        const attributes = this._getDracoAttributes(dracoGeometry, options);\n        return {\n            geometry_type,\n            num_attributes: dracoGeometry.num_attributes(),\n            num_points: dracoGeometry.num_points(),\n            num_faces: dracoGeometry instanceof this.draco.Mesh ? dracoGeometry.num_faces() : 0,\n            metadata,\n            attributes\n        };\n    }\n    /**\n     * Extract all draco provided information and metadata for each attribute\n     * @param dracoGeometry\n     * @param options\n     * @returns\n     */\n    _getDracoAttributes(dracoGeometry, options) {\n        const dracoAttributes = {};\n        for (let attributeId = 0; attributeId < dracoGeometry.num_attributes(); attributeId++) {\n            // Note: Draco docs do not seem clear on `GetAttribute` ids just being a zero-based index,\n            // but it does seems to work this way\n            const dracoAttribute = this.decoder.GetAttribute(dracoGeometry, attributeId);\n            const metadata = this._getAttributeMetadata(dracoGeometry, attributeId);\n            dracoAttributes[dracoAttribute.unique_id()] = {\n                unique_id: dracoAttribute.unique_id(),\n                attribute_type: dracoAttribute.attribute_type(),\n                data_type: dracoAttribute.data_type(),\n                num_components: dracoAttribute.num_components(),\n                byte_offset: dracoAttribute.byte_offset(),\n                byte_stride: dracoAttribute.byte_stride(),\n                normalized: dracoAttribute.normalized(),\n                attribute_index: attributeId,\n                metadata\n            };\n            // Add transformation parameters for any attributes app wants untransformed\n            const quantization = this._getQuantizationTransform(dracoAttribute, options);\n            if (quantization) {\n                dracoAttributes[dracoAttribute.unique_id()].quantization_transform = quantization;\n            }\n            const octahedron = this._getOctahedronTransform(dracoAttribute, options);\n            if (octahedron) {\n                dracoAttributes[dracoAttribute.unique_id()].octahedron_transform = octahedron;\n            }\n        }\n        return dracoAttributes;\n    }\n    /**\n     * Get standard loaders.gl mesh category data\n     * Extracts the geometry from draco\n     * @param dracoGeometry\n     * @param options\n     */\n    _getMeshData(dracoGeometry, loaderData, options) {\n        const attributes = this._getMeshAttributes(loaderData, dracoGeometry, options);\n        const positionAttribute = attributes.POSITION;\n        if (!positionAttribute) {\n            throw new Error('DRACO: No position attribute found.');\n        }\n        // For meshes, we need indices to define the faces.\n        if (dracoGeometry instanceof this.draco.Mesh) {\n            switch (options.topology) {\n                case 'triangle-strip':\n                    return {\n                        topology: 'triangle-strip',\n                        mode: 4, // GL.TRIANGLES\n                        attributes,\n                        indices: {\n                            value: this._getTriangleStripIndices(dracoGeometry),\n                            size: 1\n                        }\n                    };\n                case 'triangle-list':\n                default:\n                    return {\n                        topology: 'triangle-list',\n                        mode: 5, // GL.TRIANGLE_STRIP\n                        attributes,\n                        indices: {\n                            value: this._getTriangleListIndices(dracoGeometry),\n                            size: 1\n                        }\n                    };\n            }\n        }\n        // PointCloud - must come last as Mesh inherits from PointCloud\n        return {\n            topology: 'point-list',\n            mode: 0, // GL.POINTS\n            attributes\n        };\n    }\n    _getMeshAttributes(loaderData, dracoGeometry, options) {\n        const attributes = {};\n        for (const loaderAttribute of Object.values(loaderData.attributes)) {\n            const attributeName = this._deduceAttributeName(loaderAttribute, options);\n            loaderAttribute.name = attributeName;\n            const values = this._getAttributeValues(dracoGeometry, loaderAttribute);\n            if (values) {\n                const { value, size } = values;\n                attributes[attributeName] = {\n                    value,\n                    size,\n                    byteOffset: loaderAttribute.byte_offset,\n                    byteStride: loaderAttribute.byte_stride,\n                    normalized: loaderAttribute.normalized\n                };\n            }\n        }\n        return attributes;\n    }\n    // MESH INDICES EXTRACTION\n    /**\n     * For meshes, we need indices to define the faces.\n     * @param dracoGeometry\n     */\n    _getTriangleListIndices(dracoGeometry) {\n        // Example on how to retrieve mesh and attributes.\n        const numFaces = dracoGeometry.num_faces();\n        const numIndices = numFaces * 3;\n        const byteLength = numIndices * INDEX_ITEM_SIZE;\n        const ptr = this.draco._malloc(byteLength);\n        try {\n            this.decoder.GetTrianglesUInt32Array(dracoGeometry, byteLength, ptr);\n            return new Uint32Array(this.draco.HEAPF32.buffer, ptr, numIndices).slice();\n        }\n        finally {\n            this.draco._free(ptr);\n        }\n    }\n    /**\n     * For meshes, we need indices to define the faces.\n     * @param dracoGeometry\n     */\n    _getTriangleStripIndices(dracoGeometry) {\n        const dracoArray = new this.draco.DracoInt32Array();\n        try {\n            /* const numStrips = */ this.decoder.GetTriangleStripsFromMesh(dracoGeometry, dracoArray);\n            return getUint32Array(dracoArray);\n        }\n        finally {\n            this.draco.destroy(dracoArray);\n        }\n    }\n    /**\n     *\n     * @param dracoGeometry\n     * @param dracoAttribute\n     * @param attributeName\n     */\n    _getAttributeValues(dracoGeometry, attribute) {\n        const TypedArrayCtor = DRACO_DATA_TYPE_TO_TYPED_ARRAY_MAP[attribute.data_type];\n        if (!TypedArrayCtor) {\n            // eslint-disable-next-line no-console\n            console.warn(`DRACO: Unsupported attribute type ${attribute.data_type}`);\n            return null;\n        }\n        const numComponents = attribute.num_components;\n        const numPoints = dracoGeometry.num_points();\n        const numValues = numPoints * numComponents;\n        const byteLength = numValues * TypedArrayCtor.BYTES_PER_ELEMENT;\n        const dataType = getDracoDataType(this.draco, TypedArrayCtor);\n        let value;\n        const ptr = this.draco._malloc(byteLength);\n        try {\n            const dracoAttribute = this.decoder.GetAttribute(dracoGeometry, attribute.attribute_index);\n            this.decoder.GetAttributeDataArrayForAllPoints(dracoGeometry, dracoAttribute, dataType, byteLength, ptr);\n            value = new TypedArrayCtor(this.draco.HEAPF32.buffer, ptr, numValues).slice();\n        }\n        finally {\n            this.draco._free(ptr);\n        }\n        return { value, size: numComponents };\n    }\n    // Attribute names\n    /**\n     * DRACO does not store attribute names - We need to deduce an attribute name\n     * for each attribute\n    _getAttributeNames(\n      dracoGeometry: Mesh | PointCloud,\n      options: DracoParseOptions\n    ): {[unique_id: number]: string} {\n      const attributeNames: {[unique_id: number]: string} = {};\n      for (let attributeId = 0; attributeId < dracoGeometry.num_attributes(); attributeId++) {\n        const dracoAttribute = this.decoder.GetAttribute(dracoGeometry, attributeId);\n        const attributeName = this._deduceAttributeName(dracoAttribute, options);\n        attributeNames[attributeName] = attributeName;\n      }\n      return attributeNames;\n    }\n     */\n    /**\n     * Deduce an attribute name.\n     * @note DRACO does not save attribute names, just general type (POSITION, COLOR)\n     * to help optimize compression. We generate GLTF compatible names for the Draco-recognized\n     * types\n     * @param attributeData\n     */\n    _deduceAttributeName(attribute, options) {\n        // Deduce name based on application provided map\n        const uniqueId = attribute.unique_id;\n        for (const [attributeName, attributeUniqueId] of Object.entries(options.extraAttributes || {})) {\n            if (attributeUniqueId === uniqueId) {\n                return attributeName;\n            }\n        }\n        // Deduce name based on attribute type\n        const thisAttributeType = attribute.attribute_type;\n        for (const dracoAttributeConstant in DRACO_TO_GLTF_ATTRIBUTE_NAME_MAP) {\n            const attributeType = this.draco[dracoAttributeConstant];\n            if (attributeType === thisAttributeType) {\n                // TODO - Return unique names if there multiple attributes per type\n                // (e.g. multiple TEX_COORDS or COLORS)\n                return DRACO_TO_GLTF_ATTRIBUTE_NAME_MAP[dracoAttributeConstant];\n            }\n        }\n        // Look up in metadata\n        // TODO - shouldn't this have priority?\n        const entryName = options.attributeNameEntry || 'name';\n        if (attribute.metadata[entryName]) {\n            return attribute.metadata[entryName].string;\n        }\n        // Attribute of \"GENERIC\" type, we need to assign some name\n        return `CUSTOM_ATTRIBUTE_${uniqueId}`;\n    }\n    // METADATA EXTRACTION\n    /** Get top level metadata */\n    _getTopLevelMetadata(dracoGeometry) {\n        const dracoMetadata = this.decoder.GetMetadata(dracoGeometry);\n        return this._getDracoMetadata(dracoMetadata);\n    }\n    /** Get per attribute metadata */\n    _getAttributeMetadata(dracoGeometry, attributeId) {\n        const dracoMetadata = this.decoder.GetAttributeMetadata(dracoGeometry, attributeId);\n        return this._getDracoMetadata(dracoMetadata);\n    }\n    /**\n     * Extract metadata field values\n     * @param dracoMetadata\n     * @returns\n     */\n    _getDracoMetadata(dracoMetadata) {\n        // The not so wonderful world of undocumented Draco APIs :(\n        if (!dracoMetadata || !dracoMetadata.ptr) {\n            return {};\n        }\n        const result = {};\n        const numEntries = this.metadataQuerier.NumEntries(dracoMetadata);\n        for (let entryIndex = 0; entryIndex < numEntries; entryIndex++) {\n            const entryName = this.metadataQuerier.GetEntryName(dracoMetadata, entryIndex);\n            result[entryName] = this._getDracoMetadataField(dracoMetadata, entryName);\n        }\n        return result;\n    }\n    /**\n     * Extracts possible values for one metadata entry by name\n     * @param dracoMetadata\n     * @param entryName\n     */\n    _getDracoMetadataField(dracoMetadata, entryName) {\n        const dracoArray = new this.draco.DracoInt32Array();\n        try {\n            // Draco metadata fields can hold int32 arrays\n            this.metadataQuerier.GetIntEntryArray(dracoMetadata, entryName, dracoArray);\n            const intArray = getInt32Array(dracoArray);\n            return {\n                int: this.metadataQuerier.GetIntEntry(dracoMetadata, entryName),\n                string: this.metadataQuerier.GetStringEntry(dracoMetadata, entryName),\n                double: this.metadataQuerier.GetDoubleEntry(dracoMetadata, entryName),\n                intArray\n            };\n        }\n        finally {\n            this.draco.destroy(dracoArray);\n        }\n    }\n    // QUANTIZED ATTRIBUTE SUPPORT (NO DECOMPRESSION)\n    /** Skip transforms for specific attribute types */\n    _disableAttributeTransforms(options) {\n        const { quantizedAttributes = [], octahedronAttributes = [] } = options;\n        const skipAttributes = [...quantizedAttributes, ...octahedronAttributes];\n        for (const dracoAttributeName of skipAttributes) {\n            this.decoder.SkipAttributeTransform(this.draco[dracoAttributeName]);\n        }\n    }\n    /**\n     * Extract (and apply?) Position Transform\n     * @todo not used\n     */\n    _getQuantizationTransform(dracoAttribute, options) {\n        const { quantizedAttributes = [] } = options;\n        const attribute_type = dracoAttribute.attribute_type();\n        const skip = quantizedAttributes.map((type) => this.decoder[type]).includes(attribute_type);\n        if (skip) {\n            const transform = new this.draco.AttributeQuantizationTransform();\n            try {\n                if (transform.InitFromAttribute(dracoAttribute)) {\n                    return {\n                        quantization_bits: transform.quantization_bits(),\n                        range: transform.range(),\n                        min_values: new Float32Array([1, 2, 3]).map((i) => transform.min_value(i))\n                    };\n                }\n            }\n            finally {\n                this.draco.destroy(transform);\n            }\n        }\n        return null;\n    }\n    _getOctahedronTransform(dracoAttribute, options) {\n        const { octahedronAttributes = [] } = options;\n        const attribute_type = dracoAttribute.attribute_type();\n        const octahedron = octahedronAttributes\n            .map((type) => this.decoder[type])\n            .includes(attribute_type);\n        if (octahedron) {\n            const transform = new this.draco.AttributeQuantizationTransform();\n            try {\n                if (transform.InitFromAttribute(dracoAttribute)) {\n                    return {\n                        quantization_bits: transform.quantization_bits()\n                    };\n                }\n            }\n            finally {\n                this.draco.destroy(transform);\n            }\n        }\n        return null;\n    }\n}\n/**\n * Get draco specific data type by TypedArray constructor type\n * @param attributeType\n * @returns draco specific data type\n */\nfunction getDracoDataType(draco, attributeType) {\n    switch (attributeType) {\n        case Float32Array:\n            return draco.DT_FLOAT32;\n        case Int8Array:\n            return draco.DT_INT8;\n        case Int16Array:\n            return draco.DT_INT16;\n        case Int32Array:\n            return draco.DT_INT32;\n        case Uint8Array:\n            return draco.DT_UINT8;\n        case Uint16Array:\n            return draco.DT_UINT16;\n        case Uint32Array:\n            return draco.DT_UINT32;\n        default:\n            return draco.DT_INVALID;\n    }\n}\n/**\n * Copy a Draco int32 array into a JS typed array\n */\nfunction getInt32Array(dracoArray) {\n    const numValues = dracoArray.size();\n    const intArray = new Int32Array(numValues);\n    for (let i = 0; i < numValues; i++) {\n        intArray[i] = dracoArray.GetValue(i);\n    }\n    return intArray;\n}\n/**\n * Copy a Draco int32 array into a JS typed array\n */\nfunction getUint32Array(dracoArray) {\n    const numValues = dracoArray.size();\n    const intArray = new Int32Array(numValues);\n    for (let i = 0; i < numValues; i++) {\n        intArray[i] = dracoArray.GetValue(i);\n    }\n    return intArray;\n}\n", "// Dynamic DRACO module loading inspired by THREE.DRACOLoader\n// https://github.com/mrdoob/three.js/blob/398c4f39ebdb8b23eefd4a7a5ec49ec0c96c7462/examples/jsm/loaders/DRACOLoader.js\n// by Don McCurdy / https://www.donmccurdy.com / MIT license\nimport { loadLibrary } from '@loaders.gl/worker-utils';\nconst DRACO_DECODER_VERSION = '1.5.6';\nconst DRACO_ENCODER_VERSION = '1.4.1';\nconst STATIC_DECODER_URL = `https://www.gstatic.com/draco/versioned/decoders/${DRACO_DECODER_VERSION}`;\nexport const DRACO_EXTERNAL_LIBRARIES = {\n    /** The primary Draco3D encoder, javascript wrapper part */\n    DECODER: 'draco_wasm_wrapper.js',\n    /** The primary draco decoder, compiled web assembly part */\n    DECODER_WASM: 'draco_decoder.wasm',\n    /** Fallback decoder for non-webassebly environments. Very big bundle, lower performance */\n    FALLBACK_DECODER: 'draco_decoder.js',\n    /** Draco encoder */\n    ENCODER: 'draco_encoder.js'\n};\nexport const DRACO_EXTERNAL_LIBRARY_URLS = {\n    [DRACO_EXTERNAL_LIBRARIES.DECODER]: `${STATIC_DECODER_URL}/${DRACO_EXTERNAL_LIBRARIES.DECODER}`,\n    [DRACO_EXTERNAL_LIBRARIES.DECODER_WASM]: `${STATIC_DECODER_URL}/${DRACO_EXTERNAL_LIBRARIES.DECODER_WASM}`,\n    [DRACO_EXTERNAL_LIBRARIES.FALLBACK_DECODER]: `${STATIC_DECODER_URL}/${DRACO_EXTERNAL_LIBRARIES.FALLBACK_DECODER}`,\n    [DRACO_EXTERNAL_LIBRARIES.ENCODER]: `https://raw.githubusercontent.com/google/draco/${DRACO_ENCODER_VERSION}/javascript/${DRACO_EXTERNAL_LIBRARIES.ENCODER}`\n};\nlet loadDecoderPromise;\nlet loadEncoderPromise;\nexport async function loadDracoDecoderModule(options) {\n    const modules = options.modules || {};\n    // Check if a bundled draco3d library has been supplied by application\n    if (modules.draco3d) {\n        loadDecoderPromise ||= modules.draco3d.createDecoderModule({}).then((draco) => {\n            return { draco };\n        });\n    }\n    else {\n        // If not, dynamically load the WASM script from our CDN\n        loadDecoderPromise ||= loadDracoDecoder(options);\n    }\n    return await loadDecoderPromise;\n}\nexport async function loadDracoEncoderModule(options) {\n    const modules = options.modules || {};\n    // Check if a bundled draco3d library has been supplied by application\n    if (modules.draco3d) {\n        loadEncoderPromise ||= modules.draco3d.createEncoderModule({}).then((draco) => {\n            return { draco };\n        });\n    }\n    else {\n        // If not, dynamically load the WASM script from our CDN\n        loadEncoderPromise ||= loadDracoEncoder(options);\n    }\n    return await loadEncoderPromise;\n}\n// DRACO DECODER LOADING\nasync function loadDracoDecoder(options) {\n    let DracoDecoderModule;\n    let wasmBinary;\n    switch (options.draco && options.draco.decoderType) {\n        case 'js':\n            DracoDecoderModule = await loadLibrary(DRACO_EXTERNAL_LIBRARY_URLS[DRACO_EXTERNAL_LIBRARIES.FALLBACK_DECODER], 'draco', options, DRACO_EXTERNAL_LIBRARIES.FALLBACK_DECODER);\n            break;\n        case 'wasm':\n        default:\n            [DracoDecoderModule, wasmBinary] = await Promise.all([\n                await loadLibrary(DRACO_EXTERNAL_LIBRARY_URLS[DRACO_EXTERNAL_LIBRARIES.DECODER], 'draco', options, DRACO_EXTERNAL_LIBRARIES.DECODER),\n                await loadLibrary(DRACO_EXTERNAL_LIBRARY_URLS[DRACO_EXTERNAL_LIBRARIES.DECODER_WASM], 'draco', options, DRACO_EXTERNAL_LIBRARIES.DECODER_WASM)\n            ]);\n    }\n    // Depends on how import happened...\n    // @ts-ignore\n    DracoDecoderModule = DracoDecoderModule || globalThis.DracoDecoderModule;\n    return await initializeDracoDecoder(DracoDecoderModule, wasmBinary);\n}\nfunction initializeDracoDecoder(DracoDecoderModule, wasmBinary) {\n    const options = {};\n    if (wasmBinary) {\n        options.wasmBinary = wasmBinary;\n    }\n    return new Promise((resolve) => {\n        DracoDecoderModule({\n            ...options,\n            onModuleLoaded: (draco) => resolve({ draco }) // Module is Promise-like. Wrap in object to avoid loop.\n        });\n    });\n}\n// ENCODER\nasync function loadDracoEncoder(options) {\n    let DracoEncoderModule = await loadLibrary(DRACO_EXTERNAL_LIBRARY_URLS[DRACO_EXTERNAL_LIBRARIES.ENCODER], 'draco', options, DRACO_EXTERNAL_LIBRARIES.ENCODER);\n    // @ts-ignore\n    DracoEncoderModule = DracoEncoderModule || globalThis.DracoEncoderModule;\n    return new Promise((resolve) => {\n        DracoEncoderModule({\n            onModuleLoaded: (draco) => resolve({ draco }) // Module is Promise-like. Wrap in object to avoid loop.\n        });\n    });\n}\n", "import { DracoLoader as DracoWorkerLoader } from \"./draco-loader.js\";\nimport DracoParser from \"./lib/draco-parser.js\";\nimport { loadDracoDecoderModule } from \"./lib/draco-module-loader.js\";\nimport { VERSION } from \"./lib/utils/version.js\";\n// Module constants\nexport { DRACO_EXTERNAL_LIBRARIES, DRACO_EXTERNAL_LIBRARY_URLS } from \"./lib/draco-module-loader.js\";\nexport { DracoWriter } from \"./draco-writer.js\";\n/**\n * Browser worker doesn't work because of issue during \"draco_encoder.js\" loading.\n * Refused to execute script from 'https://raw.githubusercontent.com/google/draco/1.4.1/javascript/draco_encoder.js' because its MIME type ('') is not executable.\n */\nexport const DracoWriterWorker = {\n    id: 'draco-writer',\n    name: 'Draco compressed geometry writer',\n    module: 'draco',\n    version: VERSION,\n    worker: true,\n    options: {\n        draco: {},\n        source: null\n    }\n};\nexport { DracoWorkerLoader };\n/**\n * Loader for Draco3D compressed geometries\n */\nexport const DracoLoader = {\n    ...DracoWorkerLoader,\n    parse\n};\nasync function parse(arrayBuffer, options) {\n    const { draco } = await loadDracoDecoderModule(options);\n    const dracoParser = new DracoParser(draco);\n    try {\n        return dracoParser.parseSync(arrayBuffer, options?.draco);\n    }\n    finally {\n        dracoParser.destroy();\n    }\n}\n", "// TODO - remove\nimport { getAccessorTypeFromSize, getComponentTypeFromArray } from \"./gltf-utils.js\";\n// Returns a fresh attributes object with glTF-standardized attributes names\n// Attributes that cannot be identified will not be included\n// Removes `indices` if present, as it should be stored separately from the attributes\nexport function getGLTFAccessors(attributes) {\n    const accessors = {};\n    for (const name in attributes) {\n        const attribute = attributes[name];\n        if (name !== 'indices') {\n            const glTFAccessor = getGLTFAccessor(attribute);\n            accessors[name] = glTFAccessor;\n        }\n    }\n    return accessors;\n}\n// Fix up a single accessor.\n// Input: typed array or a partial accessor object\n// Return: accessor object\nexport function getGLTFAccessor(attribute) {\n    const { buffer, size, count } = getAccessorData(attribute);\n    const glTFAccessor = {\n        // glTF Accessor values\n        // TODO: Instead of a bufferView index we could have an actual buffer (typed array)\n        // bufferView: null,\n        // TODO: Deprecate `value` in favor of bufferView?\n        // @ts-ignore\n        value: buffer,\n        size, // Decoded `type` (e.g. SCALAR)\n        byteOffset: 0,\n        count,\n        type: getAccessorTypeFromSize(size),\n        componentType: getComponentTypeFromArray(buffer)\n    };\n    return glTFAccessor;\n}\n// export function getGLTFAttribute(data, gltfAttributeName): GLTFAccessor {\n//   return data.attributes[data.glTFAttributeMap[gltfAttributeName]];\n// }\nfunction getAccessorData(attribute) {\n    let buffer = attribute;\n    let size = 1;\n    let count = 0;\n    if (attribute && attribute.value) {\n        buffer = attribute.value;\n        size = attribute.size || 1;\n    }\n    if (buffer) {\n        if (!ArrayBuffer.isView(buffer)) {\n            buffer = toTypedArray(buffer, Float32Array);\n        }\n        count = buffer.length / size;\n    }\n    return { buffer, size, count };\n}\n// Convert non-typed arrays to arrays of specified format\nfunction toTypedArray(array, ArrayType, convertTypedArrays = false) {\n    if (!array) {\n        return null;\n    }\n    if (Array.isArray(array)) {\n        return new ArrayType(array);\n    }\n    if (convertTypedArrays && !(array instanceof ArrayType)) {\n        return new ArrayType(array);\n    }\n    return array;\n}\n", "/**\n * https://github.com/KhronosGroup/glTF/blob/main/extensions/2.0/Khronos/KHR_texture_transform/README.md\n */\nimport { Vector3, Matrix3 } from '@math.gl/core';\nimport { getAccessorArrayTypeAndLength } from \"../gltf-utils/gltf-utils.js\";\nimport { BYTES, COMPONENTS } from \"../gltf-utils/gltf-constants.js\";\nimport { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\n/** Extension name */\nconst KHR_TEXTURE_TRANSFORM = 'KHR_texture_transform';\nexport const name = KHR_TEXTURE_TRANSFORM;\nconst scratchVector = new Vector3();\nconst scratchRotationMatrix = new Matrix3();\nconst scratchScaleMatrix = new Matrix3();\n/**\n * The extension entry to process the transformation\n * @param gltfData gltf buffers and json\n * @param options GLTFLoader options\n */\nexport async function decode(gltfData, options) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const hasExtension = gltfScenegraph.hasExtension(KHR_TEXTURE_TRANSFORM);\n    if (!hasExtension || !options.gltf?.loadBuffers) {\n        return;\n    }\n    const materials = gltfData.json.materials || [];\n    for (let i = 0; i < materials.length; i++) {\n        transformTexCoords(i, gltfData);\n    }\n}\n/**\n * Transform TEXCOORD by material\n * @param materialIndex processing material index\n * @param gltfData gltf buffers and json\n */\nfunction transformTexCoords(materialIndex, gltfData) {\n    const material = gltfData.json.materials?.[materialIndex];\n    const materialTextures = [\n        material?.pbrMetallicRoughness?.baseColorTexture,\n        material?.emissiveTexture,\n        material?.normalTexture,\n        material?.occlusionTexture,\n        material?.pbrMetallicRoughness?.metallicRoughnessTexture\n    ];\n    // Save processed texCoords in order no to process the same twice\n    const processedTexCoords = [];\n    for (const textureInfo of materialTextures) {\n        if (textureInfo && textureInfo?.extensions?.[KHR_TEXTURE_TRANSFORM]) {\n            transformPrimitives(gltfData, materialIndex, textureInfo, processedTexCoords);\n        }\n    }\n}\n/**\n * Transform primitives of the particular material\n * @param gltfData gltf data\n * @param materialIndex primitives with this material will be transformed\n * @param texture texture object\n * @param processedTexCoords storage to save already processed texCoords\n */\nfunction transformPrimitives(gltfData, materialIndex, texture, processedTexCoords) {\n    const transformParameters = getTransformParameters(texture, processedTexCoords);\n    if (!transformParameters) {\n        return;\n    }\n    const meshes = gltfData.json.meshes || [];\n    for (const mesh of meshes) {\n        for (const primitive of mesh.primitives) {\n            const material = primitive.material;\n            if (Number.isFinite(material) && materialIndex === material) {\n                transformPrimitive(gltfData, primitive, transformParameters);\n            }\n        }\n    }\n}\n/**\n * Get parameters for TEXCOORD transformation\n * @param texture texture object\n * @param processedTexCoords storage to save already processed texCoords\n * @returns texCoord couple and transformation matrix\n */\nfunction getTransformParameters(texture, processedTexCoords) {\n    const textureInfo = texture.extensions?.[KHR_TEXTURE_TRANSFORM];\n    const { texCoord: originalTexCoord = 0 } = texture;\n    // If texCoord is not set in the extension, original attribute data will be replaced\n    const { texCoord = originalTexCoord } = textureInfo;\n    // Make sure that couple [originalTexCoord, extensionTexCoord] is not processed twice\n    const isProcessed = processedTexCoords.findIndex(([original, newTexCoord]) => original === originalTexCoord && newTexCoord === texCoord) !== -1;\n    if (!isProcessed) {\n        const matrix = makeTransformationMatrix(textureInfo);\n        if (originalTexCoord !== texCoord) {\n            texture.texCoord = texCoord;\n        }\n        processedTexCoords.push([originalTexCoord, texCoord]);\n        return { originalTexCoord, texCoord, matrix };\n    }\n    return null;\n}\n/**\n * Transform `TEXCOORD_0` attribute in the primitive\n * @param gltfData gltf data\n * @param primitive primitive object\n * @param transformParameters texCoord couple and transformation matrix\n */\nfunction transformPrimitive(gltfData, primitive, transformParameters) {\n    const { originalTexCoord, texCoord, matrix } = transformParameters;\n    const texCoordAccessor = primitive.attributes[`TEXCOORD_${originalTexCoord}`];\n    if (Number.isFinite(texCoordAccessor)) {\n        // Get accessor of the `TEXCOORD_0` attribute\n        const accessor = gltfData.json.accessors?.[texCoordAccessor];\n        if (accessor && accessor.bufferView) {\n            // Get `bufferView` of the `accessor`\n            const bufferView = gltfData.json.bufferViews?.[accessor.bufferView];\n            if (bufferView) {\n                // Get `arrayBuffer` the `bufferView` look at\n                const { arrayBuffer, byteOffset: bufferByteOffset } = gltfData.buffers[bufferView.buffer];\n                // Resulting byteOffset is sum of the buffer, accessor and bufferView byte offsets\n                const byteOffset = (bufferByteOffset || 0) + (accessor.byteOffset || 0) + (bufferView.byteOffset || 0);\n                // Deduce TypedArray type and its length from `accessor` and `bufferView` data\n                const { ArrayType, length } = getAccessorArrayTypeAndLength(accessor, bufferView);\n                // Number of bytes each component occupies\n                const bytes = BYTES[accessor.componentType];\n                // Number of components. For the `TEXCOORD_0` with `VEC2` type, it must return 2\n                const components = COMPONENTS[accessor.type];\n                // Multiplier to calculate the address of the `TEXCOORD_0` element in the arrayBuffer\n                const elementAddressScale = bufferView.byteStride || bytes * components;\n                // Data transform to Float32Array\n                const result = new Float32Array(length);\n                for (let i = 0; i < accessor.count; i++) {\n                    // Take [u, v] couple from the arrayBuffer\n                    const uv = new ArrayType(arrayBuffer, byteOffset + i * elementAddressScale, 2);\n                    // Set and transform Vector3 per https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_texture_transform#overview\n                    scratchVector.set(uv[0], uv[1], 1);\n                    scratchVector.transformByMatrix3(matrix);\n                    // Save result in Float32Array\n                    result.set([scratchVector[0], scratchVector[1]], i * components);\n                }\n                // If texCoord the same, replace gltf structural data\n                if (originalTexCoord === texCoord) {\n                    updateGltf(accessor, bufferView, gltfData.buffers, result);\n                }\n                else {\n                    // If texCoord change, create new attribute\n                    createAttribute(texCoord, accessor, primitive, gltfData, result);\n                }\n            }\n        }\n    }\n}\n/**\n * Update GLTF structural objects with new data as we create new `Float32Array` for `TEXCOORD_0`.\n * @param accessor accessor to change\n * @param bufferView bufferView to change\n * @param buffers binary buffers\n * @param newTexcoordArray typed array with data after transformation\n */\nfunction updateGltf(accessor, bufferView, buffers, newTexCoordArray) {\n    accessor.componentType = 5126;\n    buffers.push({\n        arrayBuffer: newTexCoordArray.buffer,\n        byteOffset: 0,\n        byteLength: newTexCoordArray.buffer.byteLength\n    });\n    bufferView.buffer = buffers.length - 1;\n    bufferView.byteLength = newTexCoordArray.buffer.byteLength;\n    bufferView.byteOffset = 0;\n    delete bufferView.byteStride;\n}\n/**\n *\n * @param newTexCoord new `texCoord` value\n * @param originalAccessor original accessor object, that store data before transformation\n * @param primitive primitive object\n * @param gltfData gltf data\n * @param newTexCoordArray typed array with data after transformation\n * @returns\n */\nfunction createAttribute(newTexCoord, originalAccessor, primitive, gltfData, newTexCoordArray) {\n    gltfData.buffers.push({\n        arrayBuffer: newTexCoordArray.buffer,\n        byteOffset: 0,\n        byteLength: newTexCoordArray.buffer.byteLength\n    });\n    const bufferViews = gltfData.json.bufferViews;\n    if (!bufferViews) {\n        return;\n    }\n    bufferViews.push({\n        buffer: gltfData.buffers.length - 1,\n        byteLength: newTexCoordArray.buffer.byteLength,\n        byteOffset: 0\n    });\n    const accessors = gltfData.json.accessors;\n    if (!accessors) {\n        return;\n    }\n    accessors.push({\n        bufferView: bufferViews?.length - 1,\n        byteOffset: 0,\n        componentType: 5126,\n        count: originalAccessor.count,\n        type: 'VEC2'\n    });\n    primitive.attributes[`TEXCOORD_${newTexCoord}`] = accessors.length - 1;\n}\n/**\n * Construct transformation matrix from the extension data (transition, rotation, scale)\n * @param extensionData extension data\n * @returns transformation matrix\n */\nfunction makeTransformationMatrix(extensionData) {\n    const { offset = [0, 0], rotation = 0, scale = [1, 1] } = extensionData;\n    const translationMatrix = new Matrix3().set(1, 0, 0, 0, 1, 0, offset[0], offset[1], 1);\n    const rotationMatrix = scratchRotationMatrix.set(Math.cos(rotation), Math.sin(rotation), 0, -Math.sin(rotation), Math.cos(rotation), 0, 0, 0, 1);\n    const scaleMatrix = scratchScaleMatrix.set(scale[0], 0, 0, 0, scale[1], 0, 0, 0, 1);\n    return translationMatrix.multiplyRight(rotationMatrix).multiplyRight(scaleMatrix);\n}\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n\n/* eslint-disable no-shadow */ // radians and degrees are common variable names\n\nimport type {NumericArray} from '@math.gl/types';\n\nimport type {MathArray} from '../classes/base/math-array';\n\nconst RADIANS_TO_DEGREES = (1 / Math.PI) * 180;\nconst DEGREES_TO_RADIANS = (1 / 180) * Math.PI;\n\nexport type ConfigurationOptions = {\n  EPSILON: number;\n  debug?: boolean;\n  precision: number;\n  printTypes?: boolean;\n  printDegrees?: boolean;\n  printRowMajor?: boolean;\n  _cartographicRadians?: boolean;\n};\n\nconst DEFAULT_CONFIG: Required<ConfigurationOptions> = {\n  EPSILON: 1e-12,\n  debug: false,\n  precision: 4,\n  printTypes: false,\n  printDegrees: false,\n  printRowMajor: true,\n  _cartographicRadians: false\n};\n\n// We use a global field to store the config\ndeclare global {\n  // eslint-disable-next-line no-var\n  var mathgl: {\n    config: Required<ConfigurationOptions>;\n  };\n}\n\n// Configuration is truly global as of v3.6 to ensure single config even if multiple copies of math.gl\n// Multiple copies of config can be quite tricky to debug...\nglobalThis.mathgl = globalThis.mathgl || {config: {...DEFAULT_CONFIG}};\n\nexport const config = globalThis.mathgl.config;\n\nexport function configure(options: Partial<ConfigurationOptions>): ConfigurationOptions {\n  // Only copy existing keys\n  Object.assign(config, options);\n  return config;\n}\n\n/**\n * Formats a value into a string\n * @param value\n * @param param1\n * @returns\n */\nexport function formatValue(\n  value: number,\n  {precision = config.precision}: {precision?: number} = {}\n): string {\n  value = round(value);\n  // get rid of trailing zeros\n  return `${parseFloat(value.toPrecision(precision))}`;\n}\n\n/**\n * Check if value is an \"array\"\n * Returns `true` if value is either an array or a typed array\n * Note: returns `false` for `ArrayBuffer` and `DataView` instances\n * @note isTypedArray and isNumericArray are often more useful in TypeScript\n */\nexport function isArray(value: unknown): boolean {\n  return Array.isArray(value) || (ArrayBuffer.isView(value) && !(value instanceof DataView));\n}\n\nexport function clone(array: NumericArray | MathArray): NumericArray {\n  return 'clone' in array ? array.clone() : array.slice();\n}\n\nexport function toRadians(degrees: number): number;\nexport function toRadians(degrees: NumericArray): NumericArray;\n\nexport function toRadians(degrees: number | NumericArray): number | NumericArray {\n  return radians(degrees as NumericArray);\n}\n\nexport function toDegrees(degrees: number): number;\nexport function toDegrees(degrees: NumericArray): NumericArray;\n\nexport function toDegrees(radians: number | NumericArray): number | NumericArray {\n  return degrees(radians as NumericArray);\n}\n\n// GLSL math function equivalents - Works on both single values and vectors\n\n/**\n * \"GLSL equivalent\" radians: Works on single values and vectors\n */\nexport function radians(degrees: number): number;\nexport function radians(degrees: NumericArray, result?: NumericArray): NumericArray;\n\nexport function radians(\n  degrees: number | NumericArray,\n  result?: NumericArray\n): number | NumericArray {\n  return map(degrees, (degrees) => degrees * DEGREES_TO_RADIANS, result);\n}\n\n/**\n * \"GLSL equivalent\" degrees: Works on single values and vectors\n */\nexport function degrees(radians: number): number;\nexport function degrees(radians: NumericArray, result?: NumericArray): NumericArray;\n\nexport function degrees(\n  radians: number | NumericArray,\n  result?: NumericArray\n): number | NumericArray {\n  return map(radians, (radians) => radians * RADIANS_TO_DEGREES, result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.sin`: Works on single values and vectors\n * @deprecated\n */\nexport function sin(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.sin(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.cos`: Works on single values and vectors\n * @deprecated\n */\nexport function cos(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.cos(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.tan`: Works on single values and vectors\n * @deprecated\n */\nexport function tan(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.tan(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.asin`: Works on single values and vectors\n * @deprecated\n */\nexport function asin(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.asin(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.acos`: Works on single values and vectors\n * @deprecated\n */\nexport function acos(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.acos(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.atan`: Works on single values and vectors\n * @deprecated\n */\nexport function atan(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.atan(angle), result);\n}\n\n/**\n * GLSL style value clamping: Works on single values and vectors\n */\nexport function clamp(value: number, min: number, max: number): number;\nexport function clamp(value: NumericArray, min: number, max: number): NumericArray;\n\nexport function clamp(\n  value: number | NumericArray,\n  min: number,\n  max: number\n): number | NumericArray {\n  return map(value, (value) => Math.max(min, Math.min(max, value)));\n}\n\n/**\n * Interpolate between two numbers or two arrays\n */\nexport function lerp(a: number, b: number, t: number): number;\nexport function lerp(a: NumericArray, b: NumericArray, t: number): NumericArray;\n\nexport function lerp(\n  a: number | NumericArray,\n  b: number | NumericArray,\n  t: number\n): number | NumericArray {\n  if (isArray(a)) {\n    return (a as NumericArray).map((ai: number, i: number) => lerp(ai, (b as NumericArray)[i], t));\n  }\n  return t * (b as number) + (1 - t) * (a as number);\n}\n\n/* eslint-disable */\n\n/**\n * Compares any two math objects, using `equals` method if available.\n * @param a\n * @param b\n * @param epsilon\n * @returns\n */\nexport function equals(a: any, b: any, epsilon?: number): boolean {\n  const oldEpsilon = config.EPSILON;\n  if (epsilon) {\n    config.EPSILON = epsilon;\n  }\n  try {\n    if (a === b) {\n      return true;\n    }\n    if (isArray(a) && isArray(b)) {\n      if (a.length !== b.length) {\n        return false;\n      }\n      for (let i = 0; i < a.length; ++i) {\n        // eslint-disable-next-line max-depth\n        if (!equals(a[i], b[i])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    if (a && a.equals) {\n      return a.equals(b);\n    }\n    if (b && b.equals) {\n      return b.equals(a);\n    }\n    if (typeof a === 'number' && typeof b === 'number') {\n      return Math.abs(a - b) <= config.EPSILON * Math.max(1, Math.abs(a), Math.abs(b));\n    }\n    return false;\n  } finally {\n    config.EPSILON = oldEpsilon;\n  }\n}\n\nexport function exactEquals(a: any, b: any): boolean {\n  if (a === b) {\n    return true;\n  }\n  if (a && typeof a === 'object' && b && typeof b === 'object') {\n    if (a.constructor !== b.constructor) {\n      return false;\n    }\n    if (a.exactEquals) {\n      return a.exactEquals(b);\n    }\n  }\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; ++i) {\n      if (!exactEquals(a[i], b[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n/* eslint-enable */\n\nexport function withEpsilon<T>(epsilon: number, func: () => T): T {\n  const oldPrecision = config.EPSILON;\n  config.EPSILON = epsilon;\n  let value: T;\n  try {\n    value = func();\n  } finally {\n    config.EPSILON = oldPrecision;\n  }\n  return value;\n}\n\n// HELPERS\n\nfunction round(value: number): number {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\n// If the array has a clone function, calls it, otherwise returns a copy\nfunction duplicateArray(array: NumericArray): NumericArray {\n  // @ts-expect-error We check for math.gl class methods\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n  return array.clone ? (array.clone() as NumericArray) : (new Array(array.length) as number[]);\n}\n\n// If the argument value is an array, applies the func element wise,\n// otherwise applies func to the argument value\nfunction map(\n  value: number | NumericArray,\n  func: (x: number, index?: number, resultArray?: NumericArray) => number,\n  result?: NumericArray\n): number | NumericArray {\n  if (isArray(value)) {\n    const array = value as NumericArray;\n    result = result || duplicateArray(array);\n    for (let i = 0; i < result.length && i < array.length; ++i) {\n      const val = typeof value === 'number' ? value : value[i];\n      result[i] = func(val, i, result);\n    }\n    return result;\n  }\n  return func(value as number);\n}\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n\nimport {NumericArray} from '@math.gl/types';\nimport {ConfigurationOptions, config, formatValue, equals, isArray} from '../../lib/common';\n\n/** Base class for vectors and matrices */\nexport abstract class MathArray extends Array<number> {\n  /** Number of elements (values) in this array */\n  abstract get ELEMENTS(): number;\n\n  abstract copy(vector: Readonly<NumericArray>): this;\n\n  abstract fromObject(object: Record<string, unknown>): this;\n\n  // Common methods\n\n  /**\n   * Clone the current object\n   * @returns a new copy of this object\n   */\n  clone(): this {\n    // @ts-expect-error TS2351: Cannot use 'new' with an expression whose type lacks a call or construct signature.\n    return new this.constructor().copy(this); // eslint-disable-line\n  }\n\n  fromArray(array: Readonly<NumericArray>, offset: number = 0): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = array[i + offset];\n    }\n    return this.check();\n  }\n\n  toArray<TypedArray>(targetArray: TypedArray, offset?: number): TypedArray;\n  toArray(targetArray?: number[], offset?: number): NumericArray;\n\n  toArray(targetArray: NumericArray = [], offset: number = 0): NumericArray {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      targetArray[offset + i] = this[i];\n    }\n    return targetArray;\n  }\n\n  toObject(targetObject: Record<string, unknown>): Record<string, unknown> {\n    return targetObject;\n  }\n\n  from(arrayOrObject: Readonly<NumericArray> | Record<string, unknown>): this {\n    return Array.isArray(arrayOrObject)\n      ? this.copy(arrayOrObject)\n      : // @ts-ignore\n        this.fromObject(arrayOrObject);\n  }\n\n  to<T extends NumericArray | Record<string, unknown>>(arrayOrObject: T): T {\n    // @ts-ignore\n    if (arrayOrObject === this) {\n      return this as T;\n    }\n    // @ts-expect-error TS2339: Property 'toObject' does not exist on type 'MathArray'.\n    return isArray(arrayOrObject) ? this.toArray(arrayOrObject) : this.toObject(arrayOrObject);\n  }\n\n  toTarget(target: this): this {\n    return target ? this.to(target) : this;\n  }\n\n  /** @deprecated */\n  toFloat32Array(): Float32Array {\n    return new Float32Array(this);\n  }\n\n  override toString(): string {\n    return this.formatString(config);\n  }\n\n  /** Formats string according to options */\n  formatString(opts: ConfigurationOptions): string {\n    let string = '';\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      string += (i > 0 ? ', ' : '') + formatValue(this[i], opts);\n    }\n    return `${opts.printTypes ? this.constructor.name : ''}[${string}]`;\n  }\n\n  equals(array: Readonly<NumericArray>): boolean {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (!equals(this[i], array[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  exactEquals(array: Readonly<NumericArray>): boolean {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (this[i] !== array[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  // Modifiers\n\n  /** Negates all values in this object */\n  negate(): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = -this[i];\n    }\n    return this.check();\n  }\n\n  /** Linearly interpolates between two values */\n  lerp(a: Readonly<NumericArray>, t: number): this;\n  lerp(a: Readonly<NumericArray>, b: Readonly<NumericArray>, t: number): this;\n\n  lerp(a: Readonly<NumericArray>, b: Readonly<NumericArray> | number, t?: number): this {\n    if (t === undefined) {\n      return this.lerp(this, a, b as number);\n    }\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const ai = a[i];\n      const endValue = typeof b === 'number' ? b : b[i];\n      this[i] = ai + t * (endValue - ai);\n    }\n    return this.check();\n  }\n\n  /** Minimal */\n  min(vector: Readonly<NumericArray>): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(vector[i], this[i]);\n    }\n    return this.check();\n  }\n\n  /** Maximal */\n  max(vector: Readonly<NumericArray>): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.max(vector[i], this[i]);\n    }\n    return this.check();\n  }\n\n  clamp(minVector: Readonly<NumericArray>, maxVector: Readonly<NumericArray>): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], minVector[i]), maxVector[i]);\n    }\n    return this.check();\n  }\n\n  add(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] += vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  subtract(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] -= vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  scale(scale: number | Readonly<NumericArray>): this {\n    if (typeof scale === 'number') {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= scale;\n      }\n    } else {\n      for (let i = 0; i < this.ELEMENTS && i < scale.length; ++i) {\n        this[i] *= scale[i];\n      }\n    }\n    return this.check();\n  }\n\n  /**\n   * Multiplies all elements by `scale`\n   * Note: `Matrix4.multiplyByScalar` only scales its 3x3 \"minor\"\n   */\n  multiplyByScalar(scalar: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n    return this.check();\n  }\n\n  // Debug checks\n\n  /** Throws an error if array length is incorrect or contains illegal values */\n  check(): this {\n    if (config.debug && !this.validate()) {\n      throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);\n    }\n    return this;\n  }\n\n  /** Returns false if the array length is incorrect or contains illegal values */\n  validate(): boolean {\n    let valid = this.length === this.ELEMENTS;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      valid = valid && Number.isFinite(this[i]);\n    }\n    return valid;\n  }\n\n  // three.js compatibility\n\n  /** @deprecated */\n  sub(a: Readonly<NumericArray>): this {\n    return this.subtract(a);\n  }\n\n  /** @deprecated */\n  setScalar(a: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = a;\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  addScalar(a: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] += a;\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  subScalar(a: number): this {\n    return this.addScalar(-a);\n  }\n\n  /** @deprecated */\n  multiplyScalar(scalar: number): this {\n    // Multiplies all elements\n    // `Matrix4.scale` only scales its 3x3 \"minor\"\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  divideScalar(a: number): this {\n    return this.multiplyByScalar(1 / a);\n  }\n\n  /** @deprecated */\n  clampScalar(min: number, max: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], min), max);\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  get elements(): NumericArray {\n    return this;\n  }\n}\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n\nimport {NumericArray} from '@math.gl/types';\nimport {config} from './common';\n\nexport function validateVector(v: NumericArray, length: number): boolean {\n  if (v.length !== length) {\n    return false;\n  }\n  // Could be arguments \"array\" (v.every not availasble)\n  for (let i = 0; i < v.length; ++i) {\n    if (!Number.isFinite(v[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function checkNumber(value: unknown): number {\n  if (!Number.isFinite(value)) {\n    throw new Error(`Invalid number ${JSON.stringify(value)}`);\n  }\n  return value as number;\n}\n\nexport function checkVector<T extends NumericArray>(\n  v: T,\n  length: number,\n  callerName: string = ''\n): T {\n  if (config.debug && !validateVector(v, length)) {\n    throw new Error(`math.gl: ${callerName} some fields set to invalid numbers'`);\n  }\n  return v;\n}\n\nconst map: Record<string, boolean> = {};\n\nexport function deprecated(method: string, version: string): void {\n  if (!map[method]) {\n    map[method] = true;\n    // eslint-disable-next-line\n    console.warn(\n      `${method} has been removed in version ${version}, see upgrade guide for more information`\n    );\n  }\n}\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n\nexport function assert(condition: unknown, message?: string): void {\n  if (!condition) {\n    throw new Error(`math.gl assertion ${message}`);\n  }\n}\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Copyright (c) 2017 Uber Technologies, Inc.\n\nimport {NumericArray} from '@math.gl/types';\nimport {MathArray} from './math-array';\nimport {checkNumber} from '../../lib/validators';\nimport {assert} from '../../lib/assert';\n\n/** Base class for vectors with at least 2 elements */\nexport abstract class Vector extends MathArray {\n  // ACCESSORS\n\n  get x(): number {\n    return this[0];\n  }\n\n  set x(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get y(): number {\n    return this[1];\n  }\n\n  set y(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  /**\n   * Returns the length of the vector from the origin to the point described by this vector\n   *\n   * @note `length` is a reserved word for Arrays, so `v.length()` will return number of elements\n   * Instead we provide `len` and `magnitude`\n   */\n  len(): number {\n    return Math.sqrt(this.lengthSquared());\n  }\n\n  /**\n   * Returns the length of the vector from the origin to the point described by this vector\n   */\n  magnitude(): number {\n    return this.len();\n  }\n\n  /**\n   * Returns the squared length of the vector from the origin to the point described by this vector\n   */\n  lengthSquared(): number {\n    let length = 0;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      length += this[i] * this[i];\n    }\n    return length;\n  }\n\n  /**\n   * Returns the squared length of the vector from the origin to the point described by this vector\n   */\n  magnitudeSquared(): number {\n    return this.lengthSquared();\n  }\n\n  distance(mathArray: Readonly<NumericArray>): number {\n    return Math.sqrt(this.distanceSquared(mathArray));\n  }\n\n  distanceSquared(mathArray: Readonly<NumericArray>): number {\n    let length = 0;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const dist = this[i] - mathArray[i];\n      length += dist * dist;\n    }\n    return checkNumber(length);\n  }\n\n  dot(mathArray: Readonly<NumericArray>): number {\n    let product = 0;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      product += this[i] * mathArray[i];\n    }\n    return checkNumber(product);\n  }\n\n  // MODIFIERS\n\n  normalize(): this {\n    const length = this.magnitude();\n    if (length !== 0) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= length;\n      }\n    }\n    return this.check();\n  }\n\n  multiply(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  divide(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  // THREE.js compatibility\n\n  lengthSq(): number {\n    return this.lengthSquared();\n  }\n  distanceTo(vector: Readonly<NumericArray>): number {\n    return this.distance(vector);\n  }\n  distanceToSquared(vector: Readonly<NumericArray>): number {\n    return this.distanceSquared(vector);\n  }\n\n  getComponent(i: number): number {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    return checkNumber(this[i]);\n  }\n\n  setComponent(i: number, value: number): this {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    this[i] = value;\n    return this.check();\n  }\n\n  addVectors(a: Readonly<NumericArray>, b: Readonly<NumericArray>): this {\n    return this.copy(a).add(b);\n  }\n\n  subVectors(a: Readonly<NumericArray>, b: Readonly<NumericArray>): this {\n    return this.copy(a).subtract(b);\n  }\n\n  multiplyVectors(a: Readonly<NumericArray>, b: Readonly<NumericArray>): this {\n    return this.copy(a).multiply(b);\n  }\n\n  addScaledVector(a: Readonly<NumericArray>, b: number): this {\n    // @ts-expect-error error TS2351: Cannot use 'new' with an expression whose type lacks a call or construct signature.\n    return this.add((new this.constructor(a) as this).multiplyScalar(b));\n  }\n}\n", "// @eslint-disable\n// @ts-nocheck\n\n/**\n * Common utilities\n * @module glMatrix\n */\n\n// Configuration Constants\nexport const EPSILON = 0.000001;\nexport let ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport const RANDOM = Math.random;\nexport const ANGLE_ORDER = 'zyx';\n\n/**\n * Symmetric round\n * see https://www.npmjs.com/package/round-half-up-symmetric#user-content-detailed-background\n *\n * @param {Number} a value to round\n */\nexport function round(a) {\n  if (a >= 0) return Math.round(a);\n\n  return a % 0.5 === 0 ? Math.floor(a) : Math.round(a);\n}\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\n\nconst degree = Math.PI / 180;\n\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\nexport function toRadian(a) {\n  return a * degree;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\n", "// @eslint-disable\n// @ts-nocheck\n\nimport type {NumericArray} from '@math.gl/types';\nimport * as glMatrix from './common.js';\n\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns a new 2D vector\n */\nexport function create(): NumericArray {\n  const out = new glMatrix.ARRAY_TYPE(2);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param a vector to clone\n * @returns a new 2D vector\n */\nexport function clone(a: Readonly<NumericArray>): NumericArray {\n  const out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param x X component\n * @param y Y component\n * @returns a new 2D vector\n */\nexport function fromValues(x: number, y: number): NumericArray {\n  const out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Copy the values from one vec2 to another\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the source vector\n * @returns {NumericArray} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {NumericArray} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {NumericArray} out\n */\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Adds two vec2's\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {NumericArray} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {NumericArray} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n\n/**\n * Multiplies two vec2's\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {NumericArray} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n\n/**\n * Divides two vec2's\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {NumericArray} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a vector to ceil\n * @returns {NumericArray} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a vector to floor\n * @returns {NumericArray} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec2's\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {NumericArray} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec2's\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {NumericArray} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a vector to round\n * @returns {NumericArray} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  return out;\n}\n\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {NumericArray} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {NumericArray} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  const x = b[0] - a[0];\n  const y = b[1] - a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  const x = b[0] - a[0];\n  const y = b[1] - a[1];\n  return x * x + y * y;\n}\n\n/**\n * Calculates the length of a vec2\n *\n * @param {Readonly<NumericArray>} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  const x = a[0];\n  const y = a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared length of a vec2\n *\n * @param {Readonly<NumericArray>} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  const x = a[0];\n  const y = a[1];\n  return x * x + y * y;\n}\n\n/**\n * Negates the components of a vec2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a vector to negate\n * @returns {NumericArray} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a vector to invert\n * @returns {NumericArray} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n\n/**\n * Normalize a vec2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a vector to normalize\n * @returns {NumericArray} out\n */\nexport function normalize(out, a) {\n  const x = a[0];\n  const y = a[1];\n  let len = x * x + y * y;\n  if (len > 0) {\n    // TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  const z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the first operand\n * @param {Readonly<NumericArray>} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {NumericArray} out\n */\nexport function lerp(out, a, b, t) {\n  const ax = a[0];\n  const ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {NumericArray} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {NumericArray} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  const r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {NumericArray} out\n */\nexport function transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {NumericArray} out\n */\nexport function transformMat2d(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {NumericArray} out\n */\nexport function transformMat3(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {NumericArray} out the receiving vector\n * @param {Readonly<NumericArray>} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {NumericArray} out\n */\nexport function transformMat4(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n\n/**\n * Rotate a 2D vector\n * @param {NumericArray} out The receiving vec2\n * @param {Readonly<NumericArray>} a The vec2 point to rotate\n * @param {Readonly<NumericArray>} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {NumericArray} out\n */\nexport function rotate(out, a, b, rad) {\n  // Translate point to the origin\n  const p0 = a[0] - b[0];\n  const p1 = a[1] - b[1];\n  const sinC = Math.sin(rad);\n  const cosC = Math.cos(rad);\n\n  // perform rotation and translate to correct position\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n\n  return out;\n}\n\n/**\n * Get the angle between two 2D vectors\n * @param {Readonly<NumericArray>} a The first operand\n * @param {Readonly<NumericArray>} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  const x1 = a[0];\n  const y1 = a[1];\n  const x2 = b[0];\n  const y2 = b[1];\n  // mag is the product of the magnitudes of a and b\n  const mag = Math.sqrt((x1 * x1 + y1 * y1) * (x2 * x2 + y2 * y2));\n  // mag &&.. short circuits if mag == 0\n  const cosine = mag && (x1 * x2 + y1 * y2) / mag;\n  // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n\n/**\n * Set the components of a vec2 to zero\n *\n * @param {NumericArray} out the receiving vector\n * @returns {NumericArray} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {Readonly<NumericArray>} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return `vec2(${a[0]}, ${a[1]})`;\n}\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {Readonly<NumericArray>} a The first vector.\n * @param {Readonly<NumericArray>} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {Readonly<NumericArray>} a The first vector.\n * @param {Readonly<NumericArray>} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  const a0 = a[0];\n  const a1 = a[1];\n  const b0 = b[0];\n  const b1 = b[1];\n  return (\n    Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n    Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1))\n  );\n}\n\n/**\n * Alias for {@link vec2.length}\n * @function\n */\nexport const len = length;\n\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\nexport const sub = subtract;\n\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\nexport const mul = multiply;\n\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\nexport const div = divide;\n\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\nexport const dist = distance;\n\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\nexport const sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\nexport const sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport const forEach = (function () {\n  const vec = create();\n\n  return function (a, stride, offset, count, fn, arg) {\n    let i;\n    let l;\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n})();\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n\n/* eslint-disable camelcase */\nimport {NumericArray} from '@math.gl/types';\n// vec2 additions\n\nexport function vec2_transformMat4AsVector<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  const w = m[3] * x + m[7] * y || 1.0;\n  out[0] = (m[0] * x + m[4] * y) / w;\n  out[1] = (m[1] * x + m[5] * y) / w;\n  return out;\n}\n\n// vec3 additions\n\n// Transform as vector, only uses 3x3 minor matrix\nexport function vec3_transformMat4AsVector<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  const w = m[3] * x + m[7] * y + m[11] * z || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z) / w;\n  return out;\n}\n\nexport function vec3_transformMat2<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  return out;\n}\n\n// vec4 additions\n\nexport function vec4_transformMat2<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\nexport function vec4_transformMat3<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  out[0] = m[0] * x + m[3] * y + m[6] * z;\n  out[1] = m[1] * x + m[4] * y + m[7] * z;\n  out[2] = m[2] * x + m[5] * y + m[8] * z;\n  out[3] = a[3];\n  return out;\n}\n", "// @eslint-disable\n// @ts-nocheck\n\nimport * as glMatrix from './common.js';\n\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nexport function create() {\n  const out = new glMatrix.ARRAY_TYPE(3);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nexport function clone(a) {\n  const out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nexport function fromValues(x, y, z) {\n  const out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  out[2] = glMatrix.round(a[2]);\n  return out;\n}\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  const x = b[0] - a[0];\n  const y = b[1] - a[1];\n  const z = b[2] - a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  const x = b[0] - a[0];\n  const y = b[1] - a[1];\n  const z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\nexport function normalize(out, a) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  let len = x * x + y * y + z * z;\n  if (len > 0) {\n    // TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  const ax = a[0];\n  const ay = a[1];\n  const az = a[2];\n  const bx = b[0];\n  const by = b[1];\n  const bz = b[2];\n\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function lerp(out, a, b, t) {\n  const ax = a[0];\n  const ay = a[1];\n  const az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n\n/**\n * Performs a spherical linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function slerp(out, a, b, t) {\n  const angle = Math.acos(Math.min(Math.max(dot(a, b), -1), 1));\n  const sinTotal = Math.sin(angle);\n\n  const ratioA = Math.sin((1 - t) * angle) / sinTotal;\n  const ratioB = Math.sin(t * angle) / sinTotal;\n  out[0] = ratioA * a[0] + ratioB * b[0];\n  out[1] = ratioA * a[1] + ratioB * b[1];\n  out[2] = ratioA * a[2] + ratioB * b[2];\n\n  return out;\n}\n\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function hermite(out, a, b, c, d, t) {\n  const factorTimes2 = t * t;\n  const factor1 = factorTimes2 * (2 * t - 3) + 1;\n  const factor2 = factorTimes2 * (t - 2) + t;\n  const factor3 = factorTimes2 * (t - 1);\n  const factor4 = factorTimes2 * (3 - 2 * t);\n\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n\n  return out;\n}\n\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function bezier(out, a, b, c, d, t) {\n  const inverseFactor = 1 - t;\n  const inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  const factorTimes2 = t * t;\n  const factor1 = inverseFactorTimesTwo * inverseFactor;\n  const factor2 = 3 * t * inverseFactorTimesTwo;\n  const factor3 = 3 * factorTimes2 * inverseFactor;\n  const factor4 = factorTimes2 * t;\n\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec3} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n\n  const r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  const z = glMatrix.RANDOM() * 2.0 - 1.0;\n  const zScale = Math.sqrt(1.0 - z * z) * scale;\n\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat4(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  let w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat3(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  const qx = q[0];\n  const qy = q[1];\n  const qz = q[2];\n  const qw = q[3];\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n  let uvx = qy * z - qz * y;\n  let uvy = qz * x - qx * z;\n  let uvz = qx * y - qy * x;\n  // var uuv = vec3.cross([], qvec, uv);\n  let uuvx = qy * uvz - qz * uvy;\n  let uuvy = qz * uvx - qx * uvz;\n  let uuvz = qx * uvy - qy * uvx;\n  // vec3.scale(uv, uv, 2 * w);\n  const w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2;\n  // vec3.scale(uuv, uuv, 2);\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2;\n  // return vec3.add(out, a, vec3.add(out, uv, uuv));\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateX(out, a, b, rad) {\n  const p = [];\n  const r = [];\n  // Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  // perform rotation\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\n\n  // translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateY(out, a, b, rad) {\n  const p = [];\n  const r = [];\n  // Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  // perform rotation\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\n\n  // translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateZ(out, a, b, rad) {\n  const p = [];\n  const r = [];\n  // Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  // perform rotation\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2];\n\n  // translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n\n  return out;\n}\n\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  const ax = a[0];\n  const ay = a[1];\n  const az = a[2];\n  const bx = b[0];\n  const by = b[1];\n  const bz = b[2];\n  const mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz));\n  const cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return `vec3(${a[0]}, ${a[1]}, ${a[2]})`;\n}\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  const a0 = a[0];\n  const a1 = a[1];\n  const a2 = a[2];\n  const b0 = b[0];\n  const b1 = b[1];\n  const b2 = b[2];\n  return (\n    Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n    Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n    Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2))\n  );\n}\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nexport const sub = subtract;\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nexport const mul = multiply;\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nexport const div = divide;\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nexport const dist = distance;\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nexport const sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nexport const len = length;\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nexport const sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport const forEach = (function () {\n  const vec = create();\n\n  return function (a, stride, offset, count, fn, arg) {\n    let i;\n    let l;\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n})();\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Copyright (c) 2017 Uber Technologies, Inc.\n\nimport {NumericArray, NumericArray3} from '@math.gl/types';\nimport {Vector} from './base/vector';\nimport {config, isArray} from '../lib/common';\nimport {checkNumber} from '../lib/validators';\n// @ts-ignore gl-matrix types\nimport {\n  angle as vec3_angle,\n  cross as vec3_cross,\n  rotateX as vec3_rotateX,\n  rotateY as vec3_rotateY,\n  rotateZ as vec3_rotateZ,\n  transformMat4 as vec3_transformMat4,\n  transformMat3 as vec3_transformMat3,\n  transformQuat as vec3_transformQuat\n} from '../gl-matrix/vec3';\n/* eslint-disable camelcase */\nimport {vec3_transformMat2, vec3_transformMat4AsVector} from '../lib/gl-matrix-extras';\n\nconst ORIGIN = [0, 0, 0];\n\nlet ZERO: Vector3;\n\n/** Helper type that captures array length for a 3 element vector */\nexport type Vector3Like = Vector3 | NumericArray3;\n\n/**\n * Three-element vector class with common linear algebra operations.\n * Subclass of Array<number> meaning that it is highly compatible with other libraries\n */\nexport class Vector3 extends Vector {\n  static get ZERO(): Vector3 {\n    if (!ZERO) {\n      ZERO = new Vector3(0, 0, 0);\n      Object.freeze(ZERO);\n    }\n    return ZERO;\n  }\n\n  /**\n   * @class\n   * @param x\n   * @param y\n   * @param z\n   */\n  constructor(x: number | Readonly<NumericArray> = 0, y: number = 0, z: number = 0) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0);\n    if (arguments.length === 1 && isArray(x)) {\n      this.copy(x as NumericArray);\n    } else {\n      // this.set(x, y, z);\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n      }\n      // @ts-expect-error TS2412: Property '0' of type 'number | [number, number, number]' is not assignable to numeric index type 'number'\n      this[0] = x;\n      this[1] = y;\n      this[2] = z;\n    }\n  }\n\n  set(x: number, y: number, z: number): this {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    return this.check();\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    return this.check();\n  }\n\n  fromObject(object: {x: number; y: number; z: number}): this {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n    }\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    return this.check();\n  }\n\n  override toObject(object: {x?: number; y?: number; z?: number}): {\n    x: number;\n    y: number;\n    z: number;\n  } {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    return object as {x: number; y: number; z: number};\n  }\n\n  // Getters/setters\n\n  get ELEMENTS(): number {\n    return 3;\n  }\n  get z(): number {\n    return this[2];\n  }\n  set z(value: number) {\n    this[2] = checkNumber(value);\n  }\n\n  // ACCESSORS\n\n  angle(vector: Readonly<NumericArray>): number {\n    return vec3_angle(this, vector);\n  }\n\n  // MODIFIERS\n\n  cross(vector: Readonly<NumericArray>): this {\n    vec3_cross(this, this, vector);\n    return this.check();\n  }\n\n  rotateX({radians, origin = ORIGIN}: {radians: number; origin?: Readonly<NumericArray>}): this {\n    vec3_rotateX(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateY({radians, origin = ORIGIN}: {radians: number; origin?: Readonly<NumericArray>}): this {\n    vec3_rotateY(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateZ({radians, origin = ORIGIN}: {radians: number; origin?: Readonly<NumericArray>}): this {\n    vec3_rotateZ(this, this, origin, radians);\n    return this.check();\n  }\n\n  // Transforms\n\n  // transforms as point (4th component is implicitly 1)\n  transform(matrix4: Readonly<NumericArray>): this {\n    return this.transformAsPoint(matrix4);\n  }\n\n  // transforms as point (4th component is implicitly 1)\n  transformAsPoint(matrix4: Readonly<NumericArray>): this {\n    vec3_transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  // transforms as vector  (4th component is implicitly 0, ignores translation. slightly faster)\n  transformAsVector(matrix4: Readonly<NumericArray>): this {\n    vec3_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3: Readonly<NumericArray>): this {\n    vec3_transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2: Readonly<NumericArray>): this {\n    vec3_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion: Readonly<NumericArray>): this {\n    vec3_transformQuat(this, this, quaternion);\n    return this.check();\n  }\n}\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Copyright (c) 2017 Uber Technologies, Inc.\n\nimport {NumericArray} from '@math.gl/types';\nimport {MathArray} from './math-array';\nimport {checkNumber} from '../../lib/validators';\nimport {config} from '../../lib/common';\n\n/** Base class for matrices */\nexport abstract class Matrix extends MathArray {\n  abstract get RANK(): number;\n\n  // fromObject(object) {\n  //   const array = object.elements;\n  //   return this.fromRowMajor(array);\n  // }\n  // toObject(object) {\n  //   const array = object.elements;\n  //   this.toRowMajor(array);\n  //   return object;\n  // }\n\n  // TODO better override formatString?\n  override toString(): string {\n    let string = '[';\n    if (config.printRowMajor) {\n      string += 'row-major:';\n      for (let row = 0; row < this.RANK; ++row) {\n        for (let col = 0; col < this.RANK; ++col) {\n          string += ` ${this[col * this.RANK + row]}`;\n        }\n      }\n    } else {\n      string += 'column-major:';\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        string += ` ${this[i]}`;\n      }\n    }\n    string += ']';\n    return string;\n  }\n\n  getElementIndex(row: number, col: number): number {\n    return col * this.RANK + row;\n  }\n\n  // By default assumes row major indices\n  getElement(row: number, col: number): number {\n    return this[col * this.RANK + row];\n  }\n\n  // By default assumes row major indices\n  setElement(row: number, col: number, value: number): this {\n    this[col * this.RANK + row] = checkNumber(value);\n    return this;\n  }\n  getColumn<NumArrayT>(columnIndex: number, result: NumArrayT): NumArrayT;\n  getColumn(columnIndex: number): number[];\n\n  getColumn(\n    columnIndex: number,\n    result: number[] = new Array<number>(this.RANK).fill(-0)\n  ): number[] {\n    const firstIndex = columnIndex * this.RANK;\n    for (let i = 0; i < this.RANK; ++i) {\n      result[i] = this[firstIndex + i];\n    }\n    return result;\n  }\n\n  setColumn(columnIndex: number, columnVector: Readonly<NumericArray>): this {\n    const firstIndex = columnIndex * this.RANK;\n    for (let i = 0; i < this.RANK; ++i) {\n      this[firstIndex + i] = columnVector[i];\n    }\n    return this;\n  }\n}\n", "import * as glMatrix from './common.js';\n\n/**\n * 3x3 Matrix\n * @module mat3\n */\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\nexport function create() {\n  const out = new glMatrix.ARRAY_TYPE(9);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {ReadonlyMat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\nexport function clone(a) {\n  const out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  const out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    const a01 = a[1];\n    const a02 = a[2];\n    const a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function invert(out, a) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a10 = a[3];\n  const a11 = a[4];\n  const a12 = a[5];\n  const a20 = a[6];\n  const a21 = a[7];\n  const a22 = a[8];\n\n  const b01 = a22 * a11 - a12 * a21;\n  const b11 = -a22 * a10 + a12 * a20;\n  const b21 = a21 * a10 - a11 * a20;\n\n  // Calculate the determinant\n  let det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\nexport function adjoint(out, a) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a10 = a[3];\n  const a11 = a[4];\n  const a12 = a[5];\n  const a20 = a[6];\n  const a21 = a[7];\n  const a22 = a[8];\n\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat3\n *\n * @param {ReadonlyMat3} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a10 = a[3];\n  const a11 = a[4];\n  const a12 = a[5];\n  const a20 = a[6];\n  const a21 = a[7];\n  const a22 = a[8];\n\n  return (\n    a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20)\n  );\n}\n\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function multiply(out, a, b) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a10 = a[3];\n  const a11 = a[4];\n  const a12 = a[5];\n  const a20 = a[6];\n  const a21 = a[7];\n  const a22 = a[8];\n\n  const b00 = b[0];\n  const b01 = b[1];\n  const b02 = b[2];\n  const b10 = b[3];\n  const b11 = b[4];\n  const b12 = b[5];\n  const b20 = b[6];\n  const b21 = b[7];\n  const b22 = b[8];\n\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to translate\n * @param {ReadonlyVec2} v vector to translate by\n * @returns {mat3} out\n */\nexport function translate(out, a, v) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a10 = a[3];\n  const a11 = a[4];\n  const a12 = a[5];\n  const a20 = a[6];\n  const a21 = a[7];\n  const a22 = a[8];\n  const x = v[0];\n  const y = v[1];\n\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nexport function rotate(out, a, rad) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a10 = a[3];\n  const a11 = a[4];\n  const a12 = a[5];\n  const a20 = a[6];\n  const a21 = a[7];\n  const a22 = a[8];\n  const s = Math.sin(rad);\n  const c = Math.cos(rad);\n\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\nexport function scale(out, a, v) {\n  const x = v[0];\n  const y = v[1];\n\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat3} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nexport function fromRotation(out, rad) {\n  const s = Math.sin(rad);\n  const c = Math.cos(rad);\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat3} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to copy\n * @returns {mat3} out\n **/\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Calculates a 3x3 matrix from the given quaternion\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat3} out\n */\nexport function fromQuat(out, q) {\n  const x = q[0];\n  const y = q[1];\n  const z = q[2];\n  const w = q[3];\n  const x2 = x + x;\n  const y2 = y + y;\n  const z2 = z + z;\n\n  const xx = x * x2;\n  const yx = y * x2;\n  const yy = y * y2;\n  const zx = z * x2;\n  const zy = z * y2;\n  const zz = z * z2;\n  const wx = w * x2;\n  const wy = w * y2;\n  const wz = w * z2;\n\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n\n  return out;\n}\n\n/**\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n *\n * @returns {mat3} out\n */\nexport function normalFromMat4(out, a) {\n  const a00 = a[0];\n  const a01 = a[1];\n  const a02 = a[2];\n  const a03 = a[3];\n  const a10 = a[4];\n  const a11 = a[5];\n  const a12 = a[6];\n  const a13 = a[7];\n  const a20 = a[8];\n  const a21 = a[9];\n  const a22 = a[10];\n  const a23 = a[11];\n  const a30 = a[12];\n  const a31 = a[13];\n  const a32 = a[14];\n  const a33 = a[15];\n\n  const b00 = a00 * a11 - a01 * a10;\n  const b01 = a00 * a12 - a02 * a10;\n  const b02 = a00 * a13 - a03 * a10;\n  const b03 = a01 * a12 - a02 * a11;\n  const b04 = a01 * a13 - a03 * a11;\n  const b05 = a02 * a13 - a03 * a12;\n  const b06 = a20 * a31 - a21 * a30;\n  const b07 = a20 * a32 - a22 * a30;\n  const b08 = a20 * a33 - a23 * a30;\n  const b09 = a21 * a32 - a22 * a31;\n  const b10 = a21 * a33 - a23 * a31;\n  const b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n\n  return out;\n}\n\n/**\n * Generates a 2D projection matrix with the given bounds\n *\n * @param {mat3} out mat3 frustum matrix will be written into\n * @param {number} width Width of your gl context\n * @param {number} height Height of gl context\n * @returns {mat3} out\n */\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat3\n *\n * @param {ReadonlyMat3} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return `mat3(${a[0]}, ${a[1]}, ${a[2]}, ${a[3]}, ${a[4]}, ${a[5]}, ${a[6]}, ${a[7]}, ${a[8]})`;\n}\n\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(\n    a[0] * a[0] +\n      a[1] * a[1] +\n      a[2] * a[2] +\n      a[3] * a[3] +\n      a[4] * a[4] +\n      a[5] * a[5] +\n      a[6] * a[6] +\n      a[7] * a[7] +\n      a[8] * a[8]\n  );\n}\n\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return (\n    a[0] === b[0] &&\n    a[1] === b[1] &&\n    a[2] === b[2] &&\n    a[3] === b[3] &&\n    a[4] === b[4] &&\n    a[5] === b[5] &&\n    a[6] === b[6] &&\n    a[7] === b[7] &&\n    a[8] === b[8]\n  );\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  const a0 = a[0];\n  const a1 = a[1];\n  const a2 = a[2];\n  const a3 = a[3];\n  const a4 = a[4];\n  const a5 = a[5];\n  const a6 = a[6];\n  const a7 = a[7];\n  const a8 = a[8];\n  const b0 = b[0];\n  const b1 = b[1];\n  const b2 = b[2];\n  const b3 = b[3];\n  const b4 = b[4];\n  const b5 = b[5];\n  const b6 = b[6];\n  const b7 = b[7];\n  const b8 = b[8];\n  return (\n    Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n    Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n    Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n    Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n    Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n    Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\n    Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\n    Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\n    Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8))\n  );\n}\n\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\nexport const mul = multiply;\n\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\nexport const sub = subtract;\n", "// math.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Copyright (c) 2017 Uber Technologies, Inc.\n\nimport {NumericArray, NumericArray9} from '@math.gl/types';\nimport {Matrix} from './base/matrix';\nimport {checkVector} from '../lib/validators';\n\nimport {vec4_transformMat3} from '../lib/gl-matrix-extras';\n\nimport {\n  fromQuat as mat3_fromQuat,\n  determinant as mat3_determinant,\n  transpose as mat3_transpose,\n  invert as mat3_invert,\n  multiply as mat3_multiply,\n  rotate as mat3_rotate,\n  scale as mat3_scale,\n  translate as mat3_translate\n} from '../gl-matrix/mat3';\nimport {transformMat3 as vec2_transformMat3} from '../gl-matrix/vec2';\nimport {transformMat3 as vec3_transformMat3} from '../gl-matrix/vec3';\n\n// eslint-disable-next-line no-shadow\nenum INDICES {\n  COL0ROW0 = 0,\n  COL0ROW1 = 1,\n  COL0ROW2 = 2,\n  COL1ROW0 = 3,\n  COL1ROW1 = 4,\n  COL1ROW2 = 5,\n  COL2ROW0 = 6,\n  COL2ROW1 = 7,\n  COL2ROW2 = 8\n}\n\nconst IDENTITY_MATRIX = Object.freeze([1, 0, 0, 0, 1, 0, 0, 0, 1]);\n\n/** Helper type that captures array length for a 3x3 matrix */\nexport type Matrix3Like = Matrix3 | NumericArray9;\n\n/**\n * A 3x3 matrix with common linear algebra operations\n * Subclass of Array<number> meaning that it is highly compatible with other libraries\n */\nexport class Matrix3 extends Matrix {\n  static get IDENTITY(): Readonly<Matrix3> {\n    return getIdentityMatrix();\n  }\n\n  static get ZERO(): Readonly<Matrix3> {\n    return getZeroMatrix();\n  }\n\n  get ELEMENTS(): number {\n    return 9;\n  }\n\n  get RANK(): number {\n    return 3;\n  }\n\n  get INDICES(): typeof INDICES {\n    return INDICES;\n  }\n\n  constructor(array?: Readonly<NumericArray>);\n  /** @deprecated */\n  constructor(...args: number[]);\n\n  constructor(array?: number | Readonly<NumericArray>, ...args: number[]) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0);\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else if (args.length > 0) {\n      this.copy([array as number, ...args]);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    // Element wise copy for performance\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    return this.check();\n  }\n\n  // Constructors\n\n  identity(): this {\n    return this.copy(IDENTITY_MATRIX);\n  }\n\n  /**\n   *\n   * @param object\n   * @returns self\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  fromObject(object: {[key: string]: any}): this {\n    return this.check();\n  }\n\n  /** Calculates a 3x3 matrix from the given quaternion\n   * q quat  Quaternion to create matrix from\n   */\n  fromQuaternion(q: Readonly<NumericArray>): this {\n    mat3_fromQuat(this, q);\n    return this.check();\n  }\n\n  /**\n   * accepts column major order, stores in column major order\n   */\n  // eslint-disable-next-line max-params\n  set(\n    m00: number,\n    m10: number,\n    m20: number,\n    m01: number,\n    m11: number,\n    m21: number,\n    m02: number,\n    m12: number,\n    m22: number\n  ): this {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m01;\n    this[4] = m11;\n    this[5] = m21;\n    this[6] = m02;\n    this[7] = m12;\n    this[8] = m22;\n    return this.check();\n  }\n\n  /**\n   * accepts row major order, stores as column major\n   */\n  // eslint-disable-next-line max-params\n  setRowMajor(\n    m00: number,\n    m01: number,\n    m02: number,\n    m10: number,\n    m11: number,\n    m12: number,\n    m20: number,\n    m21: number,\n    m22: number\n  ): this {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m01;\n    this[4] = m11;\n    this[5] = m21;\n    this[6] = m02;\n    this[7] = m12;\n    this[8] = m22;\n    return this.check();\n  }\n\n  // Accessors\n\n  determinant(): number {\n    return mat3_determinant(this);\n  }\n\n  // Modifiers\n  transpose(): this {\n    mat3_transpose(this, this);\n    return this.check();\n  }\n\n  /** Invert a matrix. Note that this can fail if the matrix is not invertible */\n  invert(): this {\n    mat3_invert(this, this);\n    return this.check();\n  }\n\n  // Operations\n  multiplyLeft(a: NumericArray): this {\n    mat3_multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a: NumericArray): this {\n    mat3_multiply(this, this, a);\n    return this.check();\n  }\n\n  rotate(radians: number): this {\n    mat3_rotate(this, this, radians);\n    return this.check();\n  }\n\n  override scale(factor: NumericArray | number): this {\n    if (Array.isArray(factor)) {\n      mat3_scale(this, this, factor);\n    } else {\n      mat3_scale(this, this, [factor as number, factor as number]);\n    }\n    return this.check();\n  }\n\n  translate(vec: NumericArray): this {\n    mat3_translate(this, this, vec);\n    return this.check();\n  }\n\n  // Transforms\n  transform(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    let out: NumericArray;\n    switch (vector.length) {\n      case 2:\n        out = vec2_transformMat3(result || [-0, -0], vector, this) as NumericArray;\n        break;\n      case 3:\n        out = vec3_transformMat3(result || [-0, -0, -0], vector, this) as NumericArray;\n        break;\n      case 4:\n        out = vec4_transformMat3(result || [-0, -0, -0, -0], vector, this);\n        break;\n      default:\n        throw new Error('Illegal vector');\n    }\n    checkVector(out, vector.length);\n    return out;\n  }\n\n  /** @deprecated */\n  transformVector(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transform(vector, result);\n  }\n\n  /** @deprecated */\n  transformVector2(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transform(vector, result);\n  }\n\n  /** @deprecated */\n  transformVector3(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transform(vector, result);\n  }\n}\n\nlet ZERO_MATRIX3: Matrix3 | null;\nlet IDENTITY_MATRIX3: Matrix3 | null = null;\n\nfunction getZeroMatrix(): Readonly<Matrix3> {\n  if (!ZERO_MATRIX3) {\n    ZERO_MATRIX3 = new Matrix3([0, 0, 0, 0, 0, 0, 0, 0, 0]);\n    Object.freeze(ZERO_MATRIX3);\n  }\n  return ZERO_MATRIX3;\n}\n\nfunction getIdentityMatrix(): Matrix3 {\n  if (!IDENTITY_MATRIX3) {\n    IDENTITY_MATRIX3 = new Matrix3();\n    Object.freeze(IDENTITY_MATRIX3);\n  }\n  return IDENTITY_MATRIX3;\n}\n", "// GLTF EXTENSION: KHR_lights_punctual\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\nimport { assert } from \"../../utils/assert.js\";\nimport { GLTFScenegraph } from \"../../api/gltf-scenegraph.js\";\nconst KHR_LIGHTS_PUNCTUAL = 'KHR_lights_punctual';\nexport const name = KHR_LIGHTS_PUNCTUAL;\nexport async function decode(gltfData) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const { json } = gltfScenegraph;\n    // Move the light array out of the extension and remove the extension\n    const extension = gltfScenegraph.getExtension(KHR_LIGHTS_PUNCTUAL);\n    if (extension) {\n        // @ts-ignore\n        gltfScenegraph.json.lights = extension.lights;\n        gltfScenegraph.removeExtension(KHR_LIGHTS_PUNCTUAL);\n    }\n    // Any nodes that have the extension, add lights field pointing to light object\n    // and remove the extension\n    for (const node of json.nodes || []) {\n        const nodeExtension = gltfScenegraph.getObjectExtension(node, KHR_LIGHTS_PUNCTUAL);\n        if (nodeExtension) {\n            // @ts-ignore\n            node.light = nodeExtension.light;\n        }\n        gltfScenegraph.removeObjectExtension(node, KHR_LIGHTS_PUNCTUAL);\n    }\n}\n// Move the light ar ray out of the extension and remove the extension\nexport async function encode(gltfData) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const { json } = gltfScenegraph;\n    // @ts-ignore\n    if (json.lights) {\n        const extension = gltfScenegraph.addExtension(KHR_LIGHTS_PUNCTUAL);\n        // @ts-ignore\n        assert(!extension.lights);\n        // @ts-ignore\n        extension.lights = json.lights;\n        // @ts-ignore\n        delete json.lights;\n    }\n    // Any nodes that have lights field pointing to light object\n    // add the extension\n    // @ts-ignore\n    if (gltfScenegraph.json.lights) {\n        // @ts-ignore\n        for (const light of gltfScenegraph.json.lights) {\n            const node = light.node;\n            gltfScenegraph.addObjectExtension(node, KHR_LIGHTS_PUNCTUAL, light);\n        }\n        // @ts-ignore\n        delete gltfScenegraph.json.lights;\n    }\n}\n", "// GLTF EXTENSION: KHR_materials_unlit\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\nimport { GLTFScenegraph } from \"../../api/gltf-scenegraph.js\";\nconst KHR_MATERIALS_UNLIT = 'KHR_materials_unlit';\nexport const name = KHR_MATERIALS_UNLIT;\nexport async function decode(gltfData) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const { json } = gltfScenegraph;\n    // Any nodes that have the extension, add lights field pointing to light object\n    // and remove the extension\n    for (const material of json.materials || []) {\n        const extension = material.extensions && material.extensions.KHR_materials_unlit;\n        if (extension) {\n            // @ts-ignore TODO\n            material.unlit = true;\n        }\n        gltfScenegraph.removeObjectExtension(material, KHR_MATERIALS_UNLIT);\n    }\n    // Remove the top-level extension\n    gltfScenegraph.removeExtension(KHR_MATERIALS_UNLIT);\n}\nexport function encode(gltfData) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const { json } = gltfScenegraph;\n    // Any nodes that have lights field pointing to light object\n    // add the extension\n    // @ts-ignore\n    if (gltfScenegraph.materials) {\n        for (const material of json.materials || []) {\n            // @ts-ignore\n            if (material.unlit) {\n                // @ts-ignore\n                delete material.unlit;\n                gltfScenegraph.addObjectExtension(material, KHR_MATERIALS_UNLIT, {});\n                gltfScenegraph.addExtension(KHR_MATERIALS_UNLIT);\n            }\n        }\n    }\n}\n", "// GLTF EXTENSION: KHR_techniques_webgl\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_techniques_webgl\nimport { GLTFScenegraph } from \"../../api/gltf-scenegraph.js\";\nconst KHR_TECHNIQUES_WEBGL = 'KHR_techniques_webgl';\nexport const name = KHR_TECHNIQUES_WEBGL;\nexport async function decode(gltfData) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const { json } = gltfScenegraph;\n    const extension = gltfScenegraph.getExtension(KHR_TECHNIQUES_WEBGL);\n    if (extension) {\n        const techniques = resolveTechniques(extension, gltfScenegraph);\n        for (const material of json.materials || []) {\n            const materialExtension = gltfScenegraph.getObjectExtension(material, KHR_TECHNIQUES_WEBGL);\n            if (materialExtension) {\n                // @ts-ignore TODO\n                material.technique = Object.assign({}, materialExtension, \n                // @ts-ignore\n                techniques[materialExtension.technique]);\n                // @ts-ignore TODO\n                material.technique.values = resolveValues(material.technique, gltfScenegraph);\n            }\n            gltfScenegraph.removeObjectExtension(material, KHR_TECHNIQUES_WEBGL);\n        }\n        // Remove the top-level extension\n        gltfScenegraph.removeExtension(KHR_TECHNIQUES_WEBGL);\n    }\n}\n// eslint-disable-next-line\nexport async function encode(gltfData, options) {\n    // TODO\n}\nfunction resolveTechniques(techniquesExtension, \n// programs: {[key: string]: any}[],\n// shaders: {[key: string]: any}[],\n// techniques: {[key: string]: any}[]\ngltfScenegraph) {\n    const { programs = [], shaders = [], techniques = [] } = techniquesExtension;\n    const textDecoder = new TextDecoder();\n    shaders.forEach((shader) => {\n        if (Number.isFinite(shader.bufferView)) {\n            shader.code = textDecoder.decode(gltfScenegraph.getTypedArrayForBufferView(shader.bufferView));\n        }\n        else {\n            // TODO: handle URI shader\n            throw new Error('KHR_techniques_webgl: no shader code');\n        }\n    });\n    programs.forEach((program) => {\n        program.fragmentShader = shaders[program.fragmentShader];\n        program.vertexShader = shaders[program.vertexShader];\n    });\n    techniques.forEach((technique) => {\n        technique.program = programs[technique.program];\n    });\n    return techniques;\n}\nfunction resolveValues(technique, gltfScenegraph) {\n    const values = Object.assign({}, technique.values);\n    // merge values from uniforms\n    Object.keys(technique.uniforms || {}).forEach((uniform) => {\n        if (technique.uniforms[uniform].value && !(uniform in values)) {\n            values[uniform] = technique.uniforms[uniform].value;\n        }\n    });\n    // resolve textures\n    Object.keys(values).forEach((uniform) => {\n        if (typeof values[uniform] === 'object' && values[uniform].index !== undefined) {\n            // Assume this is a texture\n            // TODO: find if there are any other types that can be referenced\n            values[uniform].texture = gltfScenegraph.getTexture(values[uniform].index);\n        }\n    });\n    return values;\n}\n", "// GLTF 1.0 extensions (decode only)\n// import * as KHR_binary_gltf from './KHR_draco_mesh_compression';\n// GLTF 2.0 Vendor extensions\nimport * as EXT_mesh_features from \"../extensions/EXT_mesh_features.js\";\nimport * as EXT_structural_metadata from \"../extensions/EXT_structural_metadata.js\";\n// GLTF 2.0 Khronos extensions (decode/encode)\nimport * as EXT_meshopt_compression from \"../extensions/EXT_meshopt_compression.js\";\nimport * as EXT_texture_webp from \"../extensions/EXT_texture_webp.js\";\nimport * as KHR_texture_basisu from \"../extensions/KHR_texture_basisu.js\";\nimport * as KHR_draco_mesh_compression from \"../extensions/KHR_draco_mesh_compression.js\";\nimport * as KHR_texture_transform from \"../extensions/KHR_texture_transform.js\";\n// Deprecated. These should be handled by rendering library (e.g. luma.gl), not the loader.\nimport * as KHR_lights_punctual from \"../extensions/deprecated/KHR_lights_punctual.js\";\nimport * as KHR_materials_unlit from \"../extensions/deprecated/KHR_materials_unlit.js\";\nimport * as KHR_techniques_webgl from \"../extensions/deprecated/KHR_techniques_webgl.js\";\nimport * as EXT_feature_metadata from \"../extensions/deprecated/EXT_feature_metadata.js\";\n/**\n * List of extensions processed by the GLTFLoader\n * Note that may extensions can only be handled on the rendering stage and are left out here\n * These are just extensions that can be handled fully or partially during loading.\n */\nexport const EXTENSIONS = [\n    // 1.0\n    // KHR_binary_gltf is handled separately - must be processed before other parsing starts\n    // KHR_binary_gltf,\n    // 2.0\n    EXT_structural_metadata,\n    EXT_mesh_features,\n    EXT_meshopt_compression,\n    EXT_texture_webp,\n    // Basisu should come after webp, we want basisu to be preferred if both are provided\n    KHR_texture_basisu,\n    KHR_draco_mesh_compression,\n    KHR_lights_punctual,\n    KHR_materials_unlit,\n    KHR_techniques_webgl,\n    KHR_texture_transform,\n    EXT_feature_metadata\n];\n/**\n * List of extensions processed by the GLTFWriter\n */\nconst EXTENSIONS_ENCODING = [EXT_structural_metadata, EXT_mesh_features];\n/** Call before any resource loading starts */\nexport function preprocessExtensions(gltf, options = {}, context) {\n    const extensions = EXTENSIONS.filter((extension) => useExtension(extension.name, options));\n    for (const extension of extensions) {\n        extension.preprocess?.(gltf, options, context);\n    }\n}\n/** Call after resource loading */\nexport async function decodeExtensions(gltf, options = {}, context) {\n    const extensions = EXTENSIONS.filter((extension) => useExtension(extension.name, options));\n    for (const extension of extensions) {\n        // Note: We decode async extensions sequentially, this might not be necessary\n        // Currently we only have Draco, but when we add Basis we may revisit\n        await extension.decode?.(gltf, options, context);\n    }\n}\n/** Call before resource writing */\nexport function encodeExtensions(gltf, options = {}) {\n    for (const extension of EXTENSIONS_ENCODING) {\n        gltf = extension.encode?.(gltf, options) ?? gltf;\n    }\n    return gltf;\n}\nfunction useExtension(extensionName, options) {\n    const excludes = options?.gltf?.excludeExtensions || {};\n    const exclude = extensionName in excludes && !excludes[extensionName];\n    return !exclude;\n}\n", "// GLTF 1.0 EXTENSION: KHR_binary_glTF\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/1.0/Khronos/KHR_binary_glTF\n/* eslint-disable camelcase */\nimport { GLTFScenegraph } from \"../api/gltf-scenegraph.js\";\nconst KHR_BINARY_GLTF = 'KHR_binary_glTF';\n/** Extension name */\nexport const name = KHR_BINARY_GLTF;\nexport function preprocess(gltfData) {\n    const gltfScenegraph = new GLTFScenegraph(gltfData);\n    const { json } = gltfScenegraph;\n    // Note: json.buffers.binary_glTF also needs to be replaced\n    // This is currently done during gltf normalization\n    // Image and shader nodes can have the extension\n    // https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Khronos/KHR_binary_glTF/schema/image.KHR_binary_glTF.schema.json\n    for (const image of json.images || []) {\n        const extension = gltfScenegraph.getObjectExtension(image, KHR_BINARY_GLTF);\n        // The data in the extension is valid as glTF 2.0 data inside the object, so just copy it in\n        if (extension) {\n            Object.assign(image, extension);\n        }\n        gltfScenegraph.removeObjectExtension(image, KHR_BINARY_GLTF);\n    }\n    // TODO shaders - At least traverse and throw error if used?\n    // https://github.com/KhronosGroup/glTF/blob/master/extensions/1.0/Khronos/KHR_binary_glTF/schema/shader.KHR_binary_glTF.schema.json\n    // glTF v1 one files have a partially formed URI field that is not expected in (and causes problems in) 2.0\n    if (json.buffers && json.buffers[0]) {\n        delete json.buffers[0].uri;\n    }\n    // Remove the top-level extension as it has now been processed\n    gltfScenegraph.removeExtension(KHR_BINARY_GLTF);\n}\n// KHR_binary_gltf is a 1.0 extension that is supported natively by 2.0\n// export function encode() {\n//   throw new Error(KHR_BINARY_GLTF);\n// }\n", "/* eslint-disable camelcase */\nimport * as KHR_binary_glTF from \"../extensions/KHR_binary_gltf.js\";\n// Binary format changes (mainly implemented by GLBLoader)\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/1.0/Khronos/KHR_binary_glTF\n// JSON format changes:\n// https://github.com/khronosgroup/gltf/issues/605\n// - [x] Top-level JSON objects are arrays now\n// - [ ] Removed indirection from animation: sampler now refers directly to accessors, #712\n// - [ ] material.parameter.value and technique.parameter.value must be an array, #690\n// - [ ] Node can have only one mesh #821\n// - [ ] Added reqs on JSON encoding\n// - [ ] Added reqs on binary data alignment #802 (comment)\n// Additions:\n// - [ ] Added accessor.normalized, #691, #706\n// - [ ] Added glExtensionsUsed property and 5125 (UNSIGNED_INT) accessor.componentType value, #619\n// - [ ] Added extensionsRequired property, #720, #721\n// - [ ] Added \"STEP\" as valid animation.sampler.interpolation value, #712\n// Removals:\n// - [x] Removed buffer.type, #786, #629\n// - [ ] Removed revision number from profile.version, #709\n// - [ ] Removed technique.functions.scissor and removed 3089 (SCISSOR_TEST) as a valid value for technique.states.enable, #681\n// - [ ] Techniques, programs, and shaders were moved out to KHR_technique_webgl extension.\n// Other edits:\n// - [x] asset is now required, #642\n// - [ ] buffer.byteLength and bufferView.byteLength are now required, #560.\n// - [ ] accessor.min and accessor.max are now required, #593, and clarified that the JSON value and binary data must be the same, #628.\n// - [ ] Clarified animation.sampler and animation.channel restrictions, #712\n// - [ ] skin.inverseBindMatrices is now optional, #461.\n// - [ ] Attribute parameters can't have a value defined in the technique or parameter, #563 (comment).\n// - [ ] Only TEXCOORD and COLOR attribute semantics can be written in the form [semantic]_[set_index], #563 (comment).\n// - [ ] TEXCOORD and COLOR attribute semantics must be written in the form [semantic]_[set_index], e.g., just TEXCOORD should be TEXCOORD_0, and just COLOR should be COLOR_0, #649\n// - [ ] camera.perspective.aspectRatio and camera.perspective.yfov must now be > 0, not >= 0, #563 (comment).\n// - [ ] Application-specific parameter semantics must start with an underscore, e.g., _TEMPERATURE and _SIMULATION_TIME, #563 (comment).\n// - [ ] Properties in technique.parameters must be defined in technique.uniforms or technique.attributes,\n// #563 (comment).\n// - [ ] technique.parameter.count can only be defined when the semantic is JOINTMATRIX or an application-specific semantic is used. It can never be defined for attribute parameters; only uniforms, d2f6945\n// - [ ] technique.parameter.semantic is required when the parameter is an attribute, 28e113d\n// - [ ] Mesh-only models are allowed, e.g., without materials, #642\n// - [ ] Skeleton hierarchies (nodes containing jointName) must be separated from non-skeleton hierarchies., #647\n// - [ ] technique.states.functions.blendColor and technique.states.functions.depthRange parameters now must match WebGL function min/max, #707\nconst GLTF_ARRAYS = {\n    accessors: 'accessor',\n    animations: 'animation',\n    buffers: 'buffer',\n    bufferViews: 'bufferView',\n    images: 'image',\n    materials: 'material',\n    meshes: 'mesh',\n    nodes: 'node',\n    samplers: 'sampler',\n    scenes: 'scene',\n    skins: 'skin',\n    textures: 'texture'\n};\nconst GLTF_KEYS = {\n    accessor: 'accessors',\n    animations: 'animation',\n    buffer: 'buffers',\n    bufferView: 'bufferViews',\n    image: 'images',\n    material: 'materials',\n    mesh: 'meshes',\n    node: 'nodes',\n    sampler: 'samplers',\n    scene: 'scenes',\n    skin: 'skins',\n    texture: 'textures'\n};\n/**\n * Converts (normalizes) glTF v1 to v2\n */\nclass GLTFV1Normalizer {\n    idToIndexMap = {\n        animations: {},\n        accessors: {},\n        buffers: {},\n        bufferViews: {},\n        images: {},\n        materials: {},\n        meshes: {},\n        nodes: {},\n        samplers: {},\n        scenes: {},\n        skins: {},\n        textures: {}\n    };\n    json;\n    // constructor() {}\n    /**\n     * Convert (normalize) glTF < 2.0 to glTF 2.0\n     * @param gltf - object with json and binChunks\n     * @param options\n     * @param options normalize Whether to actually normalize\n     */\n    normalize(gltf, options) {\n        this.json = gltf.json;\n        const json = gltf.json;\n        // Check version\n        switch (json.asset && json.asset.version) {\n            // We are converting to v2 format. Return if there is nothing to do\n            case '2.0':\n                return;\n            // This class is written to convert 1.0\n            case undefined:\n            case '1.0':\n                break;\n            default:\n                // eslint-disable-next-line no-undef, no-console\n                console.warn(`glTF: Unknown version ${json.asset.version}`);\n                return;\n        }\n        if (!options.normalize) {\n            // We are still missing a few conversion tricks, remove once addressed\n            throw new Error('glTF v1 is not supported.');\n        }\n        // eslint-disable-next-line no-undef, no-console\n        console.warn('Converting glTF v1 to glTF v2 format. This is experimental and may fail.');\n        this._addAsset(json);\n        // In glTF2 top-level fields are Arrays not Object maps\n        this._convertTopLevelObjectsToArrays(json);\n        // Extract bufferView indices for images\n        // (this extension needs to be invoked early in the normalization process)\n        // TODO can this be handled by standard extension processing instead of called explicitly?\n        KHR_binary_glTF.preprocess(gltf);\n        // Convert object references from ids to indices\n        this._convertObjectIdsToArrayIndices(json);\n        this._updateObjects(json);\n        this._updateMaterial(json);\n    }\n    // asset is now required, #642 https://github.com/KhronosGroup/glTF/issues/639\n    _addAsset(json) {\n        json.asset = json.asset || {};\n        // We are normalizing to glTF v2, so change version to \"2.0\"\n        json.asset.version = '2.0';\n        json.asset.generator = json.asset.generator || 'Normalized to glTF 2.0 by loaders.gl';\n    }\n    _convertTopLevelObjectsToArrays(json) {\n        // TODO check that all arrays are covered\n        for (const arrayName in GLTF_ARRAYS) {\n            this._convertTopLevelObjectToArray(json, arrayName);\n        }\n    }\n    /** Convert one top level object to array */\n    _convertTopLevelObjectToArray(json, mapName) {\n        const objectMap = json[mapName];\n        if (!objectMap || Array.isArray(objectMap)) {\n            return;\n        }\n        // Rewrite the top-level field as an array\n        json[mapName] = [];\n        // Copy the map key into object.id\n        for (const id in objectMap) {\n            const object = objectMap[id];\n            object.id = object.id || id; // Mutates the loaded object\n            const index = json[mapName].length;\n            json[mapName].push(object);\n            this.idToIndexMap[mapName][id] = index;\n        }\n    }\n    /** Go through all objects in all top-level arrays and replace ids with indices */\n    _convertObjectIdsToArrayIndices(json) {\n        for (const arrayName in GLTF_ARRAYS) {\n            this._convertIdsToIndices(json, arrayName);\n        }\n        if ('scene' in json) {\n            json.scene = this._convertIdToIndex(json.scene, 'scene');\n        }\n        // Convert any index references that are not using array names\n        // texture.source (image)\n        for (const texture of json.textures) {\n            this._convertTextureIds(texture);\n        }\n        for (const mesh of json.meshes) {\n            this._convertMeshIds(mesh);\n        }\n        for (const node of json.nodes) {\n            this._convertNodeIds(node);\n        }\n        for (const node of json.scenes) {\n            this._convertSceneIds(node);\n        }\n    }\n    _convertTextureIds(texture) {\n        if (texture.source) {\n            texture.source = this._convertIdToIndex(texture.source, 'image');\n        }\n    }\n    _convertMeshIds(mesh) {\n        for (const primitive of mesh.primitives) {\n            const { attributes, indices, material } = primitive;\n            for (const attributeName in attributes) {\n                attributes[attributeName] = this._convertIdToIndex(attributes[attributeName], 'accessor');\n            }\n            if (indices) {\n                primitive.indices = this._convertIdToIndex(indices, 'accessor');\n            }\n            if (material) {\n                primitive.material = this._convertIdToIndex(material, 'material');\n            }\n        }\n    }\n    _convertNodeIds(node) {\n        if (node.children) {\n            node.children = node.children.map((child) => this._convertIdToIndex(child, 'node'));\n        }\n        if (node.meshes) {\n            node.meshes = node.meshes.map((mesh) => this._convertIdToIndex(mesh, 'mesh'));\n        }\n    }\n    _convertSceneIds(scene) {\n        if (scene.nodes) {\n            scene.nodes = scene.nodes.map((node) => this._convertIdToIndex(node, 'node'));\n        }\n    }\n    /** Go through all objects in a top-level array and replace ids with indices */\n    _convertIdsToIndices(json, topLevelArrayName) {\n        if (!json[topLevelArrayName]) {\n            console.warn(`gltf v1: json doesn't contain attribute ${topLevelArrayName}`); // eslint-disable-line no-console, no-undef\n            json[topLevelArrayName] = [];\n        }\n        for (const object of json[topLevelArrayName]) {\n            for (const key in object) {\n                const id = object[key];\n                const index = this._convertIdToIndex(id, key);\n                object[key] = index;\n            }\n        }\n    }\n    _convertIdToIndex(id, key) {\n        const arrayName = GLTF_KEYS[key];\n        if (arrayName in this.idToIndexMap) {\n            const index = this.idToIndexMap[arrayName][id];\n            if (!Number.isFinite(index)) {\n                throw new Error(`gltf v1: failed to resolve ${key} with id ${id}`);\n            }\n            return index;\n        }\n        return id;\n    }\n    /**\n     *\n     * @param {*} json\n     */\n    _updateObjects(json) {\n        for (const buffer of this.json.buffers) {\n            // - [x] Removed buffer.type, #786, #629\n            delete buffer.type;\n        }\n    }\n    /**\n     * Update material (set pbrMetallicRoughness)\n     * @param {*} json\n     */\n    _updateMaterial(json) {\n        for (const material of json.materials) {\n            material.pbrMetallicRoughness = {\n                baseColorFactor: [1, 1, 1, 1],\n                metallicFactor: 1,\n                roughnessFactor: 1\n            };\n            const textureId = material.values?.tex || material.values?.texture2d_0 || material.values?.diffuseTex;\n            const textureIndex = json.textures.findIndex((texture) => texture.id === textureId);\n            if (textureIndex !== -1) {\n                material.pbrMetallicRoughness.baseColorTexture = { index: textureIndex };\n            }\n        }\n    }\n}\nexport function normalizeGLTFV1(gltf, options = {}) {\n    return new GLTFV1Normalizer().normalize(gltf, options);\n}\n", "import { parseJSON, sliceArrayBuffer, parseFromContext } from '@loaders.gl/loader-utils';\nimport { ImageLoader } from '@loaders.gl/images';\nimport { BasisLoader, selectSupportedBasisFormat } from '@loaders.gl/textures';\nimport { assert } from \"../utils/assert.js\";\nimport { isGLB, parseGLBSync } from \"./parse-glb.js\";\nimport { resolveUrl } from \"../gltf-utils/resolve-url.js\";\nimport { getTypedArrayForBufferView } from \"../gltf-utils/get-typed-array.js\";\nimport { preprocessExtensions, decodeExtensions } from \"../api/gltf-extensions.js\";\nimport { normalizeGLTFV1 } from \"../api/normalize-gltf-v1.js\";\n/** Check if an array buffer appears to contain GLTF data */\nexport function isGLTF(arrayBuffer, options) {\n    const byteOffset = 0;\n    return isGLB(arrayBuffer, byteOffset, options);\n}\nexport async function parseGLTF(gltf, arrayBufferOrString, byteOffset = 0, options, context) {\n    parseGLTFContainerSync(gltf, arrayBufferOrString, byteOffset, options);\n    normalizeGLTFV1(gltf, { normalize: options?.gltf?.normalize });\n    preprocessExtensions(gltf, options, context);\n    // Load linked buffers asynchronously and decodes base64 buffers in parallel\n    if (options?.gltf?.loadBuffers && gltf.json.buffers) {\n        await loadBuffers(gltf, options, context);\n    }\n    // loadImages and decodeExtensions should not be running in parallel, because\n    // decodeExtensions uses data from images taken during the loadImages call.\n    if (options?.gltf?.loadImages) {\n        await loadImages(gltf, options, context);\n    }\n    await decodeExtensions(gltf, options, context);\n    return gltf;\n}\n/**\n *\n * @param gltf\n * @param data - can be ArrayBuffer (GLB), ArrayBuffer (Binary JSON), String (JSON), or Object (parsed JSON)\n * @param byteOffset\n * @param options\n */\nfunction parseGLTFContainerSync(gltf, data, byteOffset, options) {\n    // Initialize gltf container\n    if (options.uri) {\n        gltf.baseUri = options.uri;\n    }\n    // If data is binary and starting with magic bytes, assume binary JSON text, convert to string\n    if (data instanceof ArrayBuffer && !isGLB(data, byteOffset, options)) {\n        const textDecoder = new TextDecoder();\n        data = textDecoder.decode(data);\n    }\n    if (typeof data === 'string') {\n        // If string, try to parse as JSON\n        gltf.json = parseJSON(data);\n    }\n    else if (data instanceof ArrayBuffer) {\n        // If still ArrayBuffer, parse as GLB container\n        const glb = {};\n        byteOffset = parseGLBSync(glb, data, byteOffset, options.glb);\n        assert(glb.type === 'glTF', `Invalid GLB magic string ${glb.type}`);\n        gltf._glb = glb;\n        gltf.json = glb.json;\n    }\n    else {\n        assert(false, 'GLTF: must be ArrayBuffer or string');\n    }\n    // Populate buffers\n    // Create an external buffers array to hold binary data\n    const buffers = gltf.json.buffers || [];\n    gltf.buffers = new Array(buffers.length).fill(null);\n    // Populates JSON and some bin chunk info\n    if (gltf._glb && gltf._glb.header.hasBinChunk) {\n        const { binChunks } = gltf._glb;\n        gltf.buffers[0] = {\n            arrayBuffer: binChunks[0].arrayBuffer,\n            byteOffset: binChunks[0].byteOffset,\n            byteLength: binChunks[0].byteLength\n        };\n        // TODO - this modifies JSON and is a post processing thing\n        // gltf.json.buffers[0].data = gltf.buffers[0].arrayBuffer;\n        // gltf.json.buffers[0].byteOffset = gltf.buffers[0].byteOffset;\n    }\n    // Populate images\n    const images = gltf.json.images || [];\n    gltf.images = new Array(images.length).fill({});\n}\n/** Asynchronously fetch and parse buffers, store in buffers array outside of json\n * TODO - traverse gltf and determine which buffers are actually needed\n */\nasync function loadBuffers(gltf, options, context) {\n    // TODO\n    const buffers = gltf.json.buffers || [];\n    for (let i = 0; i < buffers.length; ++i) {\n        const buffer = buffers[i];\n        if (buffer.uri) {\n            const { fetch } = context;\n            assert(fetch);\n            const uri = resolveUrl(buffer.uri, options);\n            const response = await context?.fetch?.(uri);\n            const arrayBuffer = await response?.arrayBuffer?.();\n            gltf.buffers[i] = {\n                arrayBuffer,\n                byteOffset: 0,\n                byteLength: arrayBuffer.byteLength\n            };\n            delete buffer.uri;\n        }\n        else if (gltf.buffers[i] === null) {\n            gltf.buffers[i] = {\n                arrayBuffer: new ArrayBuffer(buffer.byteLength),\n                byteOffset: 0,\n                byteLength: buffer.byteLength\n            };\n        }\n    }\n}\n/**\n * Loads all images\n * TODO - traverse gltf and determine which images are actually needed\n * @param gltf\n * @param options\n * @param context\n * @returns\n */\nasync function loadImages(gltf, options, context) {\n    const imageIndices = getReferencesImageIndices(gltf);\n    const images = gltf.json.images || [];\n    const promises = [];\n    for (const imageIndex of imageIndices) {\n        promises.push(loadImage(gltf, images[imageIndex], imageIndex, options, context));\n    }\n    return await Promise.all(promises);\n}\n/** Make sure we only load images that are actually referenced by textures */\nfunction getReferencesImageIndices(gltf) {\n    const imageIndices = new Set();\n    const textures = gltf.json.textures || [];\n    for (const texture of textures) {\n        if (texture.source !== undefined) {\n            imageIndices.add(texture.source);\n        }\n    }\n    return Array.from(imageIndices).sort();\n}\n/** Asynchronously fetches and parses one image, store in images array outside of json */\nasync function loadImage(gltf, image, index, options, context) {\n    let arrayBuffer;\n    if (image.uri && !image.hasOwnProperty('bufferView')) {\n        const uri = resolveUrl(image.uri, options);\n        const { fetch } = context;\n        const response = await fetch(uri);\n        arrayBuffer = await response.arrayBuffer();\n        image.bufferView = {\n            data: arrayBuffer\n        };\n    }\n    if (Number.isFinite(image.bufferView)) {\n        const array = getTypedArrayForBufferView(gltf.json, gltf.buffers, image.bufferView);\n        arrayBuffer = sliceArrayBuffer(array.buffer, array.byteOffset, array.byteLength);\n    }\n    assert(arrayBuffer, 'glTF image has no data');\n    // Call `parse`\n    let parsedImage = (await parseFromContext(arrayBuffer, [ImageLoader, BasisLoader], {\n        ...options,\n        mimeType: image.mimeType,\n        basis: options.basis || { format: selectSupportedBasisFormat() }\n    }, context));\n    if (parsedImage && parsedImage[0]) {\n        parsedImage = {\n            compressed: true,\n            // @ts-expect-error\n            mipmaps: false,\n            width: parsedImage[0].width,\n            height: parsedImage[0].height,\n            data: parsedImage[0]\n        };\n    }\n    // TODO making sure ImageLoader is overridable by using array of loaders\n    // const parsedImage = await parse(arrayBuffer, [ImageLoader]);\n    // Store the loaded image\n    gltf.images = gltf.images || [];\n    // @ts-expect-error TODO - sort out image typing asap\n    gltf.images[index] = parsedImage;\n}\n", "import { VERSION } from \"./lib/utils/version.js\";\nimport { parseGLTF } from \"./lib/parsers/parse-gltf.js\";\n/**\n * GLTF loader\n */\nexport const GLTFLoader = {\n    dataType: null,\n    batchType: null,\n    name: 'glTF',\n    id: 'gltf',\n    module: 'gltf',\n    version: VERSION,\n    extensions: ['gltf', 'glb'],\n    mimeTypes: ['model/gltf+json', 'model/gltf-binary'],\n    text: true,\n    binary: true,\n    tests: ['glTF'],\n    parse,\n    options: {\n        gltf: {\n            normalize: true, // Normalize glTF v1 to glTF v2 format (not yet stable)\n            loadBuffers: true, // Fetch any linked .BIN buffers, decode base64\n            loadImages: true, // Create image objects\n            decompressMeshes: true // Decompress Draco encoded meshes\n        },\n        // common?\n        log: console // eslint-disable-line\n    }\n};\nexport async function parse(arrayBuffer, options = {}, context) {\n    // Apps can call the parse method directly, we so apply default options here\n    options = { ...GLTFLoader.options, ...options };\n    // @ts-ignore\n    options.gltf = { ...GLTFLoader.options.gltf, ...options.gltf };\n    const { byteOffset = 0 } = options;\n    const gltf = {};\n    return await parseGLTF(gltf, arrayBuffer, byteOffset, options, context);\n}\n", "// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../utils/assert.js\";\nimport { getAccessorArrayTypeAndLength } from \"../gltf-utils/gltf-utils.js\";\n// This is a post processor for loaded glTF files\n// The goal is to make the loaded data easier to use in WebGL applications\n//\n// Functions:\n// * Resolve indexed arrays structure of glTF into a linked tree.\n// * Translate stringified enum keys and values into WebGL constants.\n// * Load images (optional)\n// ENUM LOOKUP\nconst COMPONENTS = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16\n};\nconst BYTES = {\n    5120: 1, // BYTE\n    5121: 1, // UNSIGNED_BYTE\n    5122: 2, // SHORT\n    5123: 2, // UNSIGNED_SHORT\n    5125: 4, // UNSIGNED_INT\n    5126: 4 // FLOAT\n};\nconst GL_SAMPLER = {\n    // Sampler parameters\n    TEXTURE_MAG_FILTER: 0x2800,\n    TEXTURE_MIN_FILTER: 0x2801,\n    TEXTURE_WRAP_S: 0x2802,\n    TEXTURE_WRAP_T: 0x2803,\n    // Sampler default values\n    REPEAT: 0x2901,\n    LINEAR: 0x2601,\n    NEAREST_MIPMAP_LINEAR: 0x2702\n};\nconst SAMPLER_PARAMETER_GLTF_TO_GL = {\n    magFilter: GL_SAMPLER.TEXTURE_MAG_FILTER,\n    minFilter: GL_SAMPLER.TEXTURE_MIN_FILTER,\n    wrapS: GL_SAMPLER.TEXTURE_WRAP_S,\n    wrapT: GL_SAMPLER.TEXTURE_WRAP_T\n};\n// When undefined, a sampler with repeat wrapping and auto filtering should be used.\n// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#texture\nconst DEFAULT_SAMPLER_PARAMETERS = {\n    [GL_SAMPLER.TEXTURE_MAG_FILTER]: GL_SAMPLER.LINEAR,\n    [GL_SAMPLER.TEXTURE_MIN_FILTER]: GL_SAMPLER.NEAREST_MIPMAP_LINEAR,\n    [GL_SAMPLER.TEXTURE_WRAP_S]: GL_SAMPLER.REPEAT,\n    [GL_SAMPLER.TEXTURE_WRAP_T]: GL_SAMPLER.REPEAT\n};\nfunction makeDefaultSampler() {\n    return {\n        id: 'default-sampler',\n        parameters: DEFAULT_SAMPLER_PARAMETERS\n    };\n}\nfunction getBytesFromComponentType(componentType) {\n    return BYTES[componentType];\n}\nfunction getSizeFromAccessorType(type) {\n    return COMPONENTS[type];\n}\nclass GLTFPostProcessor {\n    baseUri = '';\n    // @ts-expect-error\n    jsonUnprocessed;\n    // @ts-expect-error\n    json;\n    buffers = [];\n    images = [];\n    postProcess(gltf, options = {}) {\n        const { json, buffers = [], images = [] } = gltf;\n        // @ts-expect-error\n        const { baseUri = '' } = gltf;\n        assert(json);\n        this.baseUri = baseUri;\n        this.buffers = buffers;\n        this.images = images;\n        this.jsonUnprocessed = json;\n        this.json = this._resolveTree(gltf.json, options);\n        return this.json;\n    }\n    // Convert indexed glTF structure into tree structure\n    // cross-link index resolution, enum lookup, convenience calculations\n    // eslint-disable-next-line complexity, max-statements\n    _resolveTree(gltf, options = {}) {\n        // @ts-expect-error\n        const json = { ...gltf };\n        this.json = json;\n        if (gltf.bufferViews) {\n            json.bufferViews = gltf.bufferViews.map((bufView, i) => this._resolveBufferView(bufView, i));\n        }\n        if (gltf.images) {\n            json.images = gltf.images.map((image, i) => this._resolveImage(image, i));\n        }\n        if (gltf.samplers) {\n            json.samplers = gltf.samplers.map((sampler, i) => this._resolveSampler(sampler, i));\n        }\n        if (gltf.textures) {\n            json.textures = gltf.textures.map((texture, i) => this._resolveTexture(texture, i));\n        }\n        if (gltf.accessors) {\n            json.accessors = gltf.accessors.map((accessor, i) => this._resolveAccessor(accessor, i));\n        }\n        if (gltf.materials) {\n            json.materials = gltf.materials.map((material, i) => this._resolveMaterial(material, i));\n        }\n        if (gltf.meshes) {\n            json.meshes = gltf.meshes.map((mesh, i) => this._resolveMesh(mesh, i));\n        }\n        if (gltf.nodes) {\n            json.nodes = gltf.nodes.map((node, i) => this._resolveNode(node, i));\n            json.nodes = json.nodes.map((node, i) => this._resolveNodeChildren(node));\n        }\n        if (gltf.skins) {\n            json.skins = gltf.skins.map((skin, i) => this._resolveSkin(skin, i));\n        }\n        if (gltf.scenes) {\n            json.scenes = gltf.scenes.map((scene, i) => this._resolveScene(scene, i));\n        }\n        if (typeof this.json.scene === 'number' && json.scenes) {\n            json.scene = json.scenes[this.json.scene];\n        }\n        return json;\n    }\n    getScene(index) {\n        return this._get(this.json.scenes, index);\n    }\n    getNode(index) {\n        return this._get(this.json.nodes, index);\n    }\n    getSkin(index) {\n        return this._get(this.json.skins, index);\n    }\n    getMesh(index) {\n        return this._get(this.json.meshes, index);\n    }\n    getMaterial(index) {\n        return this._get(this.json.materials, index);\n    }\n    getAccessor(index) {\n        return this._get(this.json.accessors, index);\n    }\n    getCamera(index) {\n        return this._get(this.json.cameras, index);\n    }\n    getTexture(index) {\n        return this._get(this.json.textures, index);\n    }\n    getSampler(index) {\n        return this._get(this.json.samplers, index);\n    }\n    getImage(index) {\n        return this._get(this.json.images, index);\n    }\n    getBufferView(index) {\n        return this._get(this.json.bufferViews, index);\n    }\n    getBuffer(index) {\n        return this._get(this.json.buffers, index);\n    }\n    _get(array, index) {\n        // check if already resolved\n        if (typeof index === 'object') {\n            return index;\n        }\n        const object = array && array[index];\n        if (!object) {\n            console.warn(`glTF file error: Could not find ${array}[${index}]`); // eslint-disable-line\n        }\n        return object;\n    }\n    // PARSING HELPERS\n    _resolveScene(scene, index) {\n        return {\n            ...scene,\n            // @ts-ignore\n            id: scene.id || `scene-${index}`,\n            nodes: (scene.nodes || []).map((node) => this.getNode(node))\n        };\n    }\n    _resolveNode(gltfNode, index) {\n        // @ts-expect-error\n        const node = {\n            ...gltfNode,\n            // @ts-expect-error id could already be present, glTF standard does not prevent it\n            id: gltfNode?.id || `node-${index}`\n        };\n        if (gltfNode.mesh !== undefined) {\n            node.mesh = this.getMesh(gltfNode.mesh);\n        }\n        if (gltfNode.camera !== undefined) {\n            node.camera = this.getCamera(gltfNode.camera);\n        }\n        if (gltfNode.skin !== undefined) {\n            node.skin = this.getSkin(gltfNode.skin);\n        }\n        // TODO deprecated - Delete in v4.0?\n        // @ts-expect-error node.meshes does not seem to be part of the GLTF standard\n        if (gltfNode.meshes !== undefined && gltfNode.meshes.length) {\n            // @ts-expect-error\n            node.mesh = gltfNode.meshes.reduce((accum, meshIndex) => {\n                const mesh = this.getMesh(meshIndex);\n                accum.id = mesh.id;\n                accum.primitives = accum.primitives.concat(mesh.primitives);\n                return accum;\n            }, { primitives: [] });\n        }\n        return node;\n    }\n    _resolveNodeChildren(node) {\n        if (node.children) {\n            // @ts-expect-error node.children are numbers at this stage\n            node.children = node.children.map((child) => this.getNode(child));\n        }\n        return node;\n    }\n    _resolveSkin(gltfSkin, index) {\n        const inverseBindMatrices = typeof gltfSkin.inverseBindMatrices === 'number'\n            ? this.getAccessor(gltfSkin.inverseBindMatrices)\n            : undefined;\n        return {\n            ...gltfSkin,\n            id: gltfSkin.id || `skin-${index}`,\n            inverseBindMatrices\n        };\n    }\n    _resolveMesh(gltfMesh, index) {\n        const mesh = {\n            ...gltfMesh,\n            id: gltfMesh.id || `mesh-${index}`,\n            primitives: []\n        };\n        if (gltfMesh.primitives) {\n            mesh.primitives = gltfMesh.primitives.map((gltfPrimitive) => {\n                const primitive = {\n                    ...gltfPrimitive,\n                    attributes: {},\n                    indices: undefined,\n                    material: undefined\n                };\n                const attributes = gltfPrimitive.attributes;\n                for (const attribute in attributes) {\n                    primitive.attributes[attribute] = this.getAccessor(attributes[attribute]);\n                }\n                if (gltfPrimitive.indices !== undefined) {\n                    primitive.indices = this.getAccessor(gltfPrimitive.indices);\n                }\n                if (gltfPrimitive.material !== undefined) {\n                    primitive.material = this.getMaterial(gltfPrimitive.material);\n                }\n                return primitive;\n            });\n        }\n        return mesh;\n    }\n    _resolveMaterial(gltfMaterial, index) {\n        // @ts-expect-error\n        const material = {\n            ...gltfMaterial,\n            // @ts-expect-error\n            id: gltfMaterial.id || `material-${index}`\n        };\n        if (material.normalTexture) {\n            material.normalTexture = { ...material.normalTexture };\n            material.normalTexture.texture = this.getTexture(material.normalTexture.index);\n        }\n        if (material.occlusionTexture) {\n            material.occlusionTexture = { ...material.occlusionTexture };\n            material.occlusionTexture.texture = this.getTexture(material.occlusionTexture.index);\n        }\n        if (material.emissiveTexture) {\n            material.emissiveTexture = { ...material.emissiveTexture };\n            material.emissiveTexture.texture = this.getTexture(material.emissiveTexture.index);\n        }\n        if (!material.emissiveFactor) {\n            material.emissiveFactor = material.emissiveTexture ? [1, 1, 1] : [0, 0, 0];\n        }\n        if (material.pbrMetallicRoughness) {\n            material.pbrMetallicRoughness = { ...material.pbrMetallicRoughness };\n            const mr = material.pbrMetallicRoughness;\n            if (mr.baseColorTexture) {\n                mr.baseColorTexture = { ...mr.baseColorTexture };\n                mr.baseColorTexture.texture = this.getTexture(mr.baseColorTexture.index);\n            }\n            if (mr.metallicRoughnessTexture) {\n                mr.metallicRoughnessTexture = { ...mr.metallicRoughnessTexture };\n                mr.metallicRoughnessTexture.texture = this.getTexture(mr.metallicRoughnessTexture.index);\n            }\n        }\n        return material;\n    }\n    _resolveAccessor(gltfAccessor, index) {\n        // Look up enums\n        const bytesPerComponent = getBytesFromComponentType(gltfAccessor.componentType);\n        const components = getSizeFromAccessorType(gltfAccessor.type);\n        const bytesPerElement = bytesPerComponent * components;\n        const accessor = {\n            ...gltfAccessor,\n            // @ts-expect-error\n            id: gltfAccessor.id || `accessor-${index}`,\n            bytesPerComponent,\n            components,\n            bytesPerElement,\n            value: undefined,\n            bufferView: undefined,\n            sparse: undefined\n        };\n        if (gltfAccessor.bufferView !== undefined) {\n            // Draco encoded meshes don't have bufferView\n            accessor.bufferView = this.getBufferView(gltfAccessor.bufferView);\n        }\n        // Create TypedArray for the accessor\n        // Note: The canonical way to instantiate is to ignore this array and create\n        // WebGLBuffer's using the bufferViews.\n        if (accessor.bufferView) {\n            const buffer = accessor.bufferView.buffer;\n            const { ArrayType, byteLength } = getAccessorArrayTypeAndLength(accessor, accessor.bufferView);\n            const byteOffset = (accessor.bufferView.byteOffset || 0) + (accessor.byteOffset || 0) + buffer.byteOffset;\n            let cutBuffer = buffer.arrayBuffer.slice(byteOffset, byteOffset + byteLength);\n            if (accessor.bufferView.byteStride) {\n                cutBuffer = this._getValueFromInterleavedBuffer(buffer, byteOffset, accessor.bufferView.byteStride, accessor.bytesPerElement, accessor.count);\n            }\n            accessor.value = new ArrayType(cutBuffer);\n        }\n        return accessor;\n    }\n    /**\n     * Take values of particular accessor from interleaved buffer\n     * various parts of the buffer\n     * @param buffer\n     * @param byteOffset\n     * @param byteStride\n     * @param bytesPerElement\n     * @param count\n     * @returns\n     */\n    _getValueFromInterleavedBuffer(buffer, byteOffset, byteStride, bytesPerElement, count) {\n        const result = new Uint8Array(count * bytesPerElement);\n        for (let i = 0; i < count; i++) {\n            const elementOffset = byteOffset + i * byteStride;\n            result.set(new Uint8Array(buffer.arrayBuffer.slice(elementOffset, elementOffset + bytesPerElement)), i * bytesPerElement);\n        }\n        return result.buffer;\n    }\n    _resolveTexture(gltfTexture, index) {\n        return {\n            ...gltfTexture,\n            // @ts-expect-error id could already be present, glTF standard does not prevent it\n            id: gltfTexture.id || `texture-${index}`,\n            sampler: typeof gltfTexture.sampler === 'number'\n                ? this.getSampler(gltfTexture.sampler)\n                : makeDefaultSampler(),\n            source: typeof gltfTexture.source === 'number' ? this.getImage(gltfTexture.source) : undefined\n        };\n    }\n    _resolveSampler(gltfSampler, index) {\n        const sampler = {\n            // @ts-expect-error id could already be present, glTF standard does not prevent it\n            id: gltfSampler.id || `sampler-${index}`,\n            ...gltfSampler,\n            parameters: {}\n        };\n        // Map textual parameters to GL parameter values\n        for (const key in sampler) {\n            const glEnum = this._enumSamplerParameter(key);\n            if (glEnum !== undefined) {\n                sampler.parameters[glEnum] = sampler[key];\n            }\n        }\n        return sampler;\n    }\n    _enumSamplerParameter(key) {\n        return SAMPLER_PARAMETER_GLTF_TO_GL[key];\n    }\n    _resolveImage(gltfImage, index) {\n        const image = {\n            ...gltfImage,\n            // @ts-expect-error id could already be present, glTF standard does not prevent it\n            id: gltfImage.id || `image-${index}`,\n            image: null,\n            bufferView: gltfImage.bufferView !== undefined ? this.getBufferView(gltfImage.bufferView) : undefined\n        };\n        // Check if image has been preloaded by the GLTFLoader\n        // If so, link it into the JSON and drop the URI\n        const preloadedImage = this.images[index];\n        if (preloadedImage) {\n            image.image = preloadedImage;\n        }\n        return image;\n    }\n    _resolveBufferView(gltfBufferView, index) {\n        const bufferIndex = gltfBufferView.buffer;\n        const arrayBuffer = this.buffers[bufferIndex].arrayBuffer;\n        // Add offset of buffer, then offset of buffer view\n        let byteOffset = this.buffers[bufferIndex].byteOffset || 0;\n        if (gltfBufferView.byteOffset) {\n            byteOffset += gltfBufferView.byteOffset;\n        }\n        const bufferView = {\n            // // @ts-expect-error id could already be present, glTF standard does not prevent it\n            id: `bufferView-${index}`,\n            ...gltfBufferView,\n            // ...this.buffers[bufferIndex],\n            buffer: this.buffers[bufferIndex],\n            data: new Uint8Array(arrayBuffer, byteOffset, gltfBufferView.byteLength)\n        };\n        return bufferView;\n    }\n    _resolveCamera(gltfCamera, index) {\n        const camera = {\n            ...gltfCamera,\n            // @ts-expect-error id could already be present, glTF standard does not prevent it\n            id: gltfCamera.id || `camera-${index}`\n        };\n        // TODO - create 4x4 matrices\n        if (camera.perspective) {\n            // camera.matrix = createPerspectiveMatrix(camera.perspective);\n        }\n        if (camera.orthographic) {\n            // camera.matrix = createOrthographicMatrix(camera.orthographic);\n        }\n        return camera;\n    }\n}\nexport function postProcessGLTF(gltf, options) {\n    return new GLTFPostProcessor().postProcess(gltf, options);\n}\n", "import { mulMat4, rotate, translate, Vec3 } from \"r628\";\r\nimport { Components, specifyComponent } from \"../ecs\";\r\nimport { Transform } from \"../transform-component\";\r\nimport type RAPIER from \"@dimforge/rapier3d-simd\";\r\n\r\nexport function toRapierVec3(vec3: Vec3): { x: number; y: number; z: number } {\r\n  return {\r\n    x: vec3[0],\r\n    y: vec3[1],\r\n    z: vec3[2],\r\n  };\r\n}\r\n\r\nexport function toVec3(v: { x: number; y: number; z: number }): Vec3 {\r\n  return [v.x, v.y, v.z];\r\n}\r\n\r\nexport const PhysicsWorld = specifyComponent({\r\n  create() {\r\n    return;\r\n  },\r\n  brand: \"physicsWorld\" as const,\r\n  dependencies: [] as const,\r\n  globalDependencies: [] as const,\r\n  init: async () => {\r\n    const RAPIER = (await import(\"@dimforge/rapier3d-simd\")).default;\r\n    console.log(RAPIER, RAPIER.World);\r\n    const world = new RAPIER.World({\r\n      x: 0,\r\n      y: -9.81,\r\n      z: 0,\r\n    });\r\n    return {\r\n      world,\r\n      RAPIER,\r\n    };\r\n  },\r\n  fixedUpdate({ state, instances }) {\r\n    // state.world.integrationParameters.dt = 0.004;\r\n    state.world.step();\r\n  },\r\n  onDestroy(c) {\r\n    c;\r\n  },\r\n});\r\n\r\nfunction quatToAngleAxis(quat: {\r\n  w: number;\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n}): {\r\n  angle: number;\r\n  axis: Vec3;\r\n} {\r\n  const s = Math.sqrt(1 - quat.w * quat.w);\r\n\r\n  return {\r\n    angle: 2 * Math.acos(quat.w),\r\n    axis: s === 0 ? [1, 0, 0] : [quat.x / s, quat.y / s, quat.z / s],\r\n  };\r\n}\r\n\r\nexport const RigidBody = specifyComponent({\r\n  brand: \"rigidBody\" as const,\r\n  dependencies: [Transform] as const,\r\n  globalDependencies: [PhysicsWorld] as const,\r\n  create(params: RAPIER.RigidBodyDesc, _, { physicsWorld }) {\r\n    return { body: physicsWorld.state.world.createRigidBody(params) };\r\n  },\r\n  onDestroy(c, { physicsWorld }) {\r\n    physicsWorld.state.world.removeRigidBody(c.body);\r\n  },\r\n  init: () => undefined,\r\n  fixedUpdate({ state, instances }) {\r\n    for (const inst of instances) {\r\n      const translation = inst.data.body.translation();\r\n      const rotationQuat = inst.data.body.rotation();\r\n      const rotation = quatToAngleAxis(rotationQuat);\r\n\r\n      inst.entity.transform.matrix = mulMat4(\r\n        translate([translation.x, translation.y, translation.z]),\r\n        rotate(rotation.axis, rotation.angle)\r\n      );\r\n    }\r\n  },\r\n});\r\n\r\nexport const RigidBodyCollider = specifyComponent({\r\n  brand: \"rigidBodyCollider\" as const,\r\n  dependencies: [RigidBody] as const,\r\n  globalDependencies: [PhysicsWorld] as const,\r\n  create(params: RAPIER.ColliderDesc, _, { physicsWorld }, waitFor) {\r\n    const rigidBody = waitFor(RigidBody);\r\n    const collider = physicsWorld.state.world.createCollider(\r\n      params,\r\n      rigidBody.body\r\n    );\r\n\r\n    return {\r\n      collider,\r\n    };\r\n  },\r\n  onDestroy(c, { physicsWorld }) {\r\n    physicsWorld.state.world.removeCollider(c.collider, false);\r\n  },\r\n  init: () => undefined,\r\n});\r\n", "import { cartesianProduct, rescale, Vec2, Vec3 } from \"r628\";\r\nimport { createBufferFromData as createGPUBufferFromData } from \"./components/renderer\";\r\n\r\nexport type MeshSpec = {\r\n  vertices: Float32Array;\r\n  indices: Uint32Array;\r\n  drawCount: number;\r\n};\r\n\r\nexport function uploadIndexedMeshToGPU(device: GPUDevice, mesh: MeshSpec) {\r\n  return {\r\n    vertices: createGPUBufferFromData(\r\n      device,\r\n      mesh.vertices.buffer,\r\n      GPUBufferUsage.COPY_DST | GPUBufferUsage.VERTEX\r\n    ),\r\n    indices: createGPUBufferFromData(\r\n      device,\r\n      mesh.indices.buffer,\r\n      GPUBufferUsage.COPY_DST | GPUBufferUsage.INDEX\r\n    ),\r\n    drawCount: mesh.drawCount,\r\n  };\r\n}\r\n\r\nexport function parametricTriangleMeshGeometry(\r\n  fn: (coords: Vec2) => Vec3,\r\n  lo: Vec2,\r\n  hi: Vec2,\r\n  resolution: Vec2\r\n): MeshSpec {\r\n  const vertCount = resolution[1] * resolution[0];\r\n  const indexCount = (resolution[1] - 1) * (resolution[0] - 1) * 6;\r\n\r\n  const vertices = new Float32Array(vertCount * 3);\r\n  const indices = new Uint32Array(indexCount);\r\n\r\n  const [lowX, lowY] = lo;\r\n  const [highX, highY] = hi;\r\n\r\n  const stepX = (highX - lowX) / (resolution[0] - 1);\r\n  const stepY = (highY - lowY) / (resolution[1] - 1);\r\n\r\n  for (let y = 0; y < resolution[1]; y++) {\r\n    for (let x = 0; x < resolution[0]; x++) {\r\n      let iVertices = (y * resolution[0] + x) * 3;\r\n\r\n      const xIn = lowX + stepX * x;\r\n      const yIn = lowY + stepY * y;\r\n\r\n      const pt = fn([xIn, yIn]);\r\n\r\n      vertices[iVertices] = pt[0];\r\n      vertices[iVertices + 1] = pt[1];\r\n      vertices[iVertices + 2] = pt[2];\r\n    }\r\n  }\r\n\r\n  for (let y = 0; y < resolution[1] - 1; y++) {\r\n    for (let x = 0; x < resolution[0] - 1; x++) {\r\n      const iIndices = (y * (resolution[0] - 1) + x) * 6;\r\n      const baseVertex = y * resolution[0] + x;\r\n\r\n      indices[iIndices] = baseVertex;\r\n      indices[iIndices + 1] = baseVertex + 1;\r\n      indices[iIndices + 2] = baseVertex + resolution[0];\r\n\r\n      indices[iIndices + 3] = baseVertex + 1;\r\n      indices[iIndices + 5] = baseVertex + resolution[0];\r\n      indices[iIndices + 4] = baseVertex + resolution[0] + 1;\r\n    }\r\n  }\r\n\r\n  console.log(indexCount, vertCount);\r\n\r\n  return {\r\n    vertices,\r\n    indices,\r\n    drawCount: indexCount,\r\n  };\r\n}\r\n\r\nexport function uvSphere(radius: number, resolution: Vec2): MeshSpec {\r\n  return parametricTriangleMeshGeometry(\r\n    ([a, b]) => {\r\n      let px = Math.cos(a) * Math.cos(b) * radius;\r\n      let pz = Math.sin(a) * Math.cos(b) * radius;\r\n      let py = Math.sin(b) * radius;\r\n      return [px, py, pz];\r\n    },\r\n    [0, -Math.PI / 2],\r\n    [Math.PI * 2, Math.PI / 2],\r\n    resolution\r\n  );\r\n}\r\n", "struct LightingVertInput {\r\n  @location(0) sample_pos: vec3f,\r\n}\r\n\r\nstruct LightingFragInput {\r\n  @builtin(position) vertex_position : vec4f,\r\n  @location(0) tex_pos: vec2f,\r\n}\r\n\r\nstruct LightingFragOutput {\r\n  @location(0) color : vec4f,\r\n}\r\n\r\n@group(0) @binding(0) var tex_sampler : sampler;\r\n@group(0) @binding(1) var tex_pos : texture_2d<f32>;\r\n@group(0) @binding(2) var tex_normal : texture_2d<f32>;\r\n@group(0) @binding(3) var tex_albedo : texture_2d<f32>;\r\n\r\nstruct Params {\r\n  mvp: mat4x4f,\r\n  inv_vp: mat4x4f,\r\n  m: mat4x4f,\r\n  light_pos: vec4f,\r\n  light_color: vec3f,\r\n  quadratic: f32,\r\n  linear: f32,\r\n  constant: f32,\r\n  cutoff_radius: f32,\r\n}\r\n\r\n@group(1) @binding(0) var<uniform> params : Params;\r\n\r\n@vertex\r\nfn VSMain(input: LightingVertInput) -> LightingFragInput {\r\n  var frag: LightingFragInput;\r\n  var pos = params.mvp * vec4(input.sample_pos, 1.0);\r\n  // var pos2 = params.vp * vec4(input.sample_pos, 1.0);\r\n  frag.tex_pos = ((pos.xy ) / ((pos.w - 0.0) * 1.0)) * 0.5 + 0.5;\r\n  frag.tex_pos.y = 1.0 - frag.tex_pos.y;\r\n  frag.vertex_position = pos;\r\n  return frag;\r\n}\r\n\r\n@fragment\r\nfn FSMain(input: LightingFragInput) -> LightingFragOutput {\r\n  var o: LightingFragOutput;\r\n  // _ = tex_pos;\r\n  // _ = tex_albedo;\r\n  // _ = tex_normal;\r\n  let uv = input.vertex_position.xy / vec2f(textureDimensions(tex_pos).xy);\r\n  let ipos = vec2i(input.vertex_position.xy);\r\n\r\n  let albedo = textureSample(tex_albedo, tex_sampler, uv);\r\n  let pos = params.inv_vp * textureSample(tex_pos, tex_sampler, uv);\r\n  let normal = textureSample(tex_normal, tex_sampler, uv);\r\n\r\n  let vec_to_light = (params.m * vec4f(0.0,0.0, 0.0, 1.0)).xyz - pos.xyz;\r\n  let dist_to_light = length(vec_to_light);\r\n  let dir_to_light = vec4f(vec_to_light / dist_to_light, 0.0).xyz;\r\n\r\n  let attenuation = \r\n    params.quadratic * dist_to_light * dist_to_light\r\n    + params.linear * dist_to_light\r\n    + params.constant;\r\n\r\n  var brightness = 1.0 / attenuation + 0.3;\r\n\r\n  brightness = brightness * min(\r\n    1.0, \r\n    3.0 * (1.0 - dist_to_light / params.cutoff_radius)\r\n  );\r\n\r\n  var brightness_factor = brightness * max(dot(\r\n    normal.xyz,\r\n    dir_to_light\r\n  ), 0.0);\r\n\r\n  var dither_factor = (brightness_factor * 4.0);\r\n\r\n  var modulate_color = select(\r\n    (ceil(dither_factor) - 1.0) / 4.0,  \r\n    ceil(dither_factor) / 4.0,\r\n    dither256(fract(dither_factor), ipos),\r\n  );\r\n\r\n  o.color = (albedo * modulate_color);\r\n\r\n  o.color = max(o.color, vec4f(0.0));\r\n\r\n  o.color.a = 1.0;\r\n\r\n  o.color = pow(o.color, vec4(1 / 2.2));\r\n\r\n  // o.color = vec4f(dir_to_light.xyz * 0.5 + 0.5, 1.0);\r\n  // o.color = vec4f(normal.xyz * 0.5 + 0.5, 1.0);\r\n  // o.color = vec4f(max(dot(\r\n  //  normal.xyz,\r\n  //  dir_to_light\r\n  // ), 0.0) * 1.0);\r\n  \r\n  // o.color.a = 1.0;\r\n\r\n  // o.color = vec4(1.0, 0.0, 0.0, 1.0);\r\n\r\n  return o;\r\n} \r\n\r\nconst DITHER256_THRESHOLDS = array<f32, 256>(\r\n  0,\r\n  128,\r\n  32,\r\n  160,\r\n  8,\r\n  136,\r\n  40,\r\n  168,\r\n  2,\r\n  130,\r\n  34,\r\n  162,\r\n  10,\r\n  138,\r\n  42,\r\n  170,\r\n  192,\r\n  64,\r\n  224,\r\n  96,\r\n  200,\r\n  72,\r\n  232,\r\n  104,\r\n  194,\r\n  66,\r\n  226,\r\n  98,\r\n  202,\r\n  74,\r\n  234,\r\n  106,\r\n  48,\r\n  176,\r\n  16,\r\n  144,\r\n  56,\r\n  184,\r\n  24,\r\n  152,\r\n  50,\r\n  178,\r\n  18,\r\n  146,\r\n  58,\r\n  186,\r\n  26,\r\n  154,\r\n  240,\r\n  112,\r\n  208,\r\n  80,\r\n  248,\r\n  120,\r\n  216,\r\n  88,\r\n  242,\r\n  114,\r\n  210,\r\n  82,\r\n  250,\r\n  122,\r\n  218,\r\n  90,\r\n  12,\r\n  140,\r\n  44,\r\n  172,\r\n  4,\r\n  132,\r\n  36,\r\n  164,\r\n  14,\r\n  142,\r\n  46,\r\n  174,\r\n  6,\r\n  134,\r\n  38,\r\n  166,\r\n  204,\r\n  76,\r\n  236,\r\n  108,\r\n  196,\r\n  68,\r\n  228,\r\n  100,\r\n  206,\r\n  78,\r\n  238,\r\n  110,\r\n  198,\r\n  70,\r\n  230,\r\n  102,\r\n  60,\r\n  188,\r\n  28,\r\n  156,\r\n  52,\r\n  180,\r\n  20,\r\n  148,\r\n  62,\r\n  190,\r\n  30,\r\n  158,\r\n  54,\r\n  182,\r\n  22,\r\n  150,\r\n  252,\r\n  124,\r\n  220,\r\n  92,\r\n  244,\r\n  116,\r\n  212,\r\n  84,\r\n  254,\r\n  126,\r\n  222,\r\n  94,\r\n  246,\r\n  118,\r\n  214,\r\n  86,\r\n  3,\r\n  131,\r\n  35,\r\n  163,\r\n  11,\r\n  139,\r\n  43,\r\n  171,\r\n  1,\r\n  129,\r\n  33,\r\n  161,\r\n  9,\r\n  137,\r\n  41,\r\n  169,\r\n  195,\r\n  67,\r\n  227,\r\n  99,\r\n  203,\r\n  75,\r\n  235,\r\n  107,\r\n  193,\r\n  65,\r\n  225,\r\n  97,\r\n  201,\r\n  73,\r\n  233,\r\n  105,\r\n  51,\r\n  179,\r\n  19,\r\n  147,\r\n  59,\r\n  187,\r\n  27,\r\n  155,\r\n  49,\r\n  177,\r\n  17,\r\n  145,\r\n  57,\r\n  185,\r\n  25,\r\n  153,\r\n  243,\r\n  115,\r\n  211,\r\n  83,\r\n  251,\r\n  123,\r\n  219,\r\n  91,\r\n  241,\r\n  113,\r\n  209,\r\n  81,\r\n  249,\r\n  121,\r\n  217,\r\n  89,\r\n  15,\r\n  143,\r\n  47,\r\n  175,\r\n  7,\r\n  135,\r\n  39,\r\n  167,\r\n  13,\r\n  141,\r\n  45,\r\n  173,\r\n  5,\r\n  133,\r\n  37,\r\n  165,\r\n  207,\r\n  79,\r\n  239,\r\n  111,\r\n  199,\r\n  71,\r\n  231,\r\n  103,\r\n  205,\r\n  77,\r\n  237,\r\n  109,\r\n  197,\r\n  69,\r\n  229,\r\n  101,\r\n  63,\r\n  191,\r\n  31,\r\n  159,\r\n  55,\r\n  183,\r\n  23,\r\n  151,\r\n  61,\r\n  189,\r\n  29,\r\n  157,\r\n  53,\r\n  181,\r\n  21,\r\n  149,\r\n  255,\r\n  127,\r\n  223,\r\n  95,\r\n  247,\r\n  119,\r\n  215,\r\n  87,\r\n  253,\r\n  125,\r\n  221,\r\n  93,\r\n  245,\r\n  117,\r\n  213,\r\n  85\r\n);\r\n\r\nfn dither256(factor: f32, coord: vec2i) -> bool {\r\n  let x = coord.x % 16;\r\n  let y = coord.y % 16;\r\n  let threshold = DITHER256_THRESHOLDS[y * 16 + x] / 256.0;\r\n  return factor > threshold ;\r\n}", "{\"bindGroups\":[[{\"name\":\"tex_sampler\",\"type\":{\"name\":\"sampler\",\"attributes\":[{\"id\":47824,\"line\":14,\"name\":\"group\",\"value\":\"0\"},{\"id\":47825,\"line\":14,\"name\":\"binding\",\"value\":\"0\"}],\"size\":0,\"format\":null,\"access\":null},\"group\":0,\"binding\":0,\"attributes\":[{\"id\":47824,\"line\":14,\"name\":\"group\",\"value\":\"0\"},{\"id\":47825,\"line\":14,\"name\":\"binding\",\"value\":\"0\"}],\"resourceType\":3,\"access\":\"\"},{\"name\":\"tex_pos\",\"type\":{\"name\":\"texture_2d\",\"attributes\":[{\"id\":47828,\"line\":15,\"name\":\"group\",\"value\":\"0\"},{\"id\":47829,\"line\":15,\"name\":\"binding\",\"value\":\"1\"}],\"size\":0,\"format\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"access\":null},\"group\":0,\"binding\":1,\"attributes\":[{\"id\":47828,\"line\":15,\"name\":\"group\",\"value\":\"0\"},{\"id\":47829,\"line\":15,\"name\":\"binding\",\"value\":\"1\"}],\"resourceType\":2,\"access\":\"read\"},{\"name\":\"tex_normal\",\"type\":{\"name\":\"texture_2d\",\"attributes\":[{\"id\":47833,\"line\":16,\"name\":\"group\",\"value\":\"0\"},{\"id\":47834,\"line\":16,\"name\":\"binding\",\"value\":\"2\"}],\"size\":0,\"format\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"access\":null},\"group\":0,\"binding\":2,\"attributes\":[{\"id\":47833,\"line\":16,\"name\":\"group\",\"value\":\"0\"},{\"id\":47834,\"line\":16,\"name\":\"binding\",\"value\":\"2\"}],\"resourceType\":2,\"access\":\"read\"},{\"name\":\"tex_albedo\",\"type\":{\"name\":\"texture_2d\",\"attributes\":[{\"id\":47838,\"line\":17,\"name\":\"group\",\"value\":\"0\"},{\"id\":47839,\"line\":17,\"name\":\"binding\",\"value\":\"3\"}],\"size\":0,\"format\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"access\":null},\"group\":0,\"binding\":3,\"attributes\":[{\"id\":47838,\"line\":17,\"name\":\"group\",\"value\":\"0\"},{\"id\":47839,\"line\":17,\"name\":\"binding\",\"value\":\"3\"}],\"resourceType\":2,\"access\":\"read\"}],[{\"name\":\"params\",\"type\":{\"name\":\"Params\",\"attributes\":null,\"size\":240,\"members\":[{\"name\":\"mvp\",\"type\":{\"name\":\"mat4x4f\",\"attributes\":null,\"size\":64},\"attributes\":null,\"offset\":0,\"size\":64},{\"name\":\"inv_vp\",\"type\":{\"name\":\"mat4x4f\",\"attributes\":null,\"size\":64},\"attributes\":null,\"offset\":64,\"size\":64},{\"name\":\"m\",\"type\":{\"name\":\"mat4x4f\",\"attributes\":null,\"size\":64},\"attributes\":null,\"offset\":128,\"size\":64},{\"name\":\"light_pos\",\"type\":{\"name\":\"vec4f\",\"attributes\":null,\"size\":16},\"attributes\":null,\"offset\":192,\"size\":16},{\"name\":\"light_color\",\"type\":{\"name\":\"vec3f\",\"attributes\":null,\"size\":12},\"attributes\":null,\"offset\":208,\"size\":12},{\"name\":\"quadratic\",\"type\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"attributes\":null,\"offset\":220,\"size\":4},{\"name\":\"linear\",\"type\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"attributes\":null,\"offset\":224,\"size\":4},{\"name\":\"constant\",\"type\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"attributes\":null,\"offset\":228,\"size\":4},{\"name\":\"cutoff_radius\",\"type\":{\"name\":\"f32\",\"attributes\":null,\"size\":4},\"attributes\":null,\"offset\":232,\"size\":4}],\"align\":16,\"startLine\":19,\"endLine\":29,\"inUse\":true},\"group\":1,\"binding\":0,\"attributes\":[{\"id\":47862,\"line\":31,\"name\":\"group\",\"value\":\"1\"},{\"id\":47863,\"line\":31,\"name\":\"binding\",\"value\":\"0\"}],\"resourceType\":0,\"access\":\"read\"}]]}", "import * as matrix from './matrix.js';\n\nexport const AbstractMatrix = matrix.AbstractMatrix;\nexport const CHO = matrix.CHO;\nexport const CholeskyDecomposition = matrix.CholeskyDecomposition;\nexport const DistanceMatrix = matrix.DistanceMatrix;\nexport const EVD = matrix.EVD;\nexport const EigenvalueDecomposition = matrix.EigenvalueDecomposition;\nexport const LU = matrix.LU;\nexport const LuDecomposition = matrix.LuDecomposition;\nexport const Matrix = matrix.Matrix;\nexport const MatrixColumnSelectionView = matrix.MatrixColumnSelectionView;\nexport const MatrixColumnView = matrix.MatrixColumnView;\nexport const MatrixFlipColumnView = matrix.MatrixFlipColumnView;\nexport const MatrixFlipRowView = matrix.MatrixFlipRowView;\nexport const MatrixRowSelectionView = matrix.MatrixRowSelectionView;\nexport const MatrixRowView = matrix.MatrixRowView;\nexport const MatrixSelectionView = matrix.MatrixSelectionView;\nexport const MatrixSubView = matrix.MatrixSubView;\nexport const MatrixTransposeView = matrix.MatrixTransposeView;\nexport const NIPALS = matrix.NIPALS;\nexport const Nipals = matrix.Nipals;\nexport const QR = matrix.QR;\nexport const QrDecomposition = matrix.QrDecomposition;\nexport const SVD = matrix.SVD;\nexport const SingularValueDecomposition = matrix.SingularValueDecomposition;\nexport const SymmetricMatrix = matrix.SymmetricMatrix;\nexport const WrapperMatrix1D = matrix.WrapperMatrix1D;\nexport const WrapperMatrix2D = matrix.WrapperMatrix2D;\nexport const correlation = matrix.correlation;\nexport const covariance = matrix.covariance;\nexport default matrix.default.Matrix ? matrix.default.Matrix : matrix.Matrix;\nexport const determinant = matrix.determinant;\nexport const inverse = matrix.inverse;\nexport const linearDependencies = matrix.linearDependencies;\nexport const pseudoInverse = matrix.pseudoInverse;\nexport const solve = matrix.solve;\nexport const wrap = matrix.wrap;\n", "import Matrix, { inverse } from \"ml-matrix\";\r\nimport { Mat4 } from \"r628\";\r\n\r\nexport function inv4(m: Mat4): Mat4 {\r\n  const M = new Matrix([\r\n    m.slice(0, 4),\r\n    m.slice(4, 8),\r\n    m.slice(8, 12),\r\n    m.slice(12, 16),\r\n  ]).transpose();\r\n  const invM = inverse(M);\r\n  return invM.transpose().to1DArray() as Mat4;\r\n}\r\n", "import {\r\n  makeUniformBuffer,\r\n  mulMat4,\r\n  mulMat4ByVec4,\r\n  rotate,\r\n  scale,\r\n  Vec3,\r\n} from \"r628\";\r\nimport {\r\n  GBUFFER_PASS,\r\n  GBUFFER_SUBMIT,\r\n  LIGHTING_PASS,\r\n  DeferredWebgpuRenderer,\r\n} from \"./renderer\";\r\nimport { uploadIndexedMeshToGPU, uvSphere } from \"../mesh-generation\";\r\n\r\nimport LightingRenderer from \"./lighting.wgsl?raw\";\r\nimport LightingRendererJSON from \"lighting.wgsl\";\r\nimport { specifyComponent } from \"../ecs\";\r\nimport { Transform } from \"../transform-component\";\r\nimport { inv4 } from \"../matrix\";\r\n\r\nexport const PointLightSource = specifyComponent({\r\n  async init(subsystem) {\r\n    const { device, canvasFormat, onResize } = await subsystem(\r\n      DeferredWebgpuRenderer\r\n    );\r\n\r\n    const lightingBindGroupLayout = device.createBindGroupLayout({\r\n      entries: [\r\n        {\r\n          binding: 0,\r\n          sampler: { type: \"non-filtering\" },\r\n          visibility: GPUShaderStage.FRAGMENT,\r\n        },\r\n        {\r\n          binding: 1,\r\n          texture: { sampleType: \"unfilterable-float\", viewDimension: \"2d\" },\r\n          visibility: GPUShaderStage.FRAGMENT,\r\n        },\r\n        {\r\n          binding: 2,\r\n          texture: { sampleType: \"unfilterable-float\", viewDimension: \"2d\" },\r\n          visibility: GPUShaderStage.FRAGMENT,\r\n        },\r\n        {\r\n          binding: 3,\r\n          texture: { sampleType: \"float\", viewDimension: \"2d\" },\r\n          visibility: GPUShaderStage.FRAGMENT,\r\n        },\r\n      ],\r\n    });\r\n\r\n    const lightingUniformBindGroupLayout = device.createBindGroupLayout({\r\n      entries: [\r\n        {\r\n          binding: 0,\r\n          visibility: GPUShaderStage.FRAGMENT | GPUShaderStage.VERTEX,\r\n          buffer: {\r\n            type: \"uniform\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    const lightingPipeline = device.createRenderPipeline({\r\n      layout: device.createPipelineLayout({\r\n        bindGroupLayouts: [\r\n          lightingBindGroupLayout,\r\n          lightingUniformBindGroupLayout,\r\n        ],\r\n      }),\r\n      vertex: {\r\n        module: device.createShaderModule({\r\n          code: LightingRenderer,\r\n        }),\r\n        buffers: [\r\n          {\r\n            arrayStride: 12,\r\n            attributes: [\r\n              {\r\n                shaderLocation: 0,\r\n                offset: 0,\r\n                format: \"float32x3\",\r\n              },\r\n            ],\r\n          },\r\n        ],\r\n      },\r\n      fragment: {\r\n        module: device.createShaderModule({\r\n          code: LightingRenderer,\r\n        }),\r\n        targets: [\r\n          {\r\n            format: \"rgba8unorm\",\r\n            blend: {\r\n              color: {\r\n                operation: \"add\",\r\n                srcFactor: \"one\",\r\n                dstFactor: \"one\",\r\n              },\r\n              alpha: {\r\n                operation: \"add\",\r\n                srcFactor: \"one\",\r\n                dstFactor: \"zero\",\r\n              },\r\n            },\r\n          },\r\n        ],\r\n      },\r\n      primitive: { topology: \"triangle-list\", cullMode: \"back\" },\r\n    });\r\n    const pointLightGeometry = uploadIndexedMeshToGPU(\r\n      device,\r\n      uvSphere(1, [12, 12])\r\n    );\r\n\r\n    const state = {\r\n      pointLightGeometry,\r\n      lightingPipeline,\r\n      lightingBindGroupLayout,\r\n      lightingUniformBindGroupLayout,\r\n      lightingBindGroup: undefined as GPUBindGroup | undefined,\r\n    };\r\n\r\n    await onResize(async () => {\r\n      const gbuffer = (await subsystem(DeferredWebgpuRenderer)).textures\r\n        .gbuffer;\r\n      state.lightingBindGroup = device.createBindGroup({\r\n        layout: lightingBindGroupLayout,\r\n        entries: [\r\n          {\r\n            binding: 0,\r\n            resource: device.createSampler({\r\n              minFilter: \"nearest\",\r\n              magFilter: \"nearest\",\r\n            }),\r\n          },\r\n          {\r\n            binding: 1,\r\n            resource: gbuffer.position,\r\n          },\r\n          {\r\n            binding: 2,\r\n            resource: gbuffer.normal,\r\n          },\r\n          {\r\n            binding: 3,\r\n            resource: gbuffer.albedo,\r\n          },\r\n        ],\r\n      });\r\n    });\r\n\r\n    return state;\r\n  },\r\n\r\n  create(\r\n    params: {\r\n      color: Vec3;\r\n      linear: number;\r\n      quadratic: number;\r\n      constant: number;\r\n    },\r\n    global,\r\n    { deferredWebgpuRenderer }\r\n  ) {\r\n    const { device } = deferredWebgpuRenderer.state;\r\n\r\n    const uniformBuffer = device.createBuffer({\r\n      label: \"uniform buffer\",\r\n      size: 1024,\r\n      usage:\r\n        GPUBufferUsage.STORAGE |\r\n        GPUBufferUsage.COPY_DST |\r\n        GPUBufferUsage.UNIFORM,\r\n    });\r\n\r\n    const uniformBindGroup = device.createBindGroup({\r\n      label: \"lighting uniform bind group\",\r\n      entries: [\r\n        {\r\n          binding: 0,\r\n          resource: uniformBuffer,\r\n        },\r\n      ],\r\n      layout: global.state.lightingUniformBindGroupLayout,\r\n    });\r\n\r\n    return {\r\n      uniformBuffer,\r\n      uniformBindGroup,\r\n      color: params.color,\r\n      quadratic: params.quadratic,\r\n      linear: params.linear,\r\n      constant: params.constant,\r\n    };\r\n  },\r\n\r\n  renderUpdate({ state, instances, subsystem, scheduleTask }) {\r\n    scheduleTask(\r\n      () => {\r\n        const { projectionMatrix, viewMatrix, device, textures, ctx } =\r\n          subsystem(DeferredWebgpuRenderer).state;\r\n        const commandEncoder = device.createCommandEncoder();\r\n\r\n        const passEncoder = commandEncoder.beginRenderPass({\r\n          colorAttachments: [\r\n            {\r\n              view: textures.lighting.color.createView({\r\n                mipLevelCount: 1,\r\n              }),\r\n              clearValue: [0, 0, 0, 1],\r\n              loadOp: \"clear\",\r\n              storeOp: \"store\",\r\n            },\r\n          ],\r\n        });\r\n\r\n        passEncoder.setBindGroup(0, state.lightingBindGroup);\r\n\r\n        const cutoff = 5 / 256;\r\n\r\n        for (const i of instances) {\r\n          const rad =\r\n            (-i.data.linear +\r\n              Math.sqrt(\r\n                i.data.linear ** 2 -\r\n                  4 *\r\n                    i.data.quadratic *\r\n                    (i.data.constant - Math.max(...i.data.color) / cutoff)\r\n              )) /\r\n            (2 * i.data.quadratic);\r\n\r\n          const m = mulMat4(i.entity.transform.matrix, scale([rad, rad, rad]));\r\n\r\n          const vp = mulMat4(projectionMatrix, viewMatrix);\r\n\r\n          const mvp = mulMat4(vp, m);\r\n\r\n          const lightPos = mulMat4ByVec4(\r\n            mvp,\r\n            //i.entity.transform.matrix,\r\n            [0, 0, 0, 1]\r\n          );\r\n\r\n          const buf = makeUniformBuffer<typeof LightingRendererJSON, 1, 0>(\r\n            LightingRendererJSON,\r\n            1,\r\n            0,\r\n            {\r\n              inv_vp: inv4(vp),\r\n              mvp,\r\n              m,\r\n              light_color: i.data.color,\r\n              light_pos: lightPos,\r\n              quadratic: i.data.quadratic,\r\n              linear: i.data.linear,\r\n              constant: i.data.constant,\r\n              cutoff_radius: rad,\r\n            }\r\n          );\r\n          device.queue.writeBuffer(i.data.uniformBuffer, 0, buf);\r\n          passEncoder.setBindGroup(1, i.data.uniformBindGroup);\r\n\r\n          passEncoder.setPipeline(state.lightingPipeline);\r\n          passEncoder.setVertexBuffer(0, state.pointLightGeometry.vertices);\r\n          passEncoder.setIndexBuffer(\r\n            state.pointLightGeometry.indices,\r\n            \"uint32\"\r\n          );\r\n          passEncoder.drawIndexed(state.pointLightGeometry.drawCount);\r\n        }\r\n\r\n        passEncoder.end();\r\n\r\n        device.queue.submit([commandEncoder.finish()]);\r\n\r\n        // console.log(\"lighting\");\r\n        return Promise.resolve();\r\n      },\r\n      [LIGHTING_PASS],\r\n      [GBUFFER_SUBMIT]\r\n    );\r\n  },\r\n  dependencies: [Transform] as const,\r\n  globalDependencies: [DeferredWebgpuRenderer] as const,\r\n  brand: \"pointLightSource\",\r\n  onDestroy() {},\r\n});\r\n", "struct GBufferVertInput {\r\n  @location(0) pos: vec3f,\r\n  @location(1) normal: vec3f,\r\n  //  @location(2) uv: vec2f,\r\n}\r\n\r\nstruct GBufferFragInput {\r\n  @builtin(position) vertex_position:  vec4f, \r\n  @location(0) pos: vec4f,\r\n  @location(1) normal: vec4f,\r\n  @location(2) albedo: vec4f,\r\n}\r\n\r\nstruct GBufferFragOutput {\r\n  @location(0) pos: vec4f,\r\n  @location(1) normal: vec4f,\r\n  @location(2) albedo: vec4f,\r\n}\r\n\r\nstruct Params {\r\n  mvp: mat4x4f,\r\n  m: mat4x4f,\r\n  draw_color: vec4f\r\n}\r\n\r\n@group(0) @binding(0) var<uniform> params : Params;\r\n\r\n@vertex\r\nfn VSMain(input: GBufferVertInput) -> GBufferFragInput {\r\n  var frag: GBufferFragInput;\r\n  let clipspace = params.mvp * vec4f(input.pos, 1.0);\r\n  frag.pos = params.mvp * vec4f(input.pos, 1.0);\r\n  frag.vertex_position = clipspace;\r\n  frag.normal = params.m * vec4f(input.normal, 0.0);\r\n  frag.albedo = params.draw_color;\r\n  return frag;\r\n}\r\n\r\nconst DITHER16_THRESHOLDS = array(\r\n  0.0, 8.0, 2.0, 10.0,\r\n  12.0, 4.0, 13.0, 6.0,\r\n  3.0, 11.0, 1.0, 9.0,\r\n  14.0, 7.0, 15.0, 5.0\r\n);\r\n\r\nfn dither16(factor: f32, coord: vec2i) -> bool {\r\n  let x = coord.x % 4;\r\n  let y = coord.y % 4;\r\n  let threshold = DITHER16_THRESHOLDS[y * 4 + x] / 16.0;\r\n  return factor > threshold ;\r\n}\r\n\r\n\r\n/* \r\nfunction makeDitherKernel(iters) {\r\n\tif (iters === 0) {\r\n\t\treturn [0];\r\n\t}\r\n\r\n\tconst kernel = makeDitherKernel(iters - 1);\r\n\tconst oldLength = kernel.length;\r\n\tconst oldSideLength = Math.sqrt(oldLength);\r\n\t\r\n\tconst newLength = kernel.length * 4;\r\n\tconst newSideLength = Math.sqrt(newLength);\r\n\r\n\tlet k = new Array(newLength);\r\n\t\r\n\tfor (const [x, y, idx] of [[0, 0,0], [1, 1, 1], [1, 0, 2], [0, 1, 3]]) {\r\n\t\tlet baseIndex = y * newSideLength + x;\r\n\t\tfor (let i = 0; i < oldSideLength; i++) {\r\n\t\t\tfor (let j = 0; j < oldSideLength; j++) {\r\n\t\t\t\tk[baseIndex + i * 2 * newSideLength + j * 2] = \r\n\t\t\t\t\tkernel[i * oldSideLength + j] + idx * kernel.length\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn k;\r\n\t\r\n}\r\n\r\nconsole.log(makeDitherKernel(4));\r\n*/\r\n\r\nconst DITHER256_THRESHOLDS = array<f32, 256>(\r\n  0,\r\n  128,\r\n  32,\r\n  160,\r\n  8,\r\n  136,\r\n  40,\r\n  168,\r\n  2,\r\n  130,\r\n  34,\r\n  162,\r\n  10,\r\n  138,\r\n  42,\r\n  170,\r\n  192,\r\n  64,\r\n  224,\r\n  96,\r\n  200,\r\n  72,\r\n  232,\r\n  104,\r\n  194,\r\n  66,\r\n  226,\r\n  98,\r\n  202,\r\n  74,\r\n  234,\r\n  106,\r\n  48,\r\n  176,\r\n  16,\r\n  144,\r\n  56,\r\n  184,\r\n  24,\r\n  152,\r\n  50,\r\n  178,\r\n  18,\r\n  146,\r\n  58,\r\n  186,\r\n  26,\r\n  154,\r\n  240,\r\n  112,\r\n  208,\r\n  80,\r\n  248,\r\n  120,\r\n  216,\r\n  88,\r\n  242,\r\n  114,\r\n  210,\r\n  82,\r\n  250,\r\n  122,\r\n  218,\r\n  90,\r\n  12,\r\n  140,\r\n  44,\r\n  172,\r\n  4,\r\n  132,\r\n  36,\r\n  164,\r\n  14,\r\n  142,\r\n  46,\r\n  174,\r\n  6,\r\n  134,\r\n  38,\r\n  166,\r\n  204,\r\n  76,\r\n  236,\r\n  108,\r\n  196,\r\n  68,\r\n  228,\r\n  100,\r\n  206,\r\n  78,\r\n  238,\r\n  110,\r\n  198,\r\n  70,\r\n  230,\r\n  102,\r\n  60,\r\n  188,\r\n  28,\r\n  156,\r\n  52,\r\n  180,\r\n  20,\r\n  148,\r\n  62,\r\n  190,\r\n  30,\r\n  158,\r\n  54,\r\n  182,\r\n  22,\r\n  150,\r\n  252,\r\n  124,\r\n  220,\r\n  92,\r\n  244,\r\n  116,\r\n  212,\r\n  84,\r\n  254,\r\n  126,\r\n  222,\r\n  94,\r\n  246,\r\n  118,\r\n  214,\r\n  86,\r\n  3,\r\n  131,\r\n  35,\r\n  163,\r\n  11,\r\n  139,\r\n  43,\r\n  171,\r\n  1,\r\n  129,\r\n  33,\r\n  161,\r\n  9,\r\n  137,\r\n  41,\r\n  169,\r\n  195,\r\n  67,\r\n  227,\r\n  99,\r\n  203,\r\n  75,\r\n  235,\r\n  107,\r\n  193,\r\n  65,\r\n  225,\r\n  97,\r\n  201,\r\n  73,\r\n  233,\r\n  105,\r\n  51,\r\n  179,\r\n  19,\r\n  147,\r\n  59,\r\n  187,\r\n  27,\r\n  155,\r\n  49,\r\n  177,\r\n  17,\r\n  145,\r\n  57,\r\n  185,\r\n  25,\r\n  153,\r\n  243,\r\n  115,\r\n  211,\r\n  83,\r\n  251,\r\n  123,\r\n  219,\r\n  91,\r\n  241,\r\n  113,\r\n  209,\r\n  81,\r\n  249,\r\n  121,\r\n  217,\r\n  89,\r\n  15,\r\n  143,\r\n  47,\r\n  175,\r\n  7,\r\n  135,\r\n  39,\r\n  167,\r\n  13,\r\n  141,\r\n  45,\r\n  173,\r\n  5,\r\n  133,\r\n  37,\r\n  165,\r\n  207,\r\n  79,\r\n  239,\r\n  111,\r\n  199,\r\n  71,\r\n  231,\r\n  103,\r\n  205,\r\n  77,\r\n  237,\r\n  109,\r\n  197,\r\n  69,\r\n  229,\r\n  101,\r\n  63,\r\n  191,\r\n  31,\r\n  159,\r\n  55,\r\n  183,\r\n  23,\r\n  151,\r\n  61,\r\n  189,\r\n  29,\r\n  157,\r\n  53,\r\n  181,\r\n  21,\r\n  149,\r\n  255,\r\n  127,\r\n  223,\r\n  95,\r\n  247,\r\n  119,\r\n  215,\r\n  87,\r\n  253,\r\n  125,\r\n  221,\r\n  93,\r\n  245,\r\n  117,\r\n  213,\r\n  85\r\n);\r\n\r\nfn dither256(factor: f32, coord: vec2i) -> bool {\r\n  let x = coord.x % 16;\r\n  let y = coord.y % 16;\r\n  let threshold = DITHER256_THRESHOLDS[y * 16 + x] / 256.0;\r\n  return factor > threshold ;\r\n}\r\n\r\n@fragment\r\nfn FSMain(input: GBufferFragInput) -> GBufferFragOutput {\r\n  var o: GBufferFragOutput;\r\n\r\n  let ipos = vec2i(input.vertex_position.xy);\r\n  if (\r\n    !dither256(input.pos.z * 0.5 - 0.5, ipos)\r\n    // && (ipos.x + ipos.y) % 4 != 0\r\n  ) {\r\n    discard;\r\n  }\r\n\r\n\r\n  o.pos = input.pos;\r\n  o.normal = input.normal;\r\n  o.albedo = input.albedo;\r\n  return o;\r\n} ", "{\"bindGroups\":[[{\"name\":\"params\",\"type\":{\"name\":\"Params\",\"attributes\":null,\"size\":144,\"members\":[{\"name\":\"mvp\",\"type\":{\"name\":\"mat4x4f\",\"attributes\":null,\"size\":64},\"attributes\":null,\"offset\":0,\"size\":64},{\"name\":\"m\",\"type\":{\"name\":\"mat4x4f\",\"attributes\":null,\"size\":64},\"attributes\":null,\"offset\":64,\"size\":64},{\"name\":\"draw_color\",\"type\":{\"name\":\"vec4f\",\"attributes\":null,\"size\":16},\"attributes\":null,\"offset\":128,\"size\":16}],\"align\":16,\"startLine\":20,\"endLine\":24,\"inUse\":true},\"group\":0,\"binding\":0,\"attributes\":[{\"id\":47367,\"line\":26,\"name\":\"group\",\"value\":\"0\"},{\"id\":47368,\"line\":26,\"name\":\"binding\",\"value\":\"0\"}],\"resourceType\":0,\"access\":\"read\"}]]}", "import { makeUniformBuffer, mulMat4, Vec4 } from \"r628\";\r\nimport { GBUFFER_PASS, DeferredWebgpuRenderer } from \"./renderer\";\r\nimport { specifyComponent } from \"../ecs\";\r\nimport { Transform } from \"../transform-component\";\r\n\r\nimport GBufferRenderer from \"./gbuffer.wgsl?raw\";\r\nimport GBufferRendererJSON from \"gbuffer.wgsl\";\r\n\r\nexport const SampleWebgpuRendererGeometry = specifyComponent({\r\n  async init(subsystem) {\r\n    const { device } = await subsystem(DeferredWebgpuRenderer);\r\n\r\n    const gbufferPipeline = device.createRenderPipeline({\r\n      layout: \"auto\",\r\n      vertex: {\r\n        module: device.createShaderModule({\r\n          code: GBufferRenderer,\r\n        }),\r\n        buffers: [\r\n          {\r\n            arrayStride: 12,\r\n            attributes: [\r\n              {\r\n                shaderLocation: 0,\r\n                offset: 0,\r\n                format: \"float32x3\",\r\n              },\r\n            ],\r\n          },\r\n          {\r\n            arrayStride: 12,\r\n            attributes: [\r\n              {\r\n                shaderLocation: 1,\r\n                offset: 0,\r\n                format: \"float32x3\",\r\n              },\r\n            ],\r\n          },\r\n          // {\r\n          //   arrayStride: 12,\r\n          //   attributes: [\r\n          //     {\r\n          //       shaderLocation: 2,\r\n          //       offset: 0,\r\n          //       format: \"float32x3\",\r\n          //     },\r\n          //   ],\r\n          // },\r\n        ],\r\n      },\r\n      fragment: {\r\n        module: device.createShaderModule({\r\n          code: GBufferRenderer,\r\n        }),\r\n        targets: [\r\n          { format: \"rgba32float\" },\r\n          { format: \"rgba16float\" },\r\n          { format: \"rgba8unorm\" },\r\n        ],\r\n      },\r\n      depthStencil: {\r\n        depthWriteEnabled: true,\r\n        depthCompare: \"less\",\r\n        format: \"depth24plus\",\r\n      },\r\n      primitive: { topology: \"triangle-list\", cullMode: \"back\" },\r\n    });\r\n\r\n    return { gbufferPipeline };\r\n  },\r\n  create(\r\n    params: {\r\n      vertexBuffer: GPUBuffer;\r\n      normalBuffer: GPUBuffer;\r\n      indexBuffer: GPUBuffer;\r\n      indexFormat: \"uint16\" | \"uint32\";\r\n      size: number;\r\n      drawColor: Vec4;\r\n    },\r\n    global,\r\n    { deferredWebgpuRenderer }\r\n  ) {\r\n    const { device } = deferredWebgpuRenderer.state;\r\n\r\n    const uniformBuffer = device.createBuffer({\r\n      label: \"uniform buffer\",\r\n      size: 1024,\r\n      usage:\r\n        GPUBufferUsage.STORAGE |\r\n        GPUBufferUsage.COPY_DST |\r\n        GPUBufferUsage.COPY_SRC |\r\n        GPUBufferUsage.UNIFORM,\r\n    });\r\n\r\n    const bindGroup = device.createBindGroup({\r\n      layout: global.state.gbufferPipeline.getBindGroupLayout(0),\r\n      entries: [\r\n        {\r\n          binding: 0,\r\n          resource: uniformBuffer,\r\n        },\r\n      ],\r\n    });\r\n\r\n    return {\r\n      bindGroup,\r\n      vertexBuffer: params.vertexBuffer,\r\n      indexBuffer: params.indexBuffer,\r\n      normalBuffer: params.normalBuffer,\r\n      vertexCount: params.size,\r\n      uniformBuffer,\r\n      indexFormat: params.indexFormat,\r\n      drawColor: params.drawColor,\r\n    };\r\n  },\r\n  renderUpdate({ state, instances, subsystem, scheduleTask }) {\r\n    scheduleTask(() => {\r\n      const {\r\n        device,\r\n        viewMatrix,\r\n        projectionMatrix,\r\n        textures,\r\n        gBufferRenderPass,\r\n      } = subsystem(DeferredWebgpuRenderer).state;\r\n\r\n      const { gbufferPipeline } = state;\r\n\r\n      // const commandEncoder = device.createCommandEncoder();\r\n\r\n      const passEncoder = gBufferRenderPass;\r\n\r\n      // const passEncoder = commandEncoder.beginRenderPass({\r\n      //   colorAttachments: [\r\n      //     {\r\n      //       view: textures.gbuffer.position.createView(),\r\n      //       clearValue: [0, 0, 0, 1],\r\n      //       loadOp: \"clear\",\r\n      //       storeOp: \"store\",\r\n      //     },\r\n      //     {\r\n      //       view: textures.gbuffer.normal.createView(),\r\n      //       clearValue: [0, 0, 0, 1],\r\n      //       loadOp: \"clear\",\r\n      //       storeOp: \"store\",\r\n      //     },\r\n      //     {\r\n      //       view: textures.gbuffer.albedo.createView(),\r\n      //       clearValue: [0, 0, 0, 1],\r\n      //       loadOp: \"clear\",\r\n      //       storeOp: \"store\",\r\n      //     },\r\n      //   ],\r\n      //   depthStencilAttachment: {\r\n      //     view: textures.gbuffer.depth,\r\n      //     depthClearValue: 1.0,\r\n      //     depthLoadOp: \"clear\",\r\n      //     depthStoreOp: \"store\",\r\n      //   },\r\n      // });\r\n\r\n      for (const i of instances) {\r\n        const buf = makeUniformBuffer<typeof GBufferRendererJSON, 0, 0>(\r\n          GBufferRendererJSON,\r\n          0,\r\n          0,\r\n          {\r\n            m: i.entity.transform.matrix,\r\n            mvp: mulMat4(\r\n              projectionMatrix,\r\n              mulMat4(viewMatrix, i.entity.transform.matrix)\r\n            ),\r\n            draw_color: i.data.drawColor,\r\n          }\r\n        );\r\n\r\n        device.queue.writeBuffer(i.data.uniformBuffer, 0, buf);\r\n\r\n        passEncoder.setPipeline(gbufferPipeline);\r\n        passEncoder.setVertexBuffer(0, i.data.vertexBuffer);\r\n        passEncoder.setVertexBuffer(1, i.data.normalBuffer);\r\n        passEncoder.setIndexBuffer(i.data.indexBuffer, i.data.indexFormat);\r\n        passEncoder.setBindGroup(0, i.data.bindGroup);\r\n        passEncoder.drawIndexed(i.data.vertexCount);\r\n      }\r\n      // passEncoder.end();\r\n\r\n      // device.queue.submit([commandEncoder.finish()]);\r\n\r\n      return Promise.resolve();\r\n    }, [GBUFFER_PASS]);\r\n  },\r\n  onDestroy() {},\r\n  dependencies: [Transform] as const,\r\n  globalDependencies: [DeferredWebgpuRenderer] as const,\r\n  brand: \"sampleWebgpuRendererGeometry\" as const,\r\n});\r\n", "struct ParticlesVertInput {\r\n  @location(0) position: vec3f,\r\n  @builtin(vertex_index) vindex : u32,\r\n  //  @location(2) uv: vec2f,\r\n}\r\n\r\nstruct ParticlesFragInput {\r\n  @builtin(position) vertex_position: vec4f, \r\n  @location(0) pos: vec4f,\r\n  @location(1) normal: vec4f,\r\n  @location(2) albedo: vec4f,\r\n}\r\n\r\nstruct ParticlesFragOutput {\r\n  @location(0) pos: vec4f,\r\n  @location(1) normal: vec4f,\r\n  @location(2) albedo: vec4f,\r\n}\r\n\r\nstruct Params {\r\n  mvp: mat4x4f,\r\n  draw_color: vec4f,\r\n  scale: vec2f,\r\n}\r\n\r\n@group(0) @binding(0) var<uniform> params : Params;\r\n\r\n@vertex\r\nfn VSMain(input: ParticlesVertInput) -> ParticlesFragInput {\r\n  var frag: ParticlesFragInput;\r\n\r\n  let center = params.mvp * vec4f(input.position, 1.0);\r\n\r\n  frag.normal = params.mvp * vec4f(0.0, 1.0, 0.0, 0.0);\r\n  frag.albedo = params.draw_color;\r\n\r\n  frag.pos = vec4(array(\r\n    vec2( 1.0,  1.0),\r\n    vec2( 1.0, -1.0), \r\n    vec2(-1.0, -1.0),\r\n    vec2( 1.0,  1.0),\r\n    vec2(-1.0, -1.0),\r\n    vec2(-1.0,  1.0),\r\n  )[input.vindex] * params.scale, 1.0, 1.0) + center;\r\n\r\n  frag.vertex_position = frag.pos;\r\n\r\n  /*\r\n  frag.uv = array(\r\n    vec2(1.0, 0.0),\r\n    vec2(1.0, 1.0),\r\n    vec2(0.0, 1.0),\r\n    vec2(1.0, 0.0),\r\n    vec2(0.0, 1.0),\r\n    vec2(0.0, 0.0),\r\n  )[input.vindex]; */\r\n\r\n  return frag;\r\n}\r\n\r\n@fragment\r\nfn FSMain(input: ParticlesFragInput) -> ParticlesFragOutput {\r\n  var o: ParticlesFragOutput;\r\n\r\n  let ipos = vec2i(input.vertex_position.xy);\r\n\r\n  // if (\r\n  //   input.pos.z < 10.0\r\n  //   && (ipos.x + ipos.y) % 4 != 0\r\n  // ) {\r\n  //   discard;\r\n  // }\r\n\r\n  o.pos = input.pos;\r\n  o.normal = input.normal;\r\n  o.albedo = input.albedo;\r\n  return o;\r\n} ", "{\"bindGroups\":[[{\"name\":\"params\",\"type\":{\"name\":\"Params\",\"attributes\":null,\"size\":96,\"members\":[{\"name\":\"mvp\",\"type\":{\"name\":\"mat4x4f\",\"attributes\":null,\"size\":64},\"attributes\":null,\"offset\":0,\"size\":64},{\"name\":\"draw_color\",\"type\":{\"name\":\"vec4f\",\"attributes\":null,\"size\":16},\"attributes\":null,\"offset\":64,\"size\":16},{\"name\":\"scale\",\"type\":{\"name\":\"vec2f\",\"attributes\":null,\"size\":8},\"attributes\":null,\"offset\":80,\"size\":8}],\"align\":16,\"startLine\":20,\"endLine\":24,\"inUse\":true},\"group\":0,\"binding\":0,\"attributes\":[{\"id\":47209,\"line\":26,\"name\":\"group\",\"value\":\"0\"},{\"id\":47210,\"line\":26,\"name\":\"binding\",\"value\":\"0\"}],\"resourceType\":0,\"access\":\"read\"}]]}", "@group(0) @binding(0)\r\nvar<storage, read_write> buf_position: array<vec3f>;\r\n\r\n@group(0) @binding(1)\r\nvar<storage, read_write> buf_velocity: array<vec3f>;\r\n\r\n@group(0) @binding(2)\r\nvar tex_force: texture_storage_3d<rgba8snorm, read>;\r\n\r\n@compute @workgroup_size(64)\r\nfn ComputeMain(\r\n  @builtin(global_invocation_id) id3: vec3u\r\n) {\r\n  let i = id3.x;\r\n\r\n  let gridOffset = vec3i(16, 16 , 16);\r\n\r\n  let force_pos = (vec3i(floor(buf_position[i])) + gridOffset + vec3i(320, 320, 320)) % vec3i(32);\r\n\r\n  var vel = buf_velocity[i];\r\n\r\n  vel += textureLoad(tex_force, force_pos).xyz * 0.01;\r\n  vel *= 0.99;\r\n  buf_position[i] += vel;\r\n  buf_velocity[i] = vel;\r\n}", "import { makeUniformBuffer, mulMat4, Vec4 } from \"r628\";\r\nimport { specifyComponent } from \"../ecs\";\r\nimport { Transform } from \"../transform-component\";\r\nimport { GBUFFER_PASS, DeferredWebgpuRenderer } from \"./renderer\";\r\nimport ParticlesShader from \"./particles.wgsl?raw\";\r\nimport ParticlesShaderJSON from \"particles.wgsl\";\r\n\r\nimport ParticlesForcefield from \"./particle-forcefield.wgsl?raw\";\r\n\r\nexport const ParticleForcefield = specifyComponent({\r\n  async init(subsystem) {\r\n    const { device } = await subsystem(DeferredWebgpuRenderer);\r\n\r\n    const particlesForcefieldPipeline = device.createComputePipeline({\r\n      layout: \"auto\",\r\n      compute: {\r\n        module: device.createShaderModule({\r\n          code: ParticlesForcefield,\r\n        }),\r\n      },\r\n    });\r\n\r\n    return {\r\n      particlesForcefieldPipeline,\r\n    };\r\n  },\r\n  create(\r\n    params: {\r\n      positionBuffer: GPUBuffer;\r\n      velocityBuffer: GPUBuffer;\r\n      forceFieldTexture: GPUTexture;\r\n      count: number;\r\n    },\r\n    global,\r\n    { deferredWebgpuRenderer }\r\n  ) {\r\n    const { device } = deferredWebgpuRenderer.state;\r\n\r\n    const bindGroup = device.createBindGroup({\r\n      layout: global.state.particlesForcefieldPipeline.getBindGroupLayout(0),\r\n      entries: [\r\n        {\r\n          resource: params.positionBuffer,\r\n          binding: 0,\r\n        },\r\n        {\r\n          resource: params.velocityBuffer,\r\n          binding: 1,\r\n        },\r\n        {\r\n          resource: params.forceFieldTexture,\r\n          binding: 2,\r\n        },\r\n      ],\r\n    });\r\n\r\n    return {\r\n      bindGroup,\r\n      positionBuffer: params.positionBuffer,\r\n      particleCount: params.count,\r\n      velocityBuffer: params.velocityBuffer,\r\n      forceFieldTexture: params.forceFieldTexture,\r\n    };\r\n  },\r\n  renderUpdate({ state, instances, subsystem, scheduleTask }) {\r\n    scheduleTask(() => {\r\n      const {\r\n        device,\r\n        viewMatrix,\r\n        projectionMatrix,\r\n        textures,\r\n        gBufferRenderPass,\r\n      } = subsystem(DeferredWebgpuRenderer).state;\r\n\r\n      const commandEncoder = device.createCommandEncoder();\r\n      const compute = commandEncoder.beginComputePass();\r\n\r\n      compute.setPipeline(state.particlesForcefieldPipeline);\r\n\r\n      for (const i of instances) {\r\n        compute.setBindGroup(0, i.data.bindGroup);\r\n        compute.dispatchWorkgroups(Math.floor(i.data.particleCount / 64));\r\n      }\r\n      compute.end();\r\n\r\n      device.queue.submit([commandEncoder.finish()]);\r\n      return Promise.resolve();\r\n    }, [GBUFFER_PASS]);\r\n  },\r\n  dependencies: [Transform] as const,\r\n  globalDependencies: [DeferredWebgpuRenderer] as const,\r\n  onDestroy() {},\r\n  brand: \"particleForcefield\" as const,\r\n});\r\n\r\nexport const ParticleSystem = specifyComponent({\r\n  async init(subsystem) {\r\n    const { device } = await subsystem(DeferredWebgpuRenderer);\r\n\r\n    const module = device.createShaderModule({\r\n      code: ParticlesShader,\r\n    });\r\n\r\n    const blend: GPUBlendState = {\r\n      color: {\r\n        srcFactor: \"one\",\r\n        dstFactor: \"one-minus-src-alpha\",\r\n      },\r\n      alpha: {\r\n        srcFactor: \"one\",\r\n        dstFactor: \"one-minus-src-alpha\",\r\n      },\r\n    };\r\n\r\n    const particlesPipeline = device.createRenderPipeline({\r\n      layout: \"auto\",\r\n      vertex: {\r\n        module,\r\n        buffers: [\r\n          {\r\n            arrayStride: 16,\r\n            stepMode: \"instance\",\r\n            attributes: [\r\n              {\r\n                shaderLocation: 0,\r\n                offset: 0,\r\n                format: \"float32x3\",\r\n              },\r\n            ],\r\n          },\r\n        ],\r\n      },\r\n      fragment: {\r\n        module,\r\n        targets: [\r\n          { format: \"rgba32float\" },\r\n          { format: \"rgba16float\" },\r\n          { format: \"rgba8unorm\" },\r\n        ],\r\n      },\r\n      depthStencil: {\r\n        depthWriteEnabled: true,\r\n        depthCompare: \"less\",\r\n        format: \"depth24plus\",\r\n      },\r\n      primitive: { topology: \"triangle-list\" },\r\n    });\r\n\r\n    const particlesForcefieldPipeline = device.createComputePipeline({\r\n      layout: \"auto\",\r\n      compute: {\r\n        module: device.createShaderModule({\r\n          code: ParticlesForcefield,\r\n        }),\r\n      },\r\n    });\r\n\r\n    return {\r\n      particlesPipeline,\r\n      particlesForcefieldPipeline,\r\n    };\r\n  },\r\n  create(\r\n    params: { positionBuffer: GPUBuffer; count: number; drawColor: Vec4 },\r\n    global,\r\n    { deferredWebgpuRenderer }\r\n  ) {\r\n    const { device } = deferredWebgpuRenderer.state;\r\n\r\n    const uniformBuffer = device.createBuffer({\r\n      label: \"uniform buffer\",\r\n      size: 1024,\r\n      usage:\r\n        GPUBufferUsage.STORAGE |\r\n        GPUBufferUsage.COPY_DST |\r\n        GPUBufferUsage.COPY_SRC |\r\n        GPUBufferUsage.UNIFORM,\r\n    });\r\n\r\n    const bindGroup = device.createBindGroup({\r\n      layout: global.state.particlesPipeline.getBindGroupLayout(0),\r\n      entries: [\r\n        {\r\n          binding: 0,\r\n          resource: uniformBuffer,\r\n        },\r\n      ],\r\n    });\r\n\r\n    return {\r\n      bindGroup,\r\n      positionBuffer: params.positionBuffer,\r\n      particleCount: params.count,\r\n      uniformBuffer,\r\n      drawColor: params.drawColor,\r\n    };\r\n  },\r\n  renderUpdate({ state, instances, subsystem, scheduleTask }) {\r\n    scheduleTask(() => {\r\n      const {\r\n        device,\r\n        viewMatrix,\r\n        projectionMatrix,\r\n        textures,\r\n        gBufferRenderPass,\r\n        aspect,\r\n      } = subsystem(DeferredWebgpuRenderer).state;\r\n\r\n      const { particlesPipeline } = state;\r\n\r\n      const passEncoder = gBufferRenderPass;\r\n\r\n      for (const i of instances) {\r\n        const buf = makeUniformBuffer<typeof ParticlesShaderJSON, 0, 0>(\r\n          ParticlesShaderJSON,\r\n          0,\r\n          0,\r\n          {\r\n            scale: [0.03 / aspect, 0.03],\r\n            mvp: mulMat4(\r\n              projectionMatrix,\r\n              mulMat4(viewMatrix, i.entity.transform.matrix)\r\n            ),\r\n            draw_color: i.data.drawColor,\r\n          }\r\n        );\r\n\r\n        device.queue.writeBuffer(i.data.uniformBuffer, 0, buf);\r\n\r\n        passEncoder.setPipeline(particlesPipeline);\r\n        passEncoder.setVertexBuffer(0, i.data.positionBuffer);\r\n        passEncoder.setBindGroup(0, i.data.bindGroup);\r\n        passEncoder.draw(6, i.data.particleCount);\r\n      }\r\n      // passEncoder.end();\r\n\r\n      // device.queue.submit([commandEncoder.finish()]);\r\n      return Promise.resolve();\r\n    }, [GBUFFER_PASS]);\r\n  },\r\n  dependencies: [Transform] as const,\r\n  globalDependencies: [DeferredWebgpuRenderer] as const,\r\n  onDestroy() {},\r\n  brand: \"particleSystem\" as const,\r\n});\r\n", "import { Vec2 } from \"r628\";\r\nimport { specifyComponent } from \"../ecs\";\r\nimport { DeferredWebgpuRenderer, LIGHTING_PASS } from \"./renderer\";\r\n\r\nexport type PostprocessState = {\r\n  device: GPUDevice;\r\n  canvas: HTMLCanvasElement;\r\n  ctx: GPUCanvasContext;\r\n};\r\n\r\nexport const PostprocessingPipeline = <Global, ResolutionDependent>(\r\n  initGlobal: (state: PostprocessState) => Global | Promise<Global>,\r\n  initResolutionDependent: (\r\n    state: PostprocessState,\r\n    res: Vec2,\r\n    global: Awaited<Global>\r\n  ) => ResolutionDependent | Promise<ResolutionDependent>,\r\n  runFrame: (\r\n    state: PostprocessState & {\r\n      position: GPUTexture;\r\n      normal: GPUTexture;\r\n      albedo: GPUTexture;\r\n      lighting: GPUTexture;\r\n    },\r\n    res: Vec2,\r\n    global: Awaited<Global>,\r\n    resDependent: Awaited<ResolutionDependent>\r\n  ) => void | Promise<void>\r\n) =>\r\n  specifyComponent<\r\n    undefined,\r\n    Promise<undefined>,\r\n    {\r\n      global: Awaited<Global>;\r\n      resolutionDependent: Awaited<ResolutionDependent>;\r\n    },\r\n    \"postprocessingPipeline\",\r\n    [],\r\n    [typeof DeferredWebgpuRenderer]\r\n  >({\r\n    async create(params, global, dependencies, waitFor): Promise<undefined> {\r\n      return undefined;\r\n    },\r\n    onDestroy() {},\r\n    async init(waitFor): Promise<{\r\n      global: Awaited<Global>;\r\n      resolutionDependent: Awaited<ResolutionDependent>;\r\n    }> {\r\n      const { device, canvas, onResize, ctx } = await waitFor(\r\n        DeferredWebgpuRenderer\r\n      );\r\n\r\n      const post = {\r\n        global: (await initGlobal({ device, canvas, ctx })) as Awaited<Global>,\r\n        resolutionDependent: undefined as\r\n          | Awaited<ResolutionDependent>\r\n          | undefined,\r\n      };\r\n\r\n      onResize(async () => {\r\n        post.resolutionDependent = await initResolutionDependent(\r\n          { device, canvas, ctx },\r\n          [canvas.width, canvas.height],\r\n          post.global\r\n        );\r\n      });\r\n\r\n      return post;\r\n    },\r\n    globalDependencies: [DeferredWebgpuRenderer],\r\n    dependencies: [],\r\n    brand: \"postprocessingPipeline\",\r\n    async renderUpdate({ state, scheduleTask, subsystem }) {\r\n      scheduleTask(\r\n        async () => {\r\n          const { device, canvas, ctx, textures } = subsystem(\r\n            DeferredWebgpuRenderer\r\n          ).state;\r\n          await runFrame(\r\n            {\r\n              device,\r\n              canvas,\r\n              ctx,\r\n\r\n              position: textures.gbuffer.position,\r\n              normal: textures.gbuffer.normal,\r\n              albedo: textures.gbuffer.albedo,\r\n              lighting: textures.lighting.color,\r\n            },\r\n            [canvas.width, canvas.height],\r\n            state.global,\r\n            state.resolutionDependent\r\n          );\r\n        },\r\n        [],\r\n        [LIGHTING_PASS]\r\n      );\r\n    },\r\n  });\r\n", "export function delimitedSequenceRegex(start: string, end: string) {\r\n  return new RegExp(\r\n    RegExp.escape(start) + \"[\\\\s\\\\S]*?\" + RegExp.escape(end),\r\n    \"g\"\r\n  );\r\n}\r\n\r\nexport function makeDelimitedReplacements(\r\n  str: string,\r\n  replacements: (\r\n    | {\r\n        start: string;\r\n        end: string;\r\n        replaceWith: string;\r\n        delimiter?: undefined;\r\n      }\r\n    | {\r\n        delimiter: string;\r\n        replaceWith: string;\r\n        start?: undefined;\r\n        end?: undefined;\r\n      }\r\n  )[]\r\n) {\r\n  for (const r of replacements) {\r\n    str = str.replaceAll(\r\n      typeof r.delimiter === \"string\"\r\n        ? delimitedSequenceRegex(r.delimiter, r.delimiter)\r\n        : // @ts-expect-error\r\n          delimitedSequenceRegex(r.start, r.end),\r\n      r.replaceWith\r\n    );\r\n  }\r\n  return str;\r\n}\r\n", "import { Attribute } from \"../wgsl_ast.js\";\r\n\r\nexport class TypeInfo {\r\n  name: string;\r\n  attributes: Attribute[] | null;\r\n  size: number;\r\n\r\n  constructor(name: string, attributes: Attribute[] | null) {\r\n    this.name = name;\r\n    this.attributes = attributes;\r\n    this.size = 0;\r\n  }\r\n\r\n  get isArray(): boolean {\r\n    return false;\r\n  }\r\n\r\n  get isStruct(): boolean {\r\n    return false;\r\n  }\r\n\r\n  get isTemplate(): boolean {\r\n    return false;\r\n  }\r\n\r\n  get isPointer(): boolean {\r\n    return false;\r\n  }\r\n\r\n  getTypeName(): string {\r\n    return this.name;\r\n  }\r\n}\r\n\r\nexport class MemberInfo {\r\n  name: string;\r\n  type: TypeInfo;\r\n  attributes: Attribute[] | null;\r\n  offset: number;\r\n  size: number;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: TypeInfo,\r\n    attributes: Attribute[] | null\r\n  ) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.attributes = attributes;\r\n    this.offset = 0;\r\n    this.size = 0;\r\n  }\r\n\r\n  get isArray(): boolean {\r\n    return this.type.isArray;\r\n  }\r\n\r\n  get isStruct(): boolean {\r\n    return this.type.isStruct;\r\n  }\r\n\r\n  get isTemplate(): boolean {\r\n    return this.type.isTemplate;\r\n  }\r\n\r\n  get align(): number {\r\n    return this.type.isStruct ? (this.type as StructInfo).align : 0;\r\n  }\r\n\r\n  get members(): MemberInfo[] | null {\r\n    return this.type.isStruct ? (this.type as StructInfo).members : null;\r\n  }\r\n\r\n  get format(): TypeInfo | null {\r\n    return this.type.isArray\r\n      ? (this.type as ArrayInfo).format\r\n      : this.type.isTemplate\r\n      ? (this.type as TemplateInfo).format\r\n      : null;\r\n  }\r\n\r\n  get count(): number {\r\n    return this.type.isArray ? (this.type as ArrayInfo).count : 0;\r\n  }\r\n\r\n  get stride(): number {\r\n    return this.type.isArray ? (this.type as ArrayInfo).stride : this.size;\r\n  }\r\n}\r\n\r\nexport class StructInfo extends TypeInfo {\r\n  members: MemberInfo[] = [];\r\n  align: number = 0;\r\n  startLine: number = -1;\r\n  endLine: number = -1;\r\n  inUse: boolean = false;\r\n\r\n  constructor(name: string, attributes: Attribute[] | null) {\r\n    super(name, attributes);\r\n  }\r\n\r\n  get isStruct(): boolean {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport class ArrayInfo extends TypeInfo {\r\n  format: TypeInfo;\r\n  count: number;\r\n  stride: number;\r\n\r\n  constructor(name: string, attributes: Attribute[] | null) {\r\n    super(name, attributes);\r\n    this.count = 0;\r\n    this.stride = 0;\r\n  }\r\n\r\n  get isArray(): boolean {\r\n    return true;\r\n  }\r\n\r\n  getTypeName(): string {\r\n    return `array<${this.format.getTypeName()}, ${this.count}>`;\r\n  }\r\n}\r\n\r\nexport class PointerInfo extends TypeInfo {\r\n  format: TypeInfo;\r\n  constructor(name: string, format: TypeInfo, attributes: Attribute[] | null) {\r\n    super(name, attributes);\r\n    this.format = format;\r\n  }\r\n\r\n  get isPointer(): boolean {\r\n    return true;\r\n  }\r\n\r\n  getTypeName(): string {\r\n    return `&${this.format.getTypeName()}`;\r\n  }\r\n}\r\n\r\nexport class TemplateInfo extends TypeInfo {\r\n  format: TypeInfo | null;\r\n  access: string;\r\n  constructor(\r\n    name: string,\r\n    format: TypeInfo | null,\r\n    attributes: Attribute[] | null,\r\n    access: string\r\n  ) {\r\n    super(name, attributes);\r\n    this.format = format;\r\n    this.access = access;\r\n  }\r\n\r\n  get isTemplate(): boolean {\r\n    return true;\r\n  }\r\n\r\n  getTypeName(): string {\r\n    let name = this.name;\r\n    if (this.format !== null) {\r\n      if (name === \"vec2\" || name === \"vec3\" || name === \"vec4\" ||\r\n          name === \"mat2x2\" || name === \"mat2x3\" || name === \"mat2x4\" ||\r\n          name === \"mat3x2\" || name === \"mat3x3\" || name === \"mat3x4\" ||\r\n          name === \"mat4x2\" || name === \"mat4x3\" || name === \"mat4x4\") {\r\n        if (this.format.name === \"f32\") {\r\n          name += \"f\";\r\n          return name;\r\n        } else if (this.format.name === \"i32\") {\r\n          name += \"i\";\r\n          return name;\r\n        } else if (this.format.name === \"u32\") {\r\n          name += \"u\";\r\n          return name;\r\n        } else if (this.format.name === \"bool\") {\r\n          name += \"b\";\r\n          return name;\r\n        } else if (this.format.name === \"f16\") {\r\n          name += \"h\";\r\n          return name;\r\n        }\r\n      }\r\n      name += `<${this.format.name}>`;\r\n    } else {\r\n      if (name === \"vec2\" || name === \"vec3\" || name === \"vec4\") {\r\n        return name;\r\n      }\r\n      //console.error(\"Template format is null.\");\r\n    }\r\n    return name;\r\n  }\r\n}\r\n\r\nexport enum ResourceType {\r\n  Uniform,\r\n  Storage,\r\n  Texture,\r\n  Sampler,\r\n  StorageTexture,\r\n}\r\n\r\nexport class VariableInfo {\r\n  attributes: Attribute[] | null;\r\n  name: string;\r\n  type: TypeInfo;\r\n  group: number;\r\n  binding: number;\r\n  resourceType: ResourceType;\r\n  access: string;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: TypeInfo,\r\n    group: number,\r\n    binding: number,\r\n    attributes: Attribute[] | null,\r\n    resourceType: ResourceType,\r\n    access: string\r\n  ) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.group = group;\r\n    this.binding = binding;\r\n    this.attributes = attributes;\r\n    this.resourceType = resourceType;\r\n    this.access = access;\r\n  }\r\n\r\n  get isArray(): boolean {\r\n    return this.type.isArray;\r\n  }\r\n\r\n  get isStruct(): boolean {\r\n    return this.type.isStruct;\r\n  }\r\n\r\n  get isTemplate(): boolean {\r\n    return this.type.isTemplate;\r\n  }\r\n\r\n  get size(): number {\r\n    return this.type.size;\r\n  }\r\n\r\n  get align(): number {\r\n    return this.type.isStruct ? (this.type as StructInfo).align : 0;\r\n  }\r\n\r\n  get members(): MemberInfo[] | null {\r\n    return this.type.isStruct ? (this.type as StructInfo).members : null;\r\n  }\r\n\r\n  get format(): TypeInfo | null {\r\n    return this.type.isArray\r\n      ? (this.type as ArrayInfo).format\r\n      : this.type.isTemplate\r\n      ? (this.type as TemplateInfo).format\r\n      : null;\r\n  }\r\n\r\n  get count(): number {\r\n    return this.type.isArray ? (this.type as ArrayInfo).count : 0;\r\n  }\r\n\r\n  get stride(): number {\r\n    return this.type.isArray ? (this.type as ArrayInfo).stride : this.size;\r\n  }\r\n}\r\n\r\nexport class AliasInfo {\r\n  name: string;\r\n  type: TypeInfo;\r\n\r\n  constructor(name: string, type: TypeInfo) {\r\n    this.name = name;\r\n    this.type = type;\r\n  }\r\n}\r\n\r\nexport class InputInfo {\r\n  name: string;\r\n  type: TypeInfo | null;\r\n  locationType: string;\r\n  location: number | string;\r\n  interpolation: string | null;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: TypeInfo | null,\r\n    locationType: string,\r\n    location: number | string\r\n  ) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.locationType = locationType;\r\n    this.location = location;\r\n    this.interpolation = null;\r\n  }\r\n}\r\n\r\nexport class OutputInfo {\r\n  name: string;\r\n  type: TypeInfo | null;\r\n  locationType: string;\r\n  location: number | string;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: TypeInfo | null,\r\n    locationType: string,\r\n    location: number | string\r\n  ) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.locationType = locationType;\r\n    this.location = location;\r\n  }\r\n}\r\n\r\nexport class OverrideInfo {\r\n  name: string;\r\n  type: TypeInfo | null;\r\n  attributes: Attribute[] | null;\r\n  id: number;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: TypeInfo | null,\r\n    attributes: Attribute[] | null,\r\n    id: number\r\n  ) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.attributes = attributes;\r\n    this.id = id;\r\n  }\r\n}\r\n\r\nexport class ArgumentInfo {\r\n  name: string;\r\n  type: TypeInfo;\r\n  attributes: Attribute[] | null;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: TypeInfo,\r\n    attributes: Attribute[] | null\r\n  ) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.attributes = attributes;\r\n  }\r\n}\r\n\r\nexport class FunctionInfo {\r\n  name: string;\r\n  stage: string | null = null;\r\n  inputs: InputInfo[] = [];\r\n  outputs: OutputInfo[] = [];\r\n  arguments: ArgumentInfo[] = [];\r\n  returnType: TypeInfo | null = null;\r\n  resources: VariableInfo[] = [];\r\n  overrides: OverrideInfo[] = [];\r\n  attributes: Attribute[] | null;\r\n  startLine: number = -1;\r\n  endLine: number = -1;\r\n  inUse: boolean = false;\r\n  calls: Set<FunctionInfo> = new Set();\r\n\r\n  constructor(name: string, stage: string | null = null, attributes: Attribute[] | null) {\r\n    this.name = name;\r\n    this.stage = stage;\r\n    this.attributes = attributes;\r\n  }\r\n}\r\n\r\nexport class EntryFunctions {\r\n  vertex: FunctionInfo[] = [];\r\n  fragment: FunctionInfo[] = [];\r\n  compute: FunctionInfo[] = [];\r\n}\r\n", "// From https://stackoverflow.com/questions/5678432/decompressing-half-precision-floats-in-javascript\r\nexport function float16ToFloat32(float16: number): number {\r\n    var s = (float16 & 0x8000) >> 15;\r\n    var e = (float16 & 0x7C00) >> 10;\r\n    var f = float16 & 0x03FF;\r\n\r\n    if (e == 0) {\r\n      return (s ? -1:1) * Math.pow(2, -14) * (f / Math.pow(2, 10));\r\n    } else if (e == 0x1F) {\r\n      return f ? NaN : ((s ? -1 : 1) * Infinity);\r\n    }\r\n\r\n    return (s ? -1 : 1) * Math.pow(2, e - 15) * (1 + (f / Math.pow(2, 10)));\r\n}\r\n\r\nconst float32View = new Float32Array(1);\r\nconst int32View = new Int32Array(float32View.buffer);\r\nconst float16View = new Uint16Array(1);\r\n\r\nexport function float32ToFloat16(float32: number): number {\r\n  float32View[0] = float32;\r\n\r\n  const f32 = int32View[0];\r\n  const sign = (f32 >> 31) & 1;\r\n  let exponent = (f32 >> 23) & 0xff;\r\n  let fraction = f32 & 0x7fffff;\r\n\r\n  if (exponent === 0xff) { // Infinity or NaN\r\n    float16View[0] = (sign << 15) | 0x7c00 | (fraction !== 0 ? 0x0200 : 0);\r\n    return float16View[0];\r\n  }\r\n\r\n  if (exponent === 0) { // Zero or subnormal\r\n    if (fraction === 0) { // Zero\r\n      float16View[0] = sign << 15;\r\n      return float16View[0];\r\n    }\r\n    // Subnormal\r\n    fraction |= 0x800000;\r\n    let shift = 113;\r\n    while ((fraction & 0x800000) === 0) {\r\n      fraction <<= 1;\r\n      shift--;\r\n    }\r\n    exponent = 127 - shift;\r\n    fraction &= 0x7fffff;\r\n    if (exponent > 0) {\r\n      fraction = (fraction >> (126 - exponent)) + ((fraction >> (127 - exponent)) & 1);\r\n      float16View[0] = (sign << 15) | (exponent << 10) | (fraction >> 13);\r\n      return float16View[0];\r\n    } else {\r\n      float16View[0] = sign << 15;\r\n      return float16View[0];\r\n    }\r\n  }\r\n\r\n  // Normalized\r\n  exponent = exponent - 127 + 15;\r\n  if (exponent >= 31) { // Overflow\r\n    float16View[0] = (sign << 15) | 0x7c00;\r\n    return float16View[0];\r\n  }\r\n  if (exponent <= 0) { // Underflow\r\n    if (exponent < -10) {\r\n      float16View[0] = sign << 15;\r\n      return float16View[0];\r\n    }\r\n    fraction = (fraction | 0x800000) >> (1 - exponent);\r\n    float16View[0] = (sign << 15) | (fraction >> 13);\r\n    return float16View[0];\r\n  }\r\n\r\n  fraction = fraction >> 13;\r\n  float16View[0] = (sign << 15) | (exponent << 10) | fraction;\r\n  return float16View[0];\r\n}\r\n\r\nconst uint32 = new Uint32Array(1);\r\nconst uint32ToFloat32 = new Float32Array(uint32.buffer, 0, 1);\r\n\r\nexport function float11ToFloat32(f11: number): number {\r\n  const u32 = (((((f11) >> 6) & 0x1F) + (127 - 15)) << 23) | (((f11) & 0x3F) << 17);\r\n  uint32[0] = u32;\r\n  return uint32ToFloat32[0];\r\n}\r\n\r\nexport function float10ToFloat32(f10: number): number {\r\n  const u32 = (((((f10) >> 5) & 0x1F) + (127 - 15)) << 23) | (((f10) & 0x1F) << 18);\r\n  uint32[0] = u32;\r\n  return uint32ToFloat32[0];\r\n}\r\n", "import { float16ToFloat32, float32ToFloat16, float10ToFloat32, float11ToFloat32 } from \"./float.js\";\r\n\r\nexport function setTexturePixel(imageData: Uint8Array, x: number, y: number, z: number, mipLevel: number,\r\n        height: number, bytesPerRow: number, texelByteSize: number, format: string, value: number[]): void {\r\n    bytesPerRow = bytesPerRow >> mipLevel;\r\n    height = height >> mipLevel;\r\n\r\n    const offset = (z * bytesPerRow * height) + y * bytesPerRow + x * texelByteSize;\r\n\r\n    switch (format) {\r\n        case \"r8unorm\": {\r\n            setPixelValue(imageData, offset, \"8unorm\", 1, value);\r\n            return;\r\n        }\r\n        case \"r8snorm\": {\r\n            setPixelValue(imageData, offset, \"8snorm\", 1, value);\r\n            return;\r\n        }\r\n        case \"r8uint\": {\r\n            setPixelValue(imageData, offset, \"8uint\", 1, value);\r\n            return;\r\n        }\r\n        case \"r8sint\": {\r\n            setPixelValue(imageData, offset, \"8sint\", 1, value);\r\n            return;\r\n        }\r\n\r\n        case \"rg8unorm\": {\r\n            setPixelValue(imageData, offset, \"8unorm\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg8snorm\": {\r\n            setPixelValue(imageData, offset, \"8snorm\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg8uint\": {\r\n            setPixelValue(imageData, offset, \"8uint\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg8sint\": {\r\n            setPixelValue(imageData, offset, \"8sint\", 2, value);\r\n            return;\r\n        }\r\n\r\n        case \"rgba8unorm-srgb\":\r\n        case \"rgba8unorm\": {\r\n            setPixelValue(imageData, offset, \"8unorm\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba8snorm\": {\r\n            setPixelValue(imageData, offset, \"8snorm\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba8uint\": {\r\n            setPixelValue(imageData, offset, \"8uint\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba8sint\": {\r\n            setPixelValue(imageData, offset, \"8sint\", 4, value);\r\n            return;\r\n        }\r\n\r\n        case \"bgra8unorm-srgb\":\r\n        case \"bgra8unorm\": {\r\n            setPixelValue(imageData, offset, \"8unorm\", 4, value);\r\n            return;\r\n        }\r\n\r\n        case \"r16uint\": {\r\n            setPixelValue(imageData, offset, \"16uint\", 1, value);\r\n            return;\r\n        }\r\n        case \"r16sint\": {\r\n            setPixelValue(imageData, offset, \"16sint\", 1, value);\r\n            return;\r\n        }\r\n        case \"r16float\": {\r\n            setPixelValue(imageData, offset, \"16float\", 1, value);\r\n            return;\r\n        }\r\n\r\n        case \"rg16uint\": {\r\n            setPixelValue(imageData, offset, \"16uint\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg16sint\": {\r\n            setPixelValue(imageData, offset, \"16sint\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg16float\": {\r\n            setPixelValue(imageData, offset, \"16float\", 2, value);\r\n            return;\r\n        }\r\n\r\n        case \"rgba16uint\": {\r\n            setPixelValue(imageData, offset, \"16uint\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba16sint\": {\r\n            setPixelValue(imageData, offset, \"16sint\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba16float\": {\r\n            setPixelValue(imageData, offset, \"16float\", 4, value);\r\n            return;\r\n        }\r\n\r\n        case \"r32uint\": {\r\n            setPixelValue(imageData, offset, \"32uint\", 1, value);\r\n            return;\r\n        }\r\n        case \"r32sint\": {\r\n            setPixelValue(imageData, offset, \"32sint\", 1, value);\r\n            return;\r\n        }\r\n        case \"depth16unorm\": // depth formats get conerted to r32float\r\n        case \"depth24plus\":\r\n        case \"depth24plus-stencil8\":\r\n        case \"depth32float\":\r\n        case \"depth32float-stencil8\":\r\n        case \"r32float\": {\r\n            setPixelValue(imageData, offset, \"32float\", 1, value);\r\n            return;\r\n        }\r\n        case \"rg32uint\": {\r\n            setPixelValue(imageData, offset, \"32uint\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg32sint\": {\r\n            setPixelValue(imageData, offset, \"32sint\", 2, value);\r\n            return;\r\n        }\r\n        case \"rg32float\": {\r\n            setPixelValue(imageData, offset, \"32float\", 2, value);\r\n            return;\r\n        }\r\n        case \"rgba32uint\": {\r\n            setPixelValue(imageData, offset, \"32uint\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba32sint\": {\r\n            setPixelValue(imageData, offset, \"32sint\", 4, value);\r\n            return;\r\n        }\r\n        case \"rgba32float\": {\r\n            setPixelValue(imageData, offset, \"32float\", 4, value);\r\n            return;\r\n        }\r\n\r\n        case \"rg11b10ufloat\": {\r\n            console.error(\"TODO: rg11b10ufloat not supported for writing\");\r\n            /*const uintValue = new Uint32Array(imageData.buffer, offset, 1)[0];\r\n            const ri = uintValue & 0x7FF;\r\n            const gi = (uintValue & 0x3FF800) >> 11;\r\n            const bi = (uintValue & 0xFFC00000) >> 22;\r\n            const rf = float11ToFloat32(ri);\r\n            const gf = float11ToFloat32(gi);\r\n            const bf = float10ToFloat32(bi);\r\n            return [rf, gf, bf, 1.0];*/\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\nexport function getTexturePixel(imageData: Uint8Array, x: number, y: number, z: number, mipLevel: number,\r\n        height: number, bytesPerRow: number, texelByteSize: number, format: string): number[] | null {\r\n    bytesPerRow = bytesPerRow >> mipLevel;\r\n    height = height >> mipLevel;\r\n\r\n    const offset = (z * bytesPerRow * height) + y * bytesPerRow + x * texelByteSize;\r\n\r\n    switch (format) {\r\n        case \"r8unorm\": {\r\n            const value = pixelValue(imageData, offset, \"8unorm\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"r8snorm\": {\r\n            const value = pixelValue(imageData, offset, \"8snorm\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"r8uint\": {\r\n            const value = pixelValue(imageData, offset, \"8uint\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"r8sint\": {\r\n            const value = pixelValue(imageData, offset, \"8sint\", 1);\r\n            return [value[0]];\r\n        }\r\n\r\n        case \"rg8unorm\": {\r\n            const value = pixelValue(imageData, offset, \"8unorm\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg8snorm\": {\r\n            const value = pixelValue(imageData, offset, \"8snorm\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg8uint\": {\r\n            const value = pixelValue(imageData, offset, \"8uint\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg8sint\": {\r\n            const value = pixelValue(imageData, offset, \"8sint\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n\r\n        case \"rgba8unorm-srgb\":\r\n        case \"rgba8unorm\": {\r\n            const value = pixelValue(imageData, offset, \"8unorm\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba8snorm\": {\r\n            const value = pixelValue(imageData, offset, \"8snorm\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba8uint\": {\r\n            const value = pixelValue(imageData, offset, \"8uint\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba8sint\": {\r\n            const value = pixelValue(imageData, offset, \"8sint\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n\r\n        case \"bgra8unorm-srgb\":\r\n        case \"bgra8unorm\": {\r\n            const value = pixelValue(imageData, offset, \"8unorm\", 4);\r\n            return [value[2], value[1], value[0], value[3]];\r\n        }\r\n\r\n        case \"r16uint\": {\r\n            const value = pixelValue(imageData, offset, \"16uint\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"r16sint\": {\r\n            const value = pixelValue(imageData, offset, \"16sint\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"r16float\": {\r\n            const value = pixelValue(imageData, offset, \"16float\", 1);\r\n            return [value[0]];\r\n        }\r\n\r\n        case \"rg16uint\": {\r\n            const value = pixelValue(imageData, offset, \"16uint\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg16sint\": {\r\n            const value = pixelValue(imageData, offset, \"16sint\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg16float\": {\r\n            const value = pixelValue(imageData, offset, \"16float\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n\r\n        case \"rgba16uint\": {\r\n            const value = pixelValue(imageData, offset, \"16uint\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba16sint\": {\r\n            const value = pixelValue(imageData, offset, \"16sint\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba16float\": {\r\n            const value = pixelValue(imageData, offset, \"16float\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n\r\n        case \"r32uint\": {\r\n            const value = pixelValue(imageData, offset, \"32uint\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"r32sint\": {\r\n            const value = pixelValue(imageData, offset, \"32sint\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"depth16unorm\": // depth formats get conerted to r32float\r\n        case \"depth24plus\":\r\n        case \"depth24plus-stencil8\":\r\n        case \"depth32float\":\r\n        case \"depth32float-stencil8\":\r\n        case \"r32float\": {\r\n            const value = pixelValue(imageData, offset, \"32float\", 1);\r\n            return [value[0]];\r\n        }\r\n        case \"rg32uint\": {\r\n            const value = pixelValue(imageData, offset, \"32uint\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg32sint\": {\r\n            const value = pixelValue(imageData, offset, \"32sint\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rg32float\": {\r\n            const value = pixelValue(imageData, offset, \"32float\", 2);\r\n            return [value[0], value[1]];\r\n        }\r\n        case \"rgba32uint\": {\r\n            const value = pixelValue(imageData, offset, \"32uint\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba32sint\": {\r\n            const value = pixelValue(imageData, offset, \"32sint\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n        case \"rgba32float\": {\r\n            const value = pixelValue(imageData, offset, \"32float\", 4);\r\n            return [value[0], value[1], value[2], value[3]];\r\n        }\r\n\r\n        case \"rg11b10ufloat\": {\r\n            const uintValue = new Uint32Array(imageData.buffer, offset, 1)[0];\r\n            const ri = uintValue & 0x7FF;\r\n            const gi = (uintValue & 0x3FF800) >> 11;\r\n            const bi = (uintValue & 0xFFC00000) >> 22;\r\n            const rf = float11ToFloat32(ri);\r\n            const gf = float11ToFloat32(gi);\r\n            const bf = float10ToFloat32(bi);\r\n            return [rf, gf, bf, 1.0];\r\n        }\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nfunction pixelValue(imageData: Uint8Array, offset: number, format: string, numChannels: number) {\r\n    const value = [0, 0, 0, 0];\r\n    for (let i = 0; i < numChannels; ++i) {\r\n      switch (format) {\r\n        case \"8unorm\":\r\n          value[i] = imageData[offset] / 255;\r\n          offset++;\r\n          break;\r\n        case \"8snorm\":\r\n          value[i] = (imageData[offset] / 255) * 2 - 1;\r\n          offset++;\r\n          break;\r\n        case \"8uint\":\r\n          value[i] = imageData[offset];\r\n          offset++;\r\n          break;\r\n        case \"8sint\":\r\n          value[i] = imageData[offset] - 127;\r\n          offset++;\r\n          break;\r\n        case \"16uint\":\r\n          value[i] = imageData[offset] | (imageData[offset + 1] << 8);\r\n          offset += 2;\r\n          break;\r\n        case \"16sint\":\r\n          value[i] = (imageData[offset] | (imageData[offset + 1] << 8)) - 32768;\r\n          offset += 2;\r\n          break;\r\n        case \"16float\":\r\n          value[i] = float16ToFloat32(imageData[offset] | (imageData[offset + 1] << 8));\r\n          offset += 2;\r\n          break;\r\n        case \"32uint\":\r\n          value[i] = imageData[offset] | (imageData[offset + 1] << 8) | (imageData[offset + 2] << 16) | (imageData[offset + 3] << 24);\r\n          offset += 4;\r\n          break;\r\n        case \"32sint\":\r\n          value[i] = (imageData[offset] | (imageData[offset + 1] << 8) | (imageData[offset + 2] << 16) | (imageData[offset + 3] << 24)) | 0;\r\n          offset += 4;\r\n          break;\r\n        case \"32float\":\r\n          value[i] = new Float32Array(imageData.buffer, offset, 1)[0];\r\n          offset += 4;\r\n          break;\r\n      }\r\n    }\r\n    return value;\r\n}\r\n\r\nfunction setPixelValue(imageData: Uint8Array, offset: number, format: string, numChannels: number, value: number[]) {\r\n    for (let i = 0; i < numChannels; ++i) {\r\n      switch (format) {\r\n        case \"8unorm\":\r\n          imageData[offset] = value[i] * 255;\r\n          offset++;\r\n          break;\r\n        case \"8snorm\":\r\n          imageData[offset] = ((value[i] + 1.0) * 0.5) * 255;\r\n          offset++;\r\n          break;\r\n        case \"8uint\":\r\n          imageData[offset] = value[i];\r\n          offset++;\r\n          break;\r\n        case \"8sint\":\r\n          imageData[offset] = value[i] + 127;\r\n          offset++;\r\n          break;\r\n        case \"16uint\":\r\n          new Uint16Array(imageData.buffer, offset, 1)[0] = value[i];\r\n          offset += 2;\r\n          break;\r\n        case \"16sint\":\r\n          new Int16Array(imageData.buffer, offset, 1)[0] = value[i];\r\n          offset += 2;\r\n          break;\r\n        case \"16float\": {\r\n          const f16 = float32ToFloat16(value[i]);\r\n          new Uint16Array(imageData.buffer, offset, 1)[0] = f16;\r\n          offset += 2;\r\n          break;\r\n        }\r\n        case \"32uint\":\r\n          new Uint32Array(imageData.buffer, offset, 1)[0] = value[i];\r\n          offset += 4;\r\n          break;\r\n        case \"32sint\":\r\n          new Int32Array(imageData.buffer, offset, 1)[0] = value[i];\r\n          offset += 4;\r\n          break;\r\n        case \"32float\":\r\n          new Float32Array(imageData.buffer, offset, 1)[0] = value[i];\r\n          offset += 4;\r\n          break;\r\n      }\r\n    }\r\n    return value;\r\n}\r\n", "\r\nexport const TextureFormatInfo = {\r\n    \"r8unorm\": { \"bytesPerBlock\": 1, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r8snorm\": { \"bytesPerBlock\": 1, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r8uint\": { \"bytesPerBlock\": 1, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r8sint\": { \"bytesPerBlock\": 1, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"rg8unorm\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg8snorm\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg8uint\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg8sint\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n\r\n    \"rgba8unorm\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba8unorm-srgb\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba8snorm\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba8uint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba8sint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"bgra8unorm\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"bgra8unorm-srgb\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n\r\n    \"r16uint\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r16sint\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r16float\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n\r\n    \"rg16uint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg16sint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg16float\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n\r\n    \"rgba16uint\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba16sint\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba16float\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n\r\n    \"r32uint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r32sint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n    \"r32float\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 1 },\r\n\r\n    \"rg32uint\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg32sint\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n    \"rg32float\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 2 },\r\n\r\n    \"rgba32uint\": { \"bytesPerBlock\": 16, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba32sint\": { \"bytesPerBlock\": 16, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgba32float\": { \"bytesPerBlock\": 16, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgb10a2uint\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rgb10a2unorm\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n    \"rg11b10ufloat\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n\r\n    // Depth Stencil Formats\r\n    \"stencil8\": { \"bytesPerBlock\": 1, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"isDepthStencil\": true, \"hasDepth\": false, \"hasStencil\": true, \"channels\": 1 }, // bytesPerBlock is actually 1-4\r\n    \"depth16unorm\": { \"bytesPerBlock\": 2, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"isDepthStencil\": true, \"hasDepth\": true, \"hasStencil\": false, \"channels\": 1 },\r\n    \"depth24plus\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"isDepthStencil\": true, \"hasDepth\": true, \"hasStencil\": false, \"depthOnlyFormat\": \"depth32float\", \"channels\": 1 },\r\n    \"depth24plus-stencil8\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"isDepthStencil\": true, \"hasDepth\": true, \"hasStencil\": true, \"depthOnlyFormat\": \"depth32float\", \"channels\": 1 }, // bytesPerBlock is actually 4-8\r\n    \"depth32float\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"isDepthStencil\": true, \"hasDepth\": true, \"hasStencil\": false, \"channels\": 1 },\r\n    \"depth32float-stencil8\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"isDepthStencil\": true, \"hasDepth\": true, \"hasStencil\": true, \"stencilOnlyFormat\": \"depth32float\", \"channels\": 1 }, // bytesPerBlock is actually 5-8\r\n\r\n    // Packed Formats\r\n    \"rgb9e5ufloat\": { \"bytesPerBlock\": 4, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": false, \"channels\": 4 },\r\n\r\n    // Compressed Formats\r\n    \"bc1-rgba-unorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc1-rgba-unorm-srgb\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc2-rgba-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc2-rgba-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc3-rgba-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc3-rgba-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n\r\n    \"bc4-r-unorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 1 },\r\n    \"bc4-r-snorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 1 },\r\n\r\n    \"bc5-rg-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 2 },\r\n    \"bc5-rg-snorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 2 },\r\n\r\n    \"bc6h-rgb-ufloat\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc6h-rgb-float\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc7-rgba-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"bc7-rgba-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \r\n    \"etc2-rgb8unorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"etc2-rgb8unorm-srgb\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"etc2-rgb8a1unorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"etc2-rgb8a1unorm-srgb\": { \"bytesPerBlock\": 8, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"etc2-rgba8unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"etc2-rgba8unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \r\n    \"eac-r11unorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": true, \"channels\": 1 },\r\n    \"eac-r11snorm\": { \"bytesPerBlock\": 8, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": true, \"channels\": 1 },\r\n\r\n    \"eac-rg11unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": true, \"channels\": 2 },\r\n    \"eac-rg11snorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 1, \"blockHeight\": 1, \"isCompressed\": true, \"channels\": 2 },\r\n\r\n    \"astc-4x4-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-4x4-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 4, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-5x4-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 5, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-5x4-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 5, \"blockHeight\": 4, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-5x5-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 5, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-5x5-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 5, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-6x5-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 6, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-6x5-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 6, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-6x6-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 6, \"blockHeight\": 6, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-6x6-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 6, \"blockHeight\": 6, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-8x5-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 8, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-8x5-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 8, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-8x6-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 8, \"blockHeight\": 6, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-8x6-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 8, \"blockHeight\": 6, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-8x8-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 8, \"blockHeight\": 8, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-8x8-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 8, \"blockHeight\": 8, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x5-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x5-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 5, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x6-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 6, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x6-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 6, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x8-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 8, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x8-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 8, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x10-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 10, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-10x10-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 10, \"blockHeight\": 10, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-12x10-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 12, \"blockHeight\": 10, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-12x10-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 12, \"blockHeight\": 10, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-12x12-unorm\": { \"bytesPerBlock\": 16, \"blockWidth\": 12, \"blockHeight\": 12, \"isCompressed\": true, \"channels\": 4 },\r\n    \"astc-12x12-unorm-srgb\": { \"bytesPerBlock\": 16, \"blockWidth\": 12, \"blockHeight\": 12, \"isCompressed\": true, \"channels\": 4 },\r\n};\r\n", "import { WgslExec } from \"./wgsl_exec.js\";\r\nimport { TypeInfo, PointerInfo, TemplateInfo, ArrayInfo, StructInfo } from \"./reflect/info.js\";\r\nimport { ExecContext } from \"./exec/exec_context.js\";\r\nimport { ExecInterface } from \"./exec/exec_interface.js\";\r\nimport { setTexturePixel, getTexturePixel } from \"./utils/texture_sample.js\";\r\nimport { TextureFormatInfo } from \"./utils/texture_format_info.js\";\r\n\r\n/**\r\n * @class Node\r\n * @category AST\r\n * Base class for AST nodes parsed from a WGSL shader.\r\n */\r\nexport class Node {\r\n  static _id = 0;\r\n\r\n  id: number;\r\n  line: number;\r\n\r\n  constructor() {\r\n    this.id = Node._id++;\r\n    this.line = 0;\r\n  }\r\n\r\n  get isAstNode(): boolean {\r\n    return true;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n  }\r\n\r\n  searchBlock(block: Node[] | null, callback: (node: Node) => void): void {\r\n    if (block) {\r\n      callback(_BlockStart.instance);\r\n      for (const node of block) {\r\n        if (node instanceof Array) {\r\n          this.searchBlock(node as Node[], callback);\r\n        } else {\r\n          node.search(callback);\r\n        }\r\n      }\r\n      callback(_BlockEnd.instance);\r\n    }\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    throw new Error(\"Cannot evaluate node\");\r\n  }\r\n\r\n  constEvaluateString(context: WgslExec): string {\r\n    return this.constEvaluate(context).toString();\r\n  } \r\n}\r\n\r\n// For internal use only\r\nexport class _BlockStart extends Node {\r\n  static instance = new _BlockStart();\r\n}\r\n\r\n // For internal use only\r\nexport class _BlockEnd extends Node {\r\n  static instance = new _BlockEnd();\r\n}\r\n\r\nconst BuiltinFunctionNames = new Set([\r\n  \"all\",\r\n  \"all\",\r\n  \"any\",\r\n  \"select\",\r\n  \"arrayLength\",\r\n  \"abs\",\r\n  \"acos\",\r\n  \"acosh\",\r\n  \"asin\",\r\n  \"asinh\",\r\n  \"atan\",\r\n  \"atanh\",\r\n  \"atan2\",\r\n  \"ceil\",\r\n  \"clamp\",\r\n  \"cos\",\r\n  \"cosh\",\r\n  \"countLeadingZeros\",\r\n  \"countOneBits\",\r\n  \"countTrailingZeros\",\r\n  \"cross\",\r\n  \"degrees\",\r\n  \"determinant\",\r\n  \"distance\",\r\n  \"dot\",\r\n  \"dot4U8Packed\",\r\n  \"dot4I8Packed\",\r\n  \"exp\",\r\n  \"exp2\",\r\n  \"extractBits\",\r\n  \"faceForward\",\r\n  \"firstLeadingBit\",\r\n  \"firstTrailingBit\",\r\n  \"floor\",\r\n  \"fma\",\r\n  \"fract\",\r\n  \"frexp\",\r\n  \"insertBits\",\r\n  \"inverseSqrt\",\r\n  \"ldexp\",\r\n  \"length\",\r\n  \"log\",\r\n  \"log2\",\r\n  \"max\",\r\n  \"min\",\r\n  \"mix\",\r\n  \"modf\",\r\n  \"normalize\",\r\n  \"pow\",\r\n  \"quantizeToF16\",\r\n  \"radians\",\r\n  \"reflect\",\r\n  \"refract\",\r\n  \"reverseBits\",\r\n  \"round\",\r\n  \"saturate\",\r\n  \"sign\",\r\n  \"sin\",\r\n  \"sinh\",\r\n  \"smoothStep\",\r\n  \"sqrt\",\r\n  \"step\",\r\n  \"tan\",\r\n  \"tanh\",\r\n  \"transpose\",\r\n  \"trunc\",\r\n  \"dpdx\",\r\n  \"dpdxCoarse\",\r\n  \"dpdxFine\",\r\n  \"dpdy\",\r\n  \"dpdyCoarse\",\r\n  \"dpdyFine\",\r\n  \"fwidth\",\r\n  \"fwidthCoarse\",\r\n  \"fwidthFine\",\r\n  \"textureDimensions\",\r\n  \"textureGather\",\r\n  \"textureGatherCompare\",\r\n  \"textureLoad\",\r\n  \"textureNumLayers\",\r\n  \"textureNumLevels\",\r\n  \"textureNumSamples\",\r\n  \"textureSample\",\r\n  \"textureSampleBias\",\r\n  \"textureSampleCompare\",\r\n  \"textureSampleCompareLevel\",\r\n  \"textureSampleGrad\",\r\n  \"textureSampleLevel\",\r\n  \"textureSampleBaseClampToEdge\",\r\n  \"textureStore\",\r\n  \"atomicLoad\",\r\n  \"atomicStore\",\r\n  \"atomicAdd\",\r\n  \"atomicSub\",\r\n  \"atomicMax\",\r\n  \"atomicMin\",\r\n  \"atomicAnd\",\r\n  \"atomicOr\",\r\n  \"atomicXor\",\r\n  \"atomicExchange\",\r\n  \"atomicCompareExchangeWeak\",\r\n  \"pack4x8snorm\",\r\n  \"pack4x8unorm\",\r\n  \"pack4xI8\",\r\n  \"pack4xU8\",\r\n  \"pack4x8Clamp\",\r\n  \"pack4xU8Clamp\",\r\n  \"pack2x16snorm\",\r\n  \"pack2x16unorm\",\r\n  \"pack2x16float\",\r\n  \"unpack4x8snorm\",\r\n  \"unpack4x8unorm\",\r\n  \"unpack4xI8\",\r\n  \"unpack4xU8\",\r\n  \"unpack2x16snorm\",\r\n  \"unpack2x16unorm\",\r\n  \"unpack2x16float\",\r\n  \"storageBarrier\",\r\n  \"textureBarrier\",\r\n  \"workgroupBarrier\",\r\n  \"workgroupUniformLoad\",\r\n  \"subgroupAdd\",\r\n  \"subgroupExclusiveAdd\",\r\n  \"subgroupInclusiveAdd\",\r\n  \"subgroupAll\",\r\n  \"subgroupAnd\",\r\n  \"subgroupAny\",\r\n  \"subgroupBallot\",\r\n  \"subgroupBroadcast\",\r\n  \"subgroupBroadcastFirst\",\r\n  \"subgroupElect\",\r\n  \"subgroupMax\",\r\n  \"subgroupMin\",\r\n  \"subgroupMul\",\r\n  \"subgroupExclusiveMul\",\r\n  \"subgroupInclusiveMul\",\r\n  \"subgroupOr\",\r\n  \"subgroupShuffle\",\r\n  \"subgroupShuffleDown\",\r\n  \"subgroupShuffleUp\",\r\n  \"subgroupShuffleXor\",\r\n  \"subgroupXor\",\r\n  \"quadBroadcast\",\r\n  \"quadSwapDiagonal\",\r\n  \"quadSwapX\",\r\n  \"quadSwapY\",\r\n]);\r\n\r\n/**\r\n * @class Statement\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class Statement extends Node {\r\n  constructor() {\r\n    super();\r\n  }\r\n}\r\n\r\n/**\r\n * @class Function\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Function extends Statement {\r\n  name: string;\r\n  args: Argument[];\r\n  returnType: Type | null;\r\n  body: Statement[];\r\n  attributes: Attribute[] | null;\r\n  startLine: number;\r\n  endLine: number;\r\n  calls: Set<Function> = new Set();\r\n\r\n  constructor(\r\n    name: string,\r\n    args: Argument[],\r\n    returnType: Type | null,\r\n    body: Statement[],\r\n    startLine: number,\r\n    endLine: number\r\n  ) {\r\n    super();\r\n    this.name = name;\r\n    this.args = args;\r\n    this.returnType = returnType;\r\n    this.body = body;\r\n    this.startLine = startLine;\r\n    this.endLine = endLine;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"function\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    if (this.attributes) {\r\n      for (const attr of this.attributes) {\r\n        callback(attr);\r\n      }\r\n    }\r\n    callback(this);\r\n    for (const arg of this.args) {\r\n      callback(arg);\r\n    }\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class StaticAssert\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class StaticAssert extends Statement {\r\n  expression: Expression;\r\n\r\n  constructor(expression: Expression) {\r\n    super();\r\n    this.expression = expression;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"staticAssert\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.expression.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class While\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class While extends Statement {\r\n  condition: Expression;\r\n  body: Statement[];\r\n\r\n  constructor(condition: Expression, body: Statement[]) {\r\n    super();\r\n    this.condition = condition;\r\n    this.body = body;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"while\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.condition.search(callback);\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Continuing\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Continuing extends Statement {\r\n  body: Statement[];\r\n  loopId: number;\r\n\r\n  constructor(body: Statement[], loopId: number) {\r\n    super();\r\n    this.body = body;\r\n    this.loopId = loopId;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"continuing\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class For\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class For extends Statement {\r\n  init: Statement | null;\r\n  condition: Expression | null;\r\n  increment: Statement | null;\r\n  body: Statement[];\r\n\r\n  constructor(\r\n    init: Statement | null,\r\n    condition: Expression | null,\r\n    increment: Statement | null,\r\n    body: Statement[]\r\n  ) {\r\n    super();\r\n    this.init = init;\r\n    this.condition = condition;\r\n    this.increment = increment;\r\n    this.body = body;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"for\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.init?.search(callback);\r\n    this.condition?.search(callback);\r\n    this.increment?.search(callback);\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Var\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Var extends Statement {\r\n  name: string;\r\n  type: Type | null;\r\n  storage: string | null;\r\n  access: string | null;\r\n  value: Expression | null;\r\n  attributes: Attribute[] | null = null;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: Type | null,\r\n    storage: string | null,\r\n    access: string | null,\r\n    value: Expression | null\r\n  ) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n    this.storage = storage;\r\n    this.access = access;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"var\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n    this.value?.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Override\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Override extends Statement {\r\n  name: string;\r\n  type: Type | null;\r\n  value: Expression | null;\r\n  attributes: Attribute[] | null = null;\r\n\r\n  constructor(name: string, type: Type | null, value: Expression | null) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"override\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.value?.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Let\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Let extends Statement {\r\n  name: string;\r\n  type: Type | null;\r\n  storage: string | null;\r\n  access: string | null;\r\n  value: Expression | null;\r\n  attributes: Attribute[] | null = null;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: Type | null,\r\n    storage: string | null,\r\n    access: string | null,\r\n    value: Expression | null\r\n  ) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n    this.storage = storage;\r\n    this.access = access;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"let\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n    this.value?.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Const\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Const extends Statement {\r\n  name: string;\r\n  type: Type | null;\r\n  storage: string | null;\r\n  access: string | null;\r\n  value: Expression;\r\n  attributes: Attribute[] | null = null;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: Type | null,\r\n    storage: string | null,\r\n    access: string | null,\r\n    value: Expression\r\n  ) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n    this.storage = storage;\r\n    this.access = access;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"const\";\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    return this.value.constEvaluate(context, type);\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n    this.value?.search(callback);\r\n  }\r\n}\r\n\r\nexport enum IncrementOperator {\r\n  increment = \"++\",\r\n  decrement = \"--\",\r\n}\r\n\r\nexport namespace IncrementOperator {\r\n  export function parse(val: string): IncrementOperator {\r\n    const key = val as keyof typeof IncrementOperator;\r\n    if (key == \"parse\") throw new Error(\"Invalid value for IncrementOperator\");\r\n    return IncrementOperator[key];\r\n  }\r\n}\r\n\r\n/**\r\n * @class Increment\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Increment extends Statement {\r\n  operator: IncrementOperator;\r\n  variable: Expression;\r\n\r\n  constructor(operator: IncrementOperator, variable: Expression) {\r\n    super();\r\n    this.operator = operator;\r\n    this.variable = variable;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"increment\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.variable.search(callback);\r\n  }\r\n}\r\n\r\nexport enum AssignOperator {\r\n  assign = \"=\",\r\n  addAssign = \"+=\",\r\n  subtractAssin = \"-=\",\r\n  multiplyAssign = \"*=\",\r\n  divideAssign = \"/=\",\r\n  moduloAssign = \"%=\",\r\n  andAssign = \"&=\",\r\n  orAssign = \"|=\",\r\n  xorAssign = \"^=\",\r\n  shiftLeftAssign = \"<<=\",\r\n  shiftRightAssign = \">>=\",\r\n}\r\n\r\nexport namespace AssignOperator {\r\n  export function parse(val: string): AssignOperator {\r\n    const key = val as keyof typeof AssignOperator;\r\n    if (key == \"parse\") {\r\n      throw new Error(\"Invalid value for AssignOperator\");\r\n    }\r\n    //return AssignOperator[key];\r\n    return key as AssignOperator;\r\n  }\r\n}\r\n\r\n/**\r\n * @class Assign\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Assign extends Statement {\r\n  operator: AssignOperator;\r\n  variable: Expression;\r\n  value: Expression;\r\n\r\n  constructor(\r\n    operator: AssignOperator,\r\n    variable: Expression,\r\n    value: Expression\r\n  ) {\r\n    super();\r\n    this.operator = operator;\r\n    this.variable = variable;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"assign\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.variable.search(callback);\r\n    this.value.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Call\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Call extends Statement {\r\n  name: string;\r\n  args: Expression[];\r\n\r\n  constructor(name: string, args: Expression[]) {\r\n    super();\r\n    this.name = name;\r\n    this.args = args;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"call\";\r\n  }\r\n\r\n  isBuiltin(): boolean {\r\n    return BuiltinFunctionNames.has(this.name);\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    for (const node of this.args) {\r\n      node.search(callback);\r\n    }\r\n    callback(this);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Loop\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Loop extends Statement {\r\n  body: Statement[];\r\n  continuing: Continuing | null;\r\n\r\n  constructor(body: Statement[], continuing: Continuing | null) {\r\n    super();\r\n    this.body = body;\r\n    this.continuing = continuing;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"loop\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.searchBlock(this.body, callback);\r\n    this.continuing?.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Switch\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Switch extends Statement {\r\n  condition: Expression;\r\n  cases: SwitchCase[];\r\n\r\n  constructor(condition: Expression, cases: SwitchCase[]) {\r\n    super();\r\n    this.condition = condition;\r\n    this.cases = cases;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"switch\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n    for (const node of this.cases) {\r\n      node.search(callback);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * @class If\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class If extends Statement {\r\n  condition: Expression;\r\n  body: Statement[];\r\n  elseif: ElseIf[] | null;\r\n  else: Statement[] | null;\r\n\r\n  constructor(\r\n    condition: Expression,\r\n    body: Statement[],\r\n    elseif: ElseIf[] | null,\r\n    _else: Statement[] | null\r\n  ) {\r\n    super();\r\n    this.condition = condition;\r\n    this.body = body;\r\n    this.elseif = elseif;\r\n    this.else = _else;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"if\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.condition.search(callback);\r\n    this.searchBlock(this.body, callback);\r\n    this.searchBlock(this.elseif, callback);\r\n    this.searchBlock(this.else, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Return\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Return extends Statement {\r\n  value: Expression;\r\n\r\n  constructor(value: Expression) {\r\n    super();\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"return\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.value?.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Enable\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Enable extends Statement {\r\n  name: string;\r\n\r\n  constructor(name: string) {\r\n    super();\r\n    this.name = name;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"enable\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Requires\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Requires extends Statement {\r\n  extensions: string[];\r\n\r\n  constructor(extensions: string[]) {\r\n    super();\r\n    this.extensions = extensions;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"requires\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Diagnostic\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Diagnostic extends Statement {\r\n  severity: string;\r\n  rule: string;\r\n\r\n  constructor(severity: string, rule: string) {\r\n    super();\r\n    this.severity = severity;\r\n    this.rule = rule;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"diagnostic\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Alias\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Alias extends Statement {\r\n  name: string;\r\n  type: Type;\r\n\r\n  constructor(name: string, type: Type) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"alias\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Discard\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Discard extends Statement {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"discard\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Break\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Break extends Statement {\r\n  condition: Expression | null = null;\r\n  loopId: number = -1;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"break\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Continue\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Continue extends Statement {\r\n  loopId: number = -1;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"continue\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Type\r\n * @extends Statement\r\n * @category AST\r\n */\r\nexport class Type extends Statement {\r\n  name: string;\r\n  attributes: Attribute[] | null = null;\r\n\r\n  constructor(name: string) {\r\n    super();\r\n    this.name = name;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"type\";\r\n  }\r\n\r\n  get isStruct(): boolean {\r\n    return false;\r\n  }\r\n\r\n  get isArray(): boolean {\r\n    return false;\r\n  }\r\n\r\n  static x32 = new Type(\"x32\");\r\n  static f32 = new Type(\"f32\");\r\n  static i32 = new Type(\"i32\");\r\n  static u32 = new Type(\"u32\");\r\n  static f16 = new Type(\"f16\");\r\n  static bool = new Type(\"bool\");\r\n  static void = new Type(\"void\");\r\n\r\n  static _priority = new Map<string, number>([[\"f32\", 0], [\"f16\", 1], [\"u32\", 2], [\"i32\", 3], [\"x32\", 3]]);\r\n\r\n  static maxFormatType(x: Type[]): Type {\r\n    let t = x[0];\r\n    if (t.name === \"f32\") {\r\n      return t;\r\n    }\r\n    for (let i = 1; i < x.length; ++i) {\r\n      const tv = Type._priority.get(t.name);\r\n      const xv = Type._priority.get(x[i].name);\r\n      if (xv < tv) {\r\n        t = x[i];\r\n      }\r\n    }\r\n\r\n    if (t.name === \"x32\") {\r\n      return Type.i32;\r\n    }\r\n\r\n    return t;\r\n  }\r\n\r\n  getTypeName(): string {\r\n    return this.name;\r\n  }\r\n}\r\n\r\n/**\r\n * @class ForwardType\r\n * @extends Type\r\n * @category AST\r\n * Internal type used as a placeholder for a type being used before it has been defined.\r\n */\r\nexport class ForwardType extends Type {\r\n  constructor(name: string) {\r\n    super(name);\r\n  }\r\n}\r\n\r\n/**\r\n * @class StructType\r\n * @extends Type\r\n * @category AST\r\n */\r\nexport class Struct extends Type {\r\n  members: Member[];\r\n  startLine: number;\r\n  endLine: number;\r\n\r\n  constructor(name: string, members: Member[], startLine: number, endLine: number) {\r\n    super(name);\r\n    this.members = members;\r\n    this.startLine = startLine;\r\n    this.endLine = endLine;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"struct\";\r\n  }\r\n\r\n  get isStruct(): boolean {\r\n    return true;\r\n  }\r\n\r\n  /// Return the index of the member with the given name, or -1 if not found.\r\n  getMemberIndex(name: string): number {\r\n    for (let i = 0; i < this.members.length; i++) {\r\n      if (this.members[i].name == name) return i;\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    for (const member of this.members) {\r\n      callback(member);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * @class TemplateType\r\n * @extends Type\r\n * @category AST\r\n */\r\nexport class TemplateType extends Type {\r\n  format: Type | null;\r\n  access: string | null;\r\n\r\n  constructor(name: string, format: Type | null, access: string | null) {\r\n    super(name);\r\n    this.format = format;\r\n    this.access = access;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"template\";\r\n  }\r\n\r\n  getTypeName(): string {\r\n    let name = this.name;\r\n    if (this.format !== null) {\r\n      if (name === \"vec2\" || name === \"vec3\" || name === \"vec4\" ||\r\n          name === \"mat2x2\" || name === \"mat2x3\" || name === \"mat2x4\" ||\r\n          name === \"mat3x2\" || name === \"mat3x3\" || name === \"mat3x4\" ||\r\n          name === \"mat4x2\" || name === \"mat4x3\" || name === \"mat4x4\") {\r\n        if (this.format.name === \"f32\") {\r\n          name += \"f\";\r\n          return name;\r\n        } else if (this.format.name === \"i32\") {\r\n          name += \"i\";\r\n          return name;\r\n        } else if (this.format.name === \"u32\") {\r\n          name += \"u\";\r\n          return name;\r\n        } else if (this.format.name === \"bool\") {\r\n          name += \"b\";\r\n          return name;\r\n        } else if (this.format.name === \"f16\") {\r\n          name += \"h\";\r\n          return name;\r\n        }\r\n      }\r\n      name += `<${this.format.name}>`;\r\n    } else {\r\n      if (name === \"vec2\" || name === \"vec3\" || name === \"vec4\") {\r\n        return name;\r\n      }\r\n      //console.error(\"Template format is null.\");\r\n    }\r\n    return name;\r\n  }\r\n\r\n  static vec2f = new TemplateType(\"vec2\", Type.f32, null);\r\n  static vec3f = new TemplateType(\"vec3\", Type.f32, null);\r\n  static vec4f = new TemplateType(\"vec4\", Type.f32, null);\r\n  static vec2i = new TemplateType(\"vec2\", Type.i32, null);\r\n  static vec3i = new TemplateType(\"vec3\", Type.i32, null);\r\n  static vec4i = new TemplateType(\"vec4\", Type.i32, null);\r\n  static vec2u = new TemplateType(\"vec2\", Type.u32, null);\r\n  static vec3u = new TemplateType(\"vec3\", Type.u32, null);\r\n  static vec4u = new TemplateType(\"vec4\", Type.u32, null);\r\n  static vec2h = new TemplateType(\"vec2\", Type.f16, null);\r\n  static vec3h = new TemplateType(\"vec3\", Type.f16, null);\r\n  static vec4h = new TemplateType(\"vec4\", Type.f16, null);\r\n  static vec2b = new TemplateType(\"vec2\", Type.bool, null);\r\n  static vec3b = new TemplateType(\"vec3\", Type.bool, null);\r\n  static vec4b = new TemplateType(\"vec4\", Type.bool, null);\r\n\r\n  static mat2x2f = new TemplateType(\"mat2x2\", Type.f32, null);\r\n  static mat2x3f = new TemplateType(\"mat2x3\", Type.f32, null);\r\n  static mat2x4f = new TemplateType(\"mat2x4\", Type.f32, null);\r\n  static mat3x2f = new TemplateType(\"mat3x2\", Type.f32, null);\r\n  static mat3x3f = new TemplateType(\"mat3x3\", Type.f32, null);\r\n  static mat3x4f = new TemplateType(\"mat3x4\", Type.f32, null);\r\n  static mat4x2f = new TemplateType(\"mat4x2\", Type.f32, null);\r\n  static mat4x3f = new TemplateType(\"mat4x3\", Type.f32, null);\r\n  static mat4x4f = new TemplateType(\"mat4x4\", Type.f32, null);\r\n\r\n  static mat2x2h = new TemplateType(\"mat2x2\", Type.f16, null);\r\n  static mat2x3h = new TemplateType(\"mat2x3\", Type.f16, null);\r\n  static mat2x4h = new TemplateType(\"mat2x4\", Type.f16, null);\r\n  static mat3x2h = new TemplateType(\"mat3x2\", Type.f16, null);\r\n  static mat3x3h = new TemplateType(\"mat3x3\", Type.f16, null);\r\n  static mat3x4h = new TemplateType(\"mat3x4\", Type.f16, null);\r\n  static mat4x2h = new TemplateType(\"mat4x2\", Type.f16, null);\r\n  static mat4x3h = new TemplateType(\"mat4x3\", Type.f16, null);\r\n  static mat4x4h = new TemplateType(\"mat4x4\", Type.f16, null);\r\n\r\n  static mat2x2i = new TemplateType(\"mat2x2\", Type.i32, null);\r\n  static mat2x3i = new TemplateType(\"mat2x3\", Type.i32, null);\r\n  static mat2x4i = new TemplateType(\"mat2x4\", Type.i32, null);\r\n  static mat3x2i = new TemplateType(\"mat3x2\", Type.i32, null);\r\n  static mat3x3i = new TemplateType(\"mat3x3\", Type.i32, null);\r\n  static mat3x4i = new TemplateType(\"mat3x4\", Type.i32, null);\r\n  static mat4x2i = new TemplateType(\"mat4x2\", Type.i32, null);\r\n  static mat4x3i = new TemplateType(\"mat4x3\", Type.i32, null);\r\n  static mat4x4i = new TemplateType(\"mat4x4\", Type.i32, null);\r\n\r\n  static mat2x2u = new TemplateType(\"mat2x2\", Type.u32, null);\r\n  static mat2x3u = new TemplateType(\"mat2x3\", Type.u32, null);\r\n  static mat2x4u = new TemplateType(\"mat2x4\", Type.u32, null);\r\n  static mat3x2u = new TemplateType(\"mat3x2\", Type.u32, null);\r\n  static mat3x3u = new TemplateType(\"mat3x3\", Type.u32, null);\r\n  static mat3x4u = new TemplateType(\"mat3x4\", Type.u32, null);\r\n  static mat4x2u = new TemplateType(\"mat4x2\", Type.u32, null);\r\n  static mat4x3u = new TemplateType(\"mat4x3\", Type.u32, null);\r\n  static mat4x4u = new TemplateType(\"mat4x4\", Type.u32, null);\r\n}\r\n\r\n/**\r\n * @class PointerType\r\n * @extends Type\r\n * @category AST\r\n */\r\nexport class PointerType extends Type {\r\n  storage: string;\r\n  type: Type | null;\r\n  access: string | null;\r\n\r\n  constructor(\r\n    name: string,\r\n    storage: string,\r\n    type: Type | null,\r\n    access: string | null\r\n  ) {\r\n    super(name);\r\n    this.storage = storage;\r\n    this.type = type;\r\n    this.access = access;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"pointer\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class ArrayType\r\n * @extends Type\r\n * @category AST\r\n */\r\nexport class ArrayType extends Type {\r\n  attributes: Attribute[] | null;\r\n  format: Type | null;\r\n  count: number;\r\n\r\n  constructor(\r\n    name: string,\r\n    attributes: Attribute[] | null,\r\n    format: Type | null,\r\n    count: number\r\n  ) {\r\n    super(name);\r\n    this.attributes = attributes;\r\n    this.format = format;\r\n    this.count = count;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"array\";\r\n  }\r\n\r\n  get isArray(): boolean {\r\n    return true;\r\n  }\r\n}\r\n\r\n/**\r\n * @class SamplerType\r\n * @extends Type\r\n * @category AST\r\n */\r\nexport class SamplerType extends Type {\r\n  format: Type | string | null;\r\n  access: string | null;\r\n\r\n  constructor(\r\n    name: string,\r\n    format: Type | string | null,\r\n    access: string | null\r\n  ) {\r\n    super(name);\r\n    this.format = format;\r\n    this.access = access;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"sampler\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Expression\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class Expression extends Node {\r\n  postfix: Expression | null = null;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n}\r\n\r\n/**\r\n * @class StringExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class StringExpr extends Expression {\r\n  value: string;\r\n\r\n  constructor(value: string) {\r\n    super();\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"stringExpr\";\r\n  }\r\n\r\n  toString(): string {\r\n    return this.value;\r\n  }\r\n\r\n  constEvaluateString(): string {\r\n    return this.value;\r\n  }\r\n}\r\n\r\n/**\r\n * @class CreateExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class CreateExpr extends Expression {\r\n  type: Type | null;\r\n  args: Expression[] | null;\r\n\r\n  constructor(type: Type | null, args: Expression[] | null) {\r\n    super();\r\n    this.type = type;\r\n    this.args = args;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"createExpr\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n    if (this.args) {\r\n      for (const node of this.args) {\r\n        node.search(callback);\r\n      }\r\n    }\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    if (type) {\r\n      type[0] = this.type;\r\n    }\r\n    return context.evalExpression(this, context.context);\r\n  }\r\n}\r\n\r\n/**\r\n * @class CallExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class CallExpr extends Expression {\r\n  name: string;\r\n  args: Expression[] | null;\r\n  cachedReturnValue: any = null;\r\n\r\n  constructor(name: string, args: Expression[] | null) {\r\n    super();\r\n    this.name = name;\r\n    this.args = args;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"callExpr\";\r\n  }\r\n\r\n  setCachedReturnValue(value: any): void {\r\n    this.cachedReturnValue = value;\r\n  }\r\n\r\n  get isBuiltin(): boolean {\r\n    return BuiltinFunctionNames.has(this.name);\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data {\r\n    return context.evalExpression(this, context.context);\r\n  }\r\n\r\n  search(callback: (node: Node) => void) {\r\n    for (const node of this.args) {\r\n      node.search(callback);\r\n    }\r\n    callback(this);\r\n  }\r\n}\r\n\r\n/**\r\n * @class VariableExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class VariableExpr extends Expression {\r\n  name: string;\r\n\r\n  constructor(name: string) {\r\n    super();\r\n    this.name = name;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"varExpr\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void) {\r\n    callback(this);\r\n    if (this.postfix) {\r\n      this.postfix.search(callback);\r\n    }\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data {\r\n    return context.evalExpression(this, context.context);\r\n  }\r\n}\r\n\r\n/**\r\n * @class ConstExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class ConstExpr extends Expression {\r\n  name: string;\r\n  initializer: Expression;\r\n\r\n  constructor(name: string, initializer: Expression) {\r\n    super();\r\n    this.name = name;\r\n    this.initializer = initializer;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"constExpr\";\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    if (this.initializer) {\r\n      const data = context.evalExpression(this.initializer, context.context);\r\n      if (data !== null && this.postfix) {\r\n        return data.getSubData(context, this.postfix, context.context);\r\n      }\r\n      return data;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.initializer.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class LiteralExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class LiteralExpr extends Expression {\r\n  value: Data\r\n  type: Type;\r\n\r\n  constructor(value: Data, type: Type) {\r\n    super();\r\n    this.value = value;\r\n    this.type = type;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"literalExpr\";\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    if (type !== undefined) {\r\n      type[0] = this.type;\r\n    }\r\n    return this.value;\r\n  }\r\n\r\n  get isScalar(): boolean {\r\n    return this.value instanceof ScalarData;\r\n  }\r\n\r\n  get isVector(): boolean {\r\n    return this.value instanceof VectorData || this.value instanceof MatrixData;\r\n  }\r\n\r\n  get scalarValue(): number {\r\n    if (this.value instanceof ScalarData) {\r\n      return this.value.value;\r\n    }\r\n    console.error(\"Value is not scalar.\");\r\n    return 0.0;\r\n  }\r\n\r\n  get vectorValue(): Float32Array | Int32Array | Uint32Array {\r\n    if (this.value instanceof VectorData) {\r\n      return this.value.data;\r\n    }\r\n    if (this.value instanceof MatrixData) {\r\n      return this.value.data;\r\n    }\r\n    console.error(\"Value is not a vector or matrix.\");\r\n    return new Float32Array(0);\r\n  }\r\n}\r\n\r\n/**\r\n * @class BitcastExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class BitcastExpr extends Expression {\r\n  type: Type | null;\r\n  value: Expression;\r\n\r\n  constructor(type: Type | null, value: Expression) {\r\n    super();\r\n    this.type = type;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"bitcastExpr\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.value.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class TypecastExpr\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class TypecastExpr extends Expression {\r\n  type: Type | null;\r\n  args: Expression[] | null;\r\n\r\n  constructor(type: Type | null, args: Expression[] | null) {\r\n    super();\r\n    this.type = type;\r\n    this.args = args;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"typecastExpr\";\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    return context.evalExpression(this, context.context);\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.searchBlock(this.args, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class ArrayIndex\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class ArrayIndex extends Expression {\r\n  index: Expression;\r\n  constructor(index: Expression) {\r\n    super();\r\n    this.index = index;\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.index.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Operator\r\n * @extends Expression\r\n * @category AST\r\n */\r\nexport class Operator extends Expression {\r\n  constructor() {\r\n    super();\r\n  }\r\n}\r\n\r\n/**\r\n * @class UnaryOperator\r\n * @extends Operator\r\n * @category AST\r\n * @property {string} operator +, -, !, ~\r\n */\r\nexport class UnaryOperator extends Operator {\r\n  operator: string;\r\n  right: Expression;\r\n\r\n  constructor(operator: string, right: Expression) {\r\n    super();\r\n    this.operator = operator;\r\n    this.right = right;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"unaryOp\";\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    return context.evalExpression(this, context.context);\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.right.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class BinaryOperator\r\n * @extends Operator\r\n * @category AST\r\n * @property {string} operator +, -, *, /, %, ==, !=, <, >, <=, >=, &&, ||\r\n */\r\nexport class BinaryOperator extends Operator {\r\n  operator: string;\r\n  left: Expression;\r\n  right: Expression;\r\n\r\n  constructor(operator: string, left: Expression, right: Expression) {\r\n    super();\r\n    this.operator = operator;\r\n    this.left = left;\r\n    this.right = right;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"binaryOp\";\r\n  }\r\n\r\n  _getPromotedType(t1: Type, t2: Type): Type {\r\n    if (t1.name === t2.name) {\r\n      return t1;\r\n    }\r\n    if (t1.name === \"f32\" || t2.name === \"f32\") {\r\n      return Type.f32;\r\n    }\r\n    if (t1.name === \"u32\" || t2.name === \"u32\") {\r\n      return Type.u32;\r\n    }\r\n    return Type.i32;\r\n  }\r\n\r\n  constEvaluate(context: WgslExec, type?: Type[]): Data | null {\r\n    return context.evalExpression(this, context.context);\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.left.search(callback);\r\n    this.right.search(callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class SwitchCase\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class SwitchCase extends Node {\r\n  body: Statement[];\r\n\r\n  constructor(body: Statement[]) {\r\n    super();\r\n    this.body = body;\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    callback(this);\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\nexport class DefaultSelector extends Expression {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"default\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Case\r\n * @extends SwitchCase\r\n * @category AST\r\n */\r\nexport class Case extends SwitchCase {\r\n  selectors: Expression[];\r\n\r\n  constructor(selectors: Expression[], body: Statement[]) {\r\n    super(body);\r\n    this.selectors = selectors;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"case\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Default\r\n * @extends SwitchCase\r\n * @category AST\r\n */\r\nexport class Default extends SwitchCase {\r\n  constructor(body: Statement[]) {\r\n    super(body);\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"default\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Argument\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class Argument extends Node {\r\n  name: string;\r\n  type: Type;\r\n  attributes: Attribute[] | null;\r\n\r\n  constructor(name: string, type: Type, attributes: Attribute[] | null) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n    this.attributes = attributes;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"argument\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class ElseIf\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class ElseIf extends Node {\r\n  condition: Expression;\r\n  body: Statement[];\r\n\r\n  constructor(condition: Expression, body: Statement[]) {\r\n    super();\r\n    this.condition = condition;\r\n    this.body = body;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"elseif\";\r\n  }\r\n\r\n  search(callback: (node: Node) => void): void {\r\n    this.condition.search(callback);\r\n    this.searchBlock(this.body, callback);\r\n  }\r\n}\r\n\r\n/**\r\n * @class Member\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class Member extends Node {\r\n  name: string;\r\n  type: Type | null;\r\n  attributes: Attribute[] | null;\r\n\r\n  constructor(\r\n    name: string,\r\n    type: Type | null,\r\n    attributes: Attribute[] | null\r\n  ) {\r\n    super();\r\n    this.name = name;\r\n    this.type = type;\r\n    this.attributes = attributes;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"member\";\r\n  }\r\n}\r\n\r\n/**\r\n * @class Attribute\r\n * @extends Node\r\n * @category AST\r\n */\r\nexport class Attribute extends Node {\r\n  name: string;\r\n  value: string | string[] | null;\r\n\r\n  constructor(name: string, value: string | string[] | null) {\r\n    super();\r\n    this.name = name;\r\n    this.value = value;\r\n  }\r\n\r\n  get astNodeType(): string {\r\n    return \"attribute\";\r\n  }\r\n}\r\n\r\n\r\n\r\nexport class Data {\r\n  static _id = 0;\r\n\r\n  typeInfo: TypeInfo;\r\n  parent: Data | null = null;\r\n  id: number;\r\n\r\n  constructor(typeInfo: TypeInfo, parent: Data | null) {\r\n      this.typeInfo = typeInfo;\r\n      this.parent = parent;\r\n      this.id = Data._id++;\r\n  }\r\n\r\n  clone(): Data {\r\n    throw `Clone: Not implemented for ${this.constructor.name}`;\r\n  }\r\n\r\n  setDataValue(exec: ExecInterface, value: Data, postfix: Expression | null, context: ExecContext): void {\r\n      console.error(`SetDataValue: Not implemented for ${this.constructor.name}`);\r\n  }\r\n\r\n  getSubData(exec: ExecInterface, postfix: Expression | null, context: ExecContext): Data | null {\r\n      console.error(`GetDataValue: Not implemented for ${this.constructor.name}`);\r\n      return null;\r\n  }\r\n\r\n  toString(): string {\r\n      return `<${this.typeInfo.getTypeName()}>`;\r\n  }\r\n}\r\n\r\nexport class VoidData extends Data {\r\n  constructor() {\r\n      super(new TypeInfo(\"void\", null), null);\r\n  }\r\n\r\n  static void = new VoidData();\r\n\r\n  toString(): string {\r\n      return \"void\";\r\n  }\r\n}\r\n\r\nexport class PointerData extends Data {\r\n  reference: Data;\r\n\r\n  constructor(reference: Data) {\r\n    super(new PointerInfo(\"pointer\", reference.typeInfo, null), null);\r\n    this.reference = reference;\r\n  }\r\n\r\n  clone(): Data {\r\n    return this;\r\n  }\r\n\r\n  setDataValue(exec: ExecInterface, value: Data, postfix: Expression | null, context: ExecContext): void {\r\n    this.reference.setDataValue(exec, value, postfix, context);\r\n  }\r\n\r\n  getSubData(exec: ExecInterface, postfix: Expression | null, context: ExecContext): Data | null {\r\n    if (postfix) {\r\n      return this.reference.getSubData(exec, postfix, context);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  toString() {\r\n    return `&${this.reference.toString()}`;\r\n  }\r\n}\r\n\r\nexport class ScalarData extends Data {\r\n  data: Int32Array | Uint32Array | Float32Array;\r\n\r\n  constructor(value: number | Int32Array | Uint32Array | Float32Array, typeInfo: TypeInfo, parent: Data | null = null) {\r\n    super(typeInfo, parent);\r\n    if (value instanceof Int32Array || value instanceof Uint32Array || value instanceof Float32Array) {\r\n        this.data = value;\r\n    } else {\r\n      if (this.typeInfo.name === \"x32\") {\r\n        if (value - Math.floor(value) !== 0) {\r\n          this.data = new Float32Array([value]);\r\n        } else if (value >= 0) {\r\n            this.data = new Uint32Array([value]);\r\n        } else {\r\n            this.data = new Int32Array([value]);\r\n        } \r\n      } else if (this.typeInfo.name === \"i32\" || this.typeInfo.name === \"bool\") {\r\n          this.data = new Int32Array([value]);\r\n      } else if (this.typeInfo.name === \"u32\") {\r\n          this.data = new Uint32Array([value]);\r\n      } else if (this.typeInfo.name === \"f32\" || this.typeInfo.name === \"f16\") {\r\n          this.data = new Float32Array([value]);\r\n      } else {\r\n          console.error(`ScalarData2: Invalid type`, typeInfo);\r\n      }\r\n    }\r\n  }\r\n\r\n  clone(): Data {\r\n    if (this.data instanceof Float32Array) {\r\n        return new ScalarData(new Float32Array(this.data), this.typeInfo, null);\r\n    } else if (this.data instanceof Int32Array) {\r\n        return new ScalarData(new Int32Array(this.data), this.typeInfo, null);\r\n    } else if (this.data instanceof Uint32Array) {\r\n        return new ScalarData(new Uint32Array(this.data), this.typeInfo, null);\r\n    }\r\n    throw `ScalarData: Invalid data type`;\r\n  }\r\n\r\n  get value(): number {\r\n    return this.data[0];\r\n  }\r\n\r\n  set value(v: number) {\r\n    this.data[0] = v;\r\n  }\r\n\r\n  setDataValue(exec: ExecInterface, value: Data, postfix: Expression | null, context: ExecContext): void {\r\n    if (postfix) {\r\n      console.error(`SetDataValue: Scalar data does not support postfix`, postfix);\r\n      return;\r\n    }\r\n\r\n    if (!(value instanceof ScalarData)) {\r\n      console.error(`SetDataValue: Invalid value`, value);\r\n      return;\r\n    }\r\n\r\n    let v = value.data[0];\r\n\r\n    if (this.typeInfo.name === \"i32\" || this.typeInfo.name === \"u32\") {\r\n      v = Math.floor(v);\r\n    } else if (this.typeInfo.name === \"bool\") {\r\n      v = v ? 1 : 0;\r\n    }\r\n\r\n    this.data[0] = v;\r\n  }\r\n\r\n  getSubData(exec: ExecInterface, postfix: Expression | null, context: ExecContext): Data | null {\r\n    if (postfix) {\r\n      console.error(`getSubData: Scalar data does not support postfix`, postfix);\r\n      return null;\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  toString(): string {\r\n    return `${this.value}`;\r\n  }\r\n}\r\n\r\nfunction _getVectorData(exec: ExecInterface, values: number[], formatName: string): VectorData | null {\r\n  const size = values.length;\r\n  if (size === 2) {\r\n      if (formatName === \"f32\") {\r\n          return new VectorData(new Float32Array(values), exec.getTypeInfo(\"vec2f\")!);\r\n      } else if (formatName === \"i32\" || formatName === \"bool\") {\r\n          return new VectorData(new Int32Array(values), exec.getTypeInfo(\"vec2i\")!);\r\n      } else if (formatName === \"u32\") {\r\n          return new VectorData(new Uint32Array(values), exec.getTypeInfo(\"vec2u\")!);\r\n      } else if (formatName === \"f16\") {\r\n          return new VectorData(new Float32Array(values), exec.getTypeInfo(\"vec2h\")!);\r\n      } else {\r\n          console.error(`getSubData: Unknown format ${formatName}`);\r\n      }\r\n      return null;\r\n  }\r\n\r\n  if (size === 3) {\r\n      if (formatName === \"f32\") {\r\n          return new VectorData(new Float32Array(values), exec.getTypeInfo(\"vec3f\")!);\r\n      } else if (formatName === \"i32\" || formatName === \"bool\") {\r\n          return new VectorData(new Int32Array(values), exec.getTypeInfo(\"vec3i\")!);\r\n      } else if (formatName === \"u32\") {\r\n          return new VectorData(new Uint32Array(values), exec.getTypeInfo(\"vec3u\")!);\r\n      } else if (formatName === \"f16\") {\r\n          return new VectorData(new Float32Array(values), exec.getTypeInfo(\"vec3h\")!);\r\n      } else {\r\n          console.error(`getSubData: Unknown format ${formatName}`);\r\n      }\r\n      return null;\r\n  }\r\n\r\n  if (size === 4) {\r\n      if (formatName === \"f32\") {\r\n          return new VectorData(new Float32Array(values), exec.getTypeInfo(\"vec4f\")!);\r\n      } else if (formatName === \"i32\" || formatName === \"bool\") {\r\n          return new VectorData(new Int32Array(values), exec.getTypeInfo(\"vec4i\")!);\r\n      } else if (formatName === \"u32\") {\r\n          return new VectorData(new Uint32Array(values), exec.getTypeInfo(\"vec4u\")!);\r\n      } else if (formatName === \"f16\") {\r\n          return new VectorData(new Float32Array(values), exec.getTypeInfo(\"vec4h\")!);\r\n      }\r\n      console.error(`getSubData: Unknown format ${formatName}`);\r\n      return null;\r\n  }\r\n\r\n  console.error(`getSubData: Invalid vector size ${values.length}`);\r\n  return null;\r\n}\r\n\r\nexport class VectorData extends Data {\r\n  data: Int32Array | Uint32Array | Float32Array;\r\n\r\n  constructor(value: number[] | Float32Array | Uint32Array | Int32Array, typeInfo: TypeInfo, parent: Data | null = null) {\r\n    super(typeInfo, parent);\r\n    if (value instanceof Float32Array || value instanceof Uint32Array || value instanceof Int32Array) {\r\n      this.data = value;\r\n    } else {\r\n      const typename = this.typeInfo.name;\r\n      if (typename === \"vec2f\" || typename === \"vec3f\" || typename === \"vec4f\") {\r\n        this.data = new Float32Array(value);\r\n      } else if (typename === \"vec2i\" || typename === \"vec3i\" || typename === \"vec4i\") {\r\n        this.data = new Int32Array(value);\r\n      } else if (typename === \"vec2u\" || typename === \"vec3u\" || typename === \"vec4u\") {\r\n        this.data = new Uint32Array(value);\r\n      } else if (typename === \"vec2h\" || typename === \"vec3h\" || typename === \"vec4h\") {\r\n        this.data = new Float32Array(value);\r\n      } else if (typename === \"vec2b\" || typename === \"vec3b\" || typename === \"vec4b\") {\r\n        this.data = new Int32Array(value);\r\n      } else if (typename === \"vec2\" || typename === \"vec3\" || typename === \"vec4\") {\r\n        this.data = new Float32Array(value);\r\n      } else {\r\n        console.error(`VectorData: Invalid type ${typename}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  clone(): Data {\r\n    if (this.data instanceof Float32Array) {\r\n      return new VectorData(new Float32Array(this.data), this.typeInfo, null);\r\n    } else if (this.data instanceof Int32Array) {\r\n      return new VectorData(new Int32Array(this.data), this.typeInfo, null);\r\n    } else if (this.data instanceof Uint32Array) {\r\n      return new VectorData(new Uint32Array(this.data), this.typeInfo, null);\r\n    }\r\n    throw `VectorData: Invalid data type`;\r\n  }\r\n\r\n  setDataValue(exec: ExecInterface, value: Data, postfix: Expression | null, context: ExecContext): void {\r\n    if (postfix instanceof StringExpr) {\r\n      console.error(\"TODO: Set vector postfix\");\r\n      return;\r\n    }\r\n\r\n    if (!(value instanceof VectorData)) {\r\n      console.error(`SetDataValue: Invalid value`, value);\r\n      return\r\n    }\r\n\r\n    this.data = value.data;\r\n  }\r\n\r\n  getSubData(exec: ExecInterface, postfix: Expression | null, context: ExecContext): Data | null {\r\n    if (postfix === null) {\r\n      return this;\r\n    }\r\n\r\n    let format = exec.getTypeInfo(\"f32\");\r\n    if (this.typeInfo instanceof TemplateInfo) {\r\n        format = this.typeInfo.format || format;\r\n    } else {\r\n        const typeName = this.typeInfo.name;\r\n        if (typeName === \"vec2f\" || typeName === \"vec3f\" || typeName === \"vec4f\") {\r\n          format = exec.getTypeInfo(\"f32\");\r\n        } else if (typeName === \"vec2i\" || typeName === \"vec3i\" || typeName === \"vec4i\") {\r\n          format = exec.getTypeInfo(\"i32\");\r\n        } else if (typeName === \"vec2b\" || typeName === \"vec3b\" || typeName === \"vec4b\") {\r\n          format = exec.getTypeInfo(\"bool\");\r\n        } else if (typeName === \"vec2u\" || typeName === \"vec3u\" || typeName === \"vec4u\") {\r\n          format = exec.getTypeInfo(\"u32\");\r\n        } else if ( typeName === \"vec2h\" || typeName === \"vec3h\" || typeName === \"vec4h\") {\r\n          format = exec.getTypeInfo(\"f16\");\r\n        } else {\r\n          console.error(`GetSubData: Unknown type ${typeName}`);\r\n        }\r\n    }\r\n\r\n    let self: VectorData | null = this;\r\n    while (postfix !== null && self !== null) {\r\n      if (postfix instanceof ArrayIndex) {\r\n        const idx = postfix.index;\r\n        let i = -1;\r\n        if (idx instanceof LiteralExpr) {\r\n          if (idx.value instanceof ScalarData) {\r\n            i = idx.value.value;\r\n          } else {\r\n            console.error(`GetSubData: Invalid array index ${idx.value}`);\r\n            return null;\r\n          }\r\n        } else {\r\n          const d = exec.evalExpression(idx, context);\r\n          if (d instanceof ScalarData) {\r\n            i = d.value;\r\n          } else {\r\n            console.error(`GetSubData: Unknown index type`, idx);\r\n            return null;\r\n          }\r\n        }\r\n        if (i < 0 || i >= self.data.length) {\r\n          console.error(`GetSubData: Index out of range`, i);\r\n          return null;\r\n        }\r\n\r\n        if (self.data instanceof Float32Array) {\r\n          const d = new Float32Array(self.data.buffer, self.data.byteOffset + i * 4, 1);\r\n          return new ScalarData(d, format!);\r\n        } else if (self.data instanceof Int32Array) {\r\n          const d = new Int32Array(self.data.buffer, self.data.byteOffset + i * 4, 1);\r\n          return new ScalarData(d, format!);\r\n        } else if (self.data instanceof Uint32Array) {\r\n          const d = new Uint32Array(self.data.buffer, self.data.byteOffset + i * 4, 1);\r\n          return new ScalarData(d, format!);\r\n        }\r\n\r\n        throw `GetSubData: Invalid data type`;\r\n      } else if (postfix instanceof StringExpr) {\r\n        const member = postfix.value.toLowerCase();\r\n        if (member.length === 1) {\r\n          let i = 0;\r\n          if (member === \"x\" || member === \"r\") {\r\n            i = 0;\r\n          } else if (member === \"y\" || member === \"g\") {\r\n            i = 1;\r\n          } else if (member === \"z\" || member === \"b\") {\r\n            i = 2;\r\n          } else if (member === \"w\" || member === \"a\") {\r\n            i = 3;\r\n          } else {\r\n            console.error(`GetSubData: Unknown member ${member}`);\r\n            return null;\r\n          }\r\n\r\n          if (this.data instanceof Float32Array) {\r\n            let d = new Float32Array(this.data.buffer, this.data.byteOffset + i * 4, 1);\r\n            return new ScalarData(d, format!, this);\r\n          } else if (this.data instanceof Int32Array) {\r\n            let d = new Int32Array(this.data.buffer, this.data.byteOffset + i * 4, 1);\r\n            return new ScalarData(d, format!, this);\r\n          } else if (this.data instanceof Uint32Array) {\r\n            let d = new Uint32Array(this.data.buffer, this.data.byteOffset + i * 4, 1);\r\n            return new ScalarData(d, format!, this);\r\n          }\r\n        }\r\n\r\n        const values: number[] = [];\r\n        for (const m of member) {\r\n          if (m === \"x\" || m === \"r\") {\r\n            values.push(this.data[0]);\r\n          } else if (m === \"y\" || m === \"g\") {\r\n            values.push(this.data[1]);\r\n          } else if (m === \"z\" || m === \"b\") {\r\n            values.push(this.data[2]);\r\n          } else if (m === \"w\" || m === \"a\") {\r\n            values.push(this.data[3]);\r\n          } else {\r\n            console.error(`GetDataValue: Unknown member ${m}`);\r\n          }\r\n        }\r\n\r\n        self = _getVectorData(exec, values, format.name);\r\n      } else {\r\n        console.error(`GetSubData: Unknown postfix`, postfix);\r\n        return null;\r\n      }\r\n\r\n      postfix = postfix.postfix;\r\n    }\r\n\r\n    return self;\r\n  }\r\n\r\n  toString(): string {\r\n    let s = `${this.data[0]}`;\r\n    for (let i = 1; i < this.data.length; ++i) {\r\n      s += `, ${this.data[i]}`;\r\n    }\r\n    return s;\r\n  }\r\n}\r\n\r\nexport class MatrixData extends Data {\r\n  data: Float32Array;\r\n\r\n  constructor(value: number[] | Float32Array, typeInfo: TypeInfo, parent: Data | null = null) {\r\n    super(typeInfo, parent);\r\n    if (value instanceof Float32Array) {\r\n      this.data = value;\r\n    } else {\r\n      this.data = new Float32Array(value);\r\n    }\r\n  }\r\n\r\n  clone(): Data {\r\n    return new MatrixData(new Float32Array(this.data), this.typeInfo, null);\r\n  }\r\n\r\n  setDataValue(exec: ExecInterface, value: Data, postfix: Expression | null, context: ExecContext): void {\r\n    if (postfix instanceof StringExpr) {\r\n      console.error(\"TODO: Set matrix postfix\");\r\n      return;\r\n    }\r\n\r\n    if (!(value instanceof MatrixData)) {\r\n      console.error(`SetDataValue: Invalid value`, value);\r\n      return\r\n    }\r\n\r\n    this.data = value.data;\r\n  }\r\n\r\n  getSubData(exec: ExecInterface, postfix: Expression | null, context: ExecContext): Data | null {\r\n    if (postfix === null) {\r\n      return this;\r\n    }\r\n\r\n    const typeName = this.typeInfo.name;\r\n    let format = exec.getTypeInfo(\"f32\");\r\n    if (this.typeInfo instanceof TemplateInfo) {\r\n      format = this.typeInfo.format;\r\n    } else {\r\n      if (typeName.endsWith(\"f\")) {\r\n        format = exec.getTypeInfo(\"f32\");\r\n      } else if (typeName.endsWith(\"i\")) {\r\n        format = exec.getTypeInfo(\"i32\");\r\n      } else if (typeName.endsWith(\"u\")) {\r\n        format = exec.getTypeInfo(\"u32\");\r\n      } else if ( typeName.endsWith(\"h\")) {\r\n        format = exec.getTypeInfo(\"f16\");\r\n      } else {\r\n        console.error(`GetDataValue: Unknown type ${typeName}`);\r\n        return null;\r\n      }\r\n    }\r\n\r\n    if (postfix instanceof ArrayIndex) {\r\n      const idx = postfix.index;\r\n      let i = -1;\r\n      if (idx instanceof LiteralExpr) {\r\n        if (idx.value instanceof ScalarData) {\r\n          i = idx.value.value;\r\n        } else {\r\n          console.error(`GetDataValue: Invalid array index ${idx.value}`);\r\n          return null;\r\n        }\r\n      } else {\r\n        const d = exec.evalExpression(idx, context);\r\n        if (d instanceof ScalarData) {\r\n          i = d.value;\r\n        } else {\r\n          console.error(`GetDataValue: Unknown index type`, idx);\r\n          return null;\r\n        }\r\n      }\r\n      if (i < 0 || i >= this.data.length) {\r\n        console.error(`GetDataValue: Index out of range`, i);\r\n        return null;\r\n      }\r\n\r\n      const formatSuffix = typeName.endsWith(\"h\") ? \"h\" : \"f\";\r\n\r\n      let vectorData: VectorData;\r\n      if (typeName === \"mat2x2\" || typeName === \"mat2x2f\" || typeName === \"mat2x2h\" ||\r\n          typeName === \"mat3x2\" || typeName === \"mat3x2f\" || typeName === \"mat3x2h\" ||\r\n          typeName === \"mat4x2\" || typeName === \"mat4x2f\" || typeName === \"mat4x2h\") {\r\n        vectorData = new VectorData(new Float32Array(this.data.buffer, this.data.byteOffset + i * 2 * 4, 2), exec.getTypeInfo(`vec2${formatSuffix}`)!);\r\n      } else if (typeName === \"mat2x3\" || typeName === \"mat2x3f\" || typeName === \"mat2x3h\" ||\r\n                typeName === \"mat3x3\" || typeName === \"mat3x3f\" || typeName === \"mat3x3h\" ||\r\n                typeName === \"mat4x3\" || typeName === \"mat4x3f\" || typeName === \"mat4x3h\") {\r\n        vectorData = new VectorData(new Float32Array(this.data.buffer, this.data.byteOffset + i * 3 * 4, 3), exec.getTypeInfo(`vec3${formatSuffix}`)!);\r\n      } else if (typeName === \"mat2x4\" || typeName === \"mat2x4f\" || typeName === \"mat2x4h\" ||\r\n                typeName === \"mat3x4\" || typeName === \"mat3x4f\" || typeName === \"mat3x4h\" ||\r\n                typeName === \"mat4x4\" || typeName === \"mat4x4f\" || typeName === \"mat4x4h\") {\r\n        vectorData = new VectorData(new Float32Array(this.data.buffer, this.data.byteOffset + i * 4 * 4, 4), exec.getTypeInfo(`vec4${formatSuffix}`)!);\r\n      } else {\r\n        console.error(`GetDataValue: Unknown type ${typeName}`);\r\n        return null;\r\n      }\r\n\r\n      if (postfix.postfix) {\r\n        return vectorData.getSubData(exec, postfix.postfix, context);\r\n      }\r\n\r\n      return vectorData;\r\n    } else {\r\n      console.error(`GetDataValue: Invalid postfix`, postfix);\r\n      return null;\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  toString(): string {\r\n    let s = `${this.data[0]}`;\r\n    for (let i = 1; i < this.data.length; ++i) {\r\n      s += `, ${this.data[i]}`;\r\n    }\r\n    return s;\r\n  }\r\n}\r\n\r\n// Used to store array and struct data\r\nexport class TypedData extends Data {\r\n  buffer: ArrayBuffer;\r\n  offset: number;\r\n\r\n  constructor(data: ArrayBuffer | Float32Array | Uint32Array | Int32Array | Uint8Array | Int8Array,\r\n      typeInfo: TypeInfo, offset: number = 0, parent: Data | null = null) {\r\n    super(typeInfo, parent);\r\n    this.buffer = data instanceof ArrayBuffer ? data : data.buffer;\r\n    this.offset = offset;\r\n  }\r\n\r\n  clone(): Data {\r\n    const cloned = new Uint8Array(new Uint8Array(this.buffer, this.offset, this.typeInfo.size));\r\n    return new TypedData(cloned.buffer, this.typeInfo, 0, null);\r\n  }\r\n\r\n  setDataValue(exec: ExecInterface, value: Data, postfix: Expression | null, context: ExecContext): void {\r\n    if (value === null) {\r\n      console.log(`setDataValue: NULL data.`);\r\n      return;\r\n    }\r\n\r\n    let offset = this.offset;\r\n    let typeInfo = this.typeInfo;\r\n    while (postfix) {\r\n      if (postfix instanceof ArrayIndex) {\r\n        if (typeInfo instanceof ArrayInfo) {\r\n          const idx = postfix.index;\r\n          if (idx instanceof LiteralExpr) {\r\n            if (idx.value instanceof ScalarData) {\r\n              offset += idx.value.value * typeInfo.stride;\r\n            } else {\r\n              console.error(`SetDataValue: Invalid index type ${idx.value}`);\r\n              return;\r\n            }\r\n          } else {\r\n            const i = exec.evalExpression(idx, context);\r\n            if (i instanceof ScalarData) {\r\n              offset += i.value * typeInfo.stride;\r\n            } else {\r\n              console.error(`SetDataValue: Unknown index type`, idx);\r\n              return;\r\n            }\r\n          }\r\n          typeInfo = typeInfo.format;\r\n        } else {\r\n          console.error(`SetDataValue: Type ${typeInfo.getTypeName()} is not an array`);\r\n        }\r\n      } else if (postfix instanceof StringExpr) {\r\n        const member = postfix.value;\r\n        if (typeInfo instanceof StructInfo) {\r\n          let found = false;\r\n          for (const m of typeInfo.members) {\r\n            if (m.name === member) {\r\n              offset += m.offset;\r\n              typeInfo = m.type;\r\n              found = true;\r\n              break;\r\n            }\r\n          }\r\n          if (!found) {\r\n            console.error(`SetDataValue: Member ${member} not found`);\r\n            return;\r\n          }\r\n        } else if (typeInfo instanceof TypeInfo) {\r\n          const typeName = typeInfo.getTypeName();\r\n          let element = 0;\r\n          if (member === \"x\" || member === \"r\") {\r\n            element = 0;\r\n          } else if (member === \"y\" || member === \"g\") {\r\n            element = 1;\r\n          } else if (member === \"z\" || member === \"b\") {\r\n            element = 2;\r\n          } else if (member === \"w\" || member === \"a\") {\r\n            element = 3;\r\n          } else {\r\n            console.error(`SetDataValue: Unknown member ${member}`);\r\n            return;\r\n          }\r\n          if (!(value instanceof ScalarData)) {\r\n            console.error(`SetDataValue: Invalid value`, value);\r\n            return;\r\n          }\r\n          const v = value.value;\r\n          if (typeName === \"vec2f\") {\r\n            new Float32Array(this.buffer, offset, 2)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec3f\") {\r\n            new Float32Array(this.buffer, offset, 3)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec4f\") {\r\n            new Float32Array(this.buffer, offset, 4)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec2i\") {\r\n            new Int32Array(this.buffer, offset, 2)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec3i\") {\r\n            new Int32Array(this.buffer, offset, 3)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec4i\") {\r\n            new Int32Array(this.buffer, offset, 4)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec2u\") {\r\n            new Uint32Array(this.buffer, offset, 2)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec3u\") {\r\n            new Uint32Array(this.buffer, offset, 3)[element] = v;\r\n            return;\r\n          } else if (typeName === \"vec4u\") {\r\n            new Uint32Array(this.buffer, offset, 4)[element] = v;\r\n            return;\r\n          }\r\n          console.error(`SetDataValue: Type ${typeName} is not a struct`);\r\n          return;\r\n        }\r\n      } else {\r\n        console.error(`SetDataValue: Unknown postfix type`, postfix);\r\n        return;\r\n      }\r\n      postfix = postfix.postfix;\r\n    }\r\n\r\n    this.setData(exec, value, typeInfo, offset, context);\r\n  }\r\n\r\n  setData(exec: ExecInterface, value: Data, typeInfo: TypeInfo, offset: number, context: ExecContext): void {\r\n    const typeName = typeInfo.getTypeName();\r\n\r\n    if (typeName === \"f32\" || typeName === \"f16\") {\r\n      if (value instanceof ScalarData) {\r\n        new Float32Array(this.buffer, offset, 1)[0] = value.value;\r\n      }\r\n      return;\r\n    } else if (typeName === \"i32\" || typeName === \"atomic<i32>\" || typeName === \"x32\") {\r\n      if (value instanceof ScalarData) {\r\n        new Int32Array(this.buffer, offset, 1)[0] = value.value;\r\n      }\r\n      return;\r\n    } else if (typeName === \"u32\" || typeName === \"atomic<u32>\") {\r\n      if (value instanceof ScalarData) {\r\n        new Uint32Array(this.buffer, offset, 1)[0] = value.value;\r\n      }\r\n      return;\r\n    } else if (typeName === \"bool\") {\r\n      if (value instanceof ScalarData) {\r\n        new Int32Array(this.buffer, offset, 1)[0] = value.value;\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec2f\" || typeName === \"vec2h\") {\r\n      const x = new Float32Array(this.buffer, offset, 2);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec3f\" || typeName === \"vec3h\") {\r\n      const x = new Float32Array(this.buffer, offset, 3);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec4f\" || typeName === \"vec4h\") {\r\n      const x = new Float32Array(this.buffer, offset, 4);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec2i\") {\r\n      const x = new Int32Array(this.buffer, offset, 2);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec3i\") {\r\n      const x = new Int32Array(this.buffer, offset, 3);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec4i\") {\r\n      const x = new Int32Array(this.buffer, offset, 4);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec2u\") {\r\n      const x = new Uint32Array(this.buffer, offset, 2);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec3u\") {\r\n      const x = new Uint32Array(this.buffer, offset, 3);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec4u\") {\r\n      const x = new Uint32Array(this.buffer, offset, 4);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec2b\") {\r\n      const x = new Uint32Array(this.buffer, offset, 2);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec3b\") {\r\n      const x = new Uint32Array(this.buffer, offset, 3);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n      }\r\n      return;\r\n    } else if (typeName === \"vec4b\") {\r\n      const x = new Uint32Array(this.buffer, offset, 4);\r\n      if (value instanceof VectorData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat2x2f\" || typeName === \"mat2x2h\") {\r\n      const x = new Float32Array(this.buffer, offset, 4);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat2x3f\" || typeName === \"mat2x3h\") {\r\n      const x = new Float32Array(this.buffer, offset, 6);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat2x4f\" || typeName === \"mat2x4h\") {\r\n      const x = new Float32Array(this.buffer, offset, 8);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n        x[6] = value.data[6];\r\n        x[7] = value.data[7];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n        x[6] = value[6];\r\n        x[7] = value[7];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat3x2f\" || typeName === \"mat3x2h\") {\r\n      const x = new Float32Array(this.buffer, offset, 6);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat3x3f\" || typeName === \"mat3x3h\") {\r\n      const x = new Float32Array(this.buffer, offset, 9);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n        x[6] = value.data[6];\r\n        x[7] = value.data[7];\r\n        x[8] = value.data[8];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n        x[6] = value[6];\r\n        x[7] = value[7];\r\n        x[8] = value[8];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat3x4f\" || typeName === \"mat3x4h\") {\r\n      const x = new Float32Array(this.buffer, offset, 12);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n        x[6] = value.data[6];\r\n        x[7] = value.data[7];\r\n        x[8] = value.data[8];\r\n        x[9] = value.data[9];\r\n        x[10] = value.data[10];\r\n        x[11] = value.data[11];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n        x[6] = value[6];\r\n        x[7] = value[7];\r\n        x[8] = value[8];\r\n        x[9] = value[9];\r\n        x[10] = value[10];\r\n        x[11] = value[11];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat4x2f\" || typeName === \"mat4x2h\") {\r\n      const x = new Float32Array(this.buffer, offset, 8);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n        x[6] = value.data[6];\r\n        x[7] = value.data[7];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n        x[6] = value[6];\r\n        x[7] = value[7];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat4x3f\" || typeName === \"mat4x3h\") {\r\n      const x = new Float32Array(this.buffer, offset, 12);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n        x[6] = value.data[6];\r\n        x[7] = value.data[7];\r\n        x[8] = value.data[8];\r\n        x[9] = value.data[9];\r\n        x[10] = value.data[10];\r\n        x[11] = value.data[11];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n        x[6] = value[6];\r\n        x[7] = value[7];\r\n        x[8] = value[8];\r\n        x[9] = value[9];\r\n        x[10] = value[10];\r\n        x[11] = value[11];\r\n      }\r\n      return;\r\n    } else if (typeName === \"mat4x4f\" || typeName === \"mat4x4h\") {\r\n      const x = new Float32Array(this.buffer, offset, 16);\r\n      if (value instanceof MatrixData) {\r\n        x[0] = value.data[0];\r\n        x[1] = value.data[1];\r\n        x[2] = value.data[2];\r\n        x[3] = value.data[3];\r\n        x[4] = value.data[4];\r\n        x[5] = value.data[5];\r\n        x[6] = value.data[6];\r\n        x[7] = value.data[7];\r\n        x[8] = value.data[8];\r\n        x[9] = value.data[9];\r\n        x[10] = value.data[10];\r\n        x[11] = value.data[11];\r\n        x[12] = value.data[12];\r\n        x[13] = value.data[13];\r\n        x[14] = value.data[14];\r\n        x[15] = value.data[15];\r\n      } else {\r\n        x[0] = value[0];\r\n        x[1] = value[1];\r\n        x[2] = value[2];\r\n        x[3] = value[3];\r\n        x[4] = value[4];\r\n        x[5] = value[5];\r\n        x[6] = value[6];\r\n        x[7] = value[7];\r\n        x[8] = value[8];\r\n        x[9] = value[9];\r\n        x[10] = value[10];\r\n        x[11] = value[11];\r\n        x[12] = value[12];\r\n        x[13] = value[13];\r\n        x[14] = value[14];\r\n        x[15] = value[15];\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (value instanceof TypedData) {\r\n      if (typeInfo === value.typeInfo) {\r\n        const x = new Uint8Array(this.buffer, offset, value.buffer.byteLength);\r\n        x.set(new Uint8Array(value.buffer));\r\n        return;\r\n      } else {\r\n        console.error(`SetDataValue: Type mismatch`, typeName, value.typeInfo.getTypeName());\r\n        return;\r\n      }\r\n    }\r\n\r\n    console.error(`SetData: Unknown type ${typeName}`);\r\n  }\r\n\r\n  getSubData(exec: ExecInterface, postfix: Expression | null, context: ExecContext): Data | null {\r\n    if (postfix === null) {\r\n      return this;\r\n    }\r\n\r\n    let offset = this.offset;\r\n    let typeInfo = this.typeInfo;\r\n    while (postfix) {\r\n      if (postfix instanceof ArrayIndex) {\r\n        const idx = postfix.index;\r\n        const _i = idx instanceof Expression ? exec.evalExpression(idx, context) : idx;\r\n        let i = 0;\r\n        if (_i instanceof ScalarData) {\r\n          i = _i.value;\r\n        } else if (typeof _i === \"number\") {\r\n          i = _i;\r\n        } else {\r\n          console.error(`GetDataValue: Invalid index type`, idx);\r\n        }\r\n        if (typeInfo instanceof ArrayInfo) {\r\n          offset += i * typeInfo.stride;\r\n          typeInfo = typeInfo.format;\r\n        } else {\r\n          const typeName = typeInfo.getTypeName();\r\n          if (typeName === \"mat4x4\" || typeName === \"mat4x4f\" || typeName === \"mat4x4h\") {\r\n            offset += i * 16;\r\n            typeInfo = exec.getTypeInfo(\"vec4f\")!;\r\n          } else {\r\n            console.error(`getDataValue: Type ${typeInfo.getTypeName()} is not an array`);\r\n          }\r\n        }\r\n      } else if (postfix instanceof StringExpr) {\r\n        const member = postfix.value;\r\n        if (typeInfo instanceof StructInfo) {\r\n          let found = false;\r\n          for (const m of typeInfo.members) {\r\n            if (m.name === member) {\r\n              offset += m.offset;\r\n              typeInfo = m.type;\r\n              found = true;\r\n              break;\r\n            }\r\n          }\r\n          if (!found) {\r\n            console.error(`GetDataValue: Member ${member} not found`);\r\n            return null;\r\n          }\r\n        } else if (typeInfo instanceof TypeInfo) {\r\n          const typeName = typeInfo.getTypeName();\r\n          if (typeName === \"vec2f\" || typeName === \"vec3f\" || typeName === \"vec4f\" ||\r\n              typeName === \"vec2i\" || typeName === \"vec3i\" || typeName === \"vec4i\" ||\r\n              typeName === \"vec2u\" || typeName === \"vec3u\" || typeName === \"vec4u\" ||\r\n              typeName === \"vec2b\" || typeName === \"vec3b\" || typeName === \"vec4b\" ||\r\n              typeName === \"vec2h\" || typeName === \"vec3h\" || typeName === \"vec4h\" ||\r\n              typeName === \"vec2\" || typeName === \"vec3\" || typeName === \"vec4\") {\r\n\r\n            if (member.length > 0 && member.length < 5) {\r\n              let formatName = \"f32\";\r\n              let formatSuffix = \"f\";\r\n              const value: number[] = [];\r\n              for (let i = 0; i < member.length; ++i) {\r\n                const m = member[i].toLowerCase();\r\n                let element = 0;\r\n                if (m === \"x\" || m === \"r\") {\r\n                  element = 0;\r\n                } else if (m === \"y\" || m === \"g\") {\r\n                  element = 1;\r\n                } else if (m === \"z\" || m === \"b\") {\r\n                  element = 2;\r\n                } else if (m === \"w\" || m === \"a\") {\r\n                  element = 3;\r\n                } else {\r\n                  console.error(`Unknown member ${member}`);\r\n                  return null;\r\n                }\r\n\r\n                if (member.length === 1) {\r\n                  if (typeName.endsWith(\"f\")) {\r\n                    if (this.buffer.byteLength < (offset + element * 4 + 4)) {\r\n                      console.log(\"Insufficient buffer data\");\r\n                      return null;\r\n                    }\r\n                    return new ScalarData(new Float32Array(this.buffer, offset + element * 4, 1), exec.getTypeInfo(\"f32\")!, this);\r\n                  } else if (typeName.endsWith(\"h\")) {\r\n                    return new ScalarData(new Float32Array(this.buffer, offset + element * 4, 1), exec.getTypeInfo(\"f16\")!, this);\r\n                  } else if (typeName.endsWith(\"i\")) {\r\n                    return new ScalarData(new Int32Array(this.buffer, offset + element * 4, 1), exec.getTypeInfo(\"i32\")!, this);\r\n                  } else if (typeName.endsWith(\"b\")) {\r\n                    return new ScalarData(new Int32Array(this.buffer, offset + element * 4, 1), exec.getTypeInfo(\"bool\")!, this);\r\n                  } else if (typeName.endsWith(\"u\")) {\r\n                    return new ScalarData(new Uint32Array(this.buffer, offset + element * 4, 1), exec.getTypeInfo(\"i32\")!, this);\r\n                  }\r\n                }\r\n\r\n                if (typeName === \"vec2f\") {\r\n                  value.push(new Float32Array(this.buffer, offset, 2)[element]);\r\n                } else if (typeName === \"vec3f\") {\r\n                  if ((offset + 12) >= this.buffer.byteLength) {\r\n                    console.log(\"Insufficient buffer data\");\r\n                    return null;\r\n                  }\r\n                  const fa = new Float32Array(this.buffer, offset, 3);\r\n                  value.push(fa[element]);\r\n                } else if (typeName === \"vec4f\") {\r\n                  value.push(new Float32Array(this.buffer, offset, 4)[element]);\r\n                } else if (typeName === \"vec2i\") {\r\n                  formatName = \"i32\";\r\n                  formatSuffix = \"i\";\r\n                  value.push(new Int32Array(this.buffer, offset, 2)[element]);\r\n                } else if (typeName === \"vec3i\") {\r\n                  formatName = \"i32\";\r\n                  formatSuffix = \"i\";\r\n                  value.push(new Int32Array(this.buffer, offset, 3)[element]);\r\n                } else if (typeName === \"vec4i\") {\r\n                  formatName = \"i32\";\r\n                  formatSuffix = \"i\";\r\n                  value.push(new Int32Array(this.buffer, offset, 4)[element]);\r\n                } else if (typeName === \"vec2u\") {\r\n                  formatName = \"u32\";\r\n                  formatSuffix = \"u\";\r\n                  const ua = new Uint32Array(this.buffer, offset, 2);\r\n                  value.push(ua[element]);\r\n                } else if (typeName === \"vec3u\") {\r\n                  formatName = \"u32\";\r\n                  formatSuffix = \"u\";\r\n                  value.push(new Uint32Array(this.buffer, offset, 3)[element]);\r\n                } else if (typeName === \"vec4u\") {\r\n                  formatName = \"u32\";\r\n                  formatSuffix = \"u\";\r\n                  value.push(new Uint32Array(this.buffer, offset, 4)[element]);\r\n                }\r\n              }\r\n\r\n              if (value.length === 2) {\r\n                typeInfo = exec.getTypeInfo(`vec2${formatSuffix}`)!;\r\n              } else if (value.length === 3) {\r\n                typeInfo = exec.getTypeInfo(`vec3${formatSuffix}`)!;\r\n              } else if (value.length === 4) {\r\n                typeInfo = exec.getTypeInfo(`vec4${formatSuffix}`)!;\r\n              } else {\r\n                console.error(`GetDataValue: Invalid vector length ${value.length}`);\r\n              }\r\n\r\n              return new VectorData(value, typeInfo, null);\r\n            } else {\r\n              console.error(`GetDataValue: Unknown member ${member}`);\r\n              return null;\r\n            }\r\n          }\r\n\r\n          console.error(`GetDataValue: Type ${typeName} is not a struct`);\r\n          return null;\r\n        }\r\n      } else {\r\n        console.error(`GetDataValue: Unknown postfix type`, postfix);\r\n        return null;\r\n      }\r\n\r\n      postfix = postfix.postfix;\r\n    }\r\n\r\n    const typeName = typeInfo.getTypeName();\r\n\r\n    if (typeName === \"f32\") {\r\n      return new ScalarData(new Float32Array(this.buffer, offset, 1), typeInfo, this);\r\n    } else if (typeName === \"i32\") {\r\n      return new ScalarData(new Int32Array(this.buffer, offset, 1), typeInfo, this);\r\n    } else if (typeName === \"u32\") {\r\n      return new ScalarData(new Uint32Array(this.buffer, offset, 1), typeInfo, this);\r\n    } else if (typeName === \"vec2f\") {\r\n      return new VectorData(new Float32Array(this.buffer, offset, 2), typeInfo, this);\r\n    } else if (typeName === \"vec3f\") {\r\n      return new VectorData(new Float32Array(this.buffer, offset, 3), typeInfo, this);\r\n    } else if (typeName === \"vec4f\") {\r\n      return new VectorData(new Float32Array(this.buffer, offset, 4), typeInfo, this);\r\n    } else if (typeName === \"vec2i\") {\r\n      return new VectorData(new Int32Array(this.buffer, offset, 2), typeInfo, this);\r\n    } else if (typeName === \"vec3i\") {\r\n      return new VectorData(new Int32Array(this.buffer, offset, 3), typeInfo, this);\r\n    } else if (typeName === \"vec4i\") {\r\n      return new VectorData(new Int32Array(this.buffer, offset, 4), typeInfo, this);\r\n    } else if (typeName === \"vec2u\") {\r\n      return new VectorData(new Uint32Array(this.buffer, offset, 2), typeInfo, this);\r\n    } else if (typeName === \"vec3u\") {\r\n      return new VectorData(new Uint32Array(this.buffer, offset, 3), typeInfo, this);\r\n    } else if (typeName === \"vec4u\") {\r\n      return new VectorData(new Uint32Array(this.buffer, offset, 4), typeInfo, this);\r\n    }\r\n\r\n    if (typeInfo instanceof TemplateInfo && typeInfo.name === \"atomic\") {\r\n      if (typeInfo.format?.name === \"u32\") {\r\n        return new ScalarData(new Uint32Array(this.buffer, offset, 1)[0], typeInfo.format, this);\r\n      } else if (typeInfo.format?.name === \"i32\") {\r\n        return new ScalarData(new Int32Array(this.buffer, offset, 1)[0], typeInfo.format, this);\r\n      } else {\r\n        console.error(`GetDataValue: Invalid atomic format ${typeInfo.format?.name}`);\r\n        return null;\r\n      }\r\n    }\r\n\r\n    return new TypedData(this.buffer, typeInfo, offset, this);\r\n  }\r\n\r\n  toString(): string {\r\n    let s = \"\";\r\n    if (this.typeInfo instanceof ArrayInfo) {\r\n      if (this.typeInfo.format.name === \"f32\") {\r\n        const fa = new Float32Array(this.buffer, this.offset);\r\n        s = `[${fa[0]}`;\r\n        for (let i = 1; i < fa.length; ++i) {\r\n          s += `, ${fa[i]}`;\r\n        }\r\n      } else if (this.typeInfo.format.name === \"i32\") {\r\n        const fa = new Int32Array(this.buffer, this.offset);\r\n        s = `[${fa[0]}`;\r\n        for (let i = 1; i < fa.length; ++i) {\r\n          s += `, ${fa[i]}`;\r\n        }\r\n      } else if (this.typeInfo.format.name === \"u32\") {\r\n        const fa = new Uint32Array(this.buffer, this.offset);\r\n        s = `[${fa[0]}`;\r\n        for (let i = 1; i < fa.length; ++i) {\r\n          s += `, ${fa[i]}`;\r\n        }\r\n      } else if (this.typeInfo.format.name === \"vec2f\") {\r\n        const fa = new Float32Array(this.buffer, this.offset);\r\n        s = `[${fa[0]}, ${fa[1]}]`;\r\n        for (let i = 1; i < fa.length / 2; ++i) {\r\n          s += `, [${fa[i * 2]}, ${fa[i * 2 + 1]}]`;\r\n        }\r\n      } else if (this.typeInfo.format.name === \"vec3f\") {\r\n        const fa = new Float32Array(this.buffer, this.offset);\r\n        s = `[${fa[0]}, ${fa[1]}, ${fa[2]}]`;\r\n        for (let i = 4; i < fa.length; i += 4) {\r\n          s += `, [${fa[i]}, ${fa[i + 1]}, ${fa[i + 2]}]`;\r\n        }\r\n      } else if (this.typeInfo.format.name === \"vec4f\") {\r\n        const fa = new Float32Array(this.buffer, this.offset);\r\n        s = `[${fa[0]}, ${fa[1]}, ${fa[2]}, ${fa[3]}]`;\r\n        for (let i = 4; i < fa.length; i += 4) {\r\n          s += `, [${fa[i]}, ${fa[i + 1]}, ${fa[i + 2]}, ${fa[i + 3]}]`;\r\n        }\r\n      } else {\r\n        s = `[...]`;\r\n      }\r\n    } else if (this.typeInfo instanceof StructInfo) {\r\n      s += `{...}`;\r\n    } else {\r\n      s = `[...]`;\r\n    }\r\n    return s;\r\n  }\r\n}\r\n\r\nexport class TextureData extends Data {\r\n  data: Array<ArrayBuffer>;\r\n  descriptor: Object;\r\n  view: Object | null;\r\n\r\n  constructor(data: Array<ArrayBuffer | Float32Array | Uint32Array | Int32Array | Uint8Array | Int8Array>,\r\n      typeInfo: TypeInfo, descriptor: Object, view: Object | null) {\r\n      super(typeInfo, null);\r\n      this.data = data;\r\n      this.descriptor = descriptor;\r\n      this.view = view;\r\n  }\r\n\r\n  clone(): Data {\r\n    return new TextureData(this.data, this.typeInfo, this.descriptor, this.view);\r\n  }\r\n\r\n  get width(): number {\r\n    const size = this.descriptor[\"size\"];\r\n    if (size instanceof Array && size.length > 0) {\r\n      return size[0] ?? 0;\r\n    } else if (size instanceof Object) {\r\n      return size[\"width\"] ?? 0;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  get height(): number {\r\n    const size = this.descriptor[\"size\"];\r\n    if (size instanceof Array && size.length > 1) {\r\n      return size[1] ?? 0;\r\n    } else if (size instanceof Object) {\r\n      return size[\"height\"] ?? 0;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  get depthOrArrayLayers(): number {\r\n    const size = this.descriptor[\"size\"];\r\n    if (size instanceof Array && size.length > 2) {\r\n      return size[2] ?? 0;\r\n    } else if (size instanceof Object) {\r\n      return size[\"depthOrArrayLayers\"] ?? 0;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  get format(): string {\r\n    if (this.descriptor) {\r\n      return this.descriptor[\"format\"] ?? \"rgba8unorm\";\r\n    }\r\n    return \"rgba8unorm\";\r\n  }\r\n\r\n  get sampleCount(): number {\r\n    if (this.descriptor) {\r\n      return this.descriptor[\"sampleCount\"] ?? 1;\r\n    }\r\n    return 1;\r\n  }\r\n\r\n  get mipLevelCount(): number {\r\n    if (this.descriptor) {\r\n      return this.descriptor[\"mipLevelCount\"] ?? 1;\r\n    }\r\n    return 1;\r\n  }\r\n\r\n  get dimension(): string {\r\n    if (this.descriptor) {\r\n      return this.descriptor[\"dimension\"] ?? \"2d\";\r\n    }\r\n    return \"2d\";\r\n  }\r\n\r\n  getMipLevelSize(level: number): number[] {\r\n    if (level >= this.mipLevelCount) {\r\n      return [0, 0, 0];\r\n    }\r\n\r\n    const size = [this.width, this.height, this.depthOrArrayLayers];\r\n    for (let i = 0; i < size.length; ++i) {\r\n      size[i] = Math.max(1, size[i] >> level);\r\n    }\r\n\r\n    return size;\r\n  }\r\n\r\n  get texelByteSize(): number {\r\n    const format = this.format;\r\n    const formatInfo = TextureFormatInfo[format];\r\n    if (!formatInfo) {\r\n      return 0;\r\n    }\r\n    if (formatInfo.isDepthStencil) {\r\n      return 4; // depth textures have r32float imageData\r\n    }\r\n    return formatInfo.bytesPerBlock;\r\n  }\r\n\r\n  get bytesPerRow(): number {\r\n    const width = this.width;\r\n    const texelByteSize = this.texelByteSize;\r\n    //return (width * texelByteSize + 255) & ~0xff; // bytesPerRow is aligned to a multiple of 256 bytes\r\n    return width * texelByteSize;\r\n  }\r\n\r\n  get isDepthStencil(): boolean {\r\n    const format = this.format;\r\n    const formatInfo = TextureFormatInfo[format];\r\n    if (!formatInfo) {\r\n      return false;\r\n    }\r\n    return formatInfo.isDepthStencil;\r\n  }\r\n\r\n  getGpuSize(): number {\r\n    const format = this.format;\r\n    const formatInfo = TextureFormatInfo[format];\r\n    const width = this.width;\r\n    if (!format || width <= 0 || !formatInfo) {\r\n      return -1;\r\n    }\r\n\r\n    const height = this.height;\r\n    const depthOrArrayLayers = this.depthOrArrayLayers;\r\n    const dimension = this.dimension;\r\n    const blockWidth = width / formatInfo.blockWidth;\r\n    const blockHeight = dimension === \"1d\" ? 1 : height / formatInfo.blockHeight;\r\n    const bytesPerBlock = formatInfo.bytesPerBlock;\r\n\r\n    return blockWidth * blockHeight * bytesPerBlock * depthOrArrayLayers;\r\n  }\r\n\r\n  getPixel(x: number, y: number, z: number = 0, mipLevel: number = 0): number[] | null {\r\n    const texelByteSize = this.texelByteSize;\r\n    const bytesPerRow = this.bytesPerRow;\r\n    const height = this.height;\r\n    const buffer = this.data[mipLevel];\r\n    const imageData = new Uint8Array(buffer);\r\n    return getTexturePixel(imageData, x, y, z, mipLevel, height, bytesPerRow, texelByteSize, this.format);\r\n  }\r\n\r\n  setPixel(x: number, y: number, z: number, mipLevel: number, value: number[]): void {\r\n    const texelByteSize = this.texelByteSize;\r\n    const bytesPerRow = this.bytesPerRow;\r\n    const height = this.height;\r\n    const buffer = this.data[mipLevel];\r\n    const imageData = new Uint8Array(buffer);\r\n    setTexturePixel(imageData, x, y, z, mipLevel, height, bytesPerRow, texelByteSize, this.format, value);\r\n  }\r\n}\r\n", "export enum TokenClass {\r\n  token,\r\n  keyword,\r\n  reserved,\r\n}\r\n\r\nexport class TokenType {\r\n  name: string;\r\n  type: TokenClass;\r\n  rule: RegExp | string;\r\n\r\n  constructor(name: string, type: TokenClass, rule: RegExp | string) {\r\n    this.name = name;\r\n    this.type = type;\r\n    this.rule = rule;\r\n  }\r\n\r\n  toString(): string {\r\n    return this.name;\r\n  }\r\n}\r\n\r\n/// Catalog of defined token types, keywords, and reserved words.\r\nexport class TokenTypes {\r\n  static readonly none = new TokenType(\"\", TokenClass.reserved, \"\");\r\n  static readonly eof = new TokenType(\"EOF\", TokenClass.token, \"\");\r\n\r\n  static readonly reserved = {\r\n    asm: new TokenType(\"asm\", TokenClass.reserved, \"asm\"),\r\n    bf16: new TokenType(\"bf16\", TokenClass.reserved, \"bf16\"),\r\n    do: new TokenType(\"do\", TokenClass.reserved, \"do\"),\r\n    enum: new TokenType(\"enum\", TokenClass.reserved, \"enum\"),\r\n    f16: new TokenType(\"f16\", TokenClass.reserved, \"f16\"),\r\n    f64: new TokenType(\"f64\", TokenClass.reserved, \"f64\"),\r\n    handle: new TokenType(\"handle\", TokenClass.reserved, \"handle\"),\r\n    i8: new TokenType(\"i8\", TokenClass.reserved, \"i8\"),\r\n    i16: new TokenType(\"i16\", TokenClass.reserved, \"i16\"),\r\n    i64: new TokenType(\"i64\", TokenClass.reserved, \"i64\"),\r\n    mat: new TokenType(\"mat\", TokenClass.reserved, \"mat\"),\r\n    premerge: new TokenType(\"premerge\", TokenClass.reserved, \"premerge\"),\r\n    regardless: new TokenType(\"regardless\", TokenClass.reserved, \"regardless\"),\r\n    typedef: new TokenType(\"typedef\", TokenClass.reserved, \"typedef\"),\r\n    u8: new TokenType(\"u8\", TokenClass.reserved, \"u8\"),\r\n    u16: new TokenType(\"u16\", TokenClass.reserved, \"u16\"),\r\n    u64: new TokenType(\"u64\", TokenClass.reserved, \"u64\"),\r\n    unless: new TokenType(\"unless\", TokenClass.reserved, \"unless\"),\r\n    using: new TokenType(\"using\", TokenClass.reserved, \"using\"),\r\n    vec: new TokenType(\"vec\", TokenClass.reserved, \"vec\"),\r\n    void: new TokenType(\"void\", TokenClass.reserved, \"void\"),\r\n  };\r\n\r\n  static readonly keywords = {\r\n    array: new TokenType(\"array\", TokenClass.keyword, \"array\"),\r\n    atomic: new TokenType(\"atomic\", TokenClass.keyword, \"atomic\"),\r\n    bool: new TokenType(\"bool\", TokenClass.keyword, \"bool\"),\r\n    f32: new TokenType(\"f32\", TokenClass.keyword, \"f32\"),\r\n    i32: new TokenType(\"i32\", TokenClass.keyword, \"i32\"),\r\n    mat2x2: new TokenType(\"mat2x2\", TokenClass.keyword, \"mat2x2\"),\r\n    mat2x3: new TokenType(\"mat2x3\", TokenClass.keyword, \"mat2x3\"),\r\n    mat2x4: new TokenType(\"mat2x4\", TokenClass.keyword, \"mat2x4\"),\r\n    mat3x2: new TokenType(\"mat3x2\", TokenClass.keyword, \"mat3x2\"),\r\n    mat3x3: new TokenType(\"mat3x3\", TokenClass.keyword, \"mat3x3\"),\r\n    mat3x4: new TokenType(\"mat3x4\", TokenClass.keyword, \"mat3x4\"),\r\n    mat4x2: new TokenType(\"mat4x2\", TokenClass.keyword, \"mat4x2\"),\r\n    mat4x3: new TokenType(\"mat4x3\", TokenClass.keyword, \"mat4x3\"),\r\n    mat4x4: new TokenType(\"mat4x4\", TokenClass.keyword, \"mat4x4\"),\r\n    ptr: new TokenType(\"ptr\", TokenClass.keyword, \"ptr\"),\r\n    sampler: new TokenType(\"sampler\", TokenClass.keyword, \"sampler\"),\r\n    sampler_comparison: new TokenType(\r\n      \"sampler_comparison\",\r\n      TokenClass.keyword,\r\n      \"sampler_comparison\"\r\n    ),\r\n    struct: new TokenType(\"struct\", TokenClass.keyword, \"struct\"),\r\n    texture_1d: new TokenType(\"texture_1d\", TokenClass.keyword, \"texture_1d\"),\r\n    texture_2d: new TokenType(\"texture_2d\", TokenClass.keyword, \"texture_2d\"),\r\n    texture_2d_array: new TokenType(\r\n      \"texture_2d_array\",\r\n      TokenClass.keyword,\r\n      \"texture_2d_array\"\r\n    ),\r\n    texture_3d: new TokenType(\"texture_3d\", TokenClass.keyword, \"texture_3d\"),\r\n    texture_cube: new TokenType(\r\n      \"texture_cube\",\r\n      TokenClass.keyword,\r\n      \"texture_cube\"\r\n    ),\r\n    texture_cube_array: new TokenType(\r\n      \"texture_cube_array\",\r\n      TokenClass.keyword,\r\n      \"texture_cube_array\"\r\n    ),\r\n    texture_multisampled_2d: new TokenType(\r\n      \"texture_multisampled_2d\",\r\n      TokenClass.keyword,\r\n      \"texture_multisampled_2d\"\r\n    ),\r\n    texture_storage_1d: new TokenType(\r\n      \"texture_storage_1d\",\r\n      TokenClass.keyword,\r\n      \"texture_storage_1d\"\r\n    ),\r\n    texture_storage_2d: new TokenType(\r\n      \"texture_storage_2d\",\r\n      TokenClass.keyword,\r\n      \"texture_storage_2d\"\r\n    ),\r\n    texture_storage_2d_array: new TokenType(\r\n      \"texture_storage_2d_array\",\r\n      TokenClass.keyword,\r\n      \"texture_storage_2d_array\"\r\n    ),\r\n    texture_storage_3d: new TokenType(\r\n      \"texture_storage_3d\",\r\n      TokenClass.keyword,\r\n      \"texture_storage_3d\"\r\n    ),\r\n    texture_depth_2d: new TokenType(\r\n      \"texture_depth_2d\",\r\n      TokenClass.keyword,\r\n      \"texture_depth_2d\"\r\n    ),\r\n    texture_depth_2d_array: new TokenType(\r\n      \"texture_depth_2d_array\",\r\n      TokenClass.keyword,\r\n      \"texture_depth_2d_array\"\r\n    ),\r\n    texture_depth_cube: new TokenType(\r\n      \"texture_depth_cube\",\r\n      TokenClass.keyword,\r\n      \"texture_depth_cube\"\r\n    ),\r\n    texture_depth_cube_array: new TokenType(\r\n      \"texture_depth_cube_array\",\r\n      TokenClass.keyword,\r\n      \"texture_depth_cube_array\"\r\n    ),\r\n    texture_depth_multisampled_2d: new TokenType(\r\n      \"texture_depth_multisampled_2d\",\r\n      TokenClass.keyword,\r\n      \"texture_depth_multisampled_2d\"\r\n    ),\r\n    texture_external: new TokenType(\r\n      \"texture_external\",\r\n      TokenClass.keyword,\r\n      \"texture_external\"\r\n    ),\r\n    u32: new TokenType(\"u32\", TokenClass.keyword, \"u32\"),\r\n    vec2: new TokenType(\"vec2\", TokenClass.keyword, \"vec2\"),\r\n    vec3: new TokenType(\"vec3\", TokenClass.keyword, \"vec3\"),\r\n    vec4: new TokenType(\"vec4\", TokenClass.keyword, \"vec4\"),\r\n    bitcast: new TokenType(\"bitcast\", TokenClass.keyword, \"bitcast\"),\r\n    block: new TokenType(\"block\", TokenClass.keyword, \"block\"),\r\n    break: new TokenType(\"break\", TokenClass.keyword, \"break\"),\r\n    case: new TokenType(\"case\", TokenClass.keyword, \"case\"),\r\n    continue: new TokenType(\"continue\", TokenClass.keyword, \"continue\"),\r\n    continuing: new TokenType(\"continuing\", TokenClass.keyword, \"continuing\"),\r\n    default: new TokenType(\"default\", TokenClass.keyword, \"default\"),\r\n    diagnostic: new TokenType(\"diagnostic\", TokenClass.keyword, \"diagnostic\"),\r\n    discard: new TokenType(\"discard\", TokenClass.keyword, \"discard\"),\r\n    else: new TokenType(\"else\", TokenClass.keyword, \"else\"),\r\n    enable: new TokenType(\"enable\", TokenClass.keyword, \"enable\"),\r\n    fallthrough: new TokenType(\r\n      \"fallthrough\",\r\n      TokenClass.keyword,\r\n      \"fallthrough\"\r\n    ),\r\n    false: new TokenType(\"false\", TokenClass.keyword, \"false\"),\r\n    fn: new TokenType(\"fn\", TokenClass.keyword, \"fn\"),\r\n    for: new TokenType(\"for\", TokenClass.keyword, \"for\"),\r\n    function: new TokenType(\"function\", TokenClass.keyword, \"function\"),\r\n    if: new TokenType(\"if\", TokenClass.keyword, \"if\"),\r\n    let: new TokenType(\"let\", TokenClass.keyword, \"let\"),\r\n    const: new TokenType(\"const\", TokenClass.keyword, \"const\"),\r\n    loop: new TokenType(\"loop\", TokenClass.keyword, \"loop\"),\r\n    while: new TokenType(\"while\", TokenClass.keyword, \"while\"),\r\n    private: new TokenType(\"private\", TokenClass.keyword, \"private\"),\r\n    read: new TokenType(\"read\", TokenClass.keyword, \"read\"),\r\n    read_write: new TokenType(\"read_write\", TokenClass.keyword, \"read_write\"),\r\n    return: new TokenType(\"return\", TokenClass.keyword, \"return\"),\r\n    requires: new TokenType(\"requires\", TokenClass.keyword, \"requires\"),\r\n    storage: new TokenType(\"storage\", TokenClass.keyword, \"storage\"),\r\n    switch: new TokenType(\"switch\", TokenClass.keyword, \"switch\"),\r\n    true: new TokenType(\"true\", TokenClass.keyword, \"true\"),\r\n    alias: new TokenType(\"alias\", TokenClass.keyword, \"alias\"),\r\n    type: new TokenType(\"type\", TokenClass.keyword, \"type\"),\r\n    uniform: new TokenType(\"uniform\", TokenClass.keyword, \"uniform\"),\r\n    var: new TokenType(\"var\", TokenClass.keyword, \"var\"),\r\n    override: new TokenType(\"override\", TokenClass.keyword, \"override\"),\r\n    workgroup: new TokenType(\"workgroup\", TokenClass.keyword, \"workgroup\"),\r\n    write: new TokenType(\"write\", TokenClass.keyword, \"write\"),\r\n    r8unorm: new TokenType(\"r8unorm\", TokenClass.keyword, \"r8unorm\"),\r\n    r8snorm: new TokenType(\"r8snorm\", TokenClass.keyword, \"r8snorm\"),\r\n    r8uint: new TokenType(\"r8uint\", TokenClass.keyword, \"r8uint\"),\r\n    r8sint: new TokenType(\"r8sint\", TokenClass.keyword, \"r8sint\"),\r\n    r16uint: new TokenType(\"r16uint\", TokenClass.keyword, \"r16uint\"),\r\n    r16sint: new TokenType(\"r16sint\", TokenClass.keyword, \"r16sint\"),\r\n    r16float: new TokenType(\"r16float\", TokenClass.keyword, \"r16float\"),\r\n    rg8unorm: new TokenType(\"rg8unorm\", TokenClass.keyword, \"rg8unorm\"),\r\n    rg8snorm: new TokenType(\"rg8snorm\", TokenClass.keyword, \"rg8snorm\"),\r\n    rg8uint: new TokenType(\"rg8uint\", TokenClass.keyword, \"rg8uint\"),\r\n    rg8sint: new TokenType(\"rg8sint\", TokenClass.keyword, \"rg8sint\"),\r\n    r32uint: new TokenType(\"r32uint\", TokenClass.keyword, \"r32uint\"),\r\n    r32sint: new TokenType(\"r32sint\", TokenClass.keyword, \"r32sint\"),\r\n    r32float: new TokenType(\"r32float\", TokenClass.keyword, \"r32float\"),\r\n    rg16uint: new TokenType(\"rg16uint\", TokenClass.keyword, \"rg16uint\"),\r\n    rg16sint: new TokenType(\"rg16sint\", TokenClass.keyword, \"rg16sint\"),\r\n    rg16float: new TokenType(\"rg16float\", TokenClass.keyword, \"rg16float\"),\r\n    rgba8unorm: new TokenType(\"rgba8unorm\", TokenClass.keyword, \"rgba8unorm\"),\r\n    rgba8unorm_srgb: new TokenType(\r\n      \"rgba8unorm_srgb\",\r\n      TokenClass.keyword,\r\n      \"rgba8unorm_srgb\"\r\n    ),\r\n    rgba8snorm: new TokenType(\"rgba8snorm\", TokenClass.keyword, \"rgba8snorm\"),\r\n    rgba8uint: new TokenType(\"rgba8uint\", TokenClass.keyword, \"rgba8uint\"),\r\n    rgba8sint: new TokenType(\"rgba8sint\", TokenClass.keyword, \"rgba8sint\"),\r\n    bgra8unorm: new TokenType(\"bgra8unorm\", TokenClass.keyword, \"bgra8unorm\"),\r\n    bgra8unorm_srgb: new TokenType(\r\n      \"bgra8unorm_srgb\",\r\n      TokenClass.keyword,\r\n      \"bgra8unorm_srgb\"\r\n    ),\r\n    rgb10a2unorm: new TokenType(\r\n      \"rgb10a2unorm\",\r\n      TokenClass.keyword,\r\n      \"rgb10a2unorm\"\r\n    ),\r\n    rg11b10float: new TokenType(\r\n      \"rg11b10float\",\r\n      TokenClass.keyword,\r\n      \"rg11b10float\"\r\n    ),\r\n    rg32uint: new TokenType(\"rg32uint\", TokenClass.keyword, \"rg32uint\"),\r\n    rg32sint: new TokenType(\"rg32sint\", TokenClass.keyword, \"rg32sint\"),\r\n    rg32float: new TokenType(\"rg32float\", TokenClass.keyword, \"rg32float\"),\r\n    rgba16uint: new TokenType(\"rgba16uint\", TokenClass.keyword, \"rgba16uint\"),\r\n    rgba16sint: new TokenType(\"rgba16sint\", TokenClass.keyword, \"rgba16sint\"),\r\n    rgba16float: new TokenType(\r\n      \"rgba16float\",\r\n      TokenClass.keyword,\r\n      \"rgba16float\"\r\n    ),\r\n    rgba32uint: new TokenType(\"rgba32uint\", TokenClass.keyword, \"rgba32uint\"),\r\n    rgba32sint: new TokenType(\"rgba32sint\", TokenClass.keyword, \"rgba32sint\"),\r\n    rgba32float: new TokenType(\r\n      \"rgba32float\",\r\n      TokenClass.keyword,\r\n      \"rgba32float\"\r\n    ),\r\n    static_assert: new TokenType(\r\n      \"static_assert\",\r\n      TokenClass.keyword,\r\n      \"static_assert\"\r\n    ),\r\n\r\n    // WGSL grammar has a few keywords that have different token names than the strings they\r\n    // represent. Aliasing them here.\r\n    /*int32: new TokenType(\"i32\", TokenClass.keyword, \"i32\"),\r\n        uint32: new TokenType(\"u32\", TokenClass.keyword, \"u32\"),\r\n        float32: new TokenType(\"f32\", TokenClass.keyword, \"f32\"),\r\n        pointer: new TokenType(\"ptr\", TokenClass.keyword, \"ptr\"),*/\r\n  };\r\n\r\n  static readonly tokens = {\r\n    decimal_float_literal: new TokenType(\r\n      \"decimal_float_literal\",\r\n      TokenClass.token,\r\n      /((-?[0-9]*\\.[0-9]+|-?[0-9]+\\.[0-9]*)((e|E)(\\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/\r\n    ),\r\n    hex_float_literal: new TokenType(\r\n      \"hex_float_literal\",\r\n      TokenClass.token,\r\n      /-?0x((([0-9a-fA-F]*\\.[0-9a-fA-F]+|[0-9a-fA-F]+\\.[0-9a-fA-F]*)((p|P)(\\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\\+|-)?[0-9]+[fh]?))/\r\n    ),\r\n    int_literal: new TokenType(\r\n      \"int_literal\",\r\n      TokenClass.token,\r\n      /-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/\r\n    ),\r\n    uint_literal: new TokenType(\r\n      \"uint_literal\",\r\n      TokenClass.token,\r\n      /0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/\r\n    ),\r\n    name: new TokenType(\"name\", TokenClass.token,  /([_\\p{XID_Start}][\\p{XID_Continue}]+)|([\\p{XID_Start}])/u),\r\n    //name: new TokenType(\"name\", TokenClass.token, /[_a-zA-Z][0-9a-zA-Z_]*/),\r\n    ident: new TokenType(\"ident\", TokenClass.token, /[_a-zA-Z][0-9a-zA-Z_]*/),\r\n    and: new TokenType(\"and\", TokenClass.token, \"&\"),\r\n    and_and: new TokenType(\"and_and\", TokenClass.token, \"&&\"),\r\n    arrow: new TokenType(\"arrow \", TokenClass.token, \"->\"),\r\n    attr: new TokenType(\"attr\", TokenClass.token, \"@\"),\r\n    forward_slash: new TokenType(\"forward_slash\", TokenClass.token, \"/\"),\r\n    bang: new TokenType(\"bang\", TokenClass.token, \"!\"),\r\n    bracket_left: new TokenType(\"bracket_left\", TokenClass.token, \"[\"),\r\n    bracket_right: new TokenType(\"bracket_right\", TokenClass.token, \"]\"),\r\n    brace_left: new TokenType(\"brace_left\", TokenClass.token, \"{\"),\r\n    brace_right: new TokenType(\"brace_right\", TokenClass.token, \"}\"),\r\n    colon: new TokenType(\"colon\", TokenClass.token, \":\"),\r\n    comma: new TokenType(\"comma\", TokenClass.token, \",\"),\r\n    equal: new TokenType(\"equal\", TokenClass.token, \"=\"),\r\n    equal_equal: new TokenType(\"equal_equal\", TokenClass.token, \"==\"),\r\n    not_equal: new TokenType(\"not_equal\", TokenClass.token, \"!=\"),\r\n    greater_than: new TokenType(\"greater_than\", TokenClass.token, \">\"),\r\n    greater_than_equal: new TokenType(\r\n      \"greater_than_equal\",\r\n      TokenClass.token,\r\n      \">=\"\r\n    ),\r\n    shift_right: new TokenType(\"shift_right\", TokenClass.token, \">>\"),\r\n    less_than: new TokenType(\"less_than\", TokenClass.token, \"<\"),\r\n    less_than_equal: new TokenType(\"less_than_equal\", TokenClass.token, \"<=\"),\r\n    shift_left: new TokenType(\"shift_left\", TokenClass.token, \"<<\"),\r\n    modulo: new TokenType(\"modulo\", TokenClass.token, \"%\"),\r\n    minus: new TokenType(\"minus\", TokenClass.token, \"-\"),\r\n    minus_minus: new TokenType(\"minus_minus\", TokenClass.token, \"--\"),\r\n    period: new TokenType(\"period\", TokenClass.token, \".\"),\r\n    plus: new TokenType(\"plus\", TokenClass.token, \"+\"),\r\n    plus_plus: new TokenType(\"plus_plus\", TokenClass.token, \"++\"),\r\n    or: new TokenType(\"or\", TokenClass.token, \"|\"),\r\n    or_or: new TokenType(\"or_or\", TokenClass.token, \"||\"),\r\n    paren_left: new TokenType(\"paren_left\", TokenClass.token, \"(\"),\r\n    paren_right: new TokenType(\"paren_right\", TokenClass.token, \")\"),\r\n    semicolon: new TokenType(\"semicolon\", TokenClass.token, \";\"),\r\n    star: new TokenType(\"star\", TokenClass.token, \"*\"),\r\n    tilde: new TokenType(\"tilde\", TokenClass.token, \"~\"),\r\n    underscore: new TokenType(\"underscore\", TokenClass.token, \"_\"),\r\n    xor: new TokenType(\"xor\", TokenClass.token, \"^\"),\r\n    plus_equal: new TokenType(\"plus_equal\", TokenClass.token, \"+=\"),\r\n    minus_equal: new TokenType(\"minus_equal\", TokenClass.token, \"-=\"),\r\n    times_equal: new TokenType(\"times_equal\", TokenClass.token, \"*=\"),\r\n    division_equal: new TokenType(\"division_equal\", TokenClass.token, \"/=\"),\r\n    modulo_equal: new TokenType(\"modulo_equal\", TokenClass.token, \"%=\"),\r\n    and_equal: new TokenType(\"and_equal\", TokenClass.token, \"&=\"),\r\n    or_equal: new TokenType(\"or_equal\", TokenClass.token, \"|=\"),\r\n    xor_equal: new TokenType(\"xor_equal\", TokenClass.token, \"^=\"),\r\n    shift_right_equal: new TokenType(\r\n      \"shift_right_equal\",\r\n      TokenClass.token,\r\n      \">>=\"\r\n    ),\r\n    shift_left_equal: new TokenType(\r\n      \"shift_left_equal\",\r\n      TokenClass.token,\r\n      \"<<=\"\r\n    ),\r\n  };\r\n\r\n  static readonly simpleTokens = {\r\n    \"@\": this.tokens.attr,\r\n    \"{\": this.tokens.brace_left,\r\n    \"}\": this.tokens.brace_right,\r\n    \":\": this.tokens.colon,\r\n    \",\": this.tokens.comma,\r\n    \"(\": this.tokens.paren_left,\r\n    \")\": this.tokens.paren_right,\r\n    \";\": this.tokens.semicolon,\r\n  };\r\n\r\n  static readonly literalTokens = {\r\n    \"&\": this.tokens.and,\r\n    \"&&\": this.tokens.and_and,\r\n    \"->\": this.tokens.arrow ,\r\n    \"/\": this.tokens.forward_slash,\r\n    \"!\": this.tokens.bang,\r\n    \"[\": this.tokens.bracket_left,\r\n    \"]\": this.tokens.bracket_right,\r\n    \"=\": this.tokens.equal,\r\n    \"==\": this.tokens.equal_equal,\r\n    \"!=\": this.tokens.not_equal,\r\n    \">\": this.tokens.greater_than,\r\n    \">=\": this.tokens.greater_than_equal,\r\n    \">>\": this.tokens.shift_right,\r\n    \"<\": this.tokens.less_than,\r\n    \"<=\": this.tokens.less_than_equal,\r\n    \"<<\": this.tokens.shift_left,\r\n    \"%\": this.tokens.modulo,\r\n    \"-\": this.tokens.minus,\r\n    \"--\": this.tokens.minus_minus,\r\n    \".\": this.tokens.period,\r\n    \"+\": this.tokens.plus,\r\n    \"++\": this.tokens.plus_plus,\r\n    \"|\": this.tokens.or,\r\n    \"||\": this.tokens.or_or,\r\n    \"*\": this.tokens.star,\r\n    \"~\": this.tokens.tilde,\r\n    \"_\": this.tokens.underscore,\r\n    \"^\": this.tokens.xor,\r\n    \"+=\": this.tokens.plus_equal,\r\n    \"-=\": this.tokens.minus_equal,\r\n    \"*=\": this.tokens.times_equal,\r\n    \"/=\": this.tokens.division_equal,\r\n    \"%=\": this.tokens.modulo_equal,\r\n    \"&=\": this.tokens.and_equal,\r\n    \"|=\": this.tokens.or_equal,\r\n    \"^=\": this.tokens.xor_equal,\r\n    \">>=\": this.tokens.shift_right_equal,\r\n    \"<<=\": this.tokens.shift_left_equal,\r\n  };\r\n\r\n  static readonly regexTokens = {\r\n    decimal_float_literal: this.tokens.decimal_float_literal,\r\n    hex_float_literal: this.tokens.hex_float_literal,\r\n    int_literal: this.tokens.int_literal,\r\n    uint_literal: this.tokens.uint_literal,\r\n    ident: this.tokens.ident,\r\n  };\r\n\r\n  static readonly storage_class = [\r\n    this.keywords.function,\r\n    this.keywords.private,\r\n    this.keywords.workgroup,\r\n    this.keywords.uniform,\r\n    this.keywords.storage,\r\n  ];\r\n\r\n  static readonly access_mode = [\r\n    this.keywords.read,\r\n    this.keywords.write,\r\n    this.keywords.read_write,\r\n  ];\r\n\r\n  static readonly sampler_type = [\r\n    this.keywords.sampler,\r\n    this.keywords.sampler_comparison,\r\n  ];\r\n\r\n  static readonly sampled_texture_type = [\r\n    this.keywords.texture_1d,\r\n    this.keywords.texture_2d,\r\n    this.keywords.texture_2d_array,\r\n    this.keywords.texture_3d,\r\n    this.keywords.texture_cube,\r\n    this.keywords.texture_cube_array,\r\n  ];\r\n\r\n  static readonly multisampled_texture_type = [\r\n    this.keywords.texture_multisampled_2d,\r\n  ];\r\n\r\n  static readonly storage_texture_type = [\r\n    this.keywords.texture_storage_1d,\r\n    this.keywords.texture_storage_2d,\r\n    this.keywords.texture_storage_2d_array,\r\n    this.keywords.texture_storage_3d,\r\n  ];\r\n\r\n  static readonly depth_texture_type = [\r\n    this.keywords.texture_depth_2d,\r\n    this.keywords.texture_depth_2d_array,\r\n    this.keywords.texture_depth_cube,\r\n    this.keywords.texture_depth_cube_array,\r\n    this.keywords.texture_depth_multisampled_2d,\r\n  ];\r\n\r\n  static readonly texture_external_type = [this.keywords.texture_external];\r\n\r\n  static readonly any_texture_type = [\r\n    ...this.sampled_texture_type,\r\n    ...this.multisampled_texture_type,\r\n    ...this.storage_texture_type,\r\n    ...this.depth_texture_type,\r\n    ...this.texture_external_type,\r\n  ];\r\n\r\n  static readonly texel_format = [\r\n    this.keywords.r8unorm,\r\n    this.keywords.r8snorm,\r\n    this.keywords.r8uint,\r\n    this.keywords.r8sint,\r\n    this.keywords.r16uint,\r\n    this.keywords.r16sint,\r\n    this.keywords.r16float,\r\n    this.keywords.rg8unorm,\r\n    this.keywords.rg8snorm,\r\n    this.keywords.rg8uint,\r\n    this.keywords.rg8sint,\r\n    this.keywords.r32uint,\r\n    this.keywords.r32sint,\r\n    this.keywords.r32float,\r\n    this.keywords.rg16uint,\r\n    this.keywords.rg16sint,\r\n    this.keywords.rg16float,\r\n    this.keywords.rgba8unorm,\r\n    this.keywords.rgba8unorm_srgb,\r\n    this.keywords.rgba8snorm,\r\n    this.keywords.rgba8uint,\r\n    this.keywords.rgba8sint,\r\n    this.keywords.bgra8unorm,\r\n    this.keywords.bgra8unorm_srgb,\r\n    this.keywords.rgb10a2unorm,\r\n    this.keywords.rg11b10float,\r\n    this.keywords.rg32uint,\r\n    this.keywords.rg32sint,\r\n    this.keywords.rg32float,\r\n    this.keywords.rgba16uint,\r\n    this.keywords.rgba16sint,\r\n    this.keywords.rgba16float,\r\n    this.keywords.rgba32uint,\r\n    this.keywords.rgba32sint,\r\n    this.keywords.rgba32float,\r\n  ];\r\n\r\n  static readonly const_literal = [\r\n    this.tokens.int_literal,\r\n    this.tokens.uint_literal,\r\n    this.tokens.decimal_float_literal,\r\n    this.tokens.hex_float_literal,\r\n    this.keywords.true,\r\n    this.keywords.false,\r\n  ];\r\n\r\n  static readonly literal_or_ident = [\r\n    this.tokens.ident,\r\n    this.tokens.int_literal,\r\n    this.tokens.uint_literal,\r\n    this.tokens.decimal_float_literal,\r\n    this.tokens.hex_float_literal,\r\n    this.tokens.name\r\n  ];\r\n\r\n  static readonly element_count_expression = [\r\n    this.tokens.int_literal,\r\n    this.tokens.uint_literal,\r\n    this.tokens.ident,\r\n  ];\r\n\r\n  static readonly template_types = [\r\n    this.keywords.vec2,\r\n    this.keywords.vec3,\r\n    this.keywords.vec4,\r\n    this.keywords.mat2x2,\r\n    this.keywords.mat2x3,\r\n    this.keywords.mat2x4,\r\n    this.keywords.mat3x2,\r\n    this.keywords.mat3x3,\r\n    this.keywords.mat3x4,\r\n    this.keywords.mat4x2,\r\n    this.keywords.mat4x3,\r\n    this.keywords.mat4x4,\r\n    this.keywords.atomic,\r\n    this.keywords.bitcast,\r\n    ...this.any_texture_type,\r\n  ];\r\n\r\n  // The grammar calls out 'block', but attribute grammar is defined to use a 'ident'.\r\n  // The attribute grammar should be ident | block.\r\n  static readonly attribute_name = [this.tokens.ident, this.keywords.block, this.keywords.diagnostic];\r\n\r\n  static readonly assignment_operators = [\r\n    this.tokens.equal,\r\n    this.tokens.plus_equal,\r\n    this.tokens.minus_equal,\r\n    this.tokens.times_equal,\r\n    this.tokens.division_equal,\r\n    this.tokens.modulo_equal,\r\n    this.tokens.and_equal,\r\n    this.tokens.or_equal,\r\n    this.tokens.xor_equal,\r\n    this.tokens.shift_right_equal,\r\n    this.tokens.shift_left_equal,\r\n  ];\r\n\r\n  static readonly increment_operators = [\r\n    this.tokens.plus_plus,\r\n    this.tokens.minus_minus,\r\n  ];\r\n}\r\n\r\n/// A token parsed by the WgslScanner.\r\nexport class Token {\r\n  readonly type: TokenType; // The type of the token.\r\n  readonly lexeme: string; // The string of the token, as parsed from the source text.\r\n  readonly line: number; // The line number of the token in the source text.\r\n  readonly start: number; // The start position of the token in the source text.\r\n  readonly end: number; // The end position of the token in the source text.\r\n\r\n  constructor(type: TokenType, lexeme: string, line: number, start: number, end: number) {\r\n    this.type = type;\r\n    this.lexeme = lexeme;\r\n    this.line = line;\r\n    this.start = start;\r\n    this.end = end;\r\n  }\r\n\r\n  toString(): string {\r\n    return this.lexeme;\r\n  }\r\n\r\n  isTemplateType(): boolean {\r\n    return TokenTypes.template_types.indexOf(this.type) != -1;\r\n  }\r\n\r\n  isArrayType(): boolean {\r\n    return this.type == TokenTypes.keywords.array;\r\n  }\r\n\r\n  isArrayOrTemplateType(): boolean {\r\n    return this.isArrayType() || this.isTemplateType();\r\n  }\r\n}\r\n\r\n/// Lexical scanner for the WGSL language. This takes an input source text and generates a list\r\n/// of Token objects, which can then be fed into the WgslParser to generate an AST.\r\nexport class WgslScanner {\r\n  private _source: string;\r\n  private _tokens: Token[] = [];\r\n  private _start = 0;\r\n  private _current = 0;\r\n  private _line = 1;\r\n\r\n  constructor(source?: string) {\r\n    this._source = source ?? \"\";\r\n  }\r\n\r\n  /// Scan all tokens from the source.\r\n  scanTokens(): Token[] {\r\n    while (!this._isAtEnd()) {\r\n      this._start = this._current;\r\n      if (!this.scanToken()) {\r\n        throw `Invalid syntax at line ${this._line}`;\r\n      }\r\n    }\r\n\r\n    this._tokens.push(new Token(TokenTypes.eof, \"\", this._line, this._current, this._current));\r\n\r\n    return this._tokens;\r\n  }\r\n\r\n  /// Scan a single token from the source.\r\n  scanToken(): boolean {\r\n    // Find the longest consecutive set of characters that match a rule.\r\n    let lexeme = this._advance();\r\n\r\n    // Skip line-feed, adding to the line counter.\r\n    if (lexeme == \"\\n\") {\r\n      this._line++;\r\n      return true;\r\n    }\r\n\r\n    // Skip whitespace\r\n    if (this._isWhitespace(lexeme)) {\r\n      return true;\r\n    }\r\n\r\n    if (lexeme == \"/\") {\r\n      // If it's a // comment, skip everything until the next line-feed.\r\n      if (this._peekAhead() == \"/\") {\r\n        while (lexeme != \"\\n\") {\r\n          if (this._isAtEnd()) {\r\n            return true;\r\n          }\r\n          lexeme = this._advance();\r\n        }\r\n        // skip the linefeed\r\n        this._line++;\r\n        return true;\r\n      } else if (this._peekAhead() == \"*\") {\r\n        // If it's a / * block comment, skip everything until the matching * /,\r\n        // allowing for nested block comments.\r\n        this._advance();\r\n        let commentLevel = 1;\r\n        while (commentLevel > 0) {\r\n          if (this._isAtEnd()) {\r\n            return true;\r\n          }\r\n          lexeme = this._advance();\r\n          if (lexeme == \"\\n\") {\r\n            this._line++;\r\n          } else if (lexeme == \"*\") {\r\n            if (this._peekAhead() == \"/\") {\r\n              this._advance();\r\n              commentLevel--;\r\n              if (commentLevel == 0) {\r\n                return true;\r\n              }\r\n            }\r\n          } else if (lexeme == \"/\") {\r\n            if (this._peekAhead() == \"*\") {\r\n              this._advance();\r\n              commentLevel++;\r\n            }\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n    }\r\n\r\n    // Shortcut single character tokens\r\n    const simpleToken = TokenTypes.simpleTokens[lexeme];\r\n    if (simpleToken) {\r\n      this._addToken(simpleToken);\r\n      return true;\r\n    }\r\n\r\n    // Shortcut keywords and identifiers\r\n    let matchType = TokenTypes.none;\r\n    const isAlpha = this._isAlpha(lexeme);\r\n    const isUnderscore = lexeme === \"_\";\r\n\r\n    if (this._isAlphaNumeric(lexeme)) {\r\n      let nextChar = this._peekAhead();\r\n      while (this._isAlphaNumeric(nextChar)) {\r\n        lexeme += this._advance();\r\n        nextChar = this._peekAhead();\r\n      }\r\n    }\r\n\r\n    if (isAlpha) {\r\n      const matchedType = TokenTypes.keywords[lexeme];\r\n      if (matchedType) {\r\n        this._addToken(matchedType);\r\n        return true;\r\n      }\r\n    }\r\n\r\n    if (isAlpha || isUnderscore) {\r\n      this._addToken(TokenTypes.tokens.ident);\r\n      return true;\r\n    }\r\n\r\n    // Scan for the next valid token type\r\n    for (;;) {\r\n      let matchedType = this._findType(lexeme);\r\n\r\n      // An exception to \"longest lexeme\" rule is '>>'. In the case of 1>>2, it's a\r\n      // shift_right.\r\n      // In the case of array<vec4<f32>>, it's two greater_than's (one to close the vec4,\r\n      // and one to close the array).\r\n      // Another ambiguity is '>='. In the case of vec2<i32>=vec2(1,2),\r\n      // it's a greather_than and an equal, not a greater_than_equal.\r\n      // Another ambiguity is '-'. In the case of a-2, it's a minus; in the case of a*-2, it's a -2;\r\n      // in the case of foo()->int, it's a ->; in the case of foo-- or --foo, it's a -- decrement.\r\n\r\n      // WGSL requires context sensitive parsing to resolve these ambiguities. Both of these cases\r\n      // are predicated on it the > either closing a template, or being part of an operator.\r\n      // The solution here is to check if there was a less_than up to some number of tokens\r\n      // previously, and the token prior to that is a keyword that requires a '<', then it will be\r\n      // split into two operators; otherwise it's a single operator.\r\n      const nextLexeme = this._peekAhead();\r\n      if (lexeme == \"-\" && this._tokens.length > 0) {\r\n        if (nextLexeme == \"=\") {\r\n          this._current++;\r\n          lexeme += nextLexeme;\r\n          this._addToken(TokenTypes.tokens.minus_equal);\r\n          return true;\r\n        }\r\n        if (nextLexeme == \"-\") {\r\n          this._current++;\r\n          lexeme += nextLexeme;\r\n          this._addToken(TokenTypes.tokens.minus_minus);\r\n          return true;\r\n        }\r\n        const ti = this._tokens.length - 1;\r\n        const isIdentOrLiteral = TokenTypes.literal_or_ident.indexOf(this._tokens[ti].type) != -1;\r\n        if ((isIdentOrLiteral || this._tokens[ti].type == TokenTypes.tokens.paren_right) && nextLexeme != \">\") {\r\n          this._addToken(matchedType);\r\n          return true;\r\n        }\r\n      }\r\n      if (lexeme == \">\" && (nextLexeme == \">\" || nextLexeme == \"=\")) {\r\n        let foundLessThan = false;\r\n        let ti = this._tokens.length - 1;\r\n        for (let count = 0; count < 5 && ti >= 0; ++count, --ti) {\r\n          if (TokenTypes.assignment_operators.indexOf(this._tokens[ti].type) !== -1) {\r\n            break;\r\n          }\r\n          if (this._tokens[ti].type === TokenTypes.tokens.less_than) {\r\n            if (ti > 0 && this._tokens[ti - 1].isArrayOrTemplateType()) {\r\n              foundLessThan = true;\r\n            }\r\n            break;\r\n          }\r\n        }\r\n        // If there was a less_than in the recent token history, then this is probably a\r\n        // greater_than.\r\n        if (foundLessThan) {\r\n          this._addToken(matchedType);\r\n          return true;\r\n        }\r\n      }\r\n\r\n      // The current lexeme may not match any rule, but some token types may be invalid for\r\n      // part of the string but valid after a few more characters.\r\n      // For example, 0x.5 is a hex_float_literal. But as it's being scanned,\r\n      // \"0\" is a int_literal, then \"0x\" is invalid. If we stopped there, it would return\r\n      // the int_literal \"0\", but that's incorrect. So if we look forward a few characters,\r\n      // we'd get \"0x.\", which is still invalid, followed by \"0x.5\" which is the correct\r\n      // hex_float_literal. So that means if we hit an non-matching string, we should look\r\n      // ahead up to two characters to see if the string starts matching a valid rule again.\r\n      if (matchedType === TokenTypes.none) {\r\n        let lookAheadLexeme = lexeme;\r\n        let lookAhead = 0;\r\n        const maxLookAhead = 2;\r\n        for (let li = 0; li < maxLookAhead; ++li) {\r\n          lookAheadLexeme += this._peekAhead(li);\r\n          matchedType = this._findType(lookAheadLexeme);\r\n          if (matchedType !== TokenTypes.none) {\r\n            lookAhead = li;\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (matchedType === TokenTypes.none) {\r\n          if (matchType === TokenTypes.none) {\r\n            return false;\r\n          }\r\n          this._current--;\r\n          this._addToken(matchType);\r\n          return true;\r\n        }\r\n\r\n        lexeme = lookAheadLexeme;\r\n        this._current += lookAhead + 1;\r\n      }\r\n\r\n      matchType = matchedType;\r\n\r\n      if (this._isAtEnd()) {\r\n        break;\r\n      }\r\n\r\n      lexeme += this._advance();\r\n    }\r\n\r\n    // We got to the end of the input stream. Then the token we've ready so far is it.\r\n    if (matchType === TokenTypes.none) {\r\n      return false;\r\n    }\r\n\r\n    this._addToken(matchType);\r\n    return true;\r\n  }\r\n\r\n  _findType(lexeme: string): TokenType {\r\n    for (const name in TokenTypes.regexTokens) {\r\n      const type = TokenTypes.regexTokens[name];\r\n      if (this._match(lexeme, type.rule)) {\r\n        return type;\r\n      }\r\n    }\r\n\r\n    const type = TokenTypes.literalTokens[lexeme];\r\n    if (type) {\r\n      return type;\r\n    }\r\n\r\n    return TokenTypes.none;\r\n  }\r\n\r\n  _match(lexeme: string, rule: RegExp): boolean {\r\n    const match = rule.exec(lexeme);\r\n    return match && match.index == 0 && match[0] == lexeme;\r\n  }\r\n\r\n  _isAtEnd(): boolean {\r\n    return this._current >= this._source.length;\r\n  }\r\n\r\n  _isAlpha(c: string): boolean {\r\n    // To support UTF-8 characters, allow anything other than whitespace, numbers, or operators\r\n    return !this._isNumeric(c) && !this._isWhitespace(c) && c !== \"_\" && c !== \".\" && c !== \"(\" && c !== \")\" &&\r\n      c !== \"[\" && c !== \"]\" && c !== \"{\" && c !== \"}\" && c !== \",\" && c !== \";\" && c !== \":\" && c !== \"=\" &&\r\n      c !== \"!\" && c !== \"<\" && c !== \">\" && c !== \"+\" && c !== \"-\" && c !== \"*\" && c !== \"/\" && c !== \"%\" &&\r\n      c !== \"&\" && c !== \"|\" && c !== \"^\" && c !== \"~\" && c !== \"@\" && c !== \"#\" && c !== \"?\" && c !== \"'\" &&\r\n      c !== \"`\" && c !== \"\\\"\" && c !== \"\\\\\" && c !== \"\\n\" && c !== \"\\r\" && c !== \"\\t\" && c !== \"\\0\";\r\n  }\r\n\r\n  _isNumeric(c: string): boolean {\r\n    return c >= \"0\" && c <= \"9\";\r\n  }\r\n\r\n  _isAlphaNumeric(c: string): boolean {\r\n    return this._isAlpha(c) || this._isNumeric(c) || c === \"_\";\r\n  }\r\n\r\n  _isWhitespace(c: string): boolean {\r\n    return c == \" \" || c == \"\\t\" || c == \"\\r\";\r\n  }\r\n\r\n  _advance(amount: number = 0): string {\r\n    let c = this._source[this._current];\r\n    amount = amount || 0;\r\n    amount++;\r\n    this._current += amount;\r\n    return c;\r\n  }\r\n\r\n  _peekAhead(offset: number = 0): string {\r\n    offset = offset || 0;\r\n    if (this._current + offset >= this._source.length) {\r\n      return \"\\0\";\r\n    }\r\n    return this._source[this._current + offset];\r\n  }\r\n\r\n  _addToken(type: TokenType) {\r\n    const text = this._source.substring(this._start, this._current);\r\n    this._tokens.push(new Token(type, text, this._line, this._start, this._current));\r\n  }\r\n}\r\n", "export function isArray(value: any): boolean {\r\n    return Array.isArray(value) || value?.buffer instanceof ArrayBuffer;\r\n}\r\n\r\nexport function isNumber(value: any): boolean {\r\n    return typeof value === \"number\";\r\n}\r\n\r\nconst _f32 = new Float32Array(1);\r\nconst _f32_i32 = new Uint32Array(_f32.buffer);\r\nconst _f32_u32 = new Uint32Array(_f32.buffer);\r\nconst _i32 = new Int32Array(1);\r\nconst _i32_f32 = new Float32Array(_i32.buffer);\r\nconst _i32_u32 = new Uint32Array(_i32.buffer);\r\nconst _u32 = new Uint32Array(1);\r\nconst _u32_f32 = new Float32Array(_u32.buffer);\r\nconst _u32_i32 = new Int32Array(_u32.buffer);\r\n\r\nexport function castScalar(v: number, from: string, to: string): number {\r\n    if (from === to) {\r\n        return v;\r\n    }\r\n\r\n    if (from === \"f32\") {\r\n        if (to === \"i32\" || to === \"x32\") {\r\n            _f32[0] = v;\r\n            return _f32_i32[0];\r\n        } else if (to === \"u32\") {\r\n            _f32[0] = v;\r\n            return _f32_u32[0];\r\n        }\r\n    } else if (from === \"i32\" || from === \"x32\") {\r\n        if (to === \"f32\") {\r\n            _i32[0] = v;\r\n            return _i32_f32[0];\r\n        } else if (to === \"u32\") {\r\n            _i32[0] = v;\r\n            return _i32_u32[0];\r\n        }\r\n    } else if (from === \"u32\") {\r\n        if (to === \"f32\") {\r\n            _u32[0] = v;\r\n            return _u32_f32[0];\r\n        } else if (to === \"i32\" || to === \"x32\") {\r\n            _u32[0] = v;\r\n            return _u32_i32[0];\r\n        }\r\n    }\r\n\r\n    console.error(`Unsupported cast from ${from} to ${to}`);\r\n    return v;\r\n}\r\n\r\nexport function castVector(v: number[], from: string, to: string): number[] {\r\n    if (from === to) {\r\n        return v;\r\n    }\r\n\r\n    const cast = new Array<number>(v.length);\r\n    for (let i = 0; i < v.length; i++) {\r\n        cast[i] = castScalar(v[i], from, to);\r\n    }\r\n\r\n    return cast;\r\n}\r\n", "/**\r\n * @author Brendan Duncan / https://github.com/brendan-duncan\r\n */\r\nimport { TokenTypes } from \"../wgsl_scanner.js\";\r\nimport { Type, Struct, Alias, Override, Var, Node, Function, VariableExpr, CreateExpr,\r\n    Let, CallExpr, Call, Argument, Member, Attribute, ArrayType, SamplerType, TemplateType, \r\n    PointerType } from \"../wgsl_ast.js\";\r\nimport { _BlockStart, _BlockEnd } from \"../wgsl_ast.js\";\r\nimport { FunctionInfo, VariableInfo, AliasInfo, OverrideInfo, PointerInfo,\r\n  StructInfo, TypeInfo, MemberInfo, ArrayInfo, TemplateInfo, OutputInfo,\r\n  InputInfo, ArgumentInfo, ResourceType, EntryFunctions } from \"./info.js\";\r\nimport { isArray } from \"../utils/cast.js\";\r\n \r\nclass _FunctionResources {\r\n  node: Function;\r\n  resources: VariableInfo[] | null = null;\r\n  inUse: boolean = false;\r\n  info: FunctionInfo | null = null;\r\n  constructor(node: Function) {\r\n    this.node = node;\r\n  }\r\n}\r\n\r\nclass _TypeSize {\r\n  align: number;\r\n  size: number;\r\n\r\n  constructor(align: number, size: number) {\r\n    this.align = align;\r\n    this.size = size;\r\n  }\r\n}\r\n\r\nexport class Reflect {\r\n  /// All top-level uniform vars in the shader.\r\n  uniforms: VariableInfo[] = [];\r\n  /// All top-level storage vars in the shader.\r\n  storage: VariableInfo[] = [];\r\n  /// All top-level texture vars in the shader;\r\n  textures: VariableInfo[] = [];\r\n  // All top-level sampler vars in the shader.\r\n  samplers: VariableInfo[] = [];\r\n  /// All top-level type aliases in the shader.\r\n  aliases: AliasInfo[] = [];\r\n  /// All top-level overrides in the shader.\r\n  overrides: OverrideInfo[] = [];\r\n  /// All top-level structs in the shader.\r\n  structs: StructInfo[] = [];\r\n  /// All entry functions in the shader: vertex, fragment, and/or compute.\r\n  entry: EntryFunctions = new EntryFunctions();\r\n  /// All functions in the shader, including entry functions.\r\n  functions: FunctionInfo[] = [];\r\n\r\n  _types: Map<Type, TypeInfo> = new Map();\r\n  _functions: Map<string, _FunctionResources> = new Map();\r\n\r\n  _isStorageTexture(type: TypeInfo): boolean {\r\n    return (\r\n      type.name == \"texture_storage_1d\" ||\r\n      type.name == \"texture_storage_2d\" ||\r\n      type.name == \"texture_storage_2d_array\" ||\r\n      type.name == \"texture_storage_3d\"\r\n    );\r\n  }\r\n\r\n  updateAST(ast: Node[]): void {\r\n    for (const node of ast) {\r\n      if (node instanceof Function) {\r\n        this._functions.set(node.name, new _FunctionResources(node as Function));\r\n      }\r\n    }\r\n\r\n    for (const node of ast) {\r\n      if (node instanceof Struct) {\r\n        const info = this.getTypeInfo(node as Struct, null);\r\n        if (info instanceof StructInfo) {\r\n          this.structs.push(info as StructInfo);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const node of ast) {\r\n      if (node instanceof Alias) {\r\n        this.aliases.push(this._getAliasInfo(node as Alias));\r\n        continue;\r\n      }\r\n\r\n      if (node instanceof Override) {\r\n        const v = node as Override;\r\n        const id = this._getAttributeNum(v.attributes, \"id\", 0);\r\n        const type = v.type != null ? this.getTypeInfo(v.type, v.attributes) : null;\r\n        this.overrides.push(new OverrideInfo(v.name, type, v.attributes, id));\r\n        continue;\r\n      }\r\n\r\n      if (this._isUniformVar(node)) {\r\n        const v = node as Var;\r\n        const g = this._getAttributeNum(v.attributes, \"group\", 0);\r\n        const b = this._getAttributeNum(v.attributes, \"binding\", 0);\r\n        const type = this.getTypeInfo(v.type!, v.attributes);\r\n        const varInfo = new VariableInfo(v.name, type, g, b, v.attributes, ResourceType.Uniform, v.access);\r\n        if (!varInfo.access) {\r\n          varInfo.access = \"read\";\r\n        }\r\n        this.uniforms.push(varInfo);\r\n        continue;\r\n      }\r\n\r\n      if (this._isStorageVar(node)) {\r\n        const v = node as Var;\r\n        const g = this._getAttributeNum(v.attributes, \"group\", 0);\r\n        const b = this._getAttributeNum(v.attributes, \"binding\", 0);\r\n        const type = this.getTypeInfo(v.type!, v.attributes);\r\n        const isStorageTexture = this._isStorageTexture(type);\r\n        const varInfo = new VariableInfo(v.name, type, g, b, v.attributes, isStorageTexture ? ResourceType.StorageTexture : ResourceType.Storage, v.access);\r\n        if (!varInfo.access) {\r\n          varInfo.access = \"read\";\r\n        }\r\n        this.storage.push(varInfo);\r\n        continue;\r\n      }\r\n\r\n      if (this._isTextureVar(node)) {\r\n        const v = node as Var;\r\n        const g = this._getAttributeNum(v.attributes, \"group\", 0);\r\n        const b = this._getAttributeNum(v.attributes, \"binding\", 0);\r\n        const type = this.getTypeInfo(v.type!, v.attributes);\r\n        const isStorageTexture = this._isStorageTexture(type);\r\n        const varInfo = new VariableInfo(v.name, type, g, b, v.attributes, \r\n            isStorageTexture ? ResourceType.StorageTexture : ResourceType.Texture, v.access);\r\n        if (!varInfo.access) {\r\n          varInfo.access = \"read\";\r\n        }\r\n        if (isStorageTexture) {\r\n          this.storage.push(varInfo);\r\n        } else {\r\n          this.textures.push(varInfo);\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (this._isSamplerVar(node)) {\r\n        const v = node as Var;\r\n        const g = this._getAttributeNum(v.attributes, \"group\", 0);\r\n        const b = this._getAttributeNum(v.attributes, \"binding\", 0);\r\n        const type = this.getTypeInfo(v.type!, v.attributes);\r\n        const varInfo = new VariableInfo(v.name, type, g, b, v.attributes, ResourceType.Sampler, v.access);\r\n        this.samplers.push(varInfo);\r\n        continue;\r\n      }\r\n    }\r\n\r\n    for (const node of ast) {\r\n      if (node instanceof Function) {\r\n        const vertexStage = this._getAttribute(node, \"vertex\");\r\n        const fragmentStage = this._getAttribute(node, \"fragment\");\r\n        const computeStage = this._getAttribute(node, \"compute\");\r\n        const stage = vertexStage || fragmentStage || computeStage;\r\n\r\n        const fn = new FunctionInfo(node.name, stage?.name, node.attributes);\r\n        fn.attributes = node.attributes;\r\n        fn.startLine = node.startLine;\r\n        fn.endLine = node.endLine;\r\n        this.functions.push(fn);\r\n        this._functions.get(node.name)!.info = fn;\r\n\r\n        if (stage) {\r\n          this._functions.get(node.name)!.inUse = true;\r\n          fn.inUse = true;\r\n          fn.resources = this._findResources(node, !!stage);\r\n          fn.inputs = this._getInputs(node.args);\r\n          fn.outputs = this._getOutputs(node.returnType);\r\n          this.entry[stage.name].push(fn);\r\n        }\r\n\r\n        fn.arguments = node.args.map(\r\n          (arg) => new ArgumentInfo(arg.name, this.getTypeInfo(arg.type, arg.attributes), arg.attributes)\r\n        );\r\n\r\n        fn.returnType = node.returnType ? this.getTypeInfo(node.returnType, node.attributes) : null;\r\n\r\n        continue;\r\n      }\r\n    }\r\n\r\n    for (const fn of this._functions.values()) {\r\n      if (fn.info) {\r\n        fn.info.inUse = fn.inUse;\r\n        this._addCalls(fn.node, fn.info.calls);\r\n      }\r\n    }\r\n\r\n    for (const fn of this._functions.values()) {\r\n      fn.node.search((node) => {\r\n        if (node instanceof Attribute) {\r\n          if (node.value) {\r\n            if (isArray(node.value)) {\r\n              for (const value of node.value) {\r\n                for (const override of this.overrides) {\r\n                  if (value === override.name) {\r\n                    fn.info?.overrides.push(override);\r\n                  }\r\n                }\r\n              }\r\n            } else {\r\n              for (const override of this.overrides) {\r\n                if (node.value === override.name) {\r\n                  fn.info?.overrides.push(override);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        } else if (node instanceof VariableExpr) {\r\n          for (const override of this.overrides) {\r\n            if (node.name === override.name) {\r\n              fn.info?.overrides.push(override);\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    for (const u of this.uniforms) {\r\n      this._markStructsInUse(u.type);\r\n    }\r\n    for (const s of this.storage) {\r\n      this._markStructsInUse(s.type);\r\n    }\r\n  }\r\n\r\n  getFunctionInfo(name: string): FunctionInfo | null {\r\n    for (const fn of this.functions) {\r\n      if (fn.name == name) {\r\n        return fn;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getStructInfo(name: string): StructInfo | null {\r\n    for (const s of this.structs) {\r\n      if (s.name == name) {\r\n        return s;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getOverrideInfo(name: string): OverrideInfo | null {\r\n    for (const o of this.overrides) {\r\n      if (o.name == name) {\r\n        return o;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _markStructsInUse(type: TypeInfo) {\r\n    if (!type) {\r\n      return;\r\n    }\r\n    if (type.isStruct) {\r\n      (type as StructInfo).inUse = true;\r\n      if ((type as StructInfo).members) {\r\n        for (const m of (type as StructInfo).members) {\r\n          this._markStructsInUse(m.type);\r\n        }\r\n      }\r\n    } else if (type.isArray) {\r\n      this._markStructsInUse((type as ArrayInfo).format);\r\n    } else if (type.isTemplate) {\r\n      if ((type as TemplateInfo).format) {\r\n        this._markStructsInUse((type as TemplateInfo).format!);\r\n      }\r\n    } else {\r\n      const alias = this._getAlias(type.name);\r\n      if (alias) {\r\n        this._markStructsInUse(alias);\r\n      }\r\n    }\r\n  }\r\n\r\n  _addCalls(fn: Function, calls: Set<FunctionInfo>, ) {\r\n    for (const call of fn.calls) {\r\n      const info = this._functions.get(call.name)?.info;\r\n      if (info) {\r\n        calls.add(info);\r\n      }\r\n    }\r\n  }\r\n\r\n  /// Find a resource by its group and binding.\r\n  findResource(group: number, binding: number, entry?: string) {\r\n    if (entry) {\r\n      for (const fn of this.entry.compute) {\r\n        if (fn.name === entry) {\r\n          for (const r of fn.resources) {\r\n            if (r.group == group && r.binding == binding) {\r\n              return r;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      for (const fn of this.entry.vertex) {\r\n        if (fn.name === entry) {\r\n          for (const r of fn.resources) {\r\n            if (r.group == group && r.binding == binding) {\r\n              return r;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      for (const fn of this.entry.fragment) {\r\n        if (fn.name === entry) {\r\n          for (const r of fn.resources) {\r\n            if (r.group == group && r.binding == binding) {\r\n              return r;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const u of this.uniforms) {\r\n      if (u.group == group && u.binding == binding) {\r\n        return u;\r\n      }\r\n    }\r\n    for (const s of this.storage) {\r\n      if (s.group == group && s.binding == binding) {\r\n        return s;\r\n      }\r\n    }\r\n    for (const t of this.textures) {\r\n      if (t.group == group && t.binding == binding) {\r\n        return t;\r\n      }\r\n    }\r\n    for (const s of this.samplers) {\r\n      if (s.group == group && s.binding == binding) {\r\n        return s;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _findResource(name: string): VariableInfo | null {\r\n    for (const u of this.uniforms) {\r\n      if (u.name == name) {\r\n        return u;\r\n      }\r\n    }\r\n    for (const s of this.storage) {\r\n      if (s.name == name) {\r\n        return s;\r\n      }\r\n    }\r\n    for (const t of this.textures) {\r\n      if (t.name == name) {\r\n        return t;\r\n      }\r\n    }\r\n    for (const s of this.samplers) {\r\n      if (s.name == name) {\r\n        return s;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  \r\n  _markStructsFromAST(type: Type) {\r\n    const info = this.getTypeInfo(type, null);\r\n    this._markStructsInUse(info);\r\n  }\r\n\r\n  _findResources(fn: Node, isEntry: boolean): VariableInfo[] {\r\n    const resources: any[] = [];\r\n    const self = this;\r\n    const varStack: any[] = [];\r\n    fn.search((node) => {\r\n      if (node instanceof _BlockStart) {\r\n        varStack.push({});\r\n      } else if (node instanceof _BlockEnd) {\r\n        varStack.pop();\r\n      } else if (node instanceof Var) {\r\n        const v = node as Var;\r\n        if (isEntry && v.type !== null) {\r\n          this._markStructsFromAST(v.type);\r\n        }\r\n        if (varStack.length > 0) {\r\n          varStack[varStack.length - 1][v.name] = v;\r\n        }\r\n      } else if (node instanceof CreateExpr) {\r\n        const c = node as CreateExpr;\r\n        if (isEntry && c.type !== null) {\r\n          this._markStructsFromAST(c.type);\r\n        }\r\n      } else if (node instanceof Let) {\r\n        const v = node as Let;\r\n        if (isEntry && v.type !== null) {\r\n          this._markStructsFromAST(v.type);\r\n        }\r\n        if (varStack.length > 0) {\r\n          varStack[varStack.length - 1][v.name] = v;\r\n        }\r\n      } else if (node instanceof VariableExpr) {\r\n        const v = node as VariableExpr;\r\n        // Check to see if the variable is a local variable before checking to see if it's\r\n        // a resource.\r\n        if (varStack.length > 0) {\r\n          const varInfo = varStack[varStack.length - 1][v.name];\r\n          if (varInfo) {\r\n            return;\r\n          }\r\n        }\r\n        const varInfo = self._findResource(v.name);\r\n        if (varInfo) {\r\n          resources.push(varInfo);\r\n        }\r\n      } else if (node instanceof CallExpr) {\r\n        const c = node as CallExpr;\r\n        const callFn = self._functions.get(c.name);\r\n        if (callFn) {\r\n          if (isEntry) {\r\n            callFn.inUse = true;\r\n          }\r\n          (fn as Function).calls.add(callFn.node);\r\n          if (callFn.resources === null) {\r\n            callFn.resources = self._findResources(callFn.node, isEntry);\r\n          }\r\n          resources.push(...callFn.resources);\r\n        }\r\n      } else if (node instanceof Call) {\r\n        const c = node as Call;\r\n        const callFn = self._functions.get(c.name);\r\n        if (callFn) {\r\n          if (isEntry) {\r\n            callFn.inUse = true;\r\n          }\r\n          (fn as Function).calls.add(callFn.node);\r\n          if (callFn.resources === null) {\r\n            callFn.resources = self._findResources(callFn.node, isEntry);\r\n          }\r\n          resources.push(...callFn.resources);\r\n        }\r\n      }\r\n    });\r\n    return [...new Map(resources.map(r => [r.name, r])).values()];\r\n  }\r\n\r\n  getBindGroups(): Array<VariableInfo[]> {\r\n    const groups: Array<VariableInfo[]> = [];\r\n\r\n    function _makeRoom(group: number, binding: number) {\r\n      if (group >= groups.length) {\r\n        groups.length = group + 1;\r\n      }\r\n\r\n      if (groups[group] === undefined) {\r\n        groups[group] = [];\r\n      }\r\n\r\n      if (binding >= groups[group].length) {\r\n        groups[group].length = binding + 1;\r\n      }\r\n    }\r\n\r\n    for (const u of this.uniforms) {\r\n      _makeRoom(u.group, u.binding);\r\n      const group = groups[u.group];\r\n      group[u.binding] = u;\r\n    }\r\n\r\n    for (const u of this.storage) {\r\n      _makeRoom(u.group, u.binding);\r\n      const group = groups[u.group];\r\n      group[u.binding] = u;\r\n    }\r\n\r\n    for (const t of this.textures) {\r\n      _makeRoom(t.group, t.binding);\r\n      const group = groups[t.group];\r\n      group[t.binding] = t;\r\n    }\r\n\r\n    for (const t of this.samplers) {\r\n      _makeRoom(t.group, t.binding);\r\n      const group = groups[t.group];\r\n      group[t.binding] = t;\r\n    }\r\n\r\n    return groups;\r\n  }\r\n\r\n  _getOutputs(\r\n    type: Type,\r\n    outputs: OutputInfo[] | undefined = undefined\r\n  ): OutputInfo[] {\r\n    if (outputs === undefined) {\r\n      outputs = [];\r\n    }\r\n\r\n    if (type instanceof Struct) {\r\n      this._getStructOutputs(type, outputs);\r\n    } else {\r\n      const output = this._getOutputInfo(type);\r\n      if (output !== null) {\r\n        outputs.push(output);\r\n      }\r\n    }\r\n\r\n    return outputs;\r\n  }\r\n\r\n  _getStructOutputs(struct: Struct, outputs: OutputInfo[]) {\r\n    for (const m of struct.members) {\r\n      if (m.type instanceof Struct) {\r\n        this._getStructOutputs(m.type, outputs);\r\n      } else {\r\n        const location =\r\n          this._getAttribute(m, \"location\") || this._getAttribute(m, \"builtin\");\r\n        if (location !== null) {\r\n          const typeInfo = this.getTypeInfo(m.type, m.type.attributes);\r\n          const locationValue = this._parseInt(location.value);\r\n          const info = new OutputInfo(\r\n            m.name,\r\n            typeInfo,\r\n            location.name,\r\n            locationValue\r\n          );\r\n          outputs.push(info);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _getOutputInfo(type: Type): OutputInfo | null {\r\n    const location =\r\n      this._getAttribute(type, \"location\") ||\r\n      this._getAttribute(type, \"builtin\");\r\n    if (location !== null) {\r\n      const typeInfo = this.getTypeInfo(type, type.attributes);\r\n      const locationValue = this._parseInt(location.value);\r\n      const info = new OutputInfo(\"\", typeInfo, location.name, locationValue);\r\n      return info;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _getInputs(\r\n    args: Argument[],\r\n    inputs: InputInfo[] | undefined = undefined\r\n  ): InputInfo[] {\r\n    if (inputs === undefined) {\r\n      inputs = [];\r\n    }\r\n\r\n    for (const arg of args) {\r\n      if (arg.type instanceof Struct) {\r\n        this._getStructInputs(arg.type, inputs);\r\n      } else {\r\n        const input = this._getInputInfo(arg);\r\n        if (input !== null) {\r\n          inputs.push(input);\r\n        }\r\n      }\r\n    }\r\n\r\n    return inputs;\r\n  }\r\n\r\n  _getStructInputs(struct: Struct, inputs: InputInfo[]) {\r\n    for (const m of struct.members) {\r\n      if (m.type instanceof Struct) {\r\n        this._getStructInputs(m.type, inputs);\r\n      } else {\r\n        const input = this._getInputInfo(m);\r\n        if (input !== null) {\r\n          inputs.push(input);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _getInputInfo(node: Member | Argument): InputInfo | null {\r\n    const location =\r\n      this._getAttribute(node, \"location\") ||\r\n      this._getAttribute(node, \"builtin\");\r\n    if (location !== null) {\r\n      const interpolation = this._getAttribute(node, \"interpolation\");\r\n      const type = this.getTypeInfo(node.type, node.attributes);\r\n      const locationValue = this._parseInt(location.value);\r\n      const info = new InputInfo(node.name, type, location.name, locationValue);\r\n      if (interpolation !== null) {\r\n        info.interpolation = this._parseString(interpolation.value);\r\n      }\r\n      return info;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _parseString(s: string | string[]): string {\r\n    if (s instanceof Array) {\r\n      s = s[0];\r\n    }\r\n    return s;\r\n  }\r\n\r\n  _parseInt(s: string | string[]): number | string {\r\n    if (s instanceof Array) {\r\n      s = s[0];\r\n    }\r\n    const n = parseInt(s);\r\n    return isNaN(n) ? s : n;\r\n  }\r\n\r\n  _getAlias(name: string): TypeInfo | null {\r\n    for (const a of this.aliases) {\r\n      if (a.name == name) {\r\n        return a.type;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _getAliasInfo(node: Alias): AliasInfo {\r\n    return new AliasInfo(node.name, this.getTypeInfo(node.type!, null));\r\n  }\r\n\r\n  getTypeInfoByName(name: string): TypeInfo | null {\r\n    for (const s of this.structs) {\r\n      if (s.name == name) {\r\n        return s;\r\n      }\r\n    }\r\n    for (const a of this.aliases) {\r\n      if (a.name == name) {\r\n        return a.type;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getTypeInfo(type: Type, attributes: Attribute[] | null = null): TypeInfo {\r\n    if (this._types.has(type)) {\r\n      return this._types.get(type)!;\r\n    }\r\n\r\n    if (type instanceof PointerType) {\r\n      const t = type.type ? this.getTypeInfo(type.type!, type.attributes) : null;\r\n      const info = new PointerInfo(type.name, t, attributes);\r\n      this._types.set(type, info);\r\n      this._updateTypeInfo(info);\r\n      return info;\r\n    }\r\n\r\n    if (type instanceof ArrayType) {\r\n      const a = type as ArrayType;\r\n      const t = a.format ? this.getTypeInfo(a.format!, a.attributes) : null;\r\n      const info = new ArrayInfo(a.name, attributes);\r\n      info.format = t;\r\n      info.count = a.count;\r\n      this._types.set(type, info);\r\n      this._updateTypeInfo(info);\r\n      return info;\r\n    }\r\n\r\n    if (type instanceof Struct) {\r\n      const s = type as Struct;\r\n      const info = new StructInfo(s.name, attributes);\r\n      info.startLine = s.startLine;\r\n      info.endLine = s.endLine;\r\n      for (const m of s.members) {\r\n        const t = this.getTypeInfo(m.type!, m.attributes);\r\n        info.members.push(new MemberInfo(m.name, t, m.attributes));\r\n      }\r\n      this._types.set(type, info);\r\n      this._updateTypeInfo(info);\r\n      return info;\r\n    }\r\n\r\n    if (type instanceof SamplerType) {\r\n      const s = type as SamplerType;\r\n      const formatIsType = s.format instanceof Type;\r\n      const format = s.format\r\n        ? formatIsType\r\n          ? this.getTypeInfo(s.format! as Type, null)\r\n          : new TypeInfo(s.format! as string, null)\r\n        : null;\r\n      const info = new TemplateInfo(s.name, format, attributes, s.access);\r\n      this._types.set(type, info);\r\n      this._updateTypeInfo(info);\r\n      return info;\r\n    }\r\n\r\n    if (type instanceof TemplateType) {\r\n      const t = type as TemplateType;\r\n      const format = t.format ? this.getTypeInfo(t.format!, null) : null;\r\n      const info = new TemplateInfo(t.name, format, attributes, t.access);\r\n      this._types.set(type, info);\r\n      this._updateTypeInfo(info);\r\n      return info;\r\n    }\r\n\r\n    const info = new TypeInfo(type.name, attributes);\r\n    this._types.set(type, info);\r\n    this._updateTypeInfo(info);\r\n    return info;\r\n  }\r\n\r\n  _updateTypeInfo(type: TypeInfo) {\r\n    const typeSize = this._getTypeSize(type);\r\n    type.size = typeSize?.size ?? 0;\r\n\r\n    if (type instanceof ArrayInfo) {\r\n      if (type[\"format\"]) {\r\n        const formatInfo = this._getTypeSize(type[\"format\"]);\r\n        // Array stride is the maximum of the format size and alignment.\r\n        // In the case of a vec3f, the size is 12 bytes, but the alignment is 16 bytes.\r\n        // Buffer alignment is therefore 16 bytes.\r\n        type.stride = Math.max(formatInfo?.size ?? 0, formatInfo?.align ?? 0);\r\n        this._updateTypeInfo(type[\"format\"]);\r\n      }\r\n    }\r\n\r\n    if (type instanceof PointerInfo) {\r\n      this._updateTypeInfo(type[\"format\"]);\r\n    }\r\n\r\n    if (type instanceof StructInfo) {\r\n      this._updateStructInfo(type);\r\n    }\r\n  }\r\n\r\n  _updateStructInfo(struct: StructInfo) {\r\n    let offset = 0;\r\n    let lastSize = 0;\r\n    let lastOffset = 0;\r\n    let structAlign = 0;\r\n\r\n    for (let mi = 0, ml = struct.members.length; mi < ml; ++mi) {\r\n      const member = struct.members[mi];\r\n\r\n      const sizeInfo = this._getTypeSize(member);\r\n      if (!sizeInfo) {\r\n        continue;\r\n      }\r\n\r\n      const type = this._getAlias(member.type.name) ?? member.type;\r\n      const align = sizeInfo.align;\r\n      const size = sizeInfo.size;\r\n      offset = this._roundUp(align, offset + lastSize);\r\n      lastSize = size;\r\n      lastOffset = offset;\r\n      structAlign = Math.max(structAlign, align);\r\n\r\n      member.offset = offset;\r\n      member.size = size;\r\n\r\n      this._updateTypeInfo(member.type);\r\n    }\r\n\r\n    struct.size = this._roundUp(structAlign, lastOffset + lastSize);\r\n    struct.align = structAlign;\r\n  }\r\n\r\n  _getTypeSize(\r\n    type: TypeInfo | MemberInfo | null | undefined\r\n  ): _TypeSize | null {\r\n    if (type === null || type === undefined) {\r\n      return null;\r\n    }\r\n\r\n    const explicitSize = this._getAttributeNum(type.attributes, \"size\", 0);\r\n    const explicitAlign = this._getAttributeNum(type.attributes, \"align\", 0);\r\n\r\n    if (type instanceof MemberInfo) {\r\n      type = type.type;\r\n    }\r\n\r\n    if (type instanceof TypeInfo) {\r\n      const alias = this._getAlias(type.name);\r\n      if (alias !== null) {\r\n        type = alias;\r\n      }\r\n    }\r\n\r\n    {\r\n      const info = Reflect._typeInfo[type.name];\r\n      if (info !== undefined) {\r\n        const divisor = type[\"format\"]?.name === \"f16\" ? 2 : 1;\r\n        return new _TypeSize(\r\n          Math.max(explicitAlign, info.align / divisor),\r\n          Math.max(explicitSize, info.size / divisor)\r\n        );\r\n      }\r\n    }\r\n\r\n    {\r\n      const info =\r\n        Reflect._typeInfo[type.name.substring(0, type.name.length - 1)];\r\n      if (info) {\r\n        const divisor = type.name[type.name.length - 1] === \"h\" ? 2 : 1;\r\n        return new _TypeSize(\r\n          Math.max(explicitAlign, info.align / divisor),\r\n          Math.max(explicitSize, info.size / divisor)\r\n        );\r\n      }\r\n    }\r\n\r\n    if (type instanceof ArrayInfo) {\r\n      let arrayType = type as ArrayInfo;\r\n      let align = 8;\r\n      let size = 8;\r\n      // Type                 AlignOf(T)          Sizeof(T)\r\n      // array<E, N>          AlignOf(E)          N * roundUp(AlignOf(E), SizeOf(E))\r\n      // array<E>             AlignOf(E)          N * roundUp(AlignOf(E), SizeOf(E))  (N determined at runtime)\r\n      //\r\n      // @stride(Q)\r\n      // array<E, N>          AlignOf(E)          N * Q\r\n      //\r\n      // @stride(Q)\r\n      // array<E>             AlignOf(E)          Nruntime * Q\r\n      //const E = type.format.name;\r\n      const E = this._getTypeSize(arrayType.format);\r\n      if (E !== null) {\r\n        size = E.size;\r\n        align = E.align;\r\n      }\r\n\r\n      const N = arrayType.count;\r\n\r\n      const stride = this._getAttributeNum(\r\n        type?.attributes ?? null,\r\n        \"stride\",\r\n        this._roundUp(align, size)\r\n      );\r\n      size = N * stride;\r\n\r\n      if (explicitSize) {\r\n        size = explicitSize;\r\n      }\r\n\r\n      return new _TypeSize(\r\n        Math.max(explicitAlign, align),\r\n        Math.max(explicitSize, size)\r\n      );\r\n    }\r\n\r\n    if (type instanceof StructInfo) {\r\n      let align = 0;\r\n      let size = 0;\r\n      // struct S     AlignOf:    max(AlignOfMember(S, M1), ... , AlignOfMember(S, MN))\r\n      //              SizeOf:     roundUp(AlignOf(S), OffsetOfMember(S, L) + SizeOfMember(S, L))\r\n      //                          Where L is the last member of the structure\r\n      let offset = 0;\r\n      let lastSize = 0;\r\n      let lastOffset = 0;\r\n      for (const m of type.members) {\r\n        const mi = this._getTypeSize(m.type);\r\n        if (mi !== null) {\r\n          align = Math.max(mi.align, align);\r\n          offset = this._roundUp(mi.align, offset + lastSize);\r\n          lastSize = mi.size;\r\n          lastOffset = offset;\r\n        }\r\n      }\r\n      size = this._roundUp(align, lastOffset + lastSize);\r\n\r\n      return new _TypeSize(\r\n        Math.max(explicitAlign, align),\r\n        Math.max(explicitSize, size)\r\n      );\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _isUniformVar(node: Node): boolean {\r\n    return node instanceof Var && node.storage == \"uniform\";\r\n  }\r\n\r\n  _isStorageVar(node: Node): boolean {\r\n    return node instanceof Var && node.storage == \"storage\";\r\n  }\r\n\r\n  _isTextureVar(node: Node): boolean {\r\n    return (\r\n      node instanceof Var &&\r\n      node.type !== null &&\r\n      Reflect._textureTypes.indexOf(node.type.name) != -1\r\n    );\r\n  }\r\n\r\n  _isSamplerVar(node: Node): boolean {\r\n    return (\r\n      node instanceof Var &&\r\n      node.type !== null &&\r\n      Reflect._samplerTypes.indexOf(node.type.name) != -1\r\n    );\r\n  }\r\n\r\n  _getAttribute(node: Node, name: string): Attribute | null {\r\n    const obj = node as Object;\r\n    if (!obj || !obj[\"attributes\"]) {\r\n      return null;\r\n    }\r\n    const attrs = obj[\"attributes\"];\r\n    for (let a of attrs) {\r\n      if (a.name == name) {\r\n        return a;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _getAttributeNum(\r\n    attributes: Attribute[] | null,\r\n    name: string,\r\n    defaultValue: number\r\n  ): number {\r\n    if (attributes === null) {\r\n      return defaultValue;\r\n    }\r\n    for (let a of attributes) {\r\n      if (a.name == name) {\r\n        let v = a !== null && a.value !== null ? a.value : defaultValue;\r\n        if (v instanceof Array) {\r\n          v = v[0];\r\n        }\r\n        if (typeof v === \"number\") {\r\n          return v;\r\n        }\r\n        if (typeof v === \"string\") {\r\n          return parseInt(v);\r\n        }\r\n        return defaultValue;\r\n      }\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n  _roundUp(k: number, n: number): number {\r\n    return Math.ceil(n / k) * k;\r\n  }\r\n\r\n  // Type                 AlignOf(T)          Sizeof(T)\r\n  // i32, u32, or f32     4                   4\r\n  // atomic<T>            4                   4\r\n  // vec2<T>              8                   8\r\n  // vec3<T>              16                  12\r\n  // vec4<T>              16                  16\r\n  // mat2x2<f32>          8                   16\r\n  // mat3x2<f32>          8                   24\r\n  // mat4x2<f32>          8                   32\r\n  // mat2x3<f32>          16                  32\r\n  // mat3x3<f32>          16                  48\r\n  // mat4x3<f32>          16                  64\r\n  // mat2x4<f32>          16                  32\r\n  // mat3x4<f32>          16                  48\r\n  // mat4x4<f32>          16                  64\r\n  static readonly _typeInfo = {\r\n    f16: { align: 2, size: 2 },\r\n    i32: { align: 4, size: 4 },\r\n    u32: { align: 4, size: 4 },\r\n    f32: { align: 4, size: 4 },\r\n    atomic: { align: 4, size: 4 },\r\n    vec2: { align: 8, size: 8 },\r\n    vec3: { align: 16, size: 12 },\r\n    vec4: { align: 16, size: 16 },\r\n    mat2x2: { align: 8, size: 16 },\r\n    mat3x2: { align: 8, size: 24 },\r\n    mat4x2: { align: 8, size: 32 },\r\n    mat2x3: { align: 16, size: 32 },\r\n    mat3x3: { align: 16, size: 48 },\r\n    mat4x3: { align: 16, size: 64 },\r\n    mat2x4: { align: 16, size: 32 },\r\n    mat3x4: { align: 16, size: 48 },\r\n    mat4x4: { align: 16, size: 64 },\r\n  };\r\n\r\n  static readonly _textureTypes = TokenTypes.any_texture_type.map((t) => {\r\n    return t.name;\r\n  });\r\n\r\n  static readonly _samplerTypes = TokenTypes.sampler_type.map((t) => {\r\n    return t.name;\r\n  });\r\n}\r\n", "import { Let, Var, Argument, Function } from \"../wgsl_ast.js\";\r\nimport { Data } from \"../wgsl_ast.js\";\r\n\r\ntype ASTVarNode = Let | Var | Argument;\r\n\r\nlet _id = 0;\r\n\r\nexport class VarRef {\r\n    name: string;\r\n    value: Data;\r\n    node: ASTVarNode | null;\r\n    readonly id: number = _id++;\r\n\r\n    constructor(n: string, v: Data, node: ASTVarNode | null) {\r\n        this.name = n;\r\n        this.value = v;\r\n        this.node = node;\r\n    }\r\n\r\n    clone(): VarRef {\r\n        return new VarRef(this.name, this.value, this.node);\r\n    }\r\n};\r\n\r\nexport class FunctionRef {\r\n    name: string;\r\n    node: Function;\r\n    readonly id: number = _id++;\r\n\r\n    constructor(node: Function) {\r\n        this.name = node.name;\r\n        this.node = node;\r\n    }\r\n\r\n    clone(): FunctionRef {\r\n        return new FunctionRef(this.node);\r\n    }\r\n};\r\n\r\nexport class ExecContext {\r\n    parent: ExecContext | null = null;\r\n    variables = new Map<string, VarRef>();\r\n    functions = new Map<string, FunctionRef>();\r\n    currentFunctionName = \"\";\r\n    readonly id: number = _id++;\r\n\r\n    constructor(parent?: ExecContext) {\r\n        if (parent) {\r\n            this.parent = parent;\r\n            this.currentFunctionName = parent.currentFunctionName;\r\n        }\r\n    }\r\n\r\n    getVariable(name: string): VarRef | null {\r\n        if (this.variables.has(name)) {\r\n            return this.variables.get(name) ?? null;\r\n        }\r\n        if (this.parent) {\r\n            return this.parent.getVariable(name);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getFunction(name: string): FunctionRef | null {\r\n        if (this.functions.has(name)) {\r\n            return this.functions.get(name) ?? null;\r\n        }\r\n        if (this.parent) {\r\n            return this.parent.getFunction(name);\r\n        }\r\n        return null\r\n    }\r\n\r\n    createVariable(name: string, value: Data, node?: ASTVarNode) {\r\n        this.variables.set(name, new VarRef(name, value, node ?? null));\r\n    }\r\n\r\n    setVariable(name: string, value: Data, node?: ASTVarNode) {\r\n        const v = this.getVariable(name);\r\n        if (v !== null) {\r\n            v.value = value;\r\n        } else {\r\n            this.createVariable(name, value, node);\r\n        }\r\n    }\r\n\r\n    getVariableValue(name: string): Data | null {\r\n        const v = this.getVariable(name);\r\n        return v?.value ?? null;\r\n    }\r\n\r\n    clone(): ExecContext {\r\n        return new ExecContext(this);\r\n    }\r\n};\r\n", "import { Node, Type } from \"../wgsl_ast.js\";\r\nimport { ExecContext } from \"./exec_context.js\";\r\nimport { TypeInfo } from \"../wgsl_reflect.js\";\r\nimport { Data } from \"../wgsl_ast.js\";\r\n\r\nexport class ExecInterface {\r\n    evalExpression(node: Node, context: ExecContext): Data | null {\r\n        return null;\r\n    }\r\n\r\n    getTypeInfo(type: Type | string): TypeInfo | null {\r\n        return null; \r\n    }\r\n\r\n    getVariableName(node: Node, context: ExecContext): string | null {\r\n        return \"\";\r\n    }\r\n}\r\n", "import { CallExpr, Call, UnaryOperator, VariableExpr } from \"../wgsl_ast.js\";\r\nimport { Data, TypedData, TextureData, ScalarData, VectorData, MatrixData } from \"../wgsl_ast.js\";\r\nimport { ExecContext } from \"./exec_context.js\";\r\nimport { ExecInterface } from \"./exec_interface.js\";\r\nimport { ArrayInfo, TypeInfo } from \"../reflect/info.js\";\r\n\r\nexport class BuiltinFunctions {\r\n    exec: ExecInterface;\r\n\r\n    constructor(exec: ExecInterface) {\r\n        this.exec = exec;\r\n    }\r\n\r\n    getTypeInfo(type: string): TypeInfo | null {\r\n        return this.exec.getTypeInfo(type);\r\n    }\r\n\r\n    // Logical Built-in Functions\r\n    All(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        let isTrue = true;\r\n        if (value instanceof VectorData) {\r\n            value.data.forEach((x: any) => { if (!x) isTrue = false; });\r\n            return new ScalarData(isTrue ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n        }\r\n        throw new Error(`All() expects a vector argument. Line ${node.line}`);\r\n    }\r\n\r\n    Any(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            const res = value.data.some((v: any) => v);\r\n            return new ScalarData(res ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n        }\r\n        throw new Error(`Any() expects a vector argument. Line ${node.line}`);\r\n    }\r\n\r\n    Select(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // select(false, true, condition)\r\n        const condition = this.exec.evalExpression(node.args[2], context);\r\n        if (!(condition instanceof ScalarData)) {\r\n            throw new Error(`Select() expects a bool condition. Line ${node.line}`);\r\n        }\r\n        if (!condition.value) {\r\n            return this.exec.evalExpression(node.args[0], context);\r\n        } else {\r\n            return this.exec.evalExpression(node.args[1], context);\r\n        }\r\n    }\r\n\r\n    // Array Built-in Functions\r\n    ArrayLength(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let arrayArg = node.args[0];\r\n        // TODO: handle \"&\" operator\r\n        if (arrayArg instanceof UnaryOperator) {\r\n            arrayArg = (arrayArg as UnaryOperator).right;\r\n        }\r\n        const arrayData = this.exec.evalExpression(arrayArg, context);\r\n        if (arrayData instanceof TypedData && arrayData.typeInfo.size === 0) {\r\n            const ta = arrayData.typeInfo as ArrayInfo;\r\n            const count = arrayData.buffer.byteLength / ta.stride;\r\n            return new ScalarData(count, this.getTypeInfo(\"u32\"));\r\n        }\r\n        return new ScalarData(arrayData.typeInfo.size, this.getTypeInfo(\"u32\"));\r\n    }\r\n\r\n    // Numeric Built-in Functions\r\n    Abs(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.abs(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.abs(s.value), s.typeInfo);\r\n    }\r\n\r\n    Acos(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.acos(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.acos(s.value), value.typeInfo);\r\n    }\r\n\r\n    Acosh(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.acosh(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.acosh(s.value), value.typeInfo);\r\n    }\r\n\r\n    Asin(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.asin(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.asin(s.value), value.typeInfo);\r\n    }\r\n\r\n    Asinh(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.asinh(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.asinh(s.value), value.typeInfo);\r\n    }\r\n\r\n    Atan(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.atan(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.atan(s.value), value.typeInfo);\r\n    }\r\n\r\n    Atanh(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.atanh(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.atanh(s.value), value.typeInfo);\r\n    }\r\n\r\n    Atan2(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const y = this.exec.evalExpression(node.args[0], context);\r\n        const x = this.exec.evalExpression(node.args[1], context);\r\n        if (y instanceof VectorData && x instanceof VectorData) {\r\n            return new VectorData(y.data.map((v: number, i: number) => Math.atan2(v, x.data[i])), y.typeInfo);\r\n        }\r\n        const ys = y as ScalarData;\r\n        const xs = x as ScalarData;\r\n        return new ScalarData(Math.atan2(ys.value, xs.value), y.typeInfo);\r\n    }\r\n\r\n    Ceil(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.ceil(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.ceil(s.value), value.typeInfo);\r\n    }\r\n\r\n    _clamp(value: number, min: number, max: number): number {\r\n        return Math.min(Math.max(value, min), max);\r\n    }\r\n\r\n    Clamp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        const min = this.exec.evalExpression(node.args[1], context);\r\n        const max = this.exec.evalExpression(node.args[2], context);\r\n        if (value instanceof VectorData && min instanceof VectorData && max instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number, i: number) => this._clamp(v, min.data[i], max.data[i])), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        const minS = min as ScalarData;\r\n        const maxS = max as ScalarData\r\n        return new ScalarData(this._clamp(s.value, minS.value, maxS.value), value.typeInfo);\r\n    }\r\n\r\n    Cos(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.cos(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.cos(s.value), value.typeInfo);\r\n    }\r\n\r\n    Cosh(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.cosh(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.cos(s.value), value.typeInfo);\r\n    }\r\n\r\n    CountLeadingZeros(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.clz32(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.clz32(s.value), value.typeInfo);\r\n    }\r\n\r\n    _countOneBits(value: number): number {\r\n        let count = 0;\r\n        while (value !== 0) {\r\n            if (value & 1) {\r\n                count++;\r\n            }\r\n            value >>= 1;\r\n        }\r\n        return count;\r\n    }\r\n\r\n    CountOneBits(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => this._countOneBits(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(this._countOneBits(s.value), value.typeInfo);\r\n    }\r\n\r\n    _countTrailingZeros(value: number): number {\r\n        if (value === 0) {\r\n            return 32; // Special case for 0\r\n        }\r\n        let count = 0;\r\n        while ((value & 1) === 0) {\r\n            value >>= 1;\r\n            count++;\r\n        }\r\n        return count;\r\n    }\r\n\r\n    CountTrailingZeros(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => this._countTrailingZeros(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(this._countTrailingZeros(s.value), value.typeInfo);\r\n    }\r\n\r\n    Cross(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const l = this.exec.evalExpression(node.args[0], context);\r\n        const r = this.exec.evalExpression(node.args[1], context);\r\n        if (l instanceof VectorData && r instanceof VectorData) {\r\n            if (l.data.length !== 3 || r.data.length !== 3) {\r\n                console.error(`Cross() expects 3D vectors. Line ${node.line}`);\r\n                return null;\r\n            }\r\n            const lv = l.data;\r\n            const rv = r.data;\r\n            return new VectorData([\r\n                lv[1] * rv[2] - rv[1] * lv[2],\r\n                lv[2] * rv[0] - rv[2] * lv[0],\r\n                lv[0] * rv[1] - rv[0] * lv[1],\r\n            ], l.typeInfo);\r\n        }\r\n        console.error(`Cross() expects vector arguments. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Degrees(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        const radToDeg = 180.0 / Math.PI;\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => v * radToDeg), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(s.value * radToDeg, this.getTypeInfo(\"f32\"));\r\n    }\r\n\r\n    Determinant(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const m = this.exec.evalExpression(node.args[0], context);\r\n        if (m instanceof MatrixData) {\r\n            const mv = m.data;\r\n            const mt = m.typeInfo.getTypeName();\r\n            const isHalf = mt.endsWith(\"h\");\r\n            const formatType = isHalf ? this.getTypeInfo(\"f16\") : this.getTypeInfo(\"f32\");\r\n            if (mt === \"mat2x2\" || mt === \"mat2x2f\" || mt === \"mat2x2h\") {\r\n                return new ScalarData(mv[0] * mv[3] - mv[1] * mv[2], formatType);\r\n            } else if (mt === \"mat2x3\" || mt === \"mat2x3f\" || mt === \"mat2x3h\") {\r\n                return new ScalarData(mv[0] * (mv[4] * mv[8] - mv[5] * mv[7]) -\r\n                        mv[1] * (mv[3] * mv[8] - mv[5] * mv[6]) + mv[2] * (mv[3] * mv[7] - mv[4] * mv[6]), formatType);\r\n            } else if (mt === \"mat2x4\" || mt === \"mat2x4f\" || mt === \"mat2x4h\") {\r\n                console.error(`TODO: Determinant for ${mt}`);\r\n            } else if (mt === \"mat3x2\" || mt === \"mat3x2f\" || mt === \"mat3x2h\") {\r\n                console.error(`TODO: Determinant for ${mt}`);\r\n            } else if (mt === \"mat3x3\" || mt === \"mat3x3f\" || mt === \"mat3x3h\") {\r\n                return new ScalarData(mv[0] * (mv[4] * mv[8] - mv[5] * mv[7]) -\r\n                        mv[1] * (mv[3] * mv[8] - mv[5] * mv[6]) + mv[2] * (mv[3] * mv[7] - mv[4] * mv[6]), formatType);\r\n            } else if (mt === \"mat3x4\" || mt === \"mat3x4f\" || mt === \"mat3x4h\") {\r\n                console.error(`TODO: Determinant for ${mt}`);\r\n            } else if (mt === \"mat4x2\" || mt === \"mat4x2f\" || mt === \"mat4x2h\") {\r\n                console.error(`TODO: Determinant for ${mt}`);\r\n            } else if (mt === \"mat4x3\" || mt === \"mat4x3f\" || mt === \"mat4x3h\") {\r\n                console.error(`TODO: Determinant for ${mt}`);\r\n            } else if (mt === \"mat4x4\" || mt === \"mat4x4f\" || mt === \"mat4x4h\") {\r\n                console.error(`TODO: Determinant for ${mt}`);\r\n            }\r\n        }\r\n        console.error(`Determinant expects a matrix argument. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Distance(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const l = this.exec.evalExpression(node.args[0], context);\r\n        const r = this.exec.evalExpression(node.args[1], context);\r\n        if (l instanceof VectorData && r instanceof VectorData) {\r\n            let sum = 0;\r\n            for (let i = 0; i < l.data.length; ++i) {\r\n                sum += (l.data[i] - r.data[i]) * (l.data[i] - r.data[i]);\r\n            }\r\n            return new ScalarData(Math.sqrt(sum), this.getTypeInfo(\"f32\"));\r\n        }\r\n        const ls = l as ScalarData;\r\n        const rs = r as ScalarData;\r\n        return new ScalarData(Math.abs(ls.value - rs.value), l.typeInfo);\r\n    }\r\n\r\n    _dot(e1: Int32Array | Uint32Array | Float32Array, e2: Int32Array | Uint32Array | Float32Array) {\r\n        let dot = 0;\r\n        for (let i = 0; i < e1.length; ++i) {\r\n            dot += e2[i] * e1[i];\r\n        }\r\n        return dot;\r\n    }\r\n\r\n    Dot(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const l = this.exec.evalExpression(node.args[0], context);\r\n        const r = this.exec.evalExpression(node.args[1], context);\r\n        if (l instanceof VectorData && r instanceof VectorData) {\r\n            return new ScalarData(this._dot(l.data, r.data), this.getTypeInfo(\"f32\"));\r\n        }\r\n        console.error(`Dot() expects vector arguments. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Dot4U8Packed(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: dot4U8Packed. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Dot4I8Packed(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: dot4I8Packed. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Exp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.exp(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.exp(s.value), value.typeInfo);\r\n    }\r\n\r\n    Exp2(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.pow(2, v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.pow(2, s.value), value.typeInfo);\r\n    }\r\n\r\n    ExtractBits(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        const offset = this.exec.evalExpression(node.args[1], context);\r\n        const count = this.exec.evalExpression(node.args[2], context);\r\n        if (offset.typeInfo.name !== \"u32\" && offset.typeInfo.name !== \"x32\") {\r\n            console.error(`ExtractBits() expects an i32 offset argument. Line ${node.line}`);\r\n            return null;\r\n        }\r\n        if (count.typeInfo.name !== \"u32\" && count.typeInfo.name !== \"x32\") {\r\n            console.error(`ExtractBits() expects an i32 count argument. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const o = (offset as ScalarData).value;\r\n        const c = (count as ScalarData).value;\r\n\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => (v >> o) & ((1 << c) - 1)), value.typeInfo);\r\n        }\r\n\r\n        if (value.typeInfo.name !== \"i32\" && value.typeInfo.name !== \"x32\") {\r\n            console.error(`ExtractBits() expects an i32 argument. Line ${node.line}`);\r\n            return null;\r\n        }\r\n        const v = (value as ScalarData).value;\r\n        return new ScalarData((v >> o) & ((1 << c) - 1), this.getTypeInfo(\"i32\"));\r\n    }\r\n\r\n    FaceForward(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const e1 = this.exec.evalExpression(node.args[0], context);\r\n        const e2 = this.exec.evalExpression(node.args[1], context);\r\n        const n = this.exec.evalExpression(node.args[2], context);\r\n        if (e1 instanceof VectorData && e2 instanceof VectorData && n instanceof VectorData) {\r\n            const dot = this._dot(e2.data, n.data);\r\n            if (dot < 0) {\r\n                return new VectorData(Array.from(e1.data), e1.typeInfo);\r\n            }\r\n            return new VectorData(e1.data.map((v: number) => -v), e1.typeInfo);\r\n        }\r\n        console.error(`FaceForward() expects vector arguments. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    _firstLeadingBit(s: number): number {\r\n        if (s === 0) {\r\n            return -1;\r\n        }\r\n        return 31 - Math.clz32(s);  // clz32: count leading zeros\r\n    }\r\n\r\n    FirstLeadingBit(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => this._firstLeadingBit(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(this._firstLeadingBit(s.value), value.typeInfo);\r\n    }\r\n\r\n    _firstTrailingBit(s: number): number {\r\n        if (s === 0) {\r\n            return -1;\r\n        }\r\n        return Math.log2(s & -s); // n & -n isolates the lowest set bit.  Math.log2 gives its position.\r\n    }\r\n\r\n    FirstTrailingBit(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => this._firstTrailingBit(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(this._firstTrailingBit(s.value), value.typeInfo);\r\n    }\r\n\r\n    Floor(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.floor(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.floor(s.value), value.typeInfo);\r\n    }\r\n\r\n    Fma(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const a = this.exec.evalExpression(node.args[0], context);\r\n        const b = this.exec.evalExpression(node.args[1], context);\r\n        const c = this.exec.evalExpression(node.args[2], context);\r\n        if (a instanceof VectorData && b instanceof VectorData && c instanceof VectorData) {\r\n            if (a.data.length !== b.data.length || a.data.length !== c.data.length) {\r\n                console.error(`Fma() expects vectors of the same length. Line ${node.line}`);\r\n                return null;\r\n            }\r\n            return new VectorData(a.data.map((v: number, i: number) => v * b.data[i] + c.data[i]), a.typeInfo);\r\n        }\r\n        const av = a as ScalarData;\r\n        const bv = b as ScalarData;\r\n        const cv = c as ScalarData;\r\n        return new ScalarData(av.value * bv.value + cv.value, av.typeInfo);\r\n    }\r\n\r\n    Fract(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => v - Math.floor(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(s.value - Math.floor(s.value), value.typeInfo);\r\n    }\r\n\r\n    Frexp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: frexp. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    InsertBits(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        const insert = this.exec.evalExpression(node.args[1], context);\r\n        const offset = this.exec.evalExpression(node.args[2], context);\r\n        const count = this.exec.evalExpression(node.args[3], context);\r\n\r\n        if (offset.typeInfo.name !== \"u32\" && offset.typeInfo.name !== \"x32\") {\r\n            console.error(`InsertBits() expects an i32 offset argument. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const o = (offset as ScalarData).value;\r\n        const c = (count as ScalarData).value;\r\n        const mask = ((1 << c) - 1) << o;\r\n        const invMask = ~mask;\r\n\r\n        if (value instanceof VectorData && insert instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number, i: number) => {\r\n                return (v & invMask) | ((insert.data[i] << o) & mask);\r\n            }), value.typeInfo);\r\n        }\r\n        const v = (value as ScalarData).value;\r\n        const i = (insert as ScalarData).value;\r\n        return new ScalarData((v & invMask) | ((i << o) & mask), value.typeInfo);\r\n    }\r\n\r\n    InverseSqrt(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => 1 / Math.sqrt(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(1 / Math.sqrt(s.value), value.typeInfo);\r\n    }\r\n\r\n    Ldexp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: ldexp. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Length(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            let sum = 0;\r\n            value.data.forEach((v: number) => { sum += v * v; });\r\n            return new ScalarData(Math.sqrt(sum), this.getTypeInfo(\"f32\"));\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.abs(s.value), value.typeInfo);\r\n    }\r\n\r\n    Log(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.log(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.log(s.value), value.typeInfo);\r\n    }\r\n\r\n    Log2(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.log2(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData\r\n        return new ScalarData(Math.log2(s.value), value.typeInfo);\r\n    }\r\n\r\n    Max(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const l = this.exec.evalExpression(node.args[0], context);\r\n        const r = this.exec.evalExpression(node.args[1], context);\r\n        if (l instanceof VectorData && r instanceof VectorData) {\r\n            return new VectorData(l.data.map((v: number, i: number) => Math.max(v, r.data[i])), l.typeInfo);\r\n        }\r\n        const ls = l as ScalarData;\r\n        const rs = r as ScalarData;\r\n        return new ScalarData(Math.max(ls.value, rs.value), l.typeInfo);\r\n    }\r\n\r\n    Min(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const l = this.exec.evalExpression(node.args[0], context);\r\n        const r = this.exec.evalExpression(node.args[1], context);\r\n        if (l instanceof VectorData && r instanceof VectorData) {\r\n            return new VectorData(l.data.map((v: number, i: number) => Math.min(v, r.data[i])), l.typeInfo);\r\n        }\r\n        const ls = l as ScalarData;\r\n        const rs = r as ScalarData;\r\n        return new ScalarData(Math.min(ls.value, rs.value), l.typeInfo);\r\n    }\r\n\r\n    Mix(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const x = this.exec.evalExpression(node.args[0], context);\r\n        const y = this.exec.evalExpression(node.args[1], context);\r\n        const a = this.exec.evalExpression(node.args[2], context);\r\n        if (x instanceof VectorData && y instanceof VectorData && a instanceof VectorData) {\r\n            return new VectorData(x.data.map((v: number, i: number) => x.data[i] * (1 - a.data[i]) + y.data[i] * a.data[i]), x.typeInfo);\r\n        }\r\n        const xs = x as ScalarData;\r\n        const ys = y as ScalarData;\r\n        const as = a as ScalarData;\r\n        return new ScalarData(xs.value * (1 - as.value) + ys.value * as.value, x.typeInfo);\r\n    }\r\n\r\n    Modf(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const x = this.exec.evalExpression(node.args[0], context);\r\n        const y = this.exec.evalExpression(node.args[1], context);\r\n        if (x instanceof VectorData && y instanceof VectorData) {\r\n            return new VectorData(x.data.map((v: number, i: number) => v % y.data[i]), x.typeInfo);\r\n        }\r\n        const xs = x as ScalarData;\r\n        const ys = y as ScalarData;\r\n        return new ScalarData(xs.value % ys.value, x.typeInfo);\r\n    }\r\n\r\n    Normalize(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            const length = (this.Length(node, context) as ScalarData).value;\r\n            return new VectorData(value.data.map((v: number) => v / length), value.typeInfo);\r\n        }\r\n        console.error(`Normalize() expects a vector argument. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Pow(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const x = this.exec.evalExpression(node.args[0], context);\r\n        const y = this.exec.evalExpression(node.args[1], context);\r\n        if (x instanceof VectorData && y instanceof VectorData) {\r\n            return new VectorData(x.data.map((v: number, i: number) => Math.pow(v, y.data[i])), x.typeInfo);\r\n        }\r\n        const xs = x as ScalarData;\r\n        const ys = y as ScalarData;\r\n        return new ScalarData(Math.pow(xs.value, ys.value), x.typeInfo);\r\n    }\r\n\r\n    QuantizeToF16(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // TODO: actually quantize the f32 to f16\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => v), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(s.value, value.typeInfo);\r\n    }\r\n\r\n    Radians(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => v * Math.PI / 180), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(s.value * Math.PI / 180, this.getTypeInfo(\"f32\"));\r\n    }\r\n\r\n    Reflect(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // e1 - 2 * dot(e2, e1) * e2\r\n        let e1 = this.exec.evalExpression(node.args[0], context);\r\n        let e2 = this.exec.evalExpression(node.args[1], context);\r\n        if (e1 instanceof VectorData && e2 instanceof VectorData) {\r\n            const dot = this._dot(e1.data, e2.data);\r\n            return new VectorData(e1.data.map((v: number, i: number) => v - 2 * dot * e2.data[i]), e1.typeInfo);\r\n        }\r\n        console.error(`Reflect() expects vector arguments. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Refract(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let e1 = this.exec.evalExpression(node.args[0], context);\r\n        let e2 = this.exec.evalExpression(node.args[1], context);\r\n        let e3 = this.exec.evalExpression(node.args[2], context);\r\n        if (e1 instanceof VectorData && e2 instanceof VectorData && e3 instanceof ScalarData) {\r\n            const dot = this._dot(e2.data, e1.data);\r\n            return new VectorData(e1.data.map((v: number, i: number) => {\r\n                const k = 1.0 - e3.value * e3.value * (1.0 - dot * dot);\r\n                if (k < 0) {\r\n                    return 0;\r\n                }\r\n                const sqrtK = Math.sqrt(k);\r\n                return e3.value * v - (e3.value * dot + sqrtK) * e2.data[i];\r\n            }), e1.typeInfo);\r\n        }\r\n\r\n        console.error(`Refract() expects vector arguments and a scalar argument. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    ReverseBits(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: reverseBits. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    Round(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.round(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.round(s.value), value.typeInfo);\r\n    }\r\n\r\n    Saturate(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.min(Math.max(v, 0), 1)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.min(Math.max(s.value, 0), 1), value.typeInfo);\r\n    }\r\n\r\n    Sign(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.sign(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.sign(s.value), value.typeInfo);\r\n    }\r\n\r\n    Sin(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.sin(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.sin(s.value), value.typeInfo);\r\n    }\r\n\r\n    Sinh(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.sinh(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.sinh(s.value), value.typeInfo);\r\n    }\r\n\r\n    _smoothstep(edge0: number, edge1: number, x: number): number {\r\n        const t = Math.min(Math.max((x - edge0) / (edge1 - edge0), 0), 1);\r\n        return t * t * (3 - 2 * t);\r\n    }\r\n\r\n    SmoothStep(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const edge0 = this.exec.evalExpression(node.args[0], context);\r\n        const edge1 = this.exec.evalExpression(node.args[1], context);\r\n        const x = this.exec.evalExpression(node.args[2], context);\r\n        if (x instanceof VectorData && edge0 instanceof VectorData && edge1 instanceof VectorData) {\r\n            return new VectorData(x.data.map((v: number, i: number) => this._smoothstep(edge0.data[i], edge1.data[i], v)), x.typeInfo);\r\n        }\r\n        const e0 = edge0 as ScalarData;\r\n        const e1 = edge1 as ScalarData;\r\n        const xS = x as ScalarData;\r\n        return new ScalarData(this._smoothstep(e0.value, e1.value, xS.value), x.typeInfo);\r\n    }\r\n\r\n    Sqrt(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.sqrt(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.sqrt(s.value), value.typeInfo);\r\n    }\r\n\r\n    Step(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const edge = this.exec.evalExpression(node.args[0], context);\r\n        const x = this.exec.evalExpression(node.args[1], context);\r\n        if (x instanceof VectorData && edge instanceof VectorData) {\r\n            return new VectorData(x.data.map((v: number, i: number) => v < edge.data[i] ? 0 : 1), x.typeInfo);\r\n        }\r\n        const e = edge as ScalarData;\r\n        const s = x as ScalarData;\r\n        return new ScalarData(s.value < e.value ? 0 : 1, e.typeInfo);\r\n    }\r\n\r\n    Tan(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.tan(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.tan(s.value), value.typeInfo);\r\n    }\r\n\r\n    Tanh(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.tanh(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData;\r\n        return new ScalarData(Math.tanh(s.value), value.typeInfo);\r\n    }\r\n\r\n    _getTransposeType(t: TypeInfo): TypeInfo {\r\n        const tname = t.getTypeName();\r\n        if (tname === \"mat2x2f\" || tname === \"mat2x2h\") {\r\n            return t;\r\n        } else if (tname === \"mat2x3f\") {\r\n            return this.getTypeInfo(\"mat3x2f\");\r\n        } else if (tname === \"mat2x3h\") {\r\n            return this.getTypeInfo(\"mat3x2h\");\r\n        } else if (tname === \"mat2x4f\") {\r\n            return this.getTypeInfo(\"mat4x2f\");\r\n        } else if (tname === \"mat2x4h\") {\r\n            return this.getTypeInfo(\"mat4x2h\");\r\n        } else if (tname === \"mat3x2f\") {\r\n            return this.getTypeInfo(\"mat2x3f\");\r\n        } else if (tname === \"mat3x2h\") {\r\n            return this.getTypeInfo(\"mat2x3h\");\r\n        } else if (tname === \"mat3x3f\" || tname === \"mat3x3h\") {\r\n            return t;\r\n        } else if (tname === \"mat3x4f\") {\r\n            return this.getTypeInfo(\"mat4x3f\");\r\n        } else if (tname === \"mat3x4h\") {\r\n            return this.getTypeInfo(\"mat4x3h\");\r\n        } else if (tname === \"mat4x2f\") {\r\n            return this.getTypeInfo(\"mat2x4f\");\r\n        } else if (tname === \"mat4x2h\") {\r\n            return this.getTypeInfo(\"mat2x4h\");\r\n        } else if (tname === \"mat4x3f\") {\r\n            return this.getTypeInfo(\"mat3x4f\");\r\n        } else if (tname === \"mat4x3h\") {\r\n            return this.getTypeInfo(\"mat3x4h\");\r\n        } else if (tname === \"mat4x4f\" || tname === \"mat4x4h\") {\r\n            return t;\r\n        }\r\n\r\n        console.error(`Invalid matrix type ${tname}`);\r\n        return t;\r\n    }\r\n\r\n    Transpose(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const m = this.exec.evalExpression(node.args[0], context);\r\n        if (!(m instanceof MatrixData)) {\r\n            console.error(`Transpose() expects a matrix argument. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const ttype = this._getTransposeType(m.typeInfo);\r\n\r\n        if (m.typeInfo.name === \"mat2x2\" || m.typeInfo.name === \"mat2x2f\" || m.typeInfo.name === \"mat2x2h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[2], mv[1], mv[3]], ttype);\r\n        } else if (m.typeInfo.name === \"mat2x3\" || m.typeInfo.name === \"mat2x3f\" || m.typeInfo.name === \"mat2x3h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[3], mv[6], mv[1], mv[4], mv[7]], ttype);\r\n        } else if (m.typeInfo.name === \"mat2x4\" || m.typeInfo.name === \"mat2x4f\" || m.typeInfo.name === \"mat2x4h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[4], mv[8], mv[12], mv[1], mv[5], mv[9], mv[13]], ttype);\r\n        } else if (m.typeInfo.name === \"mat3x2\" || m.typeInfo.name === \"mat3x2f\" || m.typeInfo.name === \"mat3x2h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[3], mv[1], mv[4], mv[2], mv[5]], ttype);\r\n        } else if (m.typeInfo.name === \"mat3x3\" || m.typeInfo.name === \"mat3x3f\" || m.typeInfo.name === \"mat3x3h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[3], mv[6], mv[1], mv[4], mv[7], mv[2], mv[5], mv[8]], ttype);\r\n        } else if (m.typeInfo.name === \"mat3x4\" || m.typeInfo.name === \"mat3x4f\" || m.typeInfo.name === \"mat3x4h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[4], mv[8], mv[12], mv[1], mv[5], mv[9], mv[13], mv[2], mv[6], mv[10], mv[14]], ttype);\r\n        } else if (m.typeInfo.name === \"mat4x2\" || m.typeInfo.name === \"mat4x2f\" || m.typeInfo.name === \"mat4x2h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[4], mv[1], mv[5], mv[2], mv[6]], ttype);\r\n        } else if (m.typeInfo.name === \"mat4x3\" || m.typeInfo.name === \"mat4x3f\" || m.typeInfo.name === \"mat4x3h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[4], mv[8], mv[1], mv[5], mv[9], mv[2], mv[6], mv[10]], ttype);\r\n        } else if (m.typeInfo.name === \"mat4x4\" || m.typeInfo.name === \"mat4x4f\" || m.typeInfo.name === \"mat4x4h\") {\r\n            const mv = m.data;\r\n            return new MatrixData([mv[0], mv[4], mv[8], mv[12],\r\n                                   mv[1], mv[5], mv[9], mv[13],\r\n                                   mv[2], mv[6], mv[10], mv[14],\r\n                                   mv[3], mv[7], mv[11], mv[15]], ttype);\r\n        }\r\n\r\n        console.error(`Invalid matrix type ${m.typeInfo.name}`);\r\n        return null;\r\n    }\r\n\r\n    Trunc(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const value = this.exec.evalExpression(node.args[0], context);\r\n        if (value instanceof VectorData) {\r\n            return new VectorData(value.data.map((v: number) => Math.trunc(v)), value.typeInfo);\r\n        }\r\n        const s = value as ScalarData\r\n        return new ScalarData(Math.trunc(s.value), value.typeInfo);\r\n    }\r\n\r\n    // Derivative Built-in Functions\r\n    Dpdx(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: dpdx. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    DpdxCoarse(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(`TODO: dpdxCoarse. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    DpdxFine(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: dpdxFine\");\r\n        return null;\r\n    }\r\n\r\n    Dpdy(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: dpdy\");\r\n        return null;\r\n    }\r\n\r\n    DpdyCoarse(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: dpdyCoarse\");\r\n        return null;\r\n    }\r\n\r\n    DpdyFine(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: dpdyFine\");\r\n        return null;\r\n    }\r\n\r\n    Fwidth(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: fwidth\");\r\n        return null;\r\n    }\r\n\r\n    FwidthCoarse(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: fwidthCoarse\");\r\n        return null;\r\n    }\r\n\r\n    FwidthFine(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: fwidthFine\");\r\n        return null;\r\n    }\r\n\r\n    // Texture Built-in Functions\r\n    TextureDimensions(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const textureArg = node.args[0];\r\n        const level = node.args.length > 1 ? (this.exec.evalExpression(node.args[1], context) as ScalarData).value : 0;\r\n        if (textureArg instanceof VariableExpr) {\r\n            const textureName = (textureArg as VariableExpr).name;\r\n            const texture = context.getVariableValue(textureName);\r\n            if (texture instanceof TextureData) {\r\n                if (level < 0 || level >= texture.mipLevelCount) {\r\n                    console.error(`Invalid mip level for textureDimensions. Line ${node.line}`);\r\n                    return null;\r\n                }\r\n\r\n                const textureSize = texture.getMipLevelSize(level);\r\n\r\n                const dimension = texture.dimension;\r\n\r\n                if (dimension === \"1d\") {\r\n                    return new ScalarData(textureSize[0], this.getTypeInfo(\"u32\"));\r\n                } else if (dimension === \"3d\") {\r\n                    return new VectorData(textureSize, this.getTypeInfo(\"vec3u\"));\r\n                } else if (dimension === \"2d\") {\r\n                    return new VectorData(textureSize.slice(0, 2), this.getTypeInfo(\"vec2u\"));\r\n                } else {\r\n                    console.error(`Invalid texture dimension ${dimension} not found. Line ${node.line}`);\r\n                    return null;\r\n                }\r\n            } else {\r\n                console.error(`Texture ${textureName} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n        }\r\n        console.error(`Invalid texture argument for textureDimensions. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    TextureGather(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureGather\");\r\n        return null;\r\n    }\r\n\r\n    TextureGatherCompare(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureGatherCompare\");\r\n        return null;\r\n    }\r\n\r\n    TextureLoad(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const textureArg = node.args[0];\r\n        const uv = this.exec.evalExpression(node.args[1], context);\r\n        const level = node.args.length > 2 ? (this.exec.evalExpression(node.args[2], context) as ScalarData).value : 0;\r\n\r\n        // TODO: non-vec2 UVs, for non-2D textures\r\n        if (!(uv instanceof VectorData) || uv.data.length !== 2) {\r\n            console.error(`Invalid UV argument for textureLoad. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        if (textureArg instanceof VariableExpr) {\r\n            const textureName = (textureArg as VariableExpr).name;\r\n            const texture = context.getVariableValue(textureName);\r\n            if (texture instanceof TextureData) {\r\n                const x = Math.floor(uv.data[0]);\r\n                const y = Math.floor(uv.data[1]);\r\n                if (x < 0 || x >= texture.width || y < 0 || y >= texture.height) {\r\n                    console.error(`Texture ${textureName} out of bounds. Line ${node.line}`);\r\n                    return null;\r\n                }\r\n\r\n                const texel = texture.getPixel(x, y, 0, level);\r\n                if (texel === null) {\r\n                    console.error(`Invalid texture format for textureLoad. Line ${node.line}`);\r\n                    return null;\r\n                }\r\n\r\n                return new VectorData(texel, this.getTypeInfo(\"vec4f\"));\r\n            } else {\r\n                console.error(`Texture ${textureName} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n        }\r\n\r\n        console.error(`Invalid texture argument for textureLoad. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    TextureNumLayers(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const textureArg = node.args[0];\r\n        if (textureArg instanceof VariableExpr) {\r\n            const textureName = (textureArg as VariableExpr).name;\r\n            const texture = context.getVariableValue(textureName);\r\n            if (texture instanceof TextureData) {\r\n                return new ScalarData(texture.depthOrArrayLayers, this.getTypeInfo(\"u32\"));\r\n            } else {\r\n                console.error(`Texture ${textureName} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n        }\r\n        console.error(`Invalid texture argument for textureNumLayers. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    TextureNumLevels(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const textureArg = node.args[0];\r\n        if (textureArg instanceof VariableExpr) {\r\n            const textureName = (textureArg as VariableExpr).name;\r\n            const texture = context.getVariableValue(textureName);\r\n            if (texture instanceof TextureData) {\r\n                return new ScalarData(texture.mipLevelCount, this.getTypeInfo(\"u32\"));\r\n            } else {\r\n                console.error(`Texture ${textureName} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n        }\r\n        console.error(`Invalid texture argument for textureNumLevels. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    TextureNumSamples(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const textureArg = node.args[0];\r\n        if (textureArg instanceof VariableExpr) {\r\n            const textureName = (textureArg as VariableExpr).name;\r\n            const texture = context.getVariableValue(textureName);\r\n            if (texture instanceof TextureData) {\r\n                return new ScalarData(texture.sampleCount, this.getTypeInfo(\"u32\"));\r\n            } else {\r\n                console.error(`Texture ${textureName} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n        }\r\n        console.error(`Invalid texture argument for textureNumSamples. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    TextureSample(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSample\");\r\n        return null;\r\n    }\r\n\r\n    TextureSampleBias(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSampleBias\");\r\n        return null;\r\n    }\r\n\r\n    TextureSampleCompare(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSampleCompare\");\r\n        return null;\r\n    }\r\n\r\n    TextureSampleCompareLevel(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSampleCompareLevel\");\r\n        return null;\r\n    }\r\n\r\n    TextureSampleGrad(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSampleGrad\");\r\n        return null;\r\n    }\r\n\r\n    TextureSampleLevel(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSampleLevel\");\r\n        return null;\r\n    }\r\n\r\n    TextureSampleBaseClampToEdge(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: textureSampleBaseClampToEdge\");\r\n        return null;\r\n    }\r\n\r\n    TextureStore(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        const textureArg = node.args[0];\r\n        const uv = this.exec.evalExpression(node.args[1], context);\r\n        const index = (node.args.length === 4) ? (this.exec.evalExpression(node.args[2], context) as ScalarData).value : 0;\r\n        const value = (node.args.length === 4) ? (this.exec.evalExpression(node.args[3], context) as VectorData).data :\r\n            (this.exec.evalExpression(node.args[2], context) as VectorData).data;\r\n\r\n        if (value.length !== 4) {\r\n            console.error(`Invalid value argument for textureStore. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        // TODO: non-vec2 UVs, for non-2D textures\r\n        if (!(uv instanceof VectorData) || uv.data.length !== 2) {\r\n            console.error(`Invalid UV argument for textureStore. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        if (textureArg instanceof VariableExpr) {\r\n            const textureName = (textureArg as VariableExpr).name;\r\n            const texture = context.getVariableValue(textureName);\r\n            if (texture instanceof TextureData) {\r\n                const textureSize = texture.getMipLevelSize(0);\r\n                const x = Math.floor(uv.data[0]);\r\n                const y = Math.floor(uv.data[1]);\r\n                if (x < 0 || x >= textureSize[0] || y < 0 || y >= textureSize[1]) {\r\n                    console.error(`Texture ${textureName} out of bounds. Line ${node.line}`);\r\n                    return null;\r\n                }\r\n\r\n                texture.setPixel(x, y, 0, index, Array.from(value));\r\n\r\n                return null;\r\n            } else {\r\n                console.error(`Texture ${textureName} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n        }\r\n\r\n        console.error(`Invalid texture argument for textureStore. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    // Atomic Built-in Functions\r\n    AtomicLoad(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n        return currentValue;\r\n    }\r\n\r\n    AtomicStore(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    AtomicAdd(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value += value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicSub(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value -= value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicMax(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = Math.max(currentValue.value, value.value);\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicMin(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = Math.min(currentValue.value, value.value);\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicAnd(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = currentValue.value & value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicOr(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = currentValue.value | value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicXor(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = currentValue.value ^ value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicExchange(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        let l = node.args[0];\r\n        if (l instanceof UnaryOperator) {\r\n            l = l.right;\r\n        }\r\n\r\n        const name = this.exec.getVariableName(l, context);\r\n        const v = context.getVariable(name);\r\n\r\n        let r = node.args[1];\r\n        const value = this.exec.evalExpression(r, context);\r\n\r\n        const currentValue = v.value.getSubData(this.exec, l.postfix, context);\r\n\r\n        const originalValue = new ScalarData((currentValue as ScalarData).value, currentValue.typeInfo);\r\n\r\n        if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n            currentValue.value = value.value;\r\n        }\r\n\r\n        if (v.value instanceof TypedData) {\r\n            v.value.setDataValue(this.exec, currentValue, l.postfix, context);\r\n        }\r\n\r\n        return originalValue;\r\n    }\r\n\r\n    AtomicCompareExchangeWeak(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: atomicCompareExchangeWeak\");\r\n        return null;\r\n    }\r\n\r\n    // Data Packing Built-in Functions\r\n    Pack4x8snorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack4x8snorm\");\r\n        return null;\r\n    }\r\n\r\n    Pack4x8unorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack4x8unorm\");\r\n        return null;\r\n    }\r\n\r\n    Pack4xI8(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack4xI8\");\r\n        return null;\r\n    }\r\n\r\n    Pack4xU8(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack4xU8\");\r\n        return null;\r\n    }\r\n\r\n    Pack4x8Clamp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack4x8Clamp\");\r\n        return null;\r\n    }\r\n\r\n    Pack4xU8Clamp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack4xU8Clamp\");\r\n        return null;\r\n    }\r\n\r\n    Pack2x16snorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack2x16snorm\");\r\n        return null;\r\n    }\r\n\r\n    Pack2x16unorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack2x16unorm\");\r\n        return null;\r\n    }\r\n\r\n    Pack2x16float(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: pack2x16float\");\r\n        return null;\r\n    }\r\n\r\n    // Data Unpacking Built-in Functions\r\n    Unpack4x8snorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack4x8snorm\");\r\n        return null;\r\n    }\r\n\r\n    Unpack4x8unorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack4x8unorm\");\r\n        return null;\r\n    }\r\n\r\n    Unpack4xI8(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack4xI8\");\r\n        return null;\r\n    }\r\n\r\n    Unpack4xU8(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack4xU8\");\r\n        return null;\r\n    }\r\n\r\n    Unpack2x16snorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack2x16snorm\");\r\n        return null;\r\n    }\r\n\r\n    Unpack2x16unorm(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack2x16unorm\");\r\n        return null;\r\n    }\r\n\r\n    Unpack2x16float(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: unpack2x16float\");\r\n        return null;\r\n    }\r\n\r\n    // Synchronization Functions\r\n    StorageBarrier(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // Execution is single threaded, barriers not necessary.\r\n        return null;\r\n    }\r\n\r\n    TextureBarrier(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // Execution is single threaded, barriers not necessary.\r\n        return null;\r\n    }\r\n\r\n    WorkgroupBarrier(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // Execution is single threaded, barriers not necessary.\r\n        return null;\r\n    }\r\n\r\n    WorkgroupUniformLoad(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        // Execution is single threaded, barriers not necessary.\r\n        return null;\r\n    }\r\n\r\n    // Subgroup Functions\r\n    SubgroupAdd(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupAdd\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupExclusiveAdd(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupExclusiveAdd\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupInclusiveAdd(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupInclusiveAdd\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupAll(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupAll\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupAnd(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupAnd\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupAny(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupAny\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupBallot(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupBallot\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupBroadcast(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupBroadcast\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupBroadcastFirst(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupBroadcastFirst\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupElect(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupElect\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupMax(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupMax\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupMin(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupMin\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupMul(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupMul\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupExclusiveMul(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupExclusiveMul\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupInclusiveMul(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupInclusiveMul\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupOr(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupOr\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupShuffle(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupShuffle\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupShuffleDown(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupShuffleDown\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupShuffleUp(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupShuffleUp\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupShuffleXor(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupShuffleXor\");\r\n        return null;\r\n    }\r\n\r\n    SubgroupXor(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: subgroupXor\");\r\n        return null;\r\n    }\r\n\r\n    // Quad Functions\r\n    QuadBroadcast(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: quadBroadcast\");\r\n        return null;\r\n    }\r\n\r\n    QuadSwapDiagonal(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: quadSwapDiagonal\");\r\n        return null;\r\n    }\r\n\r\n    QuadSwapX(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: quadSwapX\");\r\n        return null;\r\n    }\r\n\r\n    QuadSwapY(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        console.error(\"TODO: quadSwapY\");\r\n        return null;\r\n    }\r\n}\r\n", "import { TypeInfo } from '../reflect/info';\r\n\r\nexport const VectorTypeSize = {\r\n    \"vec2\": 2, \"vec2f\": 2, \"vec2i\": 2, \"vec2u\": 2, \"vec2b\": 2, \"vec2h\": 2,\r\n    \"vec3\": 3, \"vec3f\": 3, \"vec3i\": 3, \"vec3u\": 3, \"vec3b\": 3, \"vec3h\": 3,\r\n    \"vec4\": 4, \"vec4f\": 4, \"vec4i\": 4, \"vec4u\": 4, \"vec4b\": 4, \"vec4h\": 4\r\n};\r\n\r\nexport const MatrixTypeSize = {\r\n    \"mat2x2\": [2, 2, 4], \"mat2x2f\": [2, 2, 4], \"mat2x2h\": [2, 2, 4],\r\n    \"mat2x3\": [2, 3, 6], \"mat2x3f\": [2, 3, 6], \"mat2x3h\": [2, 3, 6],\r\n    \"mat2x4\": [2, 4, 8], \"mat2x4f\": [2, 4, 8], \"mat2x4h\": [2, 4, 8],\r\n    \"mat3x2\": [3, 2, 6], \"mat3x2f\": [3, 2, 6], \"mat3x2h\": [3, 2, 6],\r\n    \"mat3x3\": [3, 3, 9], \"mat3x3f\": [3, 3, 9], \"mat3x3h\": [3, 3, 9],\r\n    \"mat3x4\": [3, 4, 12], \"mat3x4f\": [3, 4, 12], \"mat3x4h\": [3, 4, 12],\r\n    \"mat4x2\": [4, 2, 8], \"mat4x2f\": [4, 2, 8], \"mat4x2h\": [4, 2, 8],\r\n    \"mat4x3\": [4, 3, 12], \"mat4x3f\": [4, 3, 12], \"mat4x3h\": [4, 3, 12],\r\n    \"mat4x4\": [4, 4, 16], \"mat4x4f\": [4, 4, 16], \"mat4x4h\": [4, 4, 16]\r\n};\r\n\r\nexport const MatrixTransposeType = {\r\n    \"mat2x2\": \"mat2x2\", \"mat2x2f\": \"mat2x2f\", \"mat2x2h\": \"mat2x2h\",\r\n    \"mat2x3\": \"mat3x2\", \"mat2x3f\": \"mat3x2f\", \"mat2x3h\": \"mat3x2h\",\r\n    \"mat2x4\": \"mat4x2\", \"mat2x4f\": \"mat4x2f\", \"mat2x4h\": \"mat4x2h\",\r\n    \"mat3x2\": \"mat2x3\", \"mat3x2f\": \"mat2x3f\", \"mat3x2h\": \"mat2x3h\",\r\n    \"mat3x3\": \"mat3x3\", \"mat3x3f\": \"mat3x3f\", \"mat3x3h\": \"mat3x3h\",\r\n    \"mat3x4\": \"mat4x3\", \"mat3x4f\": \"mat4x3f\", \"mat3x4h\": \"mat4x3h\",\r\n    \"mat4x2\": \"mat2x4\", \"mat4x2f\": \"mat2x4f\", \"mat4x2h\": \"mat2x4h\",\r\n    \"mat4x3\": \"mat4x3\", \"mat4x3f\": \"mat4x3f\", \"mat4x3h\": \"mat4x3h\",\r\n    \"mat4x4\": \"mat4x4\", \"mat4x4f\": \"mat4x4f\", \"mat4x4h\": \"mat4x4h\"\r\n};\r\n\r\nexport function matrixTranspose(matrix: number[], t: TypeInfo) {\r\n    if (MatrixTypeSize[t.name] === undefined) {\r\n        return null;\r\n    }\r\n\r\n    const cols = MatrixTypeSize[t.name][0];\r\n    const rows = MatrixTypeSize[t.name][1];\r\n    const result: number[] = [];\r\n\r\n    for (let i = 0; i < cols; i++) {\r\n        for (let j = 0; j < rows; j++) {\r\n            result[i * rows + j] = matrix[j * cols + i];\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function matrixMultiply(matrixA: number[], t1: TypeInfo, matrixB: number[], t2: TypeInfo): number[] | null {\r\n  if (MatrixTypeSize[t1.name] === undefined || MatrixTypeSize[t2.name] === undefined) {\r\n    return null;\r\n  }\r\n\r\n  const k = MatrixTypeSize[t1.name][0];\r\n  const r = MatrixTypeSize[t1.name][1];\r\n  const c = MatrixTypeSize[t2.name][0];\r\n  const k2 = MatrixTypeSize[t2.name][1];\r\n\r\n  if (k !== k2) {\r\n    return null;\r\n  }\r\n\r\n  const result: number[] = new Array(c * r);\r\n\r\n  for (let j = 0; j < r; j++) { // Iterate through columns of result\r\n    for (let i = 0; i < c; i++) { // Iterate through rows of result\r\n      let sum = 0;\r\n      for (let l = 0; l < k; l++) {\r\n        sum += matrixA[l * r + j] * matrixB[i * k + l]; // Access column-major elements\r\n      }\r\n      result[j * c + i] = sum; // Store in column-major order\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nexport function matrixVectorMultiply(matrix: number[], t1: TypeInfo, vector: number[], t2: TypeInfo): number[] | null {\r\n  if (MatrixTypeSize[t1.name] === undefined || VectorTypeSize[t2.name] === undefined) {\r\n    return null;\r\n  }\r\n\r\n  const cols = MatrixTypeSize[t1.name][0];\r\n  const rows = MatrixTypeSize[t1.name][1];\r\n  \r\n  if (cols !== vector.length) {\r\n    return null;\r\n  }\r\n\r\n  const resultVec = new Array(rows);\r\n  // Perform matrix-vector multiplication (column-major)\r\n  for (let i = 0; i < rows; i++) {\r\n    let sum = 0;\r\n    for (let j = 0; j < cols; j++) {\r\n      sum += matrix[j * rows + i] * vector[j]; // Access column-major element\r\n    }\r\n    resultVec[i] = sum;\r\n  }\r\n\r\n  return resultVec;\r\n}\r\n\r\nexport function vectorMatrixMultiply(vector: number[], t1: TypeInfo, matrix: number[], t2: TypeInfo): number[] | null {\r\n  if (VectorTypeSize[t1.name] === undefined || MatrixTypeSize[t2.name] === undefined) {\r\n    return null;\r\n  }\r\n\r\n  const cols = MatrixTypeSize[t2.name][0];\r\n  const rows = MatrixTypeSize[t2.name][1];\r\n\r\n  if (rows !== vector.length) {\r\n    return null;\r\n  }\r\n\r\n  const result: number[] = [];\r\n  for (let j = 0; j < cols; j++) {\r\n    let sum = 0;\r\n    for (let i = 0; i < rows; i++) {\r\n      sum += vector[i] * matrix[i * cols + j];\r\n    }\r\n    result[j] = sum;\r\n  }\r\n\r\n  return result;\r\n}\r\n", "import { Node, Type, TemplateType, Return, Break, Continue, Let, Var, Const,\r\n    If, For, While, Loop, Continuing, Assign, Increment, Struct, Override, ArrayType,\r\n    Call, Diagnostic, Alias, BinaryOperator, LiteralExpr, Expression,\r\n    VariableExpr, CallExpr, CreateExpr, ConstExpr, BitcastExpr, UnaryOperator,\r\n    ArrayIndex, StringExpr, Function, Switch, SwitchCase, Case, Default, DefaultSelector } from \"./wgsl_ast.js\";\r\nimport { Data, TypedData, TextureData, ScalarData, VectorData, MatrixData, PointerData, VoidData } from \"./wgsl_ast.js\";\r\nimport { Reflect } from \"./reflect/reflect.js\";\r\nimport { TypeInfo, StructInfo, ArrayInfo, TemplateInfo } from \"./reflect/info.js\";\r\nimport { ExecContext, FunctionRef } from \"./exec/exec_context.js\";\r\nimport { ExecInterface } from \"./exec/exec_interface.js\";\r\nimport { BuiltinFunctions } from \"./exec/builtin_functions.js\";\r\nimport { isArray, castScalar, castVector } from \"./utils/cast.js\";\r\nimport { matrixMultiply, matrixVectorMultiply, vectorMatrixMultiply, MatrixTypeSize, VectorTypeSize } from \"./utils/matrix.js\";\r\n\r\nexport class WgslExec extends ExecInterface {\r\n    ast: Node[];\r\n    context: ExecContext;\r\n    reflection: Reflect;\r\n    builtins: BuiltinFunctions;\r\n    typeInfo: Object;\r\n\r\n    constructor(ast?: Node[], context?: ExecContext) {\r\n        super();\r\n        this.ast = ast ?? [];\r\n        this.reflection = new Reflect();\r\n        this.reflection.updateAST(this.ast);\r\n\r\n        this.context = context?.clone() ?? new ExecContext();\r\n        this.builtins = new BuiltinFunctions(this);\r\n\r\n        this.typeInfo = {\r\n            \"bool\": this.getTypeInfo(Type.bool),\r\n            \"i32\": this.getTypeInfo(Type.i32),\r\n            \"u32\": this.getTypeInfo(Type.u32),\r\n            \"f32\": this.getTypeInfo(Type.f32),\r\n            \"f16\": this.getTypeInfo(Type.f16),\r\n            \"vec2f\": this.getTypeInfo(TemplateType.vec2f),\r\n            \"vec2u\": this.getTypeInfo(TemplateType.vec2u),\r\n            \"vec2i\": this.getTypeInfo(TemplateType.vec2i),\r\n            \"vec2h\": this.getTypeInfo(TemplateType.vec2h),\r\n            \"vec3f\": this.getTypeInfo(TemplateType.vec3f),\r\n            \"vec3u\": this.getTypeInfo(TemplateType.vec3u),\r\n            \"vec3i\": this.getTypeInfo(TemplateType.vec3i),\r\n            \"vec3h\": this.getTypeInfo(TemplateType.vec3h),\r\n            \"vec4f\": this.getTypeInfo(TemplateType.vec4f),\r\n            \"vec4u\": this.getTypeInfo(TemplateType.vec4u),\r\n            \"vec4i\": this.getTypeInfo(TemplateType.vec4i),\r\n            \"vec4h\": this.getTypeInfo(TemplateType.vec4h),\r\n            \"mat2x2f\": this.getTypeInfo(TemplateType.mat2x2f),\r\n            \"mat2x3f\": this.getTypeInfo(TemplateType.mat2x3f),\r\n            \"mat2x4f\": this.getTypeInfo(TemplateType.mat2x4f),\r\n            \"mat3x2f\": this.getTypeInfo(TemplateType.mat3x2f),\r\n            \"mat3x3f\": this.getTypeInfo(TemplateType.mat3x3f),\r\n            \"mat3x4f\": this.getTypeInfo(TemplateType.mat3x4f),\r\n            \"mat4x2f\": this.getTypeInfo(TemplateType.mat4x2f),\r\n            \"mat4x3f\": this.getTypeInfo(TemplateType.mat4x3f),\r\n            \"mat4x4f\": this.getTypeInfo(TemplateType.mat4x4f),\r\n        };\r\n    }\r\n\r\n    getVariableValue(name: string): number | number[] | null {\r\n        const v = this.context.getVariable(name)?.value ?? null;\r\n        if (v === null) {\r\n            return null;\r\n        }\r\n        if (v instanceof ScalarData) {\r\n            return v.value;\r\n        }\r\n        if (v instanceof VectorData) {\r\n            return Array.from(v.data);\r\n        }\r\n        if (v instanceof MatrixData) {\r\n            return Array.from(v.data);\r\n        }\r\n        if (v instanceof TypedData) {\r\n            if (v.typeInfo instanceof ArrayInfo) {\r\n                if (v.typeInfo.format.name === \"u32\") {\r\n                    return Array.from(new Uint32Array(v.buffer, v.offset, v.typeInfo.count));\r\n                } else if (v.typeInfo.format.name === \"i32\") {\r\n                    return Array.from(new Int32Array(v.buffer, v.offset, v.typeInfo.count));\r\n                } else if (v.typeInfo.format.name === \"f32\") {\r\n                    return Array.from(new Float32Array(v.buffer, v.offset, v.typeInfo.count));\r\n                }\r\n            }\r\n        }\r\n        console.error(`Unsupported return variable type ${v.typeInfo.name}`);\r\n        return null;\r\n    }\r\n\r\n    execute(config?: Object): void {\r\n        config = config ?? {};\r\n        if (config[\"constants\"]) {\r\n            this._setOverrides(config[\"constants\"], this.context);\r\n        }\r\n\r\n        this._execStatements(this.ast, this.context);\r\n    }\r\n\r\n    dispatchWorkgroups(kernel: string, dispatchCount: number | number[], bindGroups: Object, config?: Object): void {\r\n        const context = this.context.clone();\r\n\r\n        config = config ?? {};\r\n        if (config[\"constants\"]) {\r\n            this._setOverrides(config[\"constants\"], context);\r\n        }\r\n\r\n        this._execStatements(this.ast, context);\r\n\r\n        const f = context.getFunction(kernel);\r\n        if (!f) {\r\n            console.error(`Function ${kernel} not found`);\r\n            return;\r\n        }\r\n\r\n        if (typeof dispatchCount === \"number\") {\r\n            dispatchCount = [dispatchCount, 1, 1];\r\n        } else if (dispatchCount.length === 0) {\r\n            console.error(`Invalid dispatch count`);\r\n            return;\r\n        } else if (dispatchCount.length === 1) {\r\n            dispatchCount = [dispatchCount[0], 1, 1];\r\n        } else if (dispatchCount.length === 2) {\r\n            dispatchCount = [dispatchCount[0], dispatchCount[1], 1];\r\n        } else if (dispatchCount.length > 3) {\r\n            dispatchCount = [dispatchCount[0], dispatchCount[1], dispatchCount[2]];\r\n        }\r\n\r\n        const width = dispatchCount[0];\r\n        const height = dispatchCount[1];\r\n        const depth = dispatchCount[2];\r\n\r\n        const vec3u = this.getTypeInfo(\"vec3u\");\r\n        context.setVariable(\"@num_workgroups\", new VectorData(dispatchCount, vec3u));\r\n\r\n        const kernelRefl = this.reflection.getFunctionInfo(kernel);\r\n        if (kernelRefl === null) {\r\n            console.error(`Function ${kernel} not found in reflection data`);\r\n        }\r\n\r\n        for (const set in bindGroups) {\r\n            for (const binding in bindGroups[set]) {\r\n                const entry = bindGroups[set][binding];\r\n\r\n                context.variables.forEach((v) => {\r\n                    const node = v.node;\r\n                    if (node?.attributes) {\r\n                        let b = null;\r\n                        let s = null;\r\n                        for (const attr of node.attributes) {\r\n                            if (attr.name === \"binding\") {\r\n                                b = attr.value;\r\n                            } else if (attr.name === \"group\") {\r\n                                s = attr.value;\r\n                            }\r\n                        }\r\n                        if (binding == b && set == s) {\r\n                            let found = false;\r\n                            for (const resource of kernelRefl.resources) {\r\n                                if (resource.name === v.name && resource.group === parseInt(set) && resource.binding === parseInt(binding)) {\r\n                                    found = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n\r\n                            if (found) {\r\n                                if (entry.texture !== undefined && entry.descriptor !== undefined) {\r\n                                    // Texture\r\n                                    const textureData = new TextureData(entry.texture, this.getTypeInfo(node.type), entry.descriptor,\r\n                                            entry.texture.view ?? null);\r\n                                    v.value = textureData;\r\n                                } else if (entry.uniform !== undefined) {\r\n                                    // Uniform buffer\r\n                                    v.value = new TypedData(entry.uniform, this.getTypeInfo(node.type));\r\n                                } else {\r\n                                    // Storage buffer\r\n                                    v.value = new TypedData(entry, this.getTypeInfo(node.type));\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        for (let z = 0; z < depth; ++z) {\r\n            for (let y = 0; y < height; ++y) {\r\n                for (let x = 0; x < width; ++x) {\r\n                    context.setVariable(\"@workgroup_id\", new VectorData([x, y, z], this.getTypeInfo(\"vec3u\")));\r\n                    this._dispatchWorkgroup(f, [x, y, z], context);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static _breakObj = new Data(new TypeInfo(\"BREAK\", null), null);\r\n    static _continueObj = new Data(new TypeInfo(\"CONTINUE\", null), null);\r\n\r\n    execStatement(stmt: Node, context: ExecContext): Data | null {\r\n        if (stmt instanceof Return) {\r\n            return this.evalExpression(stmt.value, context);\r\n        } else if (stmt instanceof Break) {\r\n            if (stmt.condition) {\r\n                const c = this.evalExpression(stmt.condition, context);\r\n                if (!(c instanceof ScalarData)) {\r\n                    throw new Error(`Invalid break-if condition`);\r\n                }\r\n                if (!c.value) {\r\n                    return null;\r\n                }\r\n            }\r\n            return WgslExec._breakObj;\r\n        } else if (stmt instanceof Continue) {\r\n            return WgslExec._continueObj;\r\n        } else if (stmt instanceof Let) {\r\n            this._let(stmt, context);\r\n        } else if (stmt instanceof Var) {\r\n            this._var(stmt, context);\r\n        } else if (stmt instanceof Const) {\r\n            this._const(stmt, context);\r\n        } else if (stmt instanceof Function) {\r\n            this._function(stmt, context);\r\n        } else if (stmt instanceof If) {\r\n            return this._if(stmt, context);\r\n        } else if (stmt instanceof Switch) {\r\n            return this._switch(stmt, context);\r\n        } else if (stmt instanceof For) {\r\n            return this._for(stmt, context);\r\n        } else if (stmt instanceof While) {\r\n            return this._while(stmt, context);\r\n        } else if (stmt instanceof Loop) {\r\n            return this._loop(stmt, context);\r\n        } else if (stmt instanceof Continuing) {\r\n            const subContext = context.clone();\r\n            subContext.currentFunctionName = context.currentFunctionName;\r\n            return this._execStatements(stmt.body, subContext);\r\n        } else if (stmt instanceof Assign) {\r\n            this._assign(stmt, context);\r\n        } else if (stmt instanceof Increment) {\r\n            this._increment(stmt, context);\r\n        } else if (stmt instanceof Struct) {\r\n            return null;\r\n        } else if (stmt instanceof Override) {\r\n            const name = stmt.name;\r\n            if (context.getVariable(name) === null) {\r\n                context.setVariable(name, new ScalarData(0, this.getTypeInfo(\"u32\")));\r\n                //console.error(`Override constant ${name} not found. Line ${stmt.line}`);\r\n            }\r\n        } else if (stmt instanceof Call) {\r\n            this._call(stmt, context);\r\n        } else if (stmt instanceof Diagnostic) {\r\n            return null; // Nothing to do here.\r\n        } else if (stmt instanceof Alias) {\r\n            return null; // Nothing to do here.\r\n        } else {\r\n            console.error(`Invalid statement type.`, stmt, `Line ${stmt.line}`);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    evalExpression(node: Node, context: ExecContext): Data | null {\r\n        if (node instanceof BinaryOperator) {\r\n            return this._evalBinaryOp(node, context);\r\n        } else if (node instanceof LiteralExpr) {\r\n            return this._evalLiteral(node, context);\r\n        } else if (node instanceof VariableExpr) {\r\n            return this._evalVariable(node, context);\r\n        } else if (node instanceof CallExpr) {\r\n            return this._evalCall(node, context);\r\n        } else if (node instanceof CreateExpr) {\r\n            return this._evalCreate(node, context);\r\n        } else if (node instanceof ConstExpr) {\r\n            return this._evalConst(node, context);\r\n        } else if (node instanceof BitcastExpr) {\r\n            return this._evalBitcast(node, context);\r\n        } else if (node instanceof UnaryOperator) {\r\n            return this._evalUnaryOp(node, context);\r\n        }\r\n        console.error(`Invalid expression type`, node, `Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    getTypeInfo(type: Type | string): TypeInfo | null {\r\n        if (type instanceof Type) {\r\n            const t = this.reflection.getTypeInfo(type as Type);\r\n            if (t !== null) {\r\n                return t;\r\n            }\r\n        }\r\n\r\n        let t = this.typeInfo[type as string] ?? null;\r\n        if (t !== null) {\r\n            return t;\r\n        }\r\n\r\n        t = this.reflection.getTypeInfoByName(type as string);\r\n        return t;\r\n    }\r\n\r\n    _setOverrides(constants: Object, context: ExecContext): void {\r\n        for (const k in constants) {\r\n            const v = constants[k];\r\n            const override = this.reflection.getOverrideInfo(k);\r\n            if (override !== null) {\r\n                if (override.type === null) {\r\n                    override.type = this.getTypeInfo(\"u32\");\r\n                }\r\n                if (override.type.name === \"u32\" || override.type.name === \"i32\" || override.type.name === \"f32\" || override.type.name === \"f16\") {\r\n                    context.setVariable(k, new ScalarData(v, override.type));\r\n                } else if (override.type.name === \"bool\") {\r\n                    context.setVariable(k, new ScalarData(v ? 1 : 0, override.type));\r\n                } else if (override.type.name === \"vec2\" || override.type.name === \"vec3\" || override.type.name === \"vec4\" ||\r\n                    override.type.name === \"vec2f\" || override.type.name === \"vec3f\" || override.type.name === \"vec4f\" ||\r\n                    override.type.name === \"vec2i\" || override.type.name === \"vec3i\" || override.type.name === \"vec4i\" ||\r\n                    override.type.name === \"vec2u\" || override.type.name === \"vec3u\" || override.type.name === \"vec4u\" ||\r\n                    override.type.name === \"vec2h\" || override.type.name === \"vec3h\" || override.type.name === \"vec4h\") {\r\n                    context.setVariable(k, new VectorData(v, override.type));\r\n                } else {\r\n                    console.error(`Invalid constant type for ${k}`);\r\n                }\r\n            } else {\r\n                console.error(`Override ${k} does not exist in the shader.`);\r\n            }\r\n        }\r\n    }\r\n\r\n    _dispatchWorkgroup(f: FunctionRef, workgroup_id: number[], context: ExecContext): void {\r\n        const workgroupSize = [1, 1, 1];\r\n        for (const attr of f.node.attributes) {\r\n            if (attr.name === \"workgroup_size\") {\r\n                if (attr.value.length > 0) {\r\n                    // The value could be an override constant\r\n                    const v = context.getVariableValue(attr.value[0]);\r\n                    if (v instanceof ScalarData) {\r\n                        workgroupSize[0] = v.value;\r\n                    } else {\r\n                        workgroupSize[0] = parseInt(attr.value[0]);\r\n                    }\r\n                }\r\n                if (attr.value.length > 1) {\r\n                    const v = context.getVariableValue(attr.value[1]);\r\n                    if (v instanceof ScalarData) {\r\n                        workgroupSize[1] = v.value;\r\n                    } else {\r\n                        workgroupSize[1] = parseInt(attr.value[1]);\r\n                    }\r\n                }\r\n                if (attr.value.length > 2) {\r\n                    const v = context.getVariableValue(attr.value[2]);\r\n                    if (v instanceof ScalarData) {\r\n                        workgroupSize[2] = v.value;\r\n                    } else {\r\n                        workgroupSize[2] = parseInt(attr.value[2]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        const vec3u = this.getTypeInfo(\"vec3u\");\r\n        const u32 = this.getTypeInfo(\"u32\");\r\n        context.setVariable(\"@workgroup_size\", new VectorData(workgroupSize, vec3u));\r\n\r\n        const width = workgroupSize[0];\r\n        const height = workgroupSize[1];\r\n        const depth = workgroupSize[2];\r\n\r\n        for (let z = 0, li = 0; z < depth; ++z) {\r\n            for (let y = 0; y < height; ++y) {\r\n                for (let x = 0; x < width; ++x, ++li) {\r\n                    const local_invocation_id = [x, y, z];\r\n                    const global_invocation_id = [\r\n                        x + workgroup_id[0] * workgroupSize[0],\r\n                        y + workgroup_id[1] * workgroupSize[1],\r\n                        z + workgroup_id[2] * workgroupSize[2]];\r\n\r\n                    context.setVariable(\"@local_invocation_id\", new VectorData(local_invocation_id, vec3u));\r\n                    context.setVariable(\"@global_invocation_id\", new VectorData(global_invocation_id, vec3u));\r\n                    context.setVariable(\"@local_invocation_index\", new ScalarData(li, u32));\r\n\r\n                    this._dispatchExec(f, context);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _dispatchExec(f: FunctionRef, context: ExecContext): void {\r\n        // Update any built-in input args.\r\n        // TODO: handle input structs.\r\n        for (const arg of f.node.args) {\r\n            for (const attr of arg.attributes) {\r\n                if (attr.name === \"builtin\") {\r\n                    const globalName = `@${attr.value}`;\r\n                    const globalVar = context.getVariable(globalName);\r\n                    if (globalVar !== undefined) {\r\n                        context.variables.set(arg.name, globalVar);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this._execStatements(f.node.body, context);\r\n    }\r\n\r\n    getVariableName(node: Node, context: ExecContext): string | null {\r\n        while (node instanceof UnaryOperator) {\r\n            node = node.right;\r\n        }\r\n\r\n        if (node instanceof VariableExpr) {\r\n            return (node as VariableExpr).name;\r\n        } else {\r\n            console.error(`Unknown variable type`, node, 'Line', node.line);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    _execStatements(statements: Node[], context: ExecContext): Data | null {\r\n        for (const stmt of statements) {\r\n            // Block statements are declared as arrays of statements.\r\n            if (stmt instanceof Array) {\r\n                const subContext = context.clone();\r\n                const res = this._execStatements(stmt, subContext);\r\n                if (res) {\r\n                    return res;\r\n                }\r\n                continue;\r\n            }\r\n\r\n            const res = this.execStatement(stmt, context);\r\n            if (res) {\r\n                return res;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    _call(node: Call, context: ExecContext): void {\r\n        const subContext = context.clone();\r\n        subContext.currentFunctionName = node.name;\r\n\r\n        const f = context.getFunction(node.name);\r\n        if (!f) {\r\n            if (node.isBuiltin) {\r\n                this._callBuiltinFunction(node, subContext);\r\n            } else {\r\n                const typeInfo = this.getTypeInfo(node.name);\r\n                if (typeInfo) {\r\n                    this._evalCreate(node, context);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n\r\n        for (let ai = 0; ai < f.node.args.length; ++ai) {\r\n            const arg = f.node.args[ai];\r\n            const value = this.evalExpression(node.args[ai], subContext);\r\n            subContext.setVariable(arg.name, value, arg);\r\n        }\r\n\r\n        this._execStatements(f.node.body, subContext);\r\n    }\r\n\r\n    _increment(node: Increment, context: ExecContext): void {\r\n        const name = this.getVariableName(node.variable, context);\r\n        const v = context.getVariable(name);\r\n        if (!v) {\r\n            console.error(`Variable ${name} not found. Line ${node.line}`);\r\n            return;\r\n        }\r\n        if (node.operator === \"++\") {\r\n            if (v.value instanceof ScalarData) {\r\n                v.value.value++;\r\n            } else {\r\n                console.error(`Variable ${name} is not a scalar. Line ${node.line}`);\r\n            }\r\n        } else if (node.operator === \"--\") {\r\n            if (v.value instanceof ScalarData) {\r\n                v.value.value--;\r\n            } else {\r\n                console.error(`Variable ${name} is not a scalar. Line ${node.line}`);\r\n            }\r\n        } else {\r\n            console.error(`Unknown increment operator ${node.operator}. Line ${node.line}`);\r\n        }\r\n    }\r\n\r\n    _getVariableData(node: Node, context: ExecContext): Data | null {\r\n        if (node instanceof VariableExpr) {\r\n            const name = this.getVariableName(node, context);\r\n            const _var = context.getVariable(name);\r\n            if (_var === null) {\r\n                console.error(`Variable ${name} not found. Line ${node.line}`);\r\n                return null;\r\n            }\r\n            return _var.value.getSubData(this, node.postfix, context);\r\n        }\r\n\r\n        if (node instanceof UnaryOperator) {\r\n            if (node.operator === \"*\") {\r\n                const refData = this._getVariableData(node.right, context);\r\n                if (!(refData instanceof PointerData)) {\r\n                    console.error(`Variable ${node.right} is not a pointer. Line ${node.line}`);\r\n                    return null;\r\n                }\r\n\r\n                return refData.reference.getSubData(this, node.postfix, context);\r\n            } else if (node.operator === \"&\") {\r\n                const refData = this._getVariableData(node.right, context);\r\n                return new PointerData(refData);\r\n            } \r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    _assign(node: Assign, context: ExecContext): void {\r\n        let v: Data | null = null;\r\n        let name: string = \"<var>\";\r\n\r\n        let postfix: Expression | null = null;\r\n\r\n        if (node.variable instanceof UnaryOperator) {\r\n            const varData = this._getVariableData(node.variable, context);\r\n            const assignValue = this.evalExpression(node.value, context);\r\n            const op = node.operator;\r\n\r\n            if (op === \"=\") {\r\n                if (varData instanceof ScalarData || varData instanceof VectorData || varData instanceof MatrixData) {\r\n                    if (assignValue instanceof ScalarData || assignValue instanceof VectorData || assignValue instanceof MatrixData &&\r\n                        varData.data.length === assignValue.data.length) {\r\n                        varData.data.set(assignValue.data);\r\n                        return;\r\n                    } else {\r\n                        console.error(`Invalid assignment. Line ${node.line}`);\r\n                    }\r\n                } else if (varData instanceof TypedData && assignValue instanceof TypedData) {\r\n                    if ((varData.buffer.byteLength - varData.offset) >= (assignValue.buffer.byteLength - assignValue.offset)) {\r\n                        if (varData.buffer.byteLength % 4 === 0) {\r\n                            new Uint32Array(varData.buffer, varData.offset, varData.typeInfo.size / 4).set(new Uint32Array(assignValue.buffer, assignValue.offset, assignValue.typeInfo.size / 4));\r\n                        } else {\r\n                            new Uint8Array(varData.buffer, varData.offset, varData.typeInfo.size).set(new Uint8Array(assignValue.buffer, assignValue.offset, assignValue.typeInfo.size));\r\n                        }\r\n                        return;\r\n                    }\r\n                }\r\n                console.error(`Invalid assignment. Line ${node.line}`);\r\n                return null;\r\n            } else if (op === \"+=\") {\r\n                if (varData instanceof ScalarData || varData instanceof VectorData || varData instanceof MatrixData) {\r\n                    if (assignValue instanceof ScalarData || assignValue instanceof VectorData || assignValue instanceof MatrixData) {\r\n                        varData.data.set(assignValue.data.map((v: number, i: number) => varData.data[i] + v));\r\n                        return;\r\n                    } else {\r\n                        console.error(`Invalid assignment . Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                } else {\r\n                    console.error(`Invalid assignment. Line ${node.line}`);\r\n                    return;\r\n                }\r\n            } else if (op === \"-=\") {\r\n                if (varData instanceof ScalarData || varData instanceof VectorData || varData instanceof MatrixData) {\r\n                    if (assignValue instanceof ScalarData || assignValue instanceof VectorData || assignValue instanceof MatrixData) {\r\n                        varData.data.set(assignValue.data.map((v: number, i: number) => varData.data[i] - v));\r\n                        return;\r\n                    } else {\r\n                        console.error(`Invalid assignment. Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                } else {\r\n                    console.error(`Invalid assignment. Line ${node.line}`);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (node.variable instanceof UnaryOperator) {\r\n            if (node.variable.operator === \"*\") {\r\n                name = this.getVariableName(node.variable.right, context);\r\n                const _var = context.getVariable(name);\r\n                if (_var && _var.value instanceof PointerData) {\r\n                    v = _var.value.reference;\r\n                } else {\r\n                    console.error(`Variable ${name} is not a pointer. Line ${node.line}`);\r\n                    return;\r\n                }\r\n\r\n                let postfix = node.variable.postfix;\r\n                if (!postfix) {\r\n                    let rNode = node.variable.right;\r\n                    while (rNode instanceof UnaryOperator) {\r\n                        if (rNode.postfix) {\r\n                            postfix = rNode.postfix;\r\n                            break;\r\n                        }\r\n                        rNode = rNode.right;\r\n                    }\r\n                }\r\n                if (postfix) {\r\n                    v = v.getSubData(this, postfix, context);\r\n                }\r\n            }\r\n        } else {\r\n            postfix = node.variable.postfix;\r\n            name = this.getVariableName(node.variable, context);\r\n            const _var = context.getVariable(name);\r\n            if (_var === null) {\r\n                console.error(`Variable ${name} not found. Line ${node.line}`);\r\n                return;\r\n            }\r\n            v = _var.value;\r\n        }\r\n\r\n        if (v instanceof PointerData) {\r\n            v = v.reference;\r\n        }\r\n\r\n        if (v === null) {\r\n            console.error(`Variable ${name} not found. Line ${node.line}`);\r\n            return;\r\n        }\r\n\r\n        const value = this.evalExpression(node.value, context);\r\n\r\n        const op = node.operator;\r\n        if (op !== \"=\") {\r\n            const currentValue = v.getSubData(this, postfix, context);\r\n\r\n            if (currentValue instanceof VectorData && value instanceof ScalarData) {\r\n                const cv = currentValue.data;\r\n                const v = value.value;\r\n\r\n                if (op === \"+=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] += v;\r\n                    }\r\n                } else if (op === \"-=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] -= v;\r\n                    }\r\n                } else if (op === \"*=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] *= v;\r\n                    }\r\n                } else if (op === \"/=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] /= v;\r\n                    }\r\n                } else if (op === \"%=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] %= v;\r\n                    }\r\n                } else if (op === \"&=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] &= v;\r\n                    }\r\n                } else if (op === \"|=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] |= v;\r\n                    }\r\n                } else if (op === \"^=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] ^= v;\r\n                    }\r\n                } else if (op === \"<<=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] <<= v;\r\n                    }\r\n                } else if (op === \">>=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] >>= v;\r\n                    }\r\n                } else {\r\n                    console.error(`Invalid operator ${op}. Line ${node.line}`);\r\n                }\r\n            } else if (currentValue instanceof VectorData && value instanceof VectorData) {\r\n                const cv = currentValue.data;\r\n                const v = value.data;\r\n                if (cv.length !== v.length) {\r\n                    console.error(`Vector length mismatch. Line ${node.line}`);\r\n                    return;\r\n                }\r\n\r\n                if (op === \"+=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] += v[i];\r\n                    }\r\n                } else if (op === \"-=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] -= v[i];\r\n                    }\r\n                } else if (op === \"*=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] *= v[i];\r\n                    }\r\n                } else if (op === \"/=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] /= v[i];\r\n                    }\r\n                } else if (op === \"%=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] %= v[i];\r\n                    }\r\n                } else if (op === \"&=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] &= v[i];\r\n                    }\r\n                } else if (op === \"|=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] |= v[i];\r\n                    }\r\n                } else if (op === \"^=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] ^= v[i];\r\n                    }\r\n                } else if (op === \"<<=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] <<= v[i];\r\n                    }\r\n                } else if (op === \">>=\") {\r\n                    for (let i = 0; i < cv.length; ++i) {\r\n                        cv[i] >>= v[i];\r\n                    }\r\n                } else {\r\n                    console.error(`Invalid operator ${op}. Line ${node.line}`);\r\n                }\r\n            } else if (currentValue instanceof ScalarData && value instanceof ScalarData) {\r\n                if (op === \"+=\") {\r\n                    currentValue.value += value.value;\r\n                } else if (op === \"-=\") {\r\n                    currentValue.value -= value.value;\r\n                } else if (op === \"*=\") {\r\n                    currentValue.value *= value.value;\r\n                } else if (op === \"/=\") {\r\n                    currentValue.value /= value.value;\r\n                } else if (op === \"%=\") {\r\n                    currentValue.value %= value.value;\r\n                } else if (op === \"&=\") {\r\n                    currentValue.value &= value.value;\r\n                } else if (op === \"|=\") {\r\n                    currentValue.value |= value.value;\r\n                } else if (op === \"^=\") {\r\n                    currentValue.value ^= value.value;\r\n                } else if (op === \"<<=\") {\r\n                    currentValue.value <<= value.value;\r\n                } else if (op === \">>=\") {\r\n                    currentValue.value >>= value.value;\r\n                } else {\r\n                    console.error(`Invalid operator ${op}. Line ${node.line}`);\r\n                }\r\n            } else {\r\n                console.error(`Invalid type for ${node.operator} operator. Line ${node.line}`);\r\n                return;\r\n            }\r\n\r\n            // If the variable is a TypedData, as in a struct or array, and we're assigning a\r\n            // sub portion of it, set the data in the original buffer.\r\n            if (v instanceof TypedData) {\r\n                v.setDataValue(this, currentValue, postfix, context);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        if (v instanceof TypedData) {\r\n            v.setDataValue(this, value, postfix, context);\r\n        } else if (postfix) {\r\n            if (!(v instanceof VectorData) && !(v instanceof MatrixData)) {\r\n                console.error(`Variable ${name} is not a vector or matrix. Line ${node.line}`);\r\n                return;\r\n            }\r\n\r\n            if (postfix instanceof ArrayIndex) {\r\n                const idx = (this.evalExpression(postfix.index, context) as ScalarData).value;\r\n\r\n                if (v instanceof VectorData) {\r\n                    if (value instanceof ScalarData) {\r\n                        v.data[idx] = value.value;\r\n                    } else {\r\n                        console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                } else if (v instanceof MatrixData) {\r\n                    const idx = (this.evalExpression(postfix.index, context) as ScalarData).value;\r\n                    if (idx < 0) {\r\n                        console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                    if (value instanceof VectorData) {\r\n                        const typeName = v.typeInfo.getTypeName();\r\n                        if (typeName === \"mat2x2\" || typeName === \"mat2x2f\" || typeName === \"mat2x2h\") {\r\n                            if (idx < 2 && value.data.length === 2) {\r\n                                v.data[idx * 2] = value.data[0];\r\n                                v.data[idx * 2 + 1] = value.data[1];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat2x3\" || typeName === \"mat2x3f\" || typeName === \"mat2x3h\") {\r\n                            if (idx < 2 && value.data.length === 3) {\r\n                                v.data[idx * 3] = value.data[0];\r\n                                v.data[idx * 3 + 1] = value.data[1];\r\n                                v.data[idx * 3 + 2] = value.data[2];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat2x4\" || typeName === \"mat2x4f\" || typeName === \"mat2x4h\") {\r\n                            if (idx < 2 && value.data.length === 4) {\r\n                                v.data[idx * 4] = value.data[0];\r\n                                v.data[idx * 4 + 1] = value.data[1];\r\n                                v.data[idx * 4 + 2] = value.data[2];\r\n                                v.data[idx * 4 + 3] = value.data[3];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat3x2\" || typeName === \"mat3x2f\" || typeName === \"mat3x2h\") {\r\n                            if (idx < 3 && value.data.length === 2) {\r\n                                v.data[idx * 2] = value.data[0];\r\n                                v.data[idx * 2 + 1] = value.data[1];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat3x3\" || typeName === \"mat3x3f\" || typeName === \"mat3x3h\") {\r\n                            if (idx < 3 && value.data.length === 3) {\r\n                                v.data[idx * 3] = value.data[0];\r\n                                v.data[idx * 3 + 1] = value.data[1];\r\n                                v.data[idx * 3 + 2] = value.data[2];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat3x4\" || typeName === \"mat3x4f\" || typeName === \"mat3x4h\") {\r\n                            if (idx < 3 && value.data.length === 4) {\r\n                                v.data[idx * 4] = value.data[0];\r\n                                v.data[idx * 4 + 1] = value.data[1];\r\n                                v.data[idx * 4 + 2] = value.data[2];\r\n                                v.data[idx * 4 + 3] = value.data[3];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat4x2\" || typeName === \"mat4x2f\" || typeName === \"mat4x2h\") {\r\n                            if (idx < 4 && value.data.length === 2) {\r\n                                v.data[idx * 2] = value.data[0];\r\n                                v.data[idx * 2 + 1] = value.data[1];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat4x3\" || typeName === \"mat4x3f\" || typeName === \"mat4x3h\") {\r\n                            if (idx < 4 && value.data.length === 3) {\r\n                                v.data[idx * 3] = value.data[0];\r\n                                v.data[idx * 3 + 1] = value.data[1];\r\n                                v.data[idx * 3 + 2] = value.data[2];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else if (typeName === \"mat4x4\" || typeName === \"mat4x4f\" || typeName === \"mat4x4h\") {\r\n                            if (idx < 4 && value.data.length === 4) {\r\n                                v.data[idx * 4] = value.data[0];\r\n                                v.data[idx * 4 + 1] = value.data[1];\r\n                                v.data[idx * 4 + 2] = value.data[2];\r\n                                v.data[idx * 4 + 3] = value.data[3];\r\n                            } else {\r\n                                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                        } else {\r\n                            console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                            return;\r\n                        }\r\n                    } else {\r\n                        console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                } else {\r\n                    console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                    return;\r\n                }\r\n            } else if (postfix instanceof StringExpr) {\r\n                const member = postfix.value;\r\n                if (!(v instanceof VectorData)) {\r\n                    console.error(`Invalid assignment to ${member}. Variable ${name} is not a vector. Line ${node.line}`);\r\n                    return;\r\n                }\r\n                if (value instanceof ScalarData) {\r\n                    if (member.length > 1) {\r\n                        console.error(`Invalid assignment to ${member} for variable ${name}. Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                    if (member === \"x\") {\r\n                        v.data[0] = value.value;\r\n                    } else if (member === \"y\") {\r\n                        if (v.data.length < 2) {\r\n                            console.error(`Invalid assignment to ${member} for variable ${name}. Line ${node.line}`);\r\n                            return;\r\n                        }\r\n                        v.data[1] = value.value;\r\n                    } else if (member === \"z\") {\r\n                        if (v.data.length < 3) {\r\n                            console.error(`Invalid assignment to ${member} for variable ${name}. Line ${node.line}`);\r\n                            return;\r\n                        }\r\n                        v.data[2] = value.value;\r\n                    } else if (member === \"w\") {\r\n                        if (v.data.length < 4) {\r\n                            console.error(`Invalid assignment to ${member} for variable ${name}. Line ${node.line}`);\r\n                            return;\r\n                        }\r\n                        v.data[3] = value.value;\r\n                    }\r\n                } else if (value instanceof VectorData) {\r\n                    if (member.length !== value.data.length) {\r\n                        console.error(`Invalid assignment to ${member} for variable ${name}. Line ${node.line}`);\r\n                        return;\r\n                    }\r\n                    for (let i = 0; i < member.length; ++i) {\r\n                        const m = member[i];\r\n                        if (m === \"x\" || m === \"r\") {\r\n                            v.data[0] = value.data[i];\r\n                        } else if (m === \"y\" || m === \"g\") {\r\n                            if (value.data.length < 2) {\r\n                                console.error(`Invalid assignment to ${m} for variable ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                            v.data[1] = value.data[i];\r\n                        } else if (m === \"z\" || m === \"b\") {\r\n                            if (value.data.length < 3) {\r\n                                console.error(`Invalid assignment to ${m} for variable ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                            v.data[2] = value.data[i];\r\n                        } else if (m === \"w\" || m === \"a\") {\r\n                            if (value.data.length < 4) {\r\n                                console.error(`Invalid assignment to ${m} for variable ${name}. Line ${node.line}`);\r\n                                return;\r\n                            }\r\n                            v.data[3] = value.data[i];\r\n                        } else {\r\n                            console.error(`Invalid assignment to ${m} for variable ${name}. Line ${node.line}`);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n                    return;\r\n                }\r\n            }\r\n        } else {\r\n            if (v instanceof ScalarData && value instanceof ScalarData) {\r\n                v.value = value.value;\r\n            } else if (v instanceof VectorData && value instanceof VectorData) {\r\n                v.data.set(value.data);\r\n            } else if (v instanceof MatrixData && value instanceof MatrixData) {\r\n                v.data.set(value.data);\r\n            } else {\r\n                console.error(`Invalid assignment to ${name}. Line ${node.line}`);\r\n            }\r\n            //v.value = value;\r\n        }\r\n        return;\r\n    }\r\n\r\n    _function(node: Function, context: ExecContext): void {\r\n        const f = new FunctionRef(node);\r\n        context.functions.set(node.name, f);\r\n    }\r\n\r\n    _const(node: Const, context: ExecContext): void {\r\n        let value = null;\r\n        if (node.value !== null) {\r\n            value = this.evalExpression(node.value, context);\r\n        }\r\n        context.createVariable(node.name, value, node);\r\n    }\r\n\r\n    _let(node: Let, context: ExecContext): void {\r\n        let value: Data | null = null;\r\n        if (node.value !== null) {\r\n            value = this.evalExpression(node.value, context);\r\n            if (value === null) {\r\n                console.error(`Invalid value for variable ${node.name}. Line ${node.line}`);\r\n                return;\r\n            }\r\n            if (!(node.value instanceof UnaryOperator)) {\r\n                value = value.clone();\r\n            }\r\n        } else {\r\n            const typeName = node.type.name;\r\n            if (typeName === \"f32\" || typeName === \"i32\" || typeName === \"u32\" ||\r\n                typeName === \"bool\" || typeName === \"f16\" ||\r\n                typeName === \"vec2\" || typeName === \"vec3\" || typeName === \"vec4\" ||\r\n                typeName === \"vec2f\" || typeName === \"vec3f\" || typeName === \"vec4f\" ||\r\n                typeName === \"vec2i\" || typeName === \"vec3i\" || typeName === \"vec4i\" ||\r\n                typeName === \"vec2u\" || typeName === \"vec3u\" || typeName === \"vec4u\" ||\r\n                typeName === \"vec2h\" || typeName === \"vec3h\" || typeName === \"vec4h\" ||\r\n                typeName === \"vec2b\" || typeName === \"vec3b\" || typeName === \"vec4b\" ||\r\n                typeName === \"mat2x2\" || typeName === \"mat2x3\" || typeName === \"mat2x4\" ||\r\n                typeName === \"mat3x2\" || typeName === \"mat3x3\" || typeName === \"mat3x4\" ||\r\n                typeName === \"mat4x2\" || typeName === \"mat4x3\" || typeName === \"mat4x4\" ||\r\n                typeName === \"mat2x2f\" || typeName === \"mat2x3f\" || typeName === \"mat2x4f\" ||\r\n                typeName === \"mat3x2f\" || typeName === \"mat3x3f\" || typeName === \"mat3x4f\" ||\r\n                typeName === \"mat4x2f\" || typeName === \"mat4x3f\" || typeName === \"mat4x4f\" ||\r\n                typeName === \"mat2x2h\" || typeName === \"mat2x3h\" || typeName === \"mat2x4h\" ||\r\n                typeName === \"mat3x2h\" || typeName === \"mat3x3h\" || typeName === \"mat3x4h\" ||\r\n                typeName === \"mat4x2h\" || typeName === \"mat4x3h\" || typeName === \"mat4x4h\" ||\r\n                typeName === \"array\") {\r\n                const defType = new CreateExpr(node.type, []);\r\n                value = this._evalCreate(defType, context);\r\n            }\r\n        }\r\n        context.createVariable(node.name, value, node);\r\n    }\r\n\r\n    _var(node: Var, context: ExecContext): void {\r\n        let value = null;\r\n        if (node.value !== null) {\r\n            value = this.evalExpression(node.value, context);\r\n            if (value === null) {\r\n                console.error(`Invalid value for variable ${node.name}. Line ${node.line}`);\r\n                return;\r\n            }\r\n            if (!(node.value instanceof UnaryOperator)) {\r\n                value = value.clone();\r\n            }\r\n        } else {\r\n            if (node.type === null) {\r\n                console.error(`Variable ${node.name} has no type. Line ${node.line}`);\r\n                return;\r\n            }\r\n\r\n            const typeName = node.type.name;\r\n            if (typeName === \"f32\" || typeName === \"i32\" || typeName === \"u32\" ||\r\n                typeName === \"bool\" || typeName === \"f16\" ||\r\n                typeName === \"vec2\" || typeName === \"vec3\" || typeName === \"vec4\" ||\r\n                typeName === \"vec2f\" || typeName === \"vec3f\" || typeName === \"vec4f\" ||\r\n                typeName === \"vec2i\" || typeName === \"vec3i\" || typeName === \"vec4i\" ||\r\n                typeName === \"vec2u\" || typeName === \"vec3u\" || typeName === \"vec4u\" ||\r\n                typeName === \"vec2h\" || typeName === \"vec3h\" || typeName === \"vec4h\" ||\r\n                typeName === \"vec2b\" || typeName === \"vec3b\" || typeName === \"vec4b\" ||\r\n                typeName === \"mat2x2\" || typeName === \"mat2x3\" || typeName === \"mat2x4\" ||\r\n                typeName === \"mat3x2\" || typeName === \"mat3x3\" || typeName === \"mat3x4\" ||\r\n                typeName === \"mat4x2\" || typeName === \"mat4x3\" || typeName === \"mat4x4\" ||\r\n                typeName === \"mat2x2f\" || typeName === \"mat2x3f\" || typeName === \"mat2x4f\" ||\r\n                typeName === \"mat3x2f\" || typeName === \"mat3x3f\" || typeName === \"mat3x4f\" ||\r\n                typeName === \"mat4x2f\" || typeName === \"mat4x3f\" || typeName === \"mat4x4f\" ||\r\n                typeName === \"mat2x2h\" || typeName === \"mat2x3h\" || typeName === \"mat2x4h\" ||\r\n                typeName === \"mat3x2h\" || typeName === \"mat3x3h\" || typeName === \"mat3x4h\" ||\r\n                typeName === \"mat4x2h\" || typeName === \"mat4x3h\" || typeName === \"mat4x4h\" ||\r\n                node.type instanceof ArrayType || node.type instanceof Struct || node.type instanceof TemplateType) {\r\n                const defType = new CreateExpr(node.type, []);\r\n                value = this._evalCreate(defType, context);\r\n            }\r\n        }\r\n\r\n        context.createVariable(node.name, value, node);\r\n    }\r\n\r\n    _switch(node: Switch, context: ExecContext) : Data | null {\r\n        context = context.clone();\r\n        const condition = this.evalExpression(node.condition, context);\r\n        if (!(condition instanceof ScalarData)) {\r\n            console.error(`Invalid if condition. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        let defaultCase: SwitchCase | null = null;\r\n\r\n        for (const c of node.cases) {\r\n            if (c instanceof Case) {\r\n                for (const selector of c.selectors) {\r\n                    if (selector instanceof DefaultSelector) {\r\n                        defaultCase = c;\r\n                        continue;\r\n                    }\r\n\r\n                    const selectorValue = this.evalExpression(selector, context);\r\n                    if (!(selectorValue instanceof ScalarData)) {\r\n                        console.error(`Invalid case selector. Line ${node.line}`);\r\n                        return null;\r\n                    }\r\n\r\n                    if (selectorValue.value === condition.value) {\r\n                        return this._execStatements(c.body, context);\r\n                    }\r\n                }\r\n            } else if (c instanceof Default) {\r\n                defaultCase = c;\r\n            }\r\n        }\r\n\r\n        if (defaultCase) {\r\n            return this._execStatements(defaultCase.body, context);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    _if(node: If, context: ExecContext): Data | null {\r\n        context = context.clone();\r\n        const condition = this.evalExpression(node.condition, context);\r\n        if (!(condition instanceof ScalarData)) {\r\n            console.error(`Invalid if condition. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        if (condition.value) {\r\n            return this._execStatements(node.body, context);\r\n        }\r\n\r\n        for (const e of node.elseif) {\r\n            const condition = this.evalExpression(e.condition, context);\r\n            if (!(condition instanceof ScalarData)) {\r\n                console.error(`Invalid if condition. Line ${node.line}`);\r\n                return null;\r\n            }\r\n            if (condition.value) {\r\n                return this._execStatements(e.body, context);\r\n            }\r\n        }\r\n\r\n        if (node.else) {\r\n            return this._execStatements(node.else, context);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    _getScalarValue(v: Data | null): number {\r\n        if (v instanceof ScalarData) {\r\n            return v.value;\r\n        }\r\n        console.error(`Expected scalar value.`, v);\r\n        return 0;\r\n    }\r\n\r\n    _for(node: For, context: ExecContext): Data | null {\r\n        context = context.clone();\r\n        this.execStatement(node.init, context);\r\n        while (this._getScalarValue(this.evalExpression(node.condition, context))) {\r\n            const res = this._execStatements(node.body, context);\r\n            if (res === WgslExec._breakObj) {\r\n                break;\r\n            }\r\n            if (res !== null && res !== WgslExec._continueObj) {\r\n                return res;\r\n            }\r\n            this.execStatement(node.increment, context);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    _loop(node: Loop, context: ExecContext): Data | null {\r\n        context = context.clone();\r\n\r\n        while (true) {\r\n            const res = this._execStatements(node.body, context);\r\n            if (res === WgslExec._breakObj) {\r\n                break;\r\n            } else if (res === WgslExec._continueObj) {\r\n                if (node.continuing) {\r\n                    const cres = this._execStatements(node.continuing.body, context);\r\n                    if (cres === WgslExec._breakObj) {\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (res !== null) {\r\n                return res;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    _while(node: While, context: ExecContext): Data | null {\r\n        context = context.clone();\r\n        while (this._getScalarValue(this.evalExpression(node.condition, context))) {\r\n            const res = this._execStatements(node.body, context);\r\n            if (res === WgslExec._breakObj) {\r\n                break;\r\n            } else if (res === WgslExec._continueObj) {\r\n                continue;\r\n            } else if (res !== null) {\r\n                return res;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    _evalBitcast(node: BitcastExpr, context: ExecContext): Data | null {\r\n        const value = this.evalExpression(node.value, context);\r\n        const type = node.type;\r\n\r\n        if (value instanceof ScalarData) {\r\n            const v = castScalar(value.value, value.typeInfo.name, type.name);\r\n            return new ScalarData(v, this.getTypeInfo(type));\r\n        }\r\n\r\n        if (value instanceof VectorData) {\r\n            const fromType = value.typeInfo.getTypeName();\r\n            let fromCast = \"\";\r\n            if (fromType.endsWith(\"f\")) {\r\n                fromCast = \"f32\";\r\n            } else if (fromType.endsWith(\"i\")) {\r\n                fromCast = \"i32\";\r\n            } else if (fromType.endsWith(\"u\")) {\r\n                fromCast = \"u32\";\r\n            } else if (fromType.endsWith(\"b\")) {\r\n                fromCast = \"bool\";\r\n            } else if (fromType.endsWith(\"h\")) {\r\n                fromCast = \"f16\";\r\n            } else {\r\n                console.error(`Unknown vector type ${fromType}. Line ${node.line}`);\r\n                return null;\r\n            }\r\n\r\n            const toType = type.getTypeName();\r\n            let toCast = \"\";\r\n            if (toType.endsWith(\"f\")) {\r\n                toCast = \"f32\";\r\n            } else if (toType.endsWith(\"i\")) {\r\n                toCast = \"i32\";\r\n            } else if (toType.endsWith(\"u\")) {\r\n                toCast = \"u32\";\r\n            } else if (toType.endsWith(\"b\")) {\r\n                toCast = \"bool\";\r\n            } else if (toType.endsWith(\"h\")) {\r\n                toCast = \"f16\";\r\n            } else {\r\n                console.error(`Unknown vector type ${toCast}. Line ${node.line}`);\r\n                return null;\r\n            }\r\n\r\n            const v = castVector(Array.from(value.data), fromCast, toCast);\r\n            return new VectorData(v, this.getTypeInfo(type));\r\n        }\r\n\r\n        console.error(`TODO: bitcast for ${value.typeInfo.name}. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    _evalConst(node: ConstExpr, context: ExecContext): Data | null {\r\n        const data = context.getVariableValue(node.name).clone();\r\n        return data.getSubData(this, node.postfix, context);\r\n    }\r\n\r\n    _evalCreate(node: CreateExpr | CallExpr | Call, context: ExecContext): Data | null {\r\n        if (node instanceof CreateExpr) {\r\n            if (node.type === null) {\r\n                return VoidData.void;\r\n            }\r\n\r\n            const typeName = node.type.getTypeName();\r\n\r\n            switch (typeName) {\r\n                // Constructor Built-in Functions\r\n                // Value Constructor Built-in Functions\r\n                case \"bool\":\r\n                case \"i32\":\r\n                case \"u32\":\r\n                case \"f32\":\r\n                case \"f16\":\r\n                    return this._callConstructorValue(node, context);\r\n                case \"vec2\":\r\n                case \"vec3\":\r\n                case \"vec4\":\r\n                case \"vec2f\":\r\n                case \"vec3f\":\r\n                case \"vec4f\":\r\n                case \"vec2h\":\r\n                case \"vec3h\":\r\n                case \"vec4h\":\r\n                case \"vec2i\":\r\n                case \"vec3i\":\r\n                case \"vec4i\":\r\n                case \"vec2u\":\r\n                case \"vec3u\":\r\n                case \"vec4u\":\r\n                case \"vec2b\":\r\n                case \"vec3b\":\r\n                case \"vec4b\":\r\n                    return this._callConstructorVec(node, context);\r\n                case \"mat2x2\":\r\n                case \"mat2x2f\":\r\n                case \"mat2x2h\":\r\n                case \"mat2x3\":\r\n                case \"mat2x3f\":\r\n                case \"mat2x3h\":\r\n                case \"mat2x4\":\r\n                case \"mat2x4f\":\r\n                case \"mat2x4h\":\r\n                case \"mat3x2\":\r\n                case \"mat3x2f\":\r\n                case \"mat3x2h\":\r\n                case \"mat3x3\":\r\n                case \"mat3x3f\":\r\n                case \"mat3x3h\":\r\n                case \"mat3x4\":\r\n                case \"mat3x4f\":\r\n                case \"mat3x4h\":\r\n                case \"mat4x2\":\r\n                case \"mat4x2f\":\r\n                case \"mat4x2h\":\r\n                case \"mat4x3\":\r\n                case \"mat4x3f\":\r\n                case \"mat4x3h\":\r\n                case \"mat4x4\":\r\n                case \"mat4x4f\":\r\n                case \"mat4x4h\":\r\n                    return this._callConstructorMatrix(node, context);\r\n            }\r\n        }\r\n\r\n        const typeName = (node instanceof CreateExpr) ? node.type.name : node.name;\r\n        const typeInfo = (node instanceof CreateExpr) ? this.getTypeInfo(node.type) : this.getTypeInfo(node.name);\r\n        if (typeInfo === null) {\r\n            console.error(`Unknown type ${typeName}. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        if (typeInfo.size === 0) {\r\n            return null;\r\n        }\r\n\r\n        const data = new TypedData(new ArrayBuffer(typeInfo.size), typeInfo, 0);\r\n\r\n        // Assign the values in node.args to the data.\r\n        if (typeInfo instanceof StructInfo) {\r\n            if (node.args) {\r\n                for (let i = 0; i < node.args.length; ++i) {\r\n                    const memberInfo = typeInfo.members[i];\r\n                    const arg = node.args[i];\r\n                    const value = this.evalExpression(arg, context);\r\n                    data.setData(this, value, memberInfo.type, memberInfo.offset, context);\r\n                }\r\n            }\r\n        } else if (typeInfo instanceof ArrayInfo) {\r\n            let offset = 0;\r\n            if (node.args) {\r\n                for (let i = 0; i < node.args.length; ++i) {\r\n                    const arg = node.args[i];\r\n                    const value = this.evalExpression(arg, context);\r\n                    if (typeInfo.format === null) {\r\n                        if (value.typeInfo?.name === \"x32\") {\r\n                            typeInfo.format = this.getTypeInfo(\"i32\");\r\n                        } else {\r\n                            typeInfo.format = value.typeInfo;\r\n                        }\r\n                    }\r\n                    data.setData(this, value, typeInfo.format, offset, context);\r\n                    offset += typeInfo.stride;\r\n                }\r\n            }\r\n        } else {\r\n            console.error(`Unknown type \"${typeName}\". Line ${node.line}`);\r\n        }\r\n\r\n        if (node instanceof CreateExpr) {\r\n            return data.getSubData(this, node.postfix, context);\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    _evalLiteral(node: LiteralExpr, context: ExecContext): Data | null {\r\n        const typeInfo = this.getTypeInfo(node.type);\r\n        const typeName = typeInfo.name;\r\n        if (typeName === \"x32\" || typeName === \"u32\" || typeName === \"f32\" || typeName === \"f16\" ||\r\n            typeName === \"i32\" || typeName === \"bool\") {\r\n            const data = new ScalarData(node.scalarValue, typeInfo);\r\n            return data;\r\n        }\r\n        if (typeName === \"vec2\" || typeName === \"vec3\" || typeName === \"vec4\" ||\r\n            typeName === \"vec2f\" || typeName === \"vec3f\" || typeName === \"vec4f\" ||\r\n            typeName === \"vec2h\" || typeName === \"vec3h\" || typeName === \"vec4h\" ||\r\n            typeName === \"vec2i\" || typeName === \"vec3i\" || typeName === \"vec4i\" ||\r\n            typeName === \"vec2u\" || typeName === \"vec3u\" || typeName === \"vec4u\") {\r\n            return this._callConstructorVec(node, context);\r\n        }\r\n        if (typeName === \"mat2x2\" || typeName === \"mat2x3\" || typeName === \"mat2x4\" ||\r\n            typeName === \"mat3x2\" || typeName === \"mat3x3\" || typeName === \"mat3x4\" ||\r\n            typeName === \"mat4x2\" || typeName === \"mat4x3\" || typeName === \"mat4x4\" ||\r\n            typeName === \"mat2x2f\" || typeName === \"mat2x3f\" || typeName === \"mat2x4f\" ||\r\n            typeName === \"mat3x2f\" || typeName === \"mat3x3f\" || typeName === \"mat3x4f\" ||\r\n            typeName === \"mat4x2f\" || typeName === \"mat4x3f\" || typeName === \"mat4x4f\" ||\r\n            typeName === \"mat2x2h\" || typeName === \"mat2x3h\" || typeName === \"mat2x4h\" ||\r\n            typeName === \"mat3x2h\" || typeName === \"mat3x3h\" || typeName === \"mat3x4h\" ||\r\n            typeName === \"mat4x2h\" || typeName === \"mat4x3h\" || typeName === \"mat4x4h\") {\r\n            return this._callConstructorMatrix(node, context);\r\n        }\r\n        return node.value;\r\n    }\r\n\r\n    _evalVariable(node: VariableExpr, context: ExecContext): Data | null {\r\n        const value = context.getVariableValue(node.name);\r\n        if (value === null) {\r\n            return value;\r\n        }\r\n        return value.getSubData(this, node.postfix, context);\r\n    }\r\n\r\n    static _priority = new Map<string, number>([[\"f32\", 0], [\"f16\", 1], [\"u32\", 2], [\"i32\", 3], [\"x32\", 3]]);\r\n    _maxFormatTypeInfo(x: TypeInfo[]): TypeInfo | null {\r\n        let t = x[0];\r\n        if (t.name === \"f32\") {\r\n            return t;\r\n        }\r\n        for (let i = 1; i < x.length; ++i) {\r\n            const tv = WgslExec._priority.get(t.name);\r\n            const xv = WgslExec._priority.get(x[i].name);\r\n            if (xv < tv) {\r\n                t = x[i];\r\n            }\r\n        }\r\n\r\n        if (t.name === \"x32\") {\r\n            return this.getTypeInfo(\"i32\");\r\n        }\r\n\r\n        return t;\r\n    }\r\n\r\n    _evalUnaryOp(node: UnaryOperator, context: ExecContext): Data | null {\r\n        const _r = this.evalExpression(node.right, context);\r\n\r\n        if (node.operator === \"&\") { \r\n            return new PointerData(_r);\r\n        } else if (node.operator === \"*\") {\r\n            if (_r instanceof PointerData) {\r\n                return _r.reference.getSubData(this, node.postfix, context);\r\n            }\r\n            console.error(`Invalid dereference. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const r = _r instanceof ScalarData ? _r.value : \r\n            _r instanceof VectorData ? Array.from(_r.data) : null;\r\n\r\n        switch (node.operator) {\r\n            case \"+\": {\r\n                if (isArray(r)) {\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => +x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_r.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(+rn, t);\r\n            }\r\n            case \"-\": {\r\n                if (isArray(r)) {\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => -x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_r.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(-rn, t);\r\n            }\r\n            case \"!\": {\r\n                if (isArray(r)) {\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => !x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_r.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(!rn ? 1 : 0, t);\r\n            }\r\n            case \"~\": {\r\n                if (isArray(r)) {\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ~x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_r.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(~rn, t);\r\n            }\r\n        }\r\n        console.error(`Invalid unary operator ${node.operator}. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    _evalBinaryOp(node: BinaryOperator, context: ExecContext): Data | null {\r\n        const _l = this.evalExpression(node.left, context);\r\n        const _r = this.evalExpression(node.right, context);\r\n\r\n        const l = _l instanceof ScalarData ? _l.value : \r\n            _l instanceof VectorData ? Array.from(_l.data) :\r\n            _l instanceof MatrixData ? Array.from(_l.data) : null;\r\n        const r = _r instanceof ScalarData ? _r.value : \r\n            _r instanceof VectorData ? Array.from(_r.data) : \r\n            _r instanceof MatrixData ? Array.from(_r.data) :\r\n            null;\r\n\r\n        switch (node.operator) {\r\n            case \"+\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x + ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x + rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln + x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln + rn, t);\r\n            }\r\n            case \"-\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x - ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x - rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln - x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln - rn, t);\r\n            }\r\n            case \"*\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n\r\n                    if (_l instanceof MatrixData && _r instanceof MatrixData) {\r\n                        const result = matrixMultiply(la, _l.typeInfo, ra, _r.typeInfo);\r\n                        if (result === null) {\r\n                            console.error(`Matrix multiplication failed. Line ${node.line}.`);\r\n                            return null;\r\n                        }\r\n                        const colsB = MatrixTypeSize[_r.typeInfo.name][0];\r\n                        const rowsA = MatrixTypeSize[_l.typeInfo.name][1];\r\n                        const type = this.getTypeInfo(`mat${colsB}x${rowsA}f`);\r\n                        return new MatrixData(result, type);\r\n                    } else if (_l instanceof MatrixData && _r instanceof VectorData) {\r\n                        const result = matrixVectorMultiply(la, _l.typeInfo, ra, _r.typeInfo);\r\n                        if (result === null) {\r\n                            console.error(`Matrix vector multiplication failed. Line ${node.line}.`);\r\n                            return null;\r\n                        }\r\n                        return new VectorData(result, _r.typeInfo);\r\n                    } else if (_l instanceof VectorData && _r instanceof MatrixData) {\r\n                        const result = vectorMatrixMultiply(la, _l.typeInfo, ra, _r.typeInfo);\r\n                        if (result === null) {\r\n                            console.error(`Matrix vector multiplication failed. Line ${node.line}.`);\r\n                            return null;\r\n                        }\r\n                        return new VectorData(result, _l.typeInfo);\r\n                    } else {\r\n                        if (la.length !== ra.length) {\r\n                            console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                            return null;\r\n                        }\r\n                        const result = la.map((x: number, i: number) => x * ra[i]);\r\n                        return new VectorData(result, _l.typeInfo);\r\n                    }\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x * rn);\r\n                    if (_l instanceof MatrixData) {\r\n                        return new MatrixData(result, _l.typeInfo);\r\n                    }\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln * x);\r\n                    if (_r instanceof MatrixData) {\r\n                        return new MatrixData(result, _r.typeInfo);\r\n                    }\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln * rn, t);\r\n            }\r\n            case \"%\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x % ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x % rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln % x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln % rn, t);\r\n            }\r\n            case \"/\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x / ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x / rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln / x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln / rn, t);\r\n            }\r\n            case \"&\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x & ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x & rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln & x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln & rn, t);\r\n            }\r\n            case \"|\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x | ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x | rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln | x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln | rn, t);\r\n            }\r\n            case \"^\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x ^ ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x ^ rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln ^ x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln ^ rn, t);\r\n            }\r\n            case \"<<\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x << ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x << rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln << x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln << rn, t);\r\n            }\r\n            case \">>\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x >> ra[i]);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x >> rn);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln >> x);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                const t = this._maxFormatTypeInfo([_l.typeInfo, _r.typeInfo]);\r\n                return new ScalarData(ln >> rn, t);\r\n            }\r\n            case \">\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x > ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x > rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln > x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln > rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n            case \"<\":\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x < ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x < rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln < x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln < rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            case \"==\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x === ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x == rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln == x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln === rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n            case \"!=\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x !== ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x !== rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln !== x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln !== rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n            case \">=\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x >= ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x >= rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln >= x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln >= rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n            case \"<=\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x <= ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x <= rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln <= x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln <= rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n            case \"&&\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x && ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x && rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln && x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln && rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n            case \"||\": {\r\n                if (isArray(l) && isArray(r)) {\r\n                    const la = l as number[];\r\n                    const ra = r as number[];\r\n                    if (la.length !== ra.length) {\r\n                        console.error(`Vector length mismatch. Line ${node.line}.`);\r\n                        return null;\r\n                    }\r\n                    const result = la.map((x: number, i: number) => x || ra[i] ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(l)) {\r\n                    const la = l as number[];\r\n                    const rn = r as number;\r\n                    const result = la.map((x: number, i: number) => x || rn ? 1 : 0);\r\n                    return new VectorData(result, _l.typeInfo);\r\n                } else if (isArray(r)) {\r\n                    const ln = l as number;\r\n                    const ra = r as number[];\r\n                    const result = ra.map((x: number, i: number) => ln || x ? 1 : 0);\r\n                    return new VectorData(result, _r.typeInfo);\r\n                }\r\n                const ln = l as number;\r\n                const rn = r as number;\r\n                return new ScalarData(ln || rn ? 1 : 0, this.getTypeInfo(\"bool\"));\r\n            }\r\n        }\r\n        console.error(`Unknown operator ${node.operator}. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    _evalCall(node: CallExpr, context: ExecContext): Data | null {\r\n        if (node.cachedReturnValue !== null) {\r\n            return node.cachedReturnValue;\r\n        }\r\n\r\n        const subContext = context.clone();\r\n        subContext.currentFunctionName = node.name;\r\n\r\n        const f = context.getFunction(node.name);\r\n        if (!f) {\r\n            if (node.isBuiltin) {\r\n                return this._callBuiltinFunction(node, subContext);\r\n            }\r\n\r\n            const typeInfo = this.getTypeInfo(node.name);\r\n            if (typeInfo) {\r\n                return this._evalCreate(node, context);\r\n            }\r\n\r\n            console.error(`Unknown function \"${node.name}\". Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        for (let ai = 0; ai < f.node.args.length; ++ai) {\r\n            const arg = f.node.args[ai];\r\n            const value = this.evalExpression(node.args[ai], subContext);\r\n            subContext.createVariable(arg.name, value, arg);\r\n        }\r\n\r\n        return this._execStatements(f.node.body, subContext);\r\n    }\r\n\r\n    _callBuiltinFunction(node: CallExpr | Call, context: ExecContext): Data | null {\r\n        switch (node.name) {\r\n            // Logical Built-in Functions\r\n            case \"all\":\r\n                return this.builtins.All(node, context);\r\n            case \"any\":\r\n                return this.builtins.Any(node, context);\r\n            case \"select\":\r\n                return this.builtins.Select(node, context);\r\n\r\n            // Array Built-in Functions\r\n            case \"arrayLength\":\r\n                return this.builtins.ArrayLength(node, context);\r\n\r\n            // Numeric Built-in Functions\r\n            case \"abs\":\r\n                return this.builtins.Abs(node, context);\r\n            case \"acos\":\r\n                return this.builtins.Acos(node, context);\r\n            case \"acosh\":\r\n                return this.builtins.Acosh(node, context);\r\n            case \"asin\":\r\n                return this.builtins.Asin(node, context);\r\n            case \"asinh\":\r\n                return this.builtins.Asinh(node, context);\r\n            case \"atan\":\r\n                return this.builtins.Atan(node, context);\r\n            case \"atanh\":\r\n                return this.builtins.Atanh(node, context);\r\n            case \"atan2\":\r\n                return this.builtins.Atan2(node, context);\r\n            case \"ceil\":\r\n                return this.builtins.Ceil(node, context);\r\n            case \"clamp\":\r\n                return this.builtins.Clamp(node, context);\r\n            case \"cos\":\r\n                return this.builtins.Cos(node, context);\r\n            case \"cosh\":\r\n                return this.builtins.Cosh(node, context);\r\n            case \"countLeadingZeros\":\r\n                return this.builtins.CountLeadingZeros(node, context);\r\n            case \"countOneBits\":\r\n                return this.builtins.CountOneBits(node, context);\r\n            case \"countTrailingZeros\":\r\n                return this.builtins.CountTrailingZeros(node, context);\r\n            case \"cross\":\r\n                return this.builtins.Cross(node, context);\r\n            case \"degrees\":\r\n                return this.builtins.Degrees(node, context);\r\n            case \"determinant\":\r\n                return this.builtins.Determinant(node, context);\r\n            case \"distance\":\r\n                return this.builtins.Distance(node, context);\r\n            case \"dot\":\r\n                return this.builtins.Dot(node, context);\r\n            case \"dot4U8Packed\":\r\n                return this.builtins.Dot4U8Packed(node, context);\r\n            case \"dot4I8Packed\":\r\n                return this.builtins.Dot4I8Packed(node, context);\r\n            case \"exp\":\r\n                return this.builtins.Exp(node, context);\r\n            case \"exp2\":\r\n                return this.builtins.Exp2(node, context);\r\n            case \"extractBits\":\r\n                return this.builtins.ExtractBits(node, context);\r\n            case \"faceForward\":\r\n                return this.builtins.FaceForward(node, context);\r\n            case \"firstLeadingBit\":\r\n                return this.builtins.FirstLeadingBit(node, context);\r\n            case \"firstTrailingBit\":\r\n                return this.builtins.FirstTrailingBit(node, context);\r\n            case \"floor\":\r\n                return this.builtins.Floor(node, context);\r\n            case \"fma\":\r\n                return this.builtins.Fma(node, context);\r\n            case \"fract\":\r\n                return this.builtins.Fract(node, context);\r\n            case \"frexp\":\r\n                return this.builtins.Frexp(node, context);\r\n            case \"insertBits\":\r\n                return this.builtins.InsertBits(node, context);\r\n            case \"inverseSqrt\":\r\n                return this.builtins.InverseSqrt(node, context);\r\n            case \"ldexp\":\r\n                return this.builtins.Ldexp(node, context);\r\n            case \"length\":\r\n                return this.builtins.Length(node, context);\r\n            case \"log\":\r\n                return this.builtins.Log(node, context);\r\n            case \"log2\":\r\n                return this.builtins.Log2(node, context);\r\n            case \"max\":\r\n                return this.builtins.Max(node, context);\r\n            case \"min\":\r\n                return this.builtins.Min(node, context);\r\n            case \"mix\":\r\n                return this.builtins.Mix(node, context);\r\n            case \"modf\":\r\n                return this.builtins.Modf(node, context);\r\n            case \"normalize\":\r\n                return this.builtins.Normalize(node, context);\r\n            case \"pow\":\r\n                return this.builtins.Pow(node, context);\r\n            case \"quantizeToF16\":\r\n                return this.builtins.QuantizeToF16(node, context);\r\n            case \"radians\":\r\n                return this.builtins.Radians(node, context);\r\n            case \"reflect\":\r\n                return this.builtins.Reflect(node, context);\r\n            case \"refract\":\r\n                return this.builtins.Refract(node, context);\r\n            case \"reverseBits\":\r\n                return this.builtins.ReverseBits(node, context);\r\n            case \"round\":\r\n                return this.builtins.Round(node, context);\r\n            case \"saturate\":\r\n                return this.builtins.Saturate(node, context);\r\n            case \"sign\":\r\n                return this.builtins.Sign(node, context);\r\n            case \"sin\":\r\n                return this.builtins.Sin(node, context);\r\n            case \"sinh\":\r\n                return this.builtins.Sinh(node, context);\r\n            case \"smoothstep\":\r\n                return this.builtins.SmoothStep(node, context);\r\n            case \"sqrt\":\r\n                return this.builtins.Sqrt(node, context);\r\n            case \"step\":\r\n                return this.builtins.Step(node, context);\r\n            case \"tan\":\r\n                return this.builtins.Tan(node, context);\r\n            case \"tanh\":\r\n                return this.builtins.Tanh(node, context);\r\n            case \"transpose\":\r\n                return this.builtins.Transpose(node, context);\r\n            case \"trunc\":\r\n                return this.builtins.Trunc(node, context);\r\n\r\n            // Derivative Built-in Functions\r\n            case \"dpdx\":\r\n                return this.builtins.Dpdx(node, context);\r\n            case \"dpdxCoarse\":\r\n                return this.builtins.DpdxCoarse(node, context);\r\n            case \"dpdxFine\":\r\n                return this.builtins.DpdxFine(node, context);\r\n            case \"dpdy\":\r\n                return this.builtins.Dpdy(node, context);\r\n            case \"dpdyCoarse\":\r\n                return this.builtins.DpdyCoarse(node, context);\r\n            case \"dpdyFine\":\r\n                return this.builtins.DpdyFine(node, context);\r\n            case \"fwidth\":\r\n                return this.builtins.Fwidth(node, context);\r\n            case \"fwidthCoarse\":\r\n                return this.builtins.FwidthCoarse(node, context);\r\n            case \"fwidthFine\":\r\n                return this.builtins.FwidthFine(node, context);\r\n\r\n            // Texture Built-in Functions\r\n            case \"textureDimensions\":\r\n                return this.builtins.TextureDimensions(node, context);\r\n            case \"textureGather\":\r\n                return this.builtins.TextureGather(node, context);\r\n            case \"textureGatherCompare\":\r\n                return this.builtins.TextureGatherCompare(node, context);\r\n            case \"textureLoad\":\r\n                return this.builtins.TextureLoad(node, context);\r\n            case \"textureNumLayers\":\r\n                return this.builtins.TextureNumLayers(node, context);\r\n            case \"textureNumLevels\":\r\n                return this.builtins.TextureNumLevels(node, context);\r\n            case \"textureNumSamples\":\r\n                return this.builtins.TextureNumSamples(node, context);\r\n            case \"textureSample\":\r\n                return this.builtins.TextureSample(node, context);\r\n            case \"textureSampleBias\":\r\n                return this.builtins.TextureSampleBias(node, context);\r\n            case \"textureSampleCompare\":\r\n                return this.builtins.TextureSampleCompare(node, context);\r\n            case \"textureSampleCompareLevel\":\r\n                return this.builtins.TextureSampleCompareLevel(node, context);\r\n            case \"textureSampleGrad\":\r\n                return this.builtins.TextureSampleGrad(node, context);\r\n            case \"textureSampleLevel\":\r\n                return this.builtins.TextureSampleLevel(node, context);\r\n            case \"textureSampleBaseClampToEdge\":\r\n                return this.builtins.TextureSampleBaseClampToEdge(node, context);\r\n            case \"textureStore\":\r\n                return this.builtins.TextureStore(node, context);\r\n\r\n            // Atomic Built-in Functions\r\n            case \"atomicLoad\":\r\n                return this.builtins.AtomicLoad(node, context);\r\n            case \"atomicStore\":\r\n                return this.builtins.AtomicStore(node, context);\r\n            case \"atomicAdd\":\r\n                return this.builtins.AtomicAdd(node, context);\r\n            case \"atomicSub\":\r\n                return this.builtins.AtomicSub(node, context);\r\n            case \"atomicMax\":\r\n                return this.builtins.AtomicMax(node, context);\r\n            case \"atomicMin\":\r\n                return this.builtins.AtomicMin(node, context);\r\n            case \"atomicAnd\":\r\n                return this.builtins.AtomicAnd(node, context);\r\n            case \"atomicOr\":\r\n                return this.builtins.AtomicOr(node, context);\r\n            case \"atomicXor\":\r\n                return this.builtins.AtomicXor(node, context);\r\n            case \"atomicExchange\":\r\n                return this.builtins.AtomicExchange(node, context);\r\n            case \"atomicCompareExchangeWeak\":\r\n                return this.builtins.AtomicCompareExchangeWeak(node, context);\r\n\r\n            // Data Packing Built-in Functions\r\n            case \"pack4x8snorm\":\r\n                return this.builtins.Pack4x8snorm(node, context);\r\n            case \"pack4x8unorm\":\r\n                return this.builtins.Pack4x8unorm(node, context);\r\n            case \"pack4xI8\":\r\n                return this.builtins.Pack4xI8(node, context);\r\n            case \"pack4xU8\":\r\n                return this.builtins.Pack4xU8(node, context);\r\n            case \"pack4x8Clamp\":\r\n                return this.builtins.Pack4x8Clamp(node, context);\r\n            case \"pack4xU8Clamp\":\r\n                return this.builtins.Pack4xU8Clamp(node, context);\r\n            case \"pack2x16snorm\":\r\n                return this.builtins.Pack2x16snorm(node, context);\r\n            case \"pack2x16unorm\":\r\n                return this.builtins.Pack2x16unorm(node, context);\r\n            case \"pack2x16float\":\r\n                return this.builtins.Pack2x16float(node, context);\r\n\r\n            // Data Unpacking Built-in Functions\r\n            case \"unpack4x8snorm\":\r\n                return this.builtins.Unpack4x8snorm(node, context);\r\n            case \"unpack4x8unorm\":\r\n                return this.builtins.Unpack4x8unorm(node, context);\r\n            case \"unpack4xI8\":\r\n                return this.builtins.Unpack4xI8(node, context);\r\n            case \"unpack4xU8\":\r\n                return this.builtins.Unpack4xU8(node, context);\r\n            case \"unpack2x16snorm\":\r\n                return this.builtins.Unpack2x16snorm(node, context);\r\n            case \"unpack2x16unorm\":\r\n                return this.builtins.Unpack2x16unorm(node, context);\r\n            case \"unpack2x16float\":\r\n                return this.builtins.Unpack2x16float(node, context);\r\n\r\n            // Synchronization Built-in Functions\r\n            case \"storageBarrier\":\r\n                return this.builtins.StorageBarrier(node, context);\r\n            case \"textureBarrier\":\r\n                return this.builtins.TextureBarrier(node, context);\r\n            case \"workgroupBarrier\":\r\n                return this.builtins.WorkgroupBarrier(node, context);\r\n            case \"workgroupUniformLoad\":\r\n                return this.builtins.WorkgroupUniformLoad(node, context);\r\n\r\n            // Subgroup Built-in Functions\r\n            case \"subgroupAdd\":\r\n                return this.builtins.SubgroupAdd(node, context);\r\n            case \"subgroupExclusiveAdd\":\r\n                return this.builtins.SubgroupExclusiveAdd(node, context);\r\n            case \"subgroupInclusiveAdd\":\r\n                return this.builtins.SubgroupInclusiveAdd(node, context);\r\n            case \"subgroupAll\":\r\n                return this.builtins.SubgroupAll(node, context);\r\n            case \"subgroupAnd\":\r\n                return this.builtins.SubgroupAnd(node, context);\r\n            case \"subgroupAny\":\r\n                return this.builtins.SubgroupAny(node, context);\r\n            case \"subgroupBallot\":\r\n                return this.builtins.SubgroupBallot(node, context);\r\n            case \"subgroupBroadcast\":\r\n                return this.builtins.SubgroupBroadcast(node, context);\r\n            case \"subgroupBroadcastFirst\":\r\n                return this.builtins.SubgroupBroadcastFirst(node, context);\r\n            case \"subgroupElect\":\r\n                return this.builtins.SubgroupElect(node, context);\r\n            case \"subgroupMax\":\r\n                return this.builtins.SubgroupMax(node, context);\r\n            case \"subgroupMin\":\r\n                return this.builtins.SubgroupMin(node, context);\r\n            case \"subgroupMul\":\r\n                return this.builtins.SubgroupMul(node, context);\r\n            case \"subgroupExclusiveMul\":\r\n                return this.builtins.SubgroupExclusiveMul(node, context);\r\n            case \"subgroupInclusiveMul\":\r\n                return this.builtins.SubgroupInclusiveMul(node, context);\r\n            case \"subgroupOr\":\r\n                return this.builtins.SubgroupOr(node, context);\r\n            case \"subgroupShuffle\":\r\n                return this.builtins.SubgroupShuffle(node, context);\r\n            case \"subgroupShuffleDown\":\r\n                return this.builtins.SubgroupShuffleDown(node, context);\r\n            case \"subgroupShuffleUp\":\r\n                return this.builtins.SubgroupShuffleUp(node, context);\r\n            case \"subgroupShuffleXor\":\r\n                return this.builtins.SubgroupShuffleXor(node, context);\r\n            case \"subgroupXor\":\r\n                return this.builtins.SubgroupXor(node, context);\r\n\r\n            // Quad Operations\r\n            case \"quadBroadcast\":\r\n                return this.builtins.QuadBroadcast(node, context);\r\n            case \"quadSwapDiagonal\":\r\n                return this.builtins.QuadSwapDiagonal(node, context);\r\n            case \"quadSwapX\":\r\n                return this.builtins.QuadSwapX(node, context);\r\n            case \"quadSwapY\":\r\n                return this.builtins.QuadSwapY(node, context);\r\n        }\r\n\r\n        const f = context.getFunction(node.name);\r\n        if (f) {\r\n            const subContext = context.clone();\r\n            for (let ai = 0; ai < f.node.args.length; ++ai) {\r\n                const arg = f.node.args[ai];\r\n                const value = this.evalExpression(node.args[ai], subContext);\r\n                subContext.setVariable(arg.name, value, arg);\r\n            }\r\n            return this._execStatements(f.node.body, subContext);\r\n        }\r\n\r\n        //console.error(`Function ${node.name} not found. Line ${node.line}`);\r\n        return null;\r\n    }\r\n\r\n    _callConstructorValue(node: CreateExpr, context: ExecContext): Data | null {\r\n        if (!node.args || node.args.length === 0) {\r\n            return new ScalarData(0, this.getTypeInfo(node.type));\r\n        }\r\n        const v = this.evalExpression(node.args[0], context);\r\n        v.typeInfo = this.getTypeInfo(node.type);\r\n        return v.getSubData(this, node.postfix, context).clone();\r\n    }\r\n\r\n    _callConstructorVec(node: CreateExpr | LiteralExpr, context: ExecContext): Data | null {\r\n        const typeInfo = this.getTypeInfo(node.type);\r\n        const typeName = node.type.getTypeName();\r\n\r\n        const count = VectorTypeSize[typeName];\r\n        if (count === undefined) {\r\n            console.error(`Invalid vec constructor ${typeName}. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const values: number[] = [];\r\n        if (node instanceof LiteralExpr) {\r\n            if (node.isVector) {\r\n                const a = node.vectorValue;\r\n                for (const v of a) {\r\n                    values.push(v);\r\n                }\r\n            } else {\r\n                values.push(node.scalarValue);\r\n            }\r\n        } else {\r\n            if (node.args) {\r\n                for (const arg of node.args) {\r\n                    const argValue = this.evalExpression(arg, context) ;\r\n                    if (argValue instanceof VectorData) {\r\n                        const vd = argValue.data;\r\n                        for (let i = 0; i < vd.length; ++i) {\r\n                            let e = vd[i];\r\n                            values.push(e);\r\n                        }\r\n                    } else if (argValue instanceof ScalarData) {\r\n                        let v = argValue.value;\r\n                        values.push(v);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (node.type instanceof TemplateType && node.type.format === null) {\r\n            node.type.format = TemplateType.f32; // TODO: get the format from the type of the arg.\r\n        }\r\n\r\n        if (values.length === 0) {\r\n            const values = new Array(count).fill(0);\r\n            return new VectorData(values, typeInfo).getSubData(this, node.postfix, context);\r\n        }\r\n\r\n        if (values.length === 1) {\r\n            while (values.length < count) {\r\n                values.push(values[0]);\r\n            }\r\n        }\r\n\r\n        if (values.length < count) {\r\n            console.error(`Invalid vec constructor. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const data = new VectorData(values.length > count ? values.slice(0, count) : values, typeInfo);\r\n        return data.getSubData(this, node.postfix, context);\r\n    }\r\n\r\n    _callConstructorMatrix(node: CreateExpr | LiteralExpr, context: ExecContext): Data | null {\r\n        const typeInfo = this.getTypeInfo(node.type);\r\n        const typeName = node.type.getTypeName();\r\n\r\n        const count = MatrixTypeSize[typeName];\r\n        if (count === undefined) {\r\n            console.error(`Invalid matrix constructor ${typeName}. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        const values = [];\r\n        if (node instanceof LiteralExpr) {\r\n            if (node.isVector) {\r\n                const a = node.vectorValue;\r\n                for (const v of a) {\r\n                    values.push(v);\r\n                }\r\n            } else {\r\n                values.push(node.scalarValue);\r\n            }\r\n        } else {\r\n            if (node.args) {\r\n                for (const arg of node.args) {\r\n                    const argValue = this.evalExpression(arg, context) ;\r\n                    if (argValue instanceof VectorData) {\r\n                        values.push(...argValue.data);\r\n                    } else if (argValue instanceof ScalarData) {\r\n                        values.push(argValue.value);\r\n                    } else if (argValue instanceof MatrixData) {\r\n                        values.push(...argValue.data);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if ((typeInfo instanceof TemplateInfo) && typeInfo.format === null) {\r\n            typeInfo.format = this.getTypeInfo(\"f32\");\r\n        }\r\n\r\n        if (values.length === 0) {\r\n            const values = new Array(count[2]).fill(0);\r\n            return new MatrixData(values, typeInfo).getSubData(this, node.postfix, context);\r\n        }\r\n\r\n        if (values.length !== count[2]) {\r\n            console.error(`Invalid matrix constructor. Line ${node.line}`);\r\n            return null;\r\n        }\r\n\r\n        return new MatrixData(values, typeInfo).getSubData(this, node.postfix, context);\r\n    }\r\n}\r\n", "import { Const, Alias, Struct } from \"../wgsl_ast.js\";\r\n\r\nexport class ParseContext {\r\n  constants: Map<string, Const> = new Map();\r\n  aliases: Map<string, Alias> = new Map();\r\n  structs: Map<string, Struct> = new Map();\r\n}\r\n", "import { WgslScanner, Token, TokenType, TokenTypes } from \"./wgsl_scanner.js\";\r\nimport * as AST from \"./wgsl_ast.js\";\r\nimport { WgslExec } from \"./wgsl_exec.js\";\r\nimport { TemplateInfo } from \"./reflect/info.js\";\r\nimport { ScalarData } from \"./wgsl_ast.js\";\r\nimport { ParseContext } from \"./ast/parse_context.js\";\r\n\r\n/// Parse a sequence of tokens from the WgslScanner into an Abstract Syntax Tree (AST).\r\nexport class WgslParser {\r\n  _tokens: Token[] = [];\r\n  _current: number = 0;\r\n  _currentLine: number = 1;\r\n  _deferArrayCountEval: Object[] = [];\r\n  _currentLoop: AST.Statement[] = [];\r\n  _context = new ParseContext();\r\n  _exec = new WgslExec();\r\n  _forwardTypeCount: number = 0;;\r\n\r\n  parse(tokensOrCode: Token[] | string): AST.Statement[] {\r\n    this._initialize(tokensOrCode);\r\n\r\n    this._deferArrayCountEval.length = 0;\r\n\r\n    const statements: AST.Statement[] = [];\r\n    while (!this._isAtEnd()) {\r\n      const statement = this._global_decl_or_directive();\r\n      if (!statement) {\r\n        break;\r\n      }\r\n      statements.push(statement);\r\n    }\r\n\r\n    // Since constants can be declared after they are used, and\r\n    // constants can be used to size arrays, defer calculating the\r\n    // size until after the shader has finished parsing.\r\n    if (this._deferArrayCountEval.length > 0) {\r\n      for (const arrayDecl of this._deferArrayCountEval) {\r\n        const arrayType = arrayDecl[\"arrayType\"];\r\n        const countNode = arrayDecl[\"countNode\"];\r\n\r\n        if (countNode instanceof AST.VariableExpr) {\r\n          const variable = countNode as AST.VariableExpr;\r\n          const name = variable.name;\r\n          const constant = this._context.constants.get(name);\r\n          if (constant) {\r\n            try {\r\n              const count = constant.constEvaluate(this._exec);\r\n              arrayType.count = count;\r\n            } catch (e) {\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this._deferArrayCountEval.length = 0;\r\n    }\r\n\r\n    if (this._forwardTypeCount > 0) {\r\n      for (const statement of statements) {\r\n        statement.search((node) => {\r\n          if (node instanceof AST.Member) {\r\n            node.type = this._forwardType(node.type);\r\n          } else if (node instanceof AST.PointerType) {\r\n            node.type = this._forwardType(node.type);\r\n          } else if (node instanceof AST.ArrayType) {\r\n            node.format = this._forwardType(node.format);\r\n          } else if (node instanceof AST.Var || node instanceof AST.Let || node instanceof AST.Const) {\r\n            node.type = this._forwardType(node.type);\r\n          } else if (node instanceof AST.Function) {\r\n            node.returnType = this._forwardType(node.returnType);\r\n          } else if (node instanceof AST.Argument) {\r\n            node.type = this._forwardType(node.type);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    return statements;\r\n  }\r\n\r\n  _forwardType(t: AST.Type | null): AST.Type | null {\r\n    if (t instanceof AST.ForwardType) {\r\n      const ft = this._getType(t.name);\r\n      if (ft) {\r\n        return ft;\r\n      }\r\n    } else if (t instanceof AST.PointerType) {\r\n      t.type = this._forwardType(t.type);\r\n    } else if (t instanceof AST.ArrayType) {\r\n      t.format = this._forwardType(t.format);\r\n    }\r\n    return t;\r\n  }\r\n\r\n  _initialize(tokensOrCode: Token[] | string) {\r\n    if (tokensOrCode) {\r\n      if (typeof tokensOrCode == \"string\") {\r\n        const scanner = new WgslScanner(tokensOrCode);\r\n        this._tokens = scanner.scanTokens();\r\n      } else {\r\n        this._tokens = tokensOrCode;\r\n      }\r\n    } else {\r\n      this._tokens = [];\r\n    }\r\n    this._current = 0;\r\n  }\r\n\r\n  _updateNode<T extends AST.Node>(n: T, l?: number): T {\r\n    n.line = l ?? this._currentLine;\r\n    return n;\r\n  }\r\n\r\n  _error(token: Token, message: string | null): Object {\r\n    return {\r\n      token,\r\n      message,\r\n      toString: function () {\r\n        return `${message}`;\r\n      },\r\n    };\r\n  }\r\n\r\n  _isAtEnd(): boolean {\r\n    return (\r\n      this._current >= this._tokens.length ||\r\n      this._peek().type == TokenTypes.eof\r\n    );\r\n  }\r\n\r\n  _match(types: TokenType | TokenType[]): boolean {\r\n    if (types instanceof TokenType) {\r\n      if (this._check(types)) {\r\n        this._advance();\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    for (let i = 0, l = types.length; i < l; ++i) {\r\n      const type = types[i];\r\n      if (this._check(type)) {\r\n        this._advance();\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  _consume(types: TokenType | TokenType[], message: string | null): Token {\r\n    if (this._check(types)) {\r\n      return this._advance();\r\n    }\r\n    throw this._error(this._peek(), `${message}. Line:${this._currentLine}`);\r\n  }\r\n\r\n  _check(types: TokenType | TokenType[]): boolean {\r\n    if (this._isAtEnd()) {\r\n      return false;\r\n    }\r\n    const tk = this._peek();\r\n    if (types instanceof Array) {\r\n      const t = tk.type;\r\n      let hasNameType = false;\r\n      for (const type of types) {\r\n        if (t === type) {\r\n          return true;\r\n        }\r\n        if (type === TokenTypes.tokens.name) {\r\n          hasNameType =  true;\r\n        }\r\n      }\r\n      if (hasNameType) {\r\n        // ident can include any of the other keywords, so special case it.\r\n        const match = (TokenTypes.tokens.name.rule as RegExp).exec(tk.lexeme);\r\n        if (match && match.index == 0 && match[0] == tk.lexeme) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n\r\n    if (tk.type === types) {\r\n      return true;\r\n    }\r\n\r\n    // ident can include any of the other keywords, so special case it.\r\n    if (types === TokenTypes.tokens.name) {\r\n      const match = (TokenTypes.tokens.name.rule as RegExp).exec(tk.lexeme);\r\n      return match && match.index == 0 && match[0] == tk.lexeme;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  _advance(): Token {\r\n    this._currentLine = this._peek()?.line ?? -1;\r\n    if (!this._isAtEnd()) {\r\n      this._current++;\r\n    }\r\n    return this._previous();\r\n  }\r\n\r\n  _peek(): Token {\r\n    return this._tokens[this._current];\r\n  }\r\n\r\n  _previous(): Token {\r\n    return this._tokens[this._current - 1];\r\n  }\r\n\r\n  _global_decl_or_directive(): AST.Statement | null {\r\n    // semicolon\r\n    // global_variable_decl semicolon\r\n    // global_constant_decl semicolon\r\n    // type_alias semicolon\r\n    // struct_decl\r\n    // function_decl\r\n    // enable_directive\r\n\r\n    // Ignore any stand-alone semicolons\r\n    while (this._match(TokenTypes.tokens.semicolon) && !this._isAtEnd());\r\n\r\n    if (this._match(TokenTypes.keywords.alias)) {\r\n      const type = this._type_alias();\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'\");\r\n      this._exec.reflection.updateAST([type]);\r\n      return type;\r\n    }\r\n\r\n    if (this._match(TokenTypes.keywords.diagnostic)) {\r\n      const directive = this._diagnostic();\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'\");\r\n      this._exec.reflection.updateAST([directive]);\r\n      return directive;\r\n    }\r\n\r\n    if (this._match(TokenTypes.keywords.requires)) {\r\n      const requires = this._requires_directive();\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'\");\r\n      this._exec.reflection.updateAST([requires]);\r\n      return requires;\r\n    }\r\n\r\n    if (this._match(TokenTypes.keywords.enable)) {\r\n      const enable = this._enable_directive();\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'\");\r\n      this._exec.reflection.updateAST([enable]);\r\n      return enable;\r\n    }\r\n\r\n    // The following statements have an optional attribute*\r\n    const attrs = this._attribute();\r\n\r\n    if (this._check(TokenTypes.keywords.var)) {\r\n      const _var = this._global_variable_decl();\r\n      if (_var != null) {\r\n        _var.attributes = attrs;\r\n      }\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'.\");\r\n      this._exec.reflection.updateAST([_var]);\r\n      return _var;\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.override)) {\r\n      const _override = this._override_variable_decl();\r\n      if (_override != null) {\r\n        _override.attributes = attrs;\r\n      }\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'.\");\r\n      this._exec.reflection.updateAST([_override]);\r\n      return _override;\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.let)) {\r\n      const _let = this._global_let_decl();\r\n      if (_let != null) {\r\n        _let.attributes = attrs;\r\n      }\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'.\");\r\n      this._exec.reflection.updateAST([_let]);\r\n      return _let;\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.const)) {\r\n      const _const = this._global_const_decl();\r\n      if (_const != null) {\r\n        _const.attributes = attrs;\r\n      }\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'.\");\r\n      this._exec.reflection.updateAST([_const]);\r\n      return _const;\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.struct)) {\r\n      const _struct = this._struct_decl();\r\n      if (_struct != null) {\r\n        _struct.attributes = attrs;\r\n      }\r\n      this._exec.reflection.updateAST([_struct]);\r\n      return _struct;\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.fn)) {\r\n      const _fn = this._function_decl();\r\n      if (_fn != null) {\r\n        _fn.attributes = attrs;\r\n      }\r\n      this._exec.reflection.updateAST([_fn]);\r\n      return _fn;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _function_decl(): AST.Function | null {\r\n    // attribute* function_header compound_statement\r\n    // function_header: fn ident paren_left param_list? paren_right (arrow attribute* type_decl)?\r\n    if (!this._match(TokenTypes.keywords.fn)) {\r\n      return null;\r\n    }\r\n\r\n    const startLine = this._currentLine;\r\n\r\n    const name = this._consume(\r\n      TokenTypes.tokens.ident,\r\n      \"Expected function name.\"\r\n    ).toString();\r\n\r\n    this._consume(\r\n      TokenTypes.tokens.paren_left,\r\n      \"Expected '(' for function arguments.\"\r\n    );\r\n\r\n    const args: AST.Argument[] = [];\r\n    if (!this._check(TokenTypes.tokens.paren_right)) {\r\n      do {\r\n        if (this._check(TokenTypes.tokens.paren_right)) {\r\n          break;\r\n        }\r\n        const argAttrs = this._attribute();\r\n\r\n        const name = this._consume(\r\n          TokenTypes.tokens.name,\r\n          \"Expected argument name.\"\r\n        ).toString();\r\n\r\n        this._consume(\r\n          TokenTypes.tokens.colon,\r\n          \"Expected ':' for argument type.\"\r\n        );\r\n\r\n        const typeAttrs = this._attribute();\r\n        const type = this._type_decl();\r\n        if (type != null) {\r\n          type.attributes = typeAttrs;\r\n\r\n          args.push(this._updateNode(new AST.Argument(name, type, argAttrs)));\r\n        }\r\n      } while (this._match(TokenTypes.tokens.comma));\r\n    }\r\n\r\n    this._consume(\r\n      TokenTypes.tokens.paren_right,\r\n      \"Expected ')' after function arguments.\"\r\n    );\r\n\r\n    let _return: AST.Type | null = null;\r\n    if (this._match(TokenTypes.tokens.arrow)) {\r\n      const attrs = this._attribute();\r\n      _return = this._type_decl();\r\n      if (_return != null) {\r\n        _return.attributes = attrs;\r\n      }\r\n    }\r\n\r\n    const body = this._compound_statement();\r\n\r\n    const endLine = this._currentLine;\r\n\r\n    return this._updateNode(new AST.Function(name, args, _return, body, startLine, endLine), startLine);\r\n  }\r\n\r\n  _compound_statement(): AST.Statement[] {\r\n    // brace_left statement* brace_right\r\n    const statements: AST.Statement[] = [];\r\n\r\n    this._consume(TokenTypes.tokens.brace_left, \"Expected '{' for block.\");\r\n    while (!this._check(TokenTypes.tokens.brace_right)) {\r\n      const statement = this._statement();\r\n      if (statement !== null) {\r\n        statements.push(statement as AST.Statement);\r\n      }\r\n    }\r\n    this._consume(TokenTypes.tokens.brace_right, \"Expected '}' for block.\");\r\n\r\n    return statements;\r\n  }\r\n\r\n  _statement(): AST.Statement | AST.Statement[] | null {\r\n    // semicolon\r\n    // return_statement semicolon\r\n    // if_statement\r\n    // switch_statement\r\n    // loop_statement\r\n    // for_statement\r\n    // func_call_statement semicolon\r\n    // variable_statement semicolon\r\n    // break_statement semicolon\r\n    // continue_statement semicolon\r\n    // continuing_statement compound_statement\r\n    // discard semicolon\r\n    // assignment_statement semicolon\r\n    // compound_statement\r\n    // increment_statement semicolon\r\n    // decrement_statement semicolon\r\n    // static_assert_statement semicolon\r\n\r\n    // Ignore any stand-alone semicolons\r\n    while (this._match(TokenTypes.tokens.semicolon) && !this._isAtEnd());\r\n\r\n    let attributes = null;\r\n    if (this._check(TokenTypes.tokens.attr)) {\r\n      attributes = this._attribute();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.if)) {\r\n      return this._if_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.switch)) {\r\n      return this._switch_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.loop)) {\r\n      return this._loop_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.for)) {\r\n      return this._for_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.while)) {\r\n      return this._while_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.continuing)) {\r\n      return this._continuing_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.keywords.static_assert)) {\r\n      return this._static_assert_statement();\r\n    }\r\n\r\n    if (this._check(TokenTypes.tokens.brace_left)) {\r\n      return this._compound_statement();\r\n    }\r\n\r\n    let result: AST.Statement | null = null;\r\n    if (this._check(TokenTypes.keywords.return)) {\r\n      result = this._return_statement();\r\n    } else if (this._check([TokenTypes.keywords.var, TokenTypes.keywords.let, TokenTypes.keywords.const])) {\r\n      result = this._variable_statement();\r\n    } else if (this._match(TokenTypes.keywords.discard)) {\r\n      result = this._updateNode(new AST.Discard());\r\n    } else if (this._match(TokenTypes.keywords.break)) {\r\n      const breakStmt = this._updateNode(new AST.Break());\r\n      if (this._currentLoop.length > 0) {\r\n        const loop = this._currentLoop[this._currentLoop.length - 1];\r\n        breakStmt.loopId = loop.id;\r\n      } else {\r\n        // This break statement is not inside a loop.\r\n        //throw this._error(this._peek(), `Break statement must be inside a loop. Line: ${breakStmt.line}`);\r\n      }\r\n      result = breakStmt;\r\n      if (this._check(TokenTypes.keywords.if)) {\r\n        // break-if\r\n        this._advance();\r\n        breakStmt.condition = this._optional_paren_expression();\r\n      }\r\n    } else if (this._match(TokenTypes.keywords.continue)) {\r\n      const continueStmt = this._updateNode(new AST.Continue());\r\n      if (this._currentLoop.length > 0) {\r\n        const loop = this._currentLoop[this._currentLoop.length - 1];\r\n        continueStmt.loopId = loop.id;\r\n      } else {\r\n        // This continue statement is not inside a loop.\r\n        throw this._error(this._peek(), `Continue statement must be inside a loop. Line: ${continueStmt.line}`);\r\n      }\r\n      result = continueStmt;\r\n    } else {\r\n      result =\r\n        this._increment_decrement_statement() ||\r\n        this._func_call_statement() ||\r\n        this._assignment_statement();\r\n    }\r\n\r\n    if (result != null) {\r\n      this._consume(\r\n        TokenTypes.tokens.semicolon,\r\n        \"Expected ';' after statement.\"\r\n      );\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  _static_assert_statement(): AST.StaticAssert | null {\r\n    if (!this._match(TokenTypes.keywords.static_assert)) {\r\n      return null;\r\n    }\r\n    const line = this._currentLine;\r\n    const expression = this._optional_paren_expression();\r\n    return this._updateNode(new AST.StaticAssert(expression), line);\r\n  }\r\n\r\n  _while_statement(): AST.While | null {\r\n    if (!this._match(TokenTypes.keywords.while)) {\r\n      return null;\r\n    }\r\n\r\n    const whileLoop = this._updateNode(new AST.While(null, null));\r\n    this._currentLoop.push(whileLoop);\r\n\r\n    whileLoop.condition = this._optional_paren_expression();\r\n\r\n    let attributes = null;\r\n    if (this._check(TokenTypes.tokens.attr)) {\r\n      attributes = this._attribute();\r\n    }\r\n\r\n    whileLoop.body = this._compound_statement();\r\n\r\n    this._currentLoop.pop();\r\n\r\n    return whileLoop;\r\n  }\r\n\r\n  _continuing_statement(): AST.Continuing | null {\r\n    const loopId = this._currentLoop.length > 0 ? this._currentLoop[this._currentLoop.length - 1].id : -1;\r\n    if (!this._match(TokenTypes.keywords.continuing)) {\r\n      return null;\r\n    }\r\n    const line = this._currentLine;\r\n    const block = this._compound_statement();\r\n    return this._updateNode(new AST.Continuing(block, loopId), line);\r\n  }\r\n\r\n  _for_statement(): AST.For | null {\r\n    // for paren_left for_header paren_right compound_statement\r\n    if (!this._match(TokenTypes.keywords.for)) {\r\n      return null;\r\n    }\r\n\r\n    this._consume(TokenTypes.tokens.paren_left, \"Expected '('.\");\r\n\r\n    const forLoop = this._updateNode(new AST.For(null, null, null, null));\r\n\r\n    this._currentLoop.push(forLoop);\r\n\r\n    // for_header: (variable_statement assignment_statement func_call_statement)? semicolon short_circuit_or_expression? semicolon (assignment_statement func_call_statement)?\r\n    forLoop.init = !this._check(TokenTypes.tokens.semicolon)\r\n      ? this._for_init()\r\n      : null;\r\n    this._consume(TokenTypes.tokens.semicolon, \"Expected ';'.\");\r\n    forLoop.condition = !this._check(TokenTypes.tokens.semicolon)\r\n      ? this._short_circuit_or_expression()\r\n      : null;\r\n    this._consume(TokenTypes.tokens.semicolon, \"Expected ';'.\");\r\n    forLoop.increment = !this._check(TokenTypes.tokens.paren_right)\r\n      ? this._for_increment()\r\n      : null;\r\n\r\n    this._consume(TokenTypes.tokens.paren_right, \"Expected ')'.\");\r\n\r\n    let attributes = null;\r\n    if (this._check(TokenTypes.tokens.attr)) {\r\n      attributes = this._attribute();\r\n    }\r\n\r\n    forLoop.body = this._compound_statement();\r\n\r\n    this._currentLoop.pop();\r\n\r\n    return forLoop;\r\n  }\r\n\r\n  _for_init(): AST.Statement | null {\r\n    // (variable_statement assignment_statement func_call_statement)?\r\n    return (\r\n      this._variable_statement() ||\r\n      this._func_call_statement() ||\r\n      this._assignment_statement()\r\n    );\r\n  }\r\n\r\n  _for_increment(): AST.Statement | null {\r\n    // (assignment_statement func_call_statement increment_statement)?\r\n    return (\r\n      this._func_call_statement() ||\r\n      this._increment_decrement_statement() ||\r\n      this._assignment_statement()\r\n    );\r\n  }\r\n\r\n  _variable_statement(): AST.Var | AST.Let | AST.Const | null {\r\n    // variable_decl\r\n    // variable_decl equal short_circuit_or_expression\r\n    // let (ident variable_ident_decl) equal short_circuit_or_expression\r\n    // const (ident variable_ident_decl) equal short_circuit_or_expression\r\n    if (this._check(TokenTypes.keywords.var)) {\r\n      const _var = this._variable_decl();\r\n      if (_var === null) {\r\n        throw this._error(this._peek(), \"Variable declaration expected.\");\r\n      }\r\n      let value: AST.Expression | null = null;\r\n      if (this._match(TokenTypes.tokens.equal)) {\r\n        value = this._short_circuit_or_expression();\r\n      }\r\n\r\n      return this._updateNode(new AST.Var(\r\n        _var.name,\r\n        _var.type,\r\n        _var.storage,\r\n        _var.access,\r\n        value\r\n      ), _var.line);\r\n    }\r\n\r\n    if (this._match(TokenTypes.keywords.let)) {\r\n      const line = this._currentLine;\r\n      const name = this._consume(\r\n        TokenTypes.tokens.name,\r\n        \"Expected name for let.\"\r\n      ).toString();\r\n      let type: AST.Type | null = null;\r\n      if (this._match(TokenTypes.tokens.colon)) {\r\n        const typeAttrs = this._attribute();\r\n        type = this._type_decl();\r\n        if (type != null) {\r\n          type.attributes = typeAttrs;\r\n        }\r\n      }\r\n      this._consume(TokenTypes.tokens.equal, \"Expected '=' for let.\");\r\n      const value = this._short_circuit_or_expression();\r\n      return this._updateNode(new AST.Let(name, type, null, null, value), line);\r\n    }\r\n\r\n    if (this._match(TokenTypes.keywords.const)) {\r\n      const line = this._currentLine;\r\n      const name = this._consume(\r\n        TokenTypes.tokens.name,\r\n        \"Expected name for const.\"\r\n      ).toString();\r\n      let type: AST.Type | null = null;\r\n      if (this._match(TokenTypes.tokens.colon)) {\r\n        const typeAttrs = this._attribute();\r\n        type = this._type_decl();\r\n        if (type != null) {\r\n          type.attributes = typeAttrs;\r\n        }\r\n      }\r\n      this._consume(TokenTypes.tokens.equal, \"Expected '=' for const.\");\r\n      const value = this._short_circuit_or_expression();\r\n      if (type === null && value instanceof AST.LiteralExpr) {\r\n        type = value.type;\r\n      }\r\n      return this._updateNode(new AST.Const(name, type, null, null, value), line);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _increment_decrement_statement(): AST.Statement | null {\r\n    const savedPos = this._current;\r\n\r\n    const _var = this._unary_expression();\r\n    if (_var == null) {\r\n      return null;\r\n    }\r\n\r\n    if (!this._check(TokenTypes.increment_operators)) {\r\n      this._current = savedPos;\r\n      return null;\r\n    }\r\n\r\n    const token = this._consume(\r\n      TokenTypes.increment_operators,\r\n      \"Expected increment operator\"\r\n    );\r\n\r\n    return this._updateNode(new AST.Increment(\r\n      token.type === TokenTypes.tokens.plus_plus\r\n        ? AST.IncrementOperator.increment\r\n        : AST.IncrementOperator.decrement,\r\n      _var));\r\n  }\r\n\r\n  _assignment_statement(): AST.Assign | null {\r\n    // (unary_expression underscore) equal short_circuit_or_expression\r\n    let _var: AST.Expression | null = null;\r\n    const line = this._currentLine;\r\n\r\n    if (this._check(TokenTypes.tokens.brace_right)) {\r\n      return null;\r\n    }\r\n\r\n    let isUnderscore = this._match(TokenTypes.tokens.underscore);\r\n    if (!isUnderscore) {\r\n      _var = this._unary_expression();\r\n    }\r\n\r\n    if (!isUnderscore && _var == null) {\r\n      return null;\r\n    }\r\n\r\n    const type = this._consume(\r\n      TokenTypes.assignment_operators,\r\n      \"Expected assignment operator.\");\r\n\r\n    const value = this._short_circuit_or_expression();\r\n\r\n    return this._updateNode(new AST.Assign(\r\n      AST.AssignOperator.parse(type.lexeme),\r\n      _var as AST.Expression,\r\n      value), line);\r\n  }\r\n\r\n  _func_call_statement(): AST.Call | null {\r\n    // ident argument_expression_list\r\n    if (!this._check(TokenTypes.tokens.ident)) {\r\n      return null;\r\n    }\r\n\r\n    const line = this._currentLine;\r\n\r\n    const savedPos = this._current;\r\n    const name = this._consume(\r\n      TokenTypes.tokens.ident,\r\n      \"Expected function name.\"\r\n    );\r\n    const args = this._argument_expression_list();\r\n\r\n    if (args === null) {\r\n      this._current = savedPos;\r\n      return null;\r\n    }\r\n\r\n    return this._updateNode(new AST.Call(name.lexeme, args), line);\r\n  }\r\n\r\n  _loop_statement(): AST.Loop | null {\r\n    // loop brace_left statement* continuing_statement? brace_right\r\n    if (!this._match(TokenTypes.keywords.loop)) {\r\n      return null;\r\n    }\r\n\r\n    let attributes = null;\r\n    if (this._check(TokenTypes.tokens.attr)) {\r\n      attributes = this._attribute();\r\n    }\r\n\r\n    this._consume(TokenTypes.tokens.brace_left, \"Expected '{' for loop.\");\r\n\r\n    const loop = this._updateNode(new AST.Loop([], null));\r\n    this._currentLoop.push(loop);\r\n\r\n    // statement*\r\n    let statement = this._statement();\r\n    while (statement !== null) {\r\n      if (Array.isArray(statement)) {\r\n        for (let s of statement) {\r\n          loop.body.push(s);\r\n        }\r\n      } else {\r\n        loop.body.push(statement);\r\n      }\r\n      // Keep continuing in the loop body statements so it can be\r\n      // executed in the stackframe of the body statements.\r\n      if (statement instanceof AST.Continuing) {\r\n        loop.continuing = statement;\r\n        // Continuing should be the last statement in the loop.\r\n        break;\r\n      }\r\n      statement = this._statement();\r\n    }\r\n\r\n    this._currentLoop.pop();\r\n\r\n    this._consume(TokenTypes.tokens.brace_right, \"Expected '}' for loop.\");\r\n\r\n    return loop;\r\n  }\r\n\r\n  _switch_statement(): AST.Switch | null {\r\n    // switch optional_paren_expression brace_left switch_body+ brace_right\r\n    if (!this._match(TokenTypes.keywords.switch)) {\r\n      return null;\r\n    }\r\n\r\n    const switchStmt = this._updateNode(new AST.Switch(null, []));\r\n\r\n    this._currentLoop.push(switchStmt);\r\n\r\n    switchStmt.condition = this._optional_paren_expression();\r\n\r\n    let attributes = null;\r\n    if (this._check(TokenTypes.tokens.attr)) {\r\n      attributes = this._attribute();\r\n    }\r\n\r\n    this._consume(TokenTypes.tokens.brace_left, \"Expected '{' for switch.\");\r\n    switchStmt.cases = this._switch_body();\r\n    if (switchStmt.cases == null || switchStmt.cases.length == 0) {\r\n      throw this._error(this._previous(), \"Expected 'case' or 'default'.\");\r\n    }\r\n    this._consume(TokenTypes.tokens.brace_right, \"Expected '}' for switch.\");\r\n\r\n    this._currentLoop.pop();\r\n\r\n    return switchStmt;\r\n  }\r\n\r\n  _switch_body(): AST.SwitchCase[] {\r\n    // case case_selectors optional_colon brace_left case_body? brace_right\r\n    // default optional_colon brace_left case_body? brace_right\r\n    const cases: AST.SwitchCase[] = [];\r\n\r\n    let hasDefault = false;\r\n    while (this._check([TokenTypes.keywords.default, TokenTypes.keywords.case])) {\r\n      if (this._match(TokenTypes.keywords.case)) {\r\n        const selectors = this._case_selectors();\r\n        for (const selector of selectors) {\r\n          if (selector instanceof AST.DefaultSelector) {\r\n            if (hasDefault) {\r\n              throw this._error(this._previous(), \"Multiple default cases in switch statement.\");\r\n            }\r\n            hasDefault = true;\r\n            break;\r\n          }\r\n        }\r\n\r\n        this._match(TokenTypes.tokens.colon); // colon is optional\r\n\r\n        let attributes = null;\r\n        if (this._check(TokenTypes.tokens.attr)) {\r\n          attributes = this._attribute();\r\n        }\r\n\r\n        this._consume(TokenTypes.tokens.brace_left, \"Exected '{' for switch case.\");\r\n\r\n        const body = this._case_body();\r\n\r\n        this._consume(TokenTypes.tokens.brace_right, \"Exected '}' for switch case.\");\r\n\r\n        cases.push(this._updateNode(new AST.Case(selectors, body)));\r\n      }\r\n\r\n      if (this._match(TokenTypes.keywords.default)) {\r\n        if (hasDefault) {\r\n          throw this._error(this._previous(), \"Multiple default cases in switch statement.\");\r\n        }\r\n        this._match(TokenTypes.tokens.colon); // colon is optional\r\n\r\n        let attributes = null;\r\n        if (this._check(TokenTypes.tokens.attr)) {\r\n          attributes = this._attribute();\r\n        }\r\n\r\n        this._consume(TokenTypes.tokens.brace_left, \"Exected '{' for switch default.\");\r\n\r\n        const body = this._case_body();\r\n\r\n        this._consume(TokenTypes.tokens.brace_right, \"Exected '}' for switch default.\");\r\n\r\n        cases.push(this._updateNode(new AST.Default(body)));\r\n      }\r\n    }\r\n\r\n    return cases;\r\n  }\r\n\r\n  _case_selectors(): AST.Expression[] {\r\n    // case_selector (comma case_selector)* comma?\r\n    // case_selector: expression | default\r\n    const selectors = [];\r\n\r\n    if (this._match(TokenTypes.keywords.default)) {\r\n      selectors.push(this._updateNode(new AST.DefaultSelector()));\r\n    } else {\r\n      selectors.push(this._shift_expression());\r\n    }\r\n\r\n    while (this._match(TokenTypes.tokens.comma)) {\r\n      if (this._match(TokenTypes.keywords.default)) {\r\n        selectors.push(this._updateNode(new AST.DefaultSelector()));\r\n      } else {\r\n        selectors.push(this._shift_expression());\r\n      }\r\n    }\r\n\r\n    return selectors;\r\n  }\r\n\r\n  _case_body(): AST.Statement[] {\r\n    // statement case_body?\r\n    // fallthrough semicolon\r\n    if (this._match(TokenTypes.keywords.fallthrough)) {\r\n      this._consume(TokenTypes.tokens.semicolon, \"Expected ';'\");\r\n      return [];\r\n    }\r\n\r\n    let statement = this._statement();\r\n    if (statement == null) {\r\n      return [];\r\n    }\r\n\r\n    if (!(statement instanceof Array)) {\r\n      statement = [statement];\r\n    }\r\n\r\n    const nextStatement = this._case_body();\r\n    if (nextStatement.length == 0) {\r\n      return statement;\r\n    }\r\n\r\n    return [...statement, nextStatement[0]];\r\n  }\r\n\r\n  _if_statement(): AST.If | null {\r\n    // if optional_paren_expression compound_statement elseif_statement? else_statement?\r\n    if (!this._match(TokenTypes.keywords.if)) {\r\n      return null;\r\n    }\r\n\r\n    const line = this._currentLine;\r\n\r\n    const condition = this._optional_paren_expression();\r\n\r\n    let attributes = null;\r\n    if (this._check(TokenTypes.tokens.attr)) {\r\n      attributes = this._attribute();\r\n    }\r\n\r\n    const block = this._compound_statement();\r\n\r\n    let elseif: AST.ElseIf[] | null = [];\r\n    if (this._match_elseif()) {\r\n      let attributes = null;\r\n      if (this._check(TokenTypes.tokens.attr)) {\r\n        attributes = this._attribute();\r\n      }\r\n      elseif = this._elseif_statement(elseif);\r\n    }\r\n\r\n    let _else: AST.Statement[] | null = null;\r\n    if (this._match(TokenTypes.keywords.else)) {\r\n      let attributes = null;\r\n      if (this._check(TokenTypes.tokens.attr)) {\r\n        attributes = this._attribute();\r\n      }\r\n      _else = this._compound_statement();\r\n    }\r\n\r\n    return this._updateNode(new AST.If(condition, block, elseif, _else), line);\r\n  }\r\n\r\n  _match_elseif(): boolean {\r\n    if (this._tokens[this._current].type === TokenTypes.keywords.else &&\r\n      this._tokens[this._current + 1].type === TokenTypes.keywords.if) {\r\n      this._advance();\r\n      this._advance();\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  _elseif_statement(elseif: AST.ElseIf[] = []): AST.ElseIf[] {\r\n    // else_if optional_paren_expression compound_statement elseif_statement?\r\n    const condition = this._optional_paren_expression();\r\n    const block = this._compound_statement();\r\n    elseif.push(this._updateNode(new AST.ElseIf(condition, block)));\r\n    if (this._match_elseif()) {\r\n      let attributes = null;\r\n      if (this._check(TokenTypes.tokens.attr)) {\r\n        attributes = this._attribute();\r\n      }\r\n      this._elseif_statement(elseif);\r\n    }\r\n    return elseif;\r\n  }\r\n\r\n  _return_statement(): AST.Return | null {\r\n    // return short_circuit_or_expression?\r\n    if (!this._match(TokenTypes.keywords.return)) {\r\n      return null;\r\n    }\r\n    const value = this._short_circuit_or_expression();\r\n    return this._updateNode(new AST.Return(value));\r\n  }\r\n\r\n  _short_circuit_or_expression(): AST.Expression {\r\n    // short_circuit_and_expression\r\n    // short_circuit_or_expression or_or short_circuit_and_expression\r\n    let expr = this._short_circuit_and_expr();\r\n    while (this._match(TokenTypes.tokens.or_or)) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._short_circuit_and_expr()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _short_circuit_and_expr(): AST.Expression {\r\n    // inclusive_or_expression\r\n    // short_circuit_and_expression and_and inclusive_or_expression\r\n    let expr = this._inclusive_or_expression();\r\n    while (this._match(TokenTypes.tokens.and_and)) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._inclusive_or_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _inclusive_or_expression(): AST.Expression {\r\n    // exclusive_or_expression\r\n    // inclusive_or_expression or exclusive_or_expression\r\n    let expr = this._exclusive_or_expression();\r\n    while (this._match(TokenTypes.tokens.or)) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._exclusive_or_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _exclusive_or_expression(): AST.Expression {\r\n    // and_expression\r\n    // exclusive_or_expression xor and_expression\r\n    let expr = this._and_expression();\r\n    while (this._match(TokenTypes.tokens.xor)) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._and_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _and_expression(): AST.Expression {\r\n    // equality_expression\r\n    // and_expression and equality_expression\r\n    let expr = this._equality_expression();\r\n    while (this._match(TokenTypes.tokens.and)) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._equality_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _equality_expression(): AST.Expression {\r\n    // relational_expression\r\n    // relational_expression equal_equal relational_expression\r\n    // relational_expression not_equal relational_expression\r\n    const expr = this._relational_expression();\r\n    if (this._match([TokenTypes.tokens.equal_equal, TokenTypes.tokens.not_equal])) {\r\n      return this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._relational_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _relational_expression(): AST.Expression {\r\n    // shift_expression\r\n    // relational_expression less_than shift_expression\r\n    // relational_expression greater_than shift_expression\r\n    // relational_expression less_than_equal shift_expression\r\n    // relational_expression greater_than_equal shift_expression\r\n    let expr = this._shift_expression();\r\n    while (this._match([\r\n        TokenTypes.tokens.less_than,\r\n        TokenTypes.tokens.greater_than,\r\n        TokenTypes.tokens.less_than_equal,\r\n        TokenTypes.tokens.greater_than_equal,\r\n      ])) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._shift_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _shift_expression(): AST.Expression {\r\n    // additive_expression\r\n    // shift_expression shift_left additive_expression\r\n    // shift_expression shift_right additive_expression\r\n    let expr = this._additive_expression();\r\n    while (this._match([TokenTypes.tokens.shift_left, TokenTypes.tokens.shift_right])) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._additive_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _additive_expression(): AST.Expression {\r\n    // multiplicative_expression\r\n    // additive_expression plus multiplicative_expression\r\n    // additive_expression minus multiplicative_expression\r\n    let expr = this._multiplicative_expression();\r\n    while (this._match([TokenTypes.tokens.plus, TokenTypes.tokens.minus])) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._multiplicative_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _multiplicative_expression(): AST.Expression {\r\n    // unary_expression\r\n    // multiplicative_expression star unary_expression\r\n    // multiplicative_expression forward_slash unary_expression\r\n    // multiplicative_expression modulo unary_expression\r\n    let expr = this._unary_expression();\r\n    while (this._match([\r\n        TokenTypes.tokens.star,\r\n        TokenTypes.tokens.forward_slash,\r\n        TokenTypes.tokens.modulo,\r\n      ])) {\r\n      expr = this._updateNode(new AST.BinaryOperator(\r\n        this._previous().toString(),\r\n        expr,\r\n        this._unary_expression()\r\n      ));\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _unary_expression(): AST.Expression {\r\n    // singular_expression\r\n    // minus unary_expression\r\n    // bang unary_expression\r\n    // tilde unary_expression\r\n    // star unary_expression\r\n    // and unary_expression\r\n    if (this._match([\r\n        TokenTypes.tokens.minus,\r\n        TokenTypes.tokens.bang,\r\n        TokenTypes.tokens.tilde,\r\n        TokenTypes.tokens.star,\r\n        TokenTypes.tokens.and,\r\n      ])) {\r\n      return this._updateNode(new AST.UnaryOperator(\r\n        this._previous().toString(),\r\n        this._unary_expression()\r\n      ));\r\n    }\r\n    return this._singular_expression();\r\n  }\r\n\r\n  _singular_expression(): AST.Expression {\r\n    // primary_expression postfix_expression ?\r\n    const expr = this._primary_expression();\r\n    const p = this._postfix_expression();\r\n    if (p) {\r\n      expr.postfix = p;\r\n    }\r\n    return expr;\r\n  }\r\n\r\n  _postfix_expression(): AST.Expression | null {\r\n    // bracket_left short_circuit_or_expression bracket_right postfix_expression?\r\n    if (this._match(TokenTypes.tokens.bracket_left)) {\r\n      const expr = this._short_circuit_or_expression();\r\n      this._consume(TokenTypes.tokens.bracket_right, \"Expected ']'.\");\r\n      const arrayIndex = this._updateNode(new AST.ArrayIndex(expr));\r\n      const p = this._postfix_expression();\r\n      if (p) {\r\n        arrayIndex.postfix = p;\r\n      }\r\n      return arrayIndex;\r\n    }\r\n\r\n    // period ident postfix_expression?\r\n    if (this._match(TokenTypes.tokens.period)) {\r\n      const name = this._consume(TokenTypes.tokens.name, \"Expected member name.\");\r\n      const p = this._postfix_expression();\r\n      const expr = this._updateNode(new AST.StringExpr(name.lexeme));\r\n      if (p) {\r\n        expr.postfix = p;\r\n      }\r\n      return expr;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _getStruct(name: string): AST.Type | null {\r\n    if (this._context.aliases.has(name)) {\r\n      const alias = this._context.aliases.get(name).type;\r\n      return alias;\r\n    }\r\n    if (this._context.structs.has(name)) {\r\n      const struct = this._context.structs.get(name);\r\n      return struct;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _getType(name: string): AST.Type {\r\n    const struct = this._getStruct(name);\r\n    if (struct !== null) {\r\n      return struct;\r\n    }\r\n    switch (name) {\r\n      case \"void\":\r\n        return AST.Type.void;\r\n      case \"bool\":\r\n        return AST.Type.bool;\r\n      case \"i32\":\r\n        return AST.Type.i32;\r\n      case \"u32\":\r\n        return AST.Type.u32;\r\n      case \"f32\":\r\n        return AST.Type.f32;\r\n      case \"f16\":\r\n        return AST.Type.f16;\r\n      case \"vec2f\":\r\n        return AST.TemplateType.vec2f;\r\n      case \"vec3f\":\r\n        return AST.TemplateType.vec3f;\r\n      case \"vec4f\":\r\n        return AST.TemplateType.vec4f;\r\n      case \"vec2i\":\r\n        return AST.TemplateType.vec2i;\r\n      case \"vec3i\":\r\n        return AST.TemplateType.vec3i;\r\n      case \"vec4i\":\r\n        return AST.TemplateType.vec4i;\r\n      case \"vec2u\":\r\n        return AST.TemplateType.vec2u;\r\n      case \"vec3u\":\r\n        return AST.TemplateType.vec3u;\r\n      case \"vec4u\":\r\n        return AST.TemplateType.vec4u;\r\n      case \"vec2h\":\r\n        return AST.TemplateType.vec2h;\r\n      case \"vec3h\":\r\n        return AST.TemplateType.vec3h;\r\n      case \"vec4h\":\r\n        return AST.TemplateType.vec4h;\r\n      case \"mat2x2f\":\r\n        return AST.TemplateType.mat2x2f;\r\n      case \"mat2x3f\":\r\n        return AST.TemplateType.mat2x3f;\r\n      case \"mat2x4f\":\r\n        return AST.TemplateType.mat2x4f;\r\n      case \"mat3x2f\":\r\n        return AST.TemplateType.mat3x2f;\r\n      case \"mat3x3f\":\r\n        return AST.TemplateType.mat3x3f;\r\n      case \"mat3x4f\":\r\n        return AST.TemplateType.mat3x4f;\r\n      case \"mat4x2f\":\r\n        return AST.TemplateType.mat4x2f;\r\n      case \"mat4x3f\":\r\n        return AST.TemplateType.mat4x3f;\r\n      case \"mat4x4f\":\r\n        return AST.TemplateType.mat4x4f;\r\n      case \"mat2x2h\":\r\n        return AST.TemplateType.mat2x2h;\r\n      case \"mat2x3h\":\r\n        return AST.TemplateType.mat2x3h;\r\n      case \"mat2x4h\":\r\n        return AST.TemplateType.mat2x4h;\r\n      case \"mat3x2h\":\r\n        return AST.TemplateType.mat3x2h;\r\n      case \"mat3x3h\":\r\n        return AST.TemplateType.mat3x3h;\r\n      case \"mat3x4h\":\r\n        return AST.TemplateType.mat3x4h;\r\n      case \"mat4x2h\":\r\n        return AST.TemplateType.mat4x2h;\r\n      case \"mat4x3h\":\r\n        return AST.TemplateType.mat4x3h;\r\n      case \"mat4x4h\":\r\n        return AST.TemplateType.mat4x4h;\r\n\r\n      case \"mat2x2i\":\r\n        return AST.TemplateType.mat2x2i;\r\n      case \"mat2x3i\":\r\n        return AST.TemplateType.mat2x3i;\r\n      case \"mat2x4i\":\r\n        return AST.TemplateType.mat2x4i;\r\n      case \"mat3x2i\":\r\n        return AST.TemplateType.mat3x2i;\r\n      case \"mat3x3i\":\r\n        return AST.TemplateType.mat3x3i;\r\n      case \"mat3x4i\":\r\n        return AST.TemplateType.mat3x4i;\r\n      case \"mat4x2i\":\r\n        return AST.TemplateType.mat4x2i;\r\n      case \"mat4x3i\":\r\n        return AST.TemplateType.mat4x3i;\r\n      case \"mat4x4i\":\r\n        return AST.TemplateType.mat4x4i;\r\n\r\n      case \"mat2x2u\":\r\n        return AST.TemplateType.mat2x2u;\r\n      case \"mat2x3u\":\r\n        return AST.TemplateType.mat2x3u;\r\n      case \"mat2x4u\":\r\n        return AST.TemplateType.mat2x4u;\r\n      case \"mat3x2u\":\r\n        return AST.TemplateType.mat3x2u;\r\n      case \"mat3x3u\":\r\n        return AST.TemplateType.mat3x3u;\r\n      case \"mat3x4u\":\r\n        return AST.TemplateType.mat3x4u;\r\n      case \"mat4x2u\":\r\n        return AST.TemplateType.mat4x2u;\r\n      case \"mat4x3u\":\r\n        return AST.TemplateType.mat4x3u;\r\n      case \"mat4x4u\":\r\n        return AST.TemplateType.mat4x4u;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _validateTypeRange(value: number, type: AST.Type) {\r\n    if (type.name === \"i32\") {\r\n      if (value < -2147483648 || value > 2147483647) {\r\n        throw this._error(this._previous(), `Value out of range for i32: ${value}. Line: ${this._currentLine}.`);\r\n      }\r\n    } else if (type.name === \"u32\") {\r\n      if (value < 0 || value > 4294967295) {\r\n        throw this._error(this._previous(), `Value out of range for u32: ${value}. Line: ${this._currentLine}.`);\r\n      }\r\n    }\r\n  }\r\n\r\n  _primary_expression(): AST.Expression {\r\n    // ident argument_expression_list?\r\n    if (this._match(TokenTypes.tokens.ident)) {\r\n      const name = this._previous().toString();\r\n      if (this._check(TokenTypes.tokens.paren_left)) {\r\n        const args = this._argument_expression_list();\r\n        const type = this._getType(name);\r\n        if (type !== null) {\r\n          return this._updateNode(new AST.CreateExpr(type, args));\r\n        }\r\n        return this._updateNode(new AST.CallExpr(name, args));\r\n      }\r\n      if (this._context.constants.has(name)) {\r\n        const c = this._context.constants.get(name);\r\n        return this._updateNode(new AST.ConstExpr(name, c.value));\r\n      }\r\n      return this._updateNode(new AST.VariableExpr(name));\r\n    }\r\n\r\n    // const_literal\r\n    if (this._match(TokenTypes.tokens.int_literal)) {\r\n      const s = this._previous().toString();\r\n      let type = s.endsWith(\"i\") || s.endsWith(\"i\") ? AST.Type.i32 :\r\n          s.endsWith(\"u\") || s.endsWith(\"U\") ? AST.Type.u32 : AST.Type.x32;\r\n      const i = parseInt(s);\r\n      this._validateTypeRange(i, type);\r\n      return this._updateNode(new AST.LiteralExpr(new ScalarData(i, this._exec.getTypeInfo(type)), type));\r\n    } else if (this._match(TokenTypes.tokens.uint_literal)) {\r\n      const u = parseInt(this._previous().toString());\r\n      this._validateTypeRange(u, AST.Type.u32);\r\n      return this._updateNode(new AST.LiteralExpr(new ScalarData(u, this._exec.getTypeInfo(AST.Type.u32)), AST.Type.u32));\r\n    } else if (this._match([TokenTypes.tokens.decimal_float_literal, TokenTypes.tokens.hex_float_literal])) {\r\n      let fs = this._previous().toString();\r\n      let isF16 = fs.endsWith(\"h\");\r\n      if (isF16) {\r\n        fs = fs.substring(0, fs.length - 1);\r\n      }\r\n      const f = parseFloat(fs);\r\n      this._validateTypeRange(f, isF16 ? AST.Type.f16 : AST.Type.f32);\r\n      const type = isF16 ? AST.Type.f16 : AST.Type.f32;\r\n      return this._updateNode(new AST.LiteralExpr(new ScalarData(f, this._exec.getTypeInfo(type)), type));\r\n    } else if (this._match([TokenTypes.keywords.true, TokenTypes.keywords.false])) {\r\n      let b = this._previous().toString() === TokenTypes.keywords.true.rule;\r\n      return this._updateNode(new AST.LiteralExpr(new ScalarData(b ? 1 : 0, this._exec.getTypeInfo(AST.Type.bool)), AST.Type.bool));\r\n    }\r\n\r\n    // paren_expression\r\n    if (this._check(TokenTypes.tokens.paren_left)) {\r\n      return this._paren_expression();\r\n    }\r\n\r\n    // bitcast less_than type_decl greater_than paren_expression\r\n    if (this._match(TokenTypes.keywords.bitcast)) {\r\n      this._consume(TokenTypes.tokens.less_than, \"Expected '<'.\");\r\n      const type = this._type_decl();\r\n      this._consume(TokenTypes.tokens.greater_than, \"Expected '>'.\");\r\n      const value = this._paren_expression();\r\n      return this._updateNode(new AST.BitcastExpr(type, value));\r\n    }\r\n\r\n    // type_decl argument_expression_list\r\n    const type = this._type_decl();\r\n    const args = this._argument_expression_list();\r\n    return this._updateNode(new AST.CreateExpr(type, args));\r\n  }\r\n\r\n  _argument_expression_list(): AST.Expression[] | null {\r\n    // paren_left ((short_circuit_or_expression comma)* short_circuit_or_expression comma?)? paren_right\r\n    if (!this._match(TokenTypes.tokens.paren_left)) {\r\n      return null;\r\n    }\r\n\r\n    const args: AST.Expression[] = [];\r\n    do {\r\n      if (this._check(TokenTypes.tokens.paren_right)) {\r\n        break;\r\n      }\r\n      const arg = this._short_circuit_or_expression();\r\n      args.push(arg);\r\n    } while (this._match(TokenTypes.tokens.comma));\r\n    this._consume(\r\n      TokenTypes.tokens.paren_right,\r\n      \"Expected ')' for agument list\"\r\n    );\r\n\r\n    return args;\r\n  }\r\n\r\n  _optional_paren_expression(): AST.Expression {\r\n    // [paren_left] short_circuit_or_expression [paren_right]\r\n    this._match(TokenTypes.tokens.paren_left);\r\n    const expr = this._short_circuit_or_expression();\r\n    this._match(TokenTypes.tokens.paren_right);\r\n    return expr;\r\n  }\r\n\r\n  _paren_expression(): AST.Expression {\r\n    // paren_left short_circuit_or_expression paren_right\r\n    this._consume(TokenTypes.tokens.paren_left, \"Expected '('.\");\r\n    const expr = this._short_circuit_or_expression();\r\n    this._consume(TokenTypes.tokens.paren_right, \"Expected ')'.\");\r\n    return expr;\r\n  }\r\n\r\n  _struct_decl(): AST.Struct | null {\r\n    // attribute* struct ident struct_body_decl\r\n    if (!this._match(TokenTypes.keywords.struct)) {\r\n      return null;\r\n    }\r\n\r\n    const startLine = this._currentLine;\r\n\r\n    const name = this._consume(TokenTypes.tokens.ident, \"Expected name for struct.\").toString();\r\n\r\n    // struct_body_decl: brace_left (struct_member comma)* struct_member comma? brace_right\r\n    this._consume(TokenTypes.tokens.brace_left, \"Expected '{' for struct body.\");\r\n    const members: AST.Member[] = [];\r\n    while (!this._check(TokenTypes.tokens.brace_right)) {\r\n      // struct_member: attribute* variable_ident_decl\r\n      const memberAttrs = this._attribute();\r\n\r\n      const memberName = this._consume(TokenTypes.tokens.name, \"Expected variable name.\").toString();\r\n\r\n      this._consume(TokenTypes.tokens.colon, \"Expected ':' for struct member type.\");\r\n\r\n      const typeAttrs = this._attribute();\r\n      const memberType = this._type_decl();\r\n      if (memberType != null) {\r\n        memberType.attributes = typeAttrs;\r\n      }\r\n\r\n      if (!this._check(TokenTypes.tokens.brace_right)) {\r\n        this._consume(TokenTypes.tokens.comma, \"Expected ',' for struct member.\");\r\n      } else {\r\n        this._match(TokenTypes.tokens.comma); // trailing comma optional.\r\n      }\r\n\r\n      members.push(this._updateNode(new AST.Member(memberName, memberType, memberAttrs)));\r\n    }\r\n\r\n    this._consume(TokenTypes.tokens.brace_right, \"Expected '}' after struct body.\");\r\n\r\n    const endLine = this._currentLine;\r\n\r\n    const structNode = this._updateNode(new AST.Struct(name, members, startLine, endLine), startLine);\r\n    this._context.structs.set(name, structNode);\r\n    return structNode;\r\n  }\r\n\r\n  _global_variable_decl(): AST.Var | null {\r\n    // attribute* variable_decl (equal const_expression)?\r\n    const _var = this._variable_decl();\r\n    if (!_var) {\r\n      return null;\r\n    }\r\n\r\n    if (this._match(TokenTypes.tokens.equal)) {\r\n      const expr = this._const_expression();\r\n      _var.value = expr;\r\n    }\r\n\r\n    if (_var.type !== null && _var.value instanceof AST.LiteralExpr) {\r\n      if (_var.value.type.name !== \"x32\") {\r\n        const t1 = _var.type.getTypeName();\r\n        const t2 = _var.value.type.getTypeName();\r\n        if (t1 !== t2) {\r\n          throw this._error(this._peek(), `Invalid cast from ${_var.value.type.name} to ${_var.type.name}. Line:${this._currentLine}`);\r\n        }\r\n      }\r\n      if (_var.value.isScalar) {\r\n        this._validateTypeRange(_var.value.scalarValue, _var.type);\r\n      }\r\n      _var.value.type = _var.type;\r\n    } else if (_var.type === null && _var.value instanceof AST.LiteralExpr) {\r\n      _var.type = _var.value.type.name === \"x32\" ? AST.Type.i32 : _var.value.type;\r\n      if (_var.value.isScalar) {\r\n        this._validateTypeRange(_var.value.scalarValue, _var.type);\r\n      }\r\n    }\r\n    return _var;\r\n  }\r\n\r\n  _override_variable_decl(): AST.Override | null {\r\n    // attribute* override_decl (equal const_expression)?\r\n    const _override = this._override_decl();\r\n    if (_override && this._match(TokenTypes.tokens.equal)) {\r\n      _override.value = this._const_expression();\r\n    }\r\n\r\n    return _override;\r\n  }\r\n\r\n  _global_const_decl(): AST.Const | null {\r\n    // attribute* const (ident variable_ident_decl) global_const_initializer?\r\n    if (!this._match(TokenTypes.keywords.const)) {\r\n      return null;\r\n    }\r\n\r\n    const name = this._consume(\r\n      TokenTypes.tokens.name,\r\n      \"Expected variable name\"\r\n    );\r\n\r\n    const line = this._currentLine;\r\n\r\n    let type: AST.Type | null = null;\r\n    if (this._match(TokenTypes.tokens.colon)) {\r\n      const attrs = this._attribute();\r\n      type = this._type_decl();\r\n      if (type != null) {\r\n        type.attributes = attrs;\r\n      }\r\n    }\r\n    let value: AST.Expression | null = null;\r\n\r\n    this._consume(TokenTypes.tokens.equal, \"const declarations require an assignment\")\r\n\r\n    const valueExpr = this._short_circuit_or_expression();\r\n    try {\r\n      let type = [AST.Type.f32];\r\n      let constValue = valueExpr.constEvaluate(this._exec, type);\r\n\r\n      if (constValue instanceof ScalarData) {\r\n        this._validateTypeRange(constValue.value, type[0]);\r\n      }\r\n\r\n      if (type[0] instanceof AST.TemplateType && type[0].format === null &&\r\n        constValue.typeInfo instanceof TemplateInfo && constValue.typeInfo.format !== null) {\r\n        if (constValue.typeInfo.format.name === \"f16\") {\r\n          type[0].format = AST.Type.f16;\r\n        } else if (constValue.typeInfo.format.name === \"f32\") {\r\n          type[0].format = AST.Type.f32;\r\n        } else if (constValue.typeInfo.format.name === \"i32\") {\r\n          type[0].format = AST.Type.i32;\r\n        } else if (constValue.typeInfo.format.name === \"u32\") {\r\n          type[0].format = AST.Type.u32;\r\n        } else if (constValue.typeInfo.format.name === \"bool\") {\r\n          type[0].format = AST.Type.bool;\r\n        } else {\r\n          console.error(`TODO: impelement template format type ${constValue.typeInfo.format.name}`);\r\n        }\r\n      }\r\n\r\n      value = this._updateNode(new AST.LiteralExpr(constValue, type[0]));\r\n      this._exec.context.setVariable(name.toString(), constValue);\r\n    } catch {\r\n      value = valueExpr;\r\n    }\r\n\r\n    if (type !== null && value instanceof AST.LiteralExpr) {\r\n      if (value.type.name !== \"x32\") {\r\n        const t1 = type.getTypeName();\r\n        const t2 = value.type.getTypeName();\r\n        if (t1 !== t2) {\r\n          throw this._error(this._peek(), `Invalid cast from ${value.type.name} to ${type.name}. Line:${this._currentLine}`);\r\n        }\r\n      }\r\n      value.type = type;\r\n      if (value.isScalar) {\r\n        this._validateTypeRange(value.scalarValue, value.type);\r\n      }\r\n    } else if (type === null && value instanceof AST.LiteralExpr) {\r\n      type = value?.type ?? AST.Type.f32;\r\n      if (type === AST.Type.x32) {\r\n        type = AST.Type.i32;\r\n      }\r\n    }\r\n\r\n    const c = this._updateNode(new AST.Const(name.toString(), type, \"\", \"\", value), line);\r\n    this._context.constants.set(c.name, c);\r\n    return c;\r\n  }\r\n\r\n  _global_let_decl(): AST.Let | null {\r\n    // attribute* let (ident variable_ident_decl) global_const_initializer?\r\n    if (!this._match(TokenTypes.keywords.let)) {\r\n      return null;\r\n    }\r\n\r\n    const line = this._currentLine;\r\n\r\n    const name = this._consume(\r\n      TokenTypes.tokens.name,\r\n      \"Expected variable name\"\r\n    );\r\n\r\n    let type: AST.Type | null = null;\r\n    if (this._match(TokenTypes.tokens.colon)) {\r\n      const attrs = this._attribute();\r\n      type = this._type_decl();\r\n      if (type != null) {\r\n        type.attributes = attrs;\r\n      }\r\n    }\r\n\r\n    let value: AST.Expression | null = null;\r\n    if (this._match(TokenTypes.tokens.equal)) {\r\n      value = this._const_expression();\r\n    }\r\n\r\n    if (type !== null && value instanceof AST.LiteralExpr) {\r\n      if (value.type.name !== \"x32\") {\r\n        const t1 = type.getTypeName();\r\n        const t2 = value.type.getTypeName();\r\n        if (t1 !== t2) {\r\n          throw this._error(this._peek(), `Invalid cast from ${value.type.name} to ${type.name}. Line:${this._currentLine}`);\r\n        }\r\n      }\r\n      value.type = type;\r\n    } else if (type === null && value instanceof AST.LiteralExpr) {\r\n      type = value.type.name === \"x32\" ? AST.Type.i32 : value.type;\r\n    }\r\n\r\n    if (value instanceof AST.LiteralExpr) {\r\n      if (value.isScalar) {\r\n        this._validateTypeRange(value.scalarValue, type);\r\n      }\r\n    }\r\n    return this._updateNode(new AST.Let(name.toString(), type, \"\", \"\", value), line);\r\n  }\r\n\r\n  _const_expression(): AST.Expression {\r\n    // type_decl paren_left ((const_expression comma)* const_expression comma?)? paren_right\r\n    // const_literal\r\n    return this._short_circuit_or_expression();\r\n  }\r\n\r\n  _variable_decl(): AST.Var | null {\r\n    // var variable_qualifier? (ident variable_ident_decl)\r\n    if (!this._match(TokenTypes.keywords.var)) {\r\n      return null;\r\n    }\r\n\r\n    const line = this._currentLine;\r\n\r\n    // variable_qualifier: less_than storage_class (comma access_mode)? greater_than\r\n    let storage: string = \"\";\r\n    let access: string = \"\";\r\n    if (this._match(TokenTypes.tokens.less_than)) {\r\n      storage = this._consume(TokenTypes.storage_class, \"Expected storage_class.\").toString();\r\n      if (this._match(TokenTypes.tokens.comma))\r\n        access = this._consume(TokenTypes.access_mode, \"Expected access_mode.\").toString();\r\n      this._consume(TokenTypes.tokens.greater_than, \"Expected '>'.\");\r\n    }\r\n\r\n    const name = this._consume(\r\n      TokenTypes.tokens.name,\r\n      \"Expected variable name\"\r\n    );\r\n\r\n    let type: AST.Type | null = null;\r\n    if (this._match(TokenTypes.tokens.colon)) {\r\n      const attrs = this._attribute();\r\n      type = this._type_decl();\r\n      if (type != null) {\r\n        type.attributes = attrs;\r\n      }\r\n    }\r\n\r\n    return this._updateNode(new AST.Var(name.toString(), type, storage, access, null), line);\r\n  }\r\n\r\n  _override_decl(): AST.Override | null {\r\n    // override (ident variable_ident_decl)\r\n    if (!this._match(TokenTypes.keywords.override)) {\r\n      return null;\r\n    }\r\n\r\n    const name = this._consume(TokenTypes.tokens.name, \"Expected variable name\");\r\n    let type: AST.Type | null = null;\r\n    if (this._match(TokenTypes.tokens.colon)) {\r\n      const attrs = this._attribute();\r\n      type = this._type_decl();\r\n      if (type != null) {\r\n        type.attributes = attrs;\r\n      }\r\n    }\r\n\r\n    return this._updateNode(new AST.Override(name.toString(), type, null));\r\n  }\r\n\r\n  _diagnostic(): AST.Diagnostic | null {\r\n    // diagnostic(severity_control_name, diagnostic_rule_name)\r\n    this._consume(TokenTypes.tokens.paren_left, \"Expected '('\");\r\n    const severity = this._consume(\r\n      TokenTypes.tokens.ident,\r\n      \"Expected severity control name.\"\r\n    );\r\n    this._consume(TokenTypes.tokens.comma, \"Expected ','\");\r\n    const rule = this._consume(\r\n      TokenTypes.tokens.ident,\r\n      \"Expected diagnostic rule name.\"\r\n    );\r\n    let ruleMessage = rule.toString();\r\n    if (this._match(TokenTypes.tokens.period)) {\r\n      const message = this._consume(\r\n        TokenTypes.tokens.ident,\r\n        \"Expected diagnostic message.\"\r\n      );\r\n      ruleMessage += `.${message.toString()}`;\r\n    }\r\n\r\n    this._consume(TokenTypes.tokens.paren_right, \"Expected ')'\");\r\n    return this._updateNode(new AST.Diagnostic(severity.toString(), ruleMessage));\r\n  }\r\n\r\n  _enable_directive(): AST.Enable {\r\n    // enable ident semicolon\r\n    const name = this._consume(TokenTypes.tokens.ident, \"identity expected.\");\r\n    return this._updateNode(new AST.Enable(name.toString()));\r\n  }\r\n\r\n  _requires_directive(): AST.Requires {\r\n    // requires extension [, extension]* semicolon\r\n    const extensions: string[] = [this._consume(TokenTypes.tokens.ident, \"identity expected.\").toString()];\r\n    while (this._match(TokenTypes.tokens.comma)) {\r\n      const name = this._consume(TokenTypes.tokens.ident, \"identity expected.\");\r\n      extensions.push(name.toString());\r\n    }\r\n    return this._updateNode(new AST.Requires(extensions));\r\n  }\r\n\r\n  _type_alias(): AST.Alias {\r\n    // type ident equal type_decl\r\n    const name = this._consume(TokenTypes.tokens.ident, \"identity expected.\");\r\n    this._consume(TokenTypes.tokens.equal, \"Expected '=' for type alias.\");\r\n\r\n    let aliasType = this._type_decl();\r\n    if (aliasType === null) {\r\n      throw this._error(this._peek(), \"Expected Type for Alias.\");\r\n    }\r\n    if (this._context.aliases.has(aliasType.name)) {\r\n      aliasType = this._context.aliases.get(aliasType.name).type;\r\n    }\r\n\r\n    const aliasNode = this._updateNode(new AST.Alias(name.toString(), aliasType));\r\n    this._context.aliases.set(aliasNode.name, aliasNode);\r\n\r\n    return aliasNode;\r\n  }\r\n\r\n  _type_decl(): AST.Type | null {\r\n    // ident\r\n    // bool\r\n    // float32\r\n    // int32\r\n    // uint32\r\n    // vec2 less_than type_decl greater_than\r\n    // vec3 less_than type_decl greater_than\r\n    // vec4 less_than type_decl greater_than\r\n    // mat2x2 less_than type_decl greater_than\r\n    // mat2x3 less_than type_decl greater_than\r\n    // mat2x4 less_than type_decl greater_than\r\n    // mat3x2 less_than type_decl greater_than\r\n    // mat3x3 less_than type_decl greater_than\r\n    // mat3x4 less_than type_decl greater_than\r\n    // mat4x2 less_than type_decl greater_than\r\n    // mat4x3 less_than type_decl greater_than\r\n    // mat4x4 less_than type_decl greater_than\r\n    // atomic less_than type_decl greater_than\r\n    // pointer less_than storage_class comma type_decl (comma access_mode)? greater_than\r\n    // array_type_decl\r\n    // texture_sampler_types\r\n\r\n    if (this._check([\r\n        TokenTypes.tokens.ident,\r\n        ...TokenTypes.texel_format,\r\n        TokenTypes.keywords.bool,\r\n        TokenTypes.keywords.f32,\r\n        TokenTypes.keywords.i32,\r\n        TokenTypes.keywords.u32,\r\n      ])) {\r\n      const type = this._advance();\r\n      const typeName = type.toString();\r\n      if (this._context.structs.has(typeName)) {\r\n        return this._context.structs.get(typeName);\r\n      }\r\n      if (this._context.aliases.has(typeName)) {\r\n        return this._context.aliases.get(typeName).type;\r\n      }\r\n\r\n      const t = this._getType(typeName);\r\n      // Don't \"forward declare\" built-in types\r\n      if (!t) {\r\n        const node = this._updateNode(new AST.ForwardType(typeName));\r\n        this._forwardTypeCount++;\r\n        return node;\r\n      }\r\n\r\n      return this._updateNode(new AST.Type(typeName));\r\n    }\r\n\r\n    // texture_sampler_types\r\n    let type = this._texture_sampler_types();\r\n    if (type) {\r\n      return type;\r\n    }\r\n\r\n    if (this._check(TokenTypes.template_types)) {\r\n      let type = this._advance().toString();\r\n      let format: AST.Type | null = null;\r\n      let access: string | null = null;\r\n      if (this._match(TokenTypes.tokens.less_than)) {\r\n        format = this._type_decl();\r\n        access = null;\r\n        if (this._match(TokenTypes.tokens.comma)) {\r\n          access = this._consume(TokenTypes.access_mode, \"Expected access_mode for pointer\").toString();\r\n        }\r\n        this._consume(TokenTypes.tokens.greater_than, \"Expected '>' for type.\");\r\n      }\r\n      const node = this._updateNode(new AST.TemplateType(type, format, access));\r\n      return node;\r\n    }\r\n\r\n    // pointer less_than storage_class comma type_decl (comma access_mode)? greater_than\r\n    if (this._match(TokenTypes.keywords.ptr)) {\r\n      let pointer = this._previous().toString();\r\n      this._consume(TokenTypes.tokens.less_than, \"Expected '<' for pointer.\");\r\n      const storage = this._consume(TokenTypes.storage_class, \"Expected storage_class for pointer\");\r\n      this._consume(TokenTypes.tokens.comma, \"Expected ',' for pointer.\");\r\n      const decl = this._type_decl();\r\n      let access: string | null = null;\r\n      if (this._match(TokenTypes.tokens.comma)) {\r\n        access = this._consume(TokenTypes.access_mode, \"Expected access_mode for pointer\").toString();\r\n      }\r\n      this._consume(TokenTypes.tokens.greater_than, \"Expected '>' for pointer.\");\r\n      const node = this._updateNode(new AST.PointerType(pointer, storage.toString(), decl, access));\r\n      return node;\r\n    }\r\n\r\n    // The following type_decl's have an optional attribyte_list*\r\n    const attrs = this._attribute();\r\n\r\n    // attribute* array\r\n    // attribute* array less_than type_decl (comma element_count_expression)? greater_than\r\n    if (this._match(TokenTypes.keywords.array)) {\r\n      let format = null;\r\n      let countInt = -1;\r\n      const array = this._previous();\r\n      let countNode: AST.Expression | null = null;\r\n      if (this._match(TokenTypes.tokens.less_than)) {\r\n        format = this._type_decl();\r\n        if (this._context.aliases.has(format.name)) {\r\n          format = this._context.aliases.get(format.name).type;\r\n        }\r\n        let count: string = \"\";\r\n        if (this._match(TokenTypes.tokens.comma)) {\r\n          countNode = this._shift_expression();\r\n          // If we can't evaluate the node, defer evaluating it until after the shader has\r\n          // finished being parsed, because const statements can be declared **after** they\r\n          // are used.\r\n          try {\r\n            count = countNode.constEvaluate(this._exec).toString();\r\n            countNode = null;\r\n          } catch (e) {\r\n            count = \"1\";\r\n          }\r\n        }\r\n        this._consume(TokenTypes.tokens.greater_than, \"Expected '>' for array.\");\r\n        countInt = count ? parseInt(count) : 0;\r\n      }\r\n      const arrayType = this._updateNode(new AST.ArrayType(array.toString(), attrs, format, countInt));\r\n      if (countNode) {\r\n        this._deferArrayCountEval.push({ arrayType, countNode });\r\n      }\r\n      return arrayType;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _texture_sampler_types(): AST.SamplerType | null {\r\n    // sampler_type\r\n    if (this._match(TokenTypes.sampler_type)) {\r\n      return this._updateNode(new AST.SamplerType(this._previous().toString(), null, null));\r\n    }\r\n\r\n    // depth_texture_type\r\n    if (this._match(TokenTypes.depth_texture_type)) {\r\n      return this._updateNode(new AST.SamplerType(this._previous().toString(), null, null));\r\n    }\r\n\r\n    // sampled_texture_type less_than type_decl greater_than\r\n    // multisampled_texture_type less_than type_decl greater_than\r\n    if (this._match(TokenTypes.sampled_texture_type) ||\r\n      this._match(TokenTypes.multisampled_texture_type)) {\r\n      const sampler = this._previous();\r\n      this._consume(\r\n        TokenTypes.tokens.less_than,\r\n        \"Expected '<' for sampler type.\"\r\n      );\r\n      const format = this._type_decl();\r\n      this._consume(TokenTypes.tokens.greater_than, \"Expected '>' for sampler type.\");\r\n      return this._updateNode(new AST.SamplerType(sampler.toString(), format, null));\r\n    }\r\n\r\n    // storage_texture_type less_than texel_format comma access_mode greater_than\r\n    if (this._match(TokenTypes.storage_texture_type)) {\r\n      const sampler = this._previous();\r\n      this._consume(TokenTypes.tokens.less_than, \"Expected '<' for sampler type.\");\r\n      const format = this._consume(TokenTypes.texel_format, \"Invalid texel format.\").toString();\r\n      this._consume(TokenTypes.tokens.comma, \"Expected ',' after texel format.\");\r\n      const access = this._consume(TokenTypes.access_mode, \"Expected access mode for storage texture type.\").toString();\r\n      this._consume(TokenTypes.tokens.greater_than, \"Expected '>' for sampler type.\");\r\n      return this._updateNode(new AST.SamplerType(sampler.toString(), format, access));\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  _attribute(): AST.Attribute[] | null {\r\n    // attr ident paren_left (literal_or_ident comma)* literal_or_ident paren_right\r\n    // attr ident\r\n\r\n    let attributes: AST.Attribute[] = [];\r\n\r\n    while (this._match(TokenTypes.tokens.attr)) {\r\n      const name = this._consume(\r\n        TokenTypes.attribute_name,\r\n        \"Expected attribute name\"\r\n      );\r\n      const attr = this._updateNode(new AST.Attribute(name.toString(), null));\r\n      if (this._match(TokenTypes.tokens.paren_left)) {\r\n        // literal_or_ident\r\n        attr.value = this._consume(TokenTypes.literal_or_ident, \"Expected attribute value\").toString();\r\n        if (this._check(TokenTypes.tokens.comma)) {\r\n          this._advance();\r\n          do {\r\n            const v = this._consume(TokenTypes.literal_or_ident, \"Expected attribute value\").toString();\r\n            if (!(attr.value instanceof Array)) {\r\n              attr.value = [attr.value as string];\r\n            }\r\n            attr.value.push(v);\r\n          } while (this._match(TokenTypes.tokens.comma));\r\n        }\r\n        this._consume(TokenTypes.tokens.paren_right, \"Expected ')'\");\r\n      }\r\n      attributes.push(attr);\r\n    }\r\n\r\n    if (attributes.length == 0) {\r\n      return null;\r\n    }\r\n\r\n    return attributes;\r\n  }\r\n}\r\n", "import { WgslParser } from \"./wgsl_parser.js\";\r\nimport { Reflect } from \"./reflect/reflect.js\";\r\n\r\nexport * from \"./reflect/info.js\";\r\n\r\nexport class WgslReflect extends Reflect {\r\n  constructor(code?: string) {\r\n    super();\r\n    if (code) {\r\n      this.update(code);\r\n    }\r\n  }\r\n\r\n  update(code: string): void {\r\n    const parser = new WgslParser();\r\n    const ast = parser.parse(code);\r\n    this.updateAST(ast);\r\n  }\r\n}\r\n", "import { Node, CallExpr, Continue, Expression, Break } from \"../wgsl_ast.js\";\n\nexport class Command {\n    get line(): number { return -1; }\n}\n\nexport class StatementCommand extends Command {\n    node: Node;\n\n    constructor(node: Node) {\n        super();\n        this.node = node;\n    }\n\n    get line(): number { return this.node.line; }\n}\n\nexport class CallExprCommand extends Command {\n    node: CallExpr;\n    statement: Node;\n\n    constructor(node: CallExpr, statement: Node) {\n        super();\n        this.node = node;\n        this.statement = statement;\n    }\n\n    get line(): number { return this.statement.line; }\n}\n\nexport class ContinueTargetCommand extends Command {\n    id: number;\n\n    constructor(id: number) {\n        super();\n        this.id = id;\n    }\n}\n\nexport class BreakTargetCommand extends Command {\n    id: number;\n\n    constructor(id: number) {\n        super();\n        this.id = id;\n    }\n}\n\nexport class ContinueCommand extends Command {\n    id: number;\n    node: Continue;\n\n    constructor(id: number, node: Continue) {\n        super();\n        this.id = id;\n        this.node = node;\n    }\n\n    get line(): number { return this.node.line; }\n}\n\nexport class BreakCommand extends Command {\n    id: number;\n    condition: Expression | null;\n    node: Break;\n\n    constructor(id: number, condition: Expression | null, node: Break) {\n        super();\n        this.id = id;\n        this.condition = condition;\n        this.node = node;\n    }\n\n    get line(): number { return this.node.line; }\n}\n\n\nexport class GotoCommand extends Command {\n    condition: Node | null;\n    position: number;\n    lineNo: number = -1;\n\n    constructor(condition: Node | null, position: number, line: number) {\n        super();\n        this.condition = condition;\n        this.position = position;\n        this.lineNo = line;\n    }\n\n    get line(): number {\n        return this.condition?.line ?? this.lineNo;\n    }\n}\n\nexport class BlockCommand extends Command {\n    statements: Array<Node> = [];\n\n    constructor(statements: Array<Node>) {\n      super();\n      this.statements = statements;\n    }\n\n    get line(): number {\n      return this.statements.length > 0 ? this.statements[0].line : -1;\n    }\n}\n", "import { Command } from \"./command.js\";\r\nimport { CallExpr } from \"../wgsl_ast.js\";\r\nimport { ExecContext } from \"./exec_context.js\";\r\n\r\nexport class StackFrame {\r\n    parent: StackFrame | null = null;\r\n    context: ExecContext;\r\n    commands: Command[] = [];\r\n    current: number = 0;\r\n    parentCallExpr: CallExpr | null = null;\r\n\r\n    constructor(context: ExecContext, parent?: StackFrame) {\r\n        this.context = context;\r\n        this.parent = parent ?? null;\r\n    }\r\n\r\n    get isAtEnd(): boolean { return this.current >= this.commands.length; }\r\n\r\n    getNextCommand(): Command | null {\r\n        if (this.current >= this.commands.length) {\r\n            return null;\r\n        }\r\n        const command = this.commands[this.current];\r\n        this.current++;\r\n        return command;\r\n    }\r\n\r\n    getCurrentCommand(): Command | null {\r\n        if (this.current >= this.commands.length) {\r\n            return null;\r\n        }\r\n        return this.commands[this.current];\r\n    }\r\n}\r\n", "import { StackFrame } from \"./stack_frame.js\";\r\n\r\nexport class ExecStack {\r\n    states: StackFrame[] = [];\r\n\r\n    get isEmpty(): boolean { return this.states.length == 0; }\r\n\r\n    get last(): StackFrame | null { return this.states[this.states.length - 1] ?? null; }\r\n\r\n    pop(): void {\r\n        this.states.pop();\r\n    }\r\n}\r\n", "import * as AST from \"./wgsl_ast.js\";\r\nimport { WgslExec } from \"./wgsl_exec.js\";\r\nimport { WgslParser } from \"./wgsl_parser.js\";\r\nimport { ExecContext, FunctionRef } from \"./exec/exec_context.js\";\r\nimport { Command, StatementCommand, CallExprCommand, GotoCommand, BlockCommand,\r\n        ContinueTargetCommand, ContinueCommand, BreakCommand, BreakTargetCommand } from \"./exec/command.js\";\r\nimport { StackFrame } from \"./exec/stack_frame.js\";\r\nimport { ExecStack } from \"./exec/exec_stack.js\";\r\nimport { ScalarData, VectorData, MatrixData, TextureData, TypedData, VoidData } from \"./wgsl_ast.js\";\r\n\r\ntype RuntimeStateCallbackType = () => void;\r\n\r\nexport class WgslDebug {\r\n    _code: string;\r\n    _exec: WgslExec;\r\n    _execStack: ExecStack;\r\n    _dispatchId: number[];\r\n    _runTimer: any = null;\r\n    breakpoints: Set<number> = new Set();\r\n    runStateCallback: RuntimeStateCallbackType | null = null;\r\n\r\n    constructor(code: string, runStateCallback?: RuntimeStateCallbackType) {\r\n        this._code = code;\r\n        const parser = new WgslParser();\r\n        const ast = parser.parse(code);\r\n        this._exec = new WgslExec(ast);\r\n        this.runStateCallback = runStateCallback ?? null\r\n    }\r\n\r\n    getVariableValue(name: string): number | number[] | null {\r\n        const context = this.context;\r\n        const v = context.getVariable(name)?.value ?? null;\r\n        if (v === null) {\r\n            return null;\r\n        }\r\n        if (v instanceof ScalarData) {\r\n            return v.value;\r\n        }\r\n        if (v instanceof VectorData) {\r\n            return Array.from(v.data);\r\n        }\r\n        if (v instanceof MatrixData) {\r\n            return Array.from(v.data);\r\n        }\r\n        console.error(`Unsupported return variable type ${v.typeInfo.name}`);\r\n        return null;\r\n    }\r\n\r\n    reset(): void {\r\n        this._exec = new WgslExec(this._exec.ast);\r\n        this.startDebug();\r\n    }\r\n\r\n    startDebug(): void {\r\n        this._execStack = new ExecStack();\r\n        const state = this._createState(this._exec.ast, this._exec.context);\r\n        this._execStack.states.push(state);\r\n    }\r\n\r\n    get context(): ExecContext {\r\n        const state = this.currentState;\r\n        if (state === null) {\r\n            return this._exec.context;\r\n        }\r\n        return state.context;\r\n    }\r\n\r\n    get currentState(): StackFrame | null {\r\n        while (true) {\r\n            if (this._execStack.isEmpty) {\r\n                return null;\r\n            }\r\n\r\n            let state = this._execStack.last;\r\n            if (state === null) {\r\n                return null;\r\n            }\r\n\r\n            if (state.isAtEnd) {\r\n                this._execStack.pop();\r\n                if (this._execStack.isEmpty) {\r\n                    return null;\r\n                }\r\n                state = this._execStack.last;\r\n            }\r\n\r\n            return state;\r\n        }\r\n    }\r\n\r\n    get currentCommand(): Command | null {\r\n        while (true) {\r\n            if (this._execStack.isEmpty) {\r\n                return null;\r\n            }\r\n\r\n            let state = this._execStack.last;\r\n            if (state === null) {\r\n                return null;\r\n            }\r\n\r\n            if (state.isAtEnd) {\r\n                this._execStack.pop();\r\n                if (this._execStack.isEmpty) {\r\n                    return null;\r\n                }\r\n                state = this._execStack.last;\r\n            }\r\n\r\n            const command = state.getCurrentCommand();\r\n            if (command === null) {\r\n                continue;\r\n            }\r\n\r\n            return command;\r\n        }\r\n    }\r\n\r\n    toggleBreakpoint(line: number) {\r\n        if (this.breakpoints.has(line)) {\r\n            this.breakpoints.delete(line);\r\n        } else {\r\n            this.breakpoints.add(line);\r\n        }\r\n    }\r\n\r\n    clearBreakpoints() {\r\n        this.breakpoints.clear();\r\n    }\r\n\r\n    get isRunning() {\r\n        return this._runTimer !== null;\r\n    }\r\n\r\n    run() {\r\n        if (this.isRunning) {\r\n            return;\r\n        }\r\n        this._runTimer = setInterval(() => {\r\n            const command = this.currentCommand;\r\n            if (command) {\r\n                if (this.breakpoints.has(command.line)) {\r\n                    clearInterval(this._runTimer!);\r\n                    this._runTimer = null;\r\n                    if (this.runStateCallback !== null) {\r\n                        this.runStateCallback();\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n            if (!this.stepNext(true)) {\r\n                clearInterval(this._runTimer!);\r\n                this._runTimer = null;\r\n                if (this.runStateCallback !== null) {\r\n                    this.runStateCallback();\r\n                }\r\n            }\r\n        }, 0);\r\n        if (this.runStateCallback !== null) {\r\n            this.runStateCallback();\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this._runTimer !== null) {\r\n            clearInterval(this._runTimer);\r\n            this._runTimer = null;\r\n            if (this.runStateCallback !== null) {\r\n                this.runStateCallback();\r\n            }\r\n        }\r\n    }\r\n\r\n    _setOverrides(constants: Object, context: ExecContext): void {\r\n        for (const k in constants) {\r\n            const v = constants[k];\r\n            const override = this._exec.reflection.getOverrideInfo(k);\r\n            if (override !== null) {\r\n                if (override.type === null) {\r\n                    override.type = this._exec.getTypeInfo(\"u32\");\r\n                }\r\n                if (override.type.name === \"u32\" || override.type.name === \"i32\" || override.type.name === \"f32\" || override.type.name === \"f16\") {\r\n                    context.setVariable(k, new ScalarData(v, override.type));\r\n                } else if (override.type.name === \"bool\") {\r\n                    context.setVariable(k, new ScalarData(v ? 1 : 0, override.type));\r\n                } else if (override.type.name === \"vec2\" || override.type.name === \"vec3\" || override.type.name === \"vec4\" ||\r\n                    override.type.name === \"vec2f\" || override.type.name === \"vec3f\" || override.type.name === \"vec4f\" ||\r\n                    override.type.name === \"vec2i\" || override.type.name === \"vec3i\" || override.type.name === \"vec4i\" ||\r\n                    override.type.name === \"vec2u\" || override.type.name === \"vec3u\" || override.type.name === \"vec4u\" ||\r\n                    override.type.name === \"vec2h\" || override.type.name === \"vec3h\" || override.type.name === \"vec4h\") {\r\n                    context.setVariable(k, new VectorData(v, override.type));\r\n                } else {\r\n                    console.error(`Invalid constant type for ${k}`);\r\n                }\r\n            } else {\r\n                console.error(`Override ${k} does not exist in the shader.`);\r\n            }\r\n        }\r\n    }\r\n\r\n    debugWorkgroup(kernel: string, dispatchId: number[], \r\n        dispatchCount: number | number[], bindGroups: Object, config?: Object): boolean {\r\n\r\n        this._execStack = new ExecStack();\r\n\r\n        const context = this._exec.context;\r\n        context.currentFunctionName = kernel;\r\n\r\n        this._dispatchId = dispatchId;\r\n\r\n        config = config ?? {};\r\n        if (config[\"constants\"]) {\r\n            this._setOverrides(config[\"constants\"], context);\r\n        }\r\n\r\n        // Use this to debug the top level statements, otherwise call _execStatements.\r\n        /*const state = new _ExecState(this._exec.context);\r\n        this._execStack.states.push(state);\r\n        for (const statement of this._exec.ast) {\r\n            state.commands.push(new Command(CommandType.Statement, statement));\r\n        }*/\r\n        this._exec._execStatements(this._exec.ast, context);\r\n\r\n        const kernelFn = context.getFunction(kernel);\r\n        if (!kernelFn) {\r\n            console.error(`Function ${kernel} not found`);\r\n            return false;\r\n        }\r\n\r\n        const kernelRefl = this._exec.reflection.getFunctionInfo(kernel);\r\n\r\n        if (typeof dispatchCount === \"number\") {\r\n            dispatchCount = [dispatchCount, 1, 1];\r\n        } else if (dispatchCount.length === 0) {\r\n            console.error(`Invalid dispatch count`);\r\n            return false;\r\n        } else if (dispatchCount.length === 1) {\r\n            dispatchCount = [dispatchCount[0], 1, 1];\r\n        } else if (dispatchCount.length === 2) {\r\n            dispatchCount = [dispatchCount[0], dispatchCount[1], 1];\r\n        } else if (dispatchCount.length > 3) {\r\n            dispatchCount = [dispatchCount[0], dispatchCount[1], dispatchCount[2]];\r\n        }\r\n\r\n        const depth = dispatchCount[2];\r\n        const height = dispatchCount[1];\r\n        const width = dispatchCount[0];\r\n\r\n        const vec3u = this._exec.typeInfo[\"vec3u\"];\r\n        context.setVariable(\"@num_workgroups\", new VectorData(dispatchCount, vec3u));\r\n\r\n        for (const set in bindGroups) {\r\n            for (const binding in bindGroups[set]) {\r\n                const entry = bindGroups[set][binding];\r\n\r\n                context.variables.forEach((v) => {\r\n                    const node = v.node;\r\n                    if (node?.attributes) {\r\n                        let b = null;\r\n                        let s = null;\r\n                        for (const attr of node.attributes) {\r\n                            if (attr.name === \"binding\") {\r\n                                b = attr.value;\r\n                            } else if (attr.name === \"group\") {\r\n                                s = attr.value;\r\n                            }\r\n                        }\r\n                        if (binding == b && set == s) {\r\n                            let found = false;\r\n                            for (const resource of kernelRefl.resources) {\r\n                                if (resource.name === v.name && resource.group === parseInt(set) && resource.binding === parseInt(binding)) {\r\n                                    found = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            if (found) {\r\n                                if (entry.texture !== undefined && entry.descriptor !== undefined) {\r\n                                    // Texture\r\n                                    const textureData = new TextureData(entry.texture, this._exec.getTypeInfo(node.type), entry.descriptor,\r\n                                                                        entry.texture.view ?? null);\r\n                                    v.value = textureData;\r\n                                } else if (entry.uniform !== undefined) {\r\n                                    // Uniform buffer\r\n                                    v.value = new TypedData(entry.uniform, this._exec.getTypeInfo(node.type));\r\n                                } else {\r\n                                    // Storage buffer\r\n                                    v.value = new TypedData(entry, this._exec.getTypeInfo(node.type));\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        let found = false;\r\n        for (let z = 0; z < depth && !found; ++z) {\r\n            for (let y = 0; y < height && !found; ++y) {\r\n                for (let x = 0; x < width && !found; ++x) {\r\n                    context.setVariable(\"@workgroup_id\", new VectorData([x, y, z], vec3u));\r\n                    if (this._dispatchWorkgroup(kernelFn, [x, y, z], context)) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return found;\r\n    }\r\n\r\n    _shouldExecuteNextCommand(): boolean {\r\n        const command = this.currentCommand;\r\n        if (command === null) {\r\n            return false;\r\n        }\r\n        if (command instanceof GotoCommand) {\r\n            if (command.condition === null) {\r\n                return true;\r\n            }\r\n        } else if (command instanceof ContinueTargetCommand || command instanceof BreakTargetCommand) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    stepInto() {\r\n        if (this.isRunning) {\r\n            return;\r\n        }\r\n        this.stepNext(true);\r\n    }\r\n\r\n    stepOver() {\r\n        if (this.isRunning) {\r\n            return;\r\n        }\r\n        this.stepNext(false);\r\n    }\r\n\r\n    stepOut() {\r\n        const state = this.currentState;\r\n        if (state === null) {\r\n            return;\r\n        }\r\n        const parentState = state.parent;\r\n\r\n        if (this.isRunning) {\r\n            clearInterval(this._runTimer);\r\n            this._runTimer = null;\r\n        }\r\n\r\n        this._runTimer = setInterval(() => {\r\n            const command = this.currentCommand;\r\n            if (command) {\r\n                if (this.breakpoints.has(command.line)) {\r\n                    clearInterval(this._runTimer!);\r\n                    this._runTimer = null;\r\n                    if (this.runStateCallback !== null) {\r\n                        this.runStateCallback();\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n            if (!this.stepNext(true)) {\r\n                clearInterval(this._runTimer!);\r\n                this._runTimer = null;\r\n                if (this.runStateCallback !== null) {\r\n                    this.runStateCallback();\r\n                }\r\n            }\r\n\r\n            const state = this.currentState;\r\n            if (state === parentState) {\r\n                clearInterval(this._runTimer!);\r\n                this._runTimer = null;\r\n                if (this.runStateCallback !== null) {\r\n                    this.runStateCallback();\r\n                }\r\n            }\r\n        }, 0);\r\n        if (this.runStateCallback !== null) {\r\n            this.runStateCallback();\r\n        }\r\n    }\r\n\r\n    // Returns true if execution is not finished, false if execution is complete.\r\n    stepNext(stepInto = true): boolean {\r\n        if (!this._execStack) {\r\n            this._execStack = new ExecStack();\r\n            const state = this._createState(this._exec.ast, this._exec.context);\r\n            this._execStack.states.push(state);\r\n        }\r\n\r\n        while (true) {\r\n            if (this._execStack.isEmpty) {\r\n                return false;\r\n            }\r\n\r\n            let state = this._execStack.last;\r\n            if (state === null) {\r\n                return false;\r\n            }\r\n\r\n            if (state.isAtEnd) {\r\n                this._execStack.pop();\r\n                if (this._execStack.isEmpty) {\r\n                    return false;\r\n                }\r\n                state = this._execStack.last;\r\n            }\r\n\r\n            const command = state!.getNextCommand();\r\n            if (command === null) {\r\n                continue;\r\n            }\r\n\r\n            if (stepInto && command instanceof CallExprCommand) {\r\n                const node = command.node;\r\n                const fn = state.context.getFunction(node.name);\r\n                if (!fn) {\r\n                    continue; // it's not a custom function, step over it\r\n                }\r\n                const fnState = this._createState(fn.node.body, state.context.clone(), state);\r\n\r\n                for (let ai = 0; ai < fn.node.args.length; ++ai) {\r\n                    const arg = fn.node.args[ai];\r\n                    const value = this._exec.evalExpression(node.args[ai], fnState.context);\r\n                    fnState.context.createVariable(arg.name, value, arg);\r\n                }\r\n\r\n                fnState.parentCallExpr = node;\r\n                this._execStack.states.push(fnState);\r\n                fnState.context.currentFunctionName = fn.name;\r\n\r\n                if (this._shouldExecuteNextCommand()) {\r\n                    continue;\r\n                }\r\n                return true;\r\n            } else if (command instanceof StatementCommand) {\r\n                const node = command.node;\r\n                if (stepInto && node instanceof AST.Call) {\r\n                    const fn = state.context.getFunction(node.name);\r\n                    // We want to step into custom functions, not directly execute them\r\n                    if (fn) {\r\n                        const fnState = this._createState(fn.node.body, state.context.clone(), state);\r\n\r\n                        for (let ai = 0; ai < fn.node.args.length; ++ai) {\r\n                            const arg = fn.node.args[ai];\r\n                            const value = this._exec.evalExpression(node.args[ai], fnState.context);\r\n                            fnState.context.createVariable(arg.name, value, arg);\r\n                        }\r\n\r\n                        this._execStack.states.push(fnState);\r\n                        fnState.context.currentFunctionName = fn.name;\r\n\r\n                        if (this._shouldExecuteNextCommand()) {\r\n                            continue;\r\n                        }\r\n                        return true;\r\n                    }\r\n                }\r\n\r\n                const res = this._exec.execStatement(node, state.context);\r\n                if (res !== null && res !== undefined && !(res instanceof VoidData)) {\r\n                    let s = state;\r\n                    // Find the CallExpr to store the return value in.\r\n                    while (s) {\r\n                        if (s.parentCallExpr) {\r\n                            s.parentCallExpr.setCachedReturnValue(res);\r\n                            break;\r\n                        }\r\n                        s = s.parent;\r\n                    }\r\n                    if (s === null) {\r\n                        console.error(\"Could not find CallExpr to store return value in\");\r\n                    }\r\n                    if (this._shouldExecuteNextCommand()) {\r\n                        continue;\r\n                    }\r\n                    return true;\r\n                }\r\n            } else if (command instanceof ContinueTargetCommand) {\r\n                continue;\r\n            } else if (command instanceof BreakTargetCommand) {\r\n                continue;\r\n            } else if (command instanceof ContinueCommand) {\r\n                const targetId = command.id;\r\n                while (!this._execStack.isEmpty) {\r\n                    state = this._execStack.last;\r\n                    for (let i = state.commands.length - 1; i >= 0; --i) {\r\n                        const cmd = state.commands[i];\r\n                        if (cmd instanceof ContinueTargetCommand) {\r\n                            if (cmd.id === targetId) {\r\n                                state.current = i + 1;\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    // No Goto -1 found (loop), pop the current state and continue searching.\r\n                    this._execStack.pop();\r\n                }\r\n                // If we got here, we've reached the end of the stack and didn't find a -1.\r\n                // That means a continue was used outside of a loop, so we're done.\r\n                console.error(\"Continue statement used outside of a loop\");\r\n                return false;\r\n            } else if (command instanceof BreakCommand) {\r\n                const targetId = command.id;\r\n                // break-if conditional break \r\n                if (command.condition) {\r\n                    const res = this._exec.evalExpression(command.condition, state.context);\r\n                    if (!(res instanceof ScalarData)) {\r\n                        console.error(\"Condition must be a scalar\");\r\n                        return false;\r\n                    }\r\n                    // If the condition is false, then we should not the break.\r\n                    if (!res.value) {\r\n                        if (this._shouldExecuteNextCommand()) {\r\n                            continue;\r\n                        }\r\n                        return true;\r\n                    }\r\n                }\r\n\r\n                while (!this._execStack.isEmpty) {\r\n                    state = this._execStack.last;\r\n                    for (let i = state.commands.length - 1; i >= 0; --i) {\r\n                        const cmd = state.commands[i];\r\n                        if (cmd instanceof BreakTargetCommand) {\r\n                            if (cmd.id === targetId) {\r\n                                state.current = i + 1;\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    // No Goto -2 found (loop), pop the current state and continue searching.\r\n                    this._execStack.pop();\r\n                }\r\n                // If we got here, we've reached the end of the stack and didn't find a BreakTarget.\r\n                // That means a break was used outside of a loop, so we're done.\r\n                console.error(\"Break statement used outside of a loop\");\r\n                return false;\r\n            } else if (command instanceof GotoCommand) {\r\n                if (command.condition) {\r\n                    const res = this._exec.evalExpression(command.condition, state.context);\r\n                    if (!(res instanceof ScalarData)) {\r\n                        console.error(\"Condition must be a scalar\");\r\n                        return false;\r\n                    }\r\n                    // If the GOTO condition value is true, then continue to the next command.\r\n                    // Otherwise, jump to the specified position.\r\n                    if (res.value) {\r\n                        if (this._shouldExecuteNextCommand()) {\r\n                            continue;\r\n                        }\r\n                        return true;\r\n                    }\r\n                }\r\n                state.current = command.position;\r\n                if (this._shouldExecuteNextCommand()) {\r\n                    continue;\r\n                }\r\n                return true;\r\n            } else if (command instanceof BlockCommand) {\r\n                const blockState = this._createState(command.statements, state.context.clone(), state);\r\n                this._execStack.states.push(blockState);\r\n                continue; // step into the first statement of the block\r\n            }\r\n\r\n            if (state.isAtEnd) {\r\n                this._execStack.pop();\r\n                if (this._execStack.isEmpty) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            if (this._shouldExecuteNextCommand()) {\r\n                continue;\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n\r\n    _dispatchWorkgroup(f: FunctionRef, workgroup_id: number[], context: ExecContext): boolean {\r\n        const workgroupSize = [1, 1, 1];\r\n        for (const attr of f.node.attributes) {\r\n            if (attr.name === \"workgroup_size\") {\r\n                if (Array.isArray(attr.value)) {\r\n                    if (attr.value.length > 0) {\r\n                        // The value could be an override constant\r\n                        const v = context.getVariableValue(attr.value[0]);\r\n                        if (v instanceof ScalarData) {\r\n                            workgroupSize[0] = v.value;\r\n                        } else {\r\n                            workgroupSize[0] = parseInt(attr.value[0]);\r\n                        }\r\n                    }\r\n                    if (attr.value.length > 1) {\r\n                        const v = context.getVariableValue(attr.value[1]);\r\n                        if (v instanceof ScalarData) {\r\n                            workgroupSize[1] = v.value;\r\n                        } else {\r\n                            workgroupSize[1] = parseInt(attr.value[1]);\r\n                        }\r\n                    }\r\n                    if (attr.value.length > 2) {\r\n                        const v = context.getVariableValue(attr.value[2]);\r\n                        if (v instanceof ScalarData) {\r\n                            workgroupSize[2] = v.value;\r\n                        } else {\r\n                            workgroupSize[2] = parseInt(attr.value[2]);\r\n                        }\r\n                    }\r\n                } else {\r\n                    const v = context.getVariableValue(attr.value);\r\n                    if (v instanceof ScalarData) {\r\n                        workgroupSize[0] = v.value;\r\n                    } else if (v instanceof VectorData) {\r\n                        workgroupSize[0] = v.data[0];\r\n                        workgroupSize[1] = v.data.length > 1 ? v.data[1] : 1;\r\n                        workgroupSize[2] = v.data.length > 2 ? v.data[2] : 1;\r\n                    } else {\r\n                        workgroupSize[0] = parseInt(attr.value);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        const vec3u = this._exec.typeInfo[\"vec3u\"];\r\n        const u32 = this._exec.typeInfo[\"u32\"];\r\n        context.setVariable(\"@workgroup_size\", new VectorData(workgroupSize, vec3u));\r\n\r\n        const width = workgroupSize[0];\r\n        const height = workgroupSize[1];\r\n        const depth = workgroupSize[2];\r\n\r\n        let found = false;\r\n        for (let z = 0, li = 0; z < depth && !found; ++z) {\r\n            for (let y = 0; y < height && !found; ++y) {\r\n                for (let x = 0; x < width && !found; ++x, ++li) {\r\n                    const local_invocation_id = [x, y, z];\r\n                    const global_invocation_id = [\r\n                        x + workgroup_id[0] * workgroupSize[0],\r\n                        y + workgroup_id[1] * workgroupSize[1],\r\n                        z + workgroup_id[2] * workgroupSize[2]];\r\n\r\n                    context.setVariable(\"@local_invocation_id\", new VectorData(local_invocation_id, vec3u));\r\n                    context.setVariable(\"@global_invocation_id\", new VectorData(global_invocation_id, vec3u));\r\n                    context.setVariable(\"@local_invocation_index\", new ScalarData(li, u32));\r\n\r\n                    if (global_invocation_id[0] === this._dispatchId[0] &&\r\n                        global_invocation_id[1] === this._dispatchId[1] &&\r\n                        global_invocation_id[2] === this._dispatchId[2]) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (found) {\r\n            this._dispatchExec(f, context);\r\n        }\r\n\r\n        return found;\r\n    }\r\n\r\n    _dispatchExec(f: FunctionRef, context: ExecContext) {\r\n        // Update any built-in input args.\r\n        // TODO: handle input structs.\r\n        for (const arg of f.node.args) {\r\n            for (const attr of arg.attributes) {\r\n                if (attr.name === \"builtin\") {\r\n                    const globalName = `@${attr.value}`;\r\n                    const globalVar = context.getVariable(globalName);\r\n                    if (globalVar !== null) {\r\n                        context.variables.set(arg.name, globalVar);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        const state = this._createState(f.node.body, context);\r\n        this._execStack.states.push(state);\r\n    }\r\n\r\n    _createState(ast: AST.Node[], context: ExecContext, parent?: StackFrame): StackFrame {\r\n        const state = new StackFrame(context, parent ?? null);\r\n\r\n        for (const statement of ast) {\r\n            // A statement may have expressions that include function calls.\r\n            // Gather all of the internal function calls from the statement.\r\n            // We can then include them as commands to step through, storing their\r\n            // values with the call node so that when it is evaluated, it uses that\r\n            // already computed value. This allows us to step into the function\r\n            if (statement instanceof AST.Let ||\r\n                statement instanceof AST.Var ||\r\n                statement instanceof AST.Const ||\r\n                statement instanceof AST.Assign) {\r\n                const functionCalls = [];\r\n                this._collectFunctionCalls(statement.value, functionCalls);\r\n                for (const call of functionCalls) {\r\n                    state.commands.push(new CallExprCommand(call, statement));\r\n                }\r\n                state.commands.push(new StatementCommand(statement));\r\n            } else if (statement instanceof AST.Call) {\r\n                const functionCalls = [];\r\n                for (const arg of statement.args) {\r\n                    this._collectFunctionCalls(arg, functionCalls);\r\n                }\r\n                for (const call of functionCalls) {\r\n                    state.commands.push(new CallExprCommand(call, statement));\r\n                }\r\n                state.commands.push(new StatementCommand(statement));\r\n            } else if (statement instanceof AST.Return) {\r\n                const functionCalls = [];\r\n                this._collectFunctionCalls(statement.value, functionCalls);\r\n                for (const call of functionCalls) {\r\n                    state.commands.push(new CallExprCommand(call, statement));\r\n                }\r\n                state.commands.push(new StatementCommand(statement));\r\n            } else if (statement instanceof AST.Increment) {\r\n                state.commands.push(new StatementCommand(statement));\r\n            } else if (statement instanceof AST.Function) {\r\n                const f = new FunctionRef(statement);\r\n                state.context.functions.set(statement.name, f);\r\n                continue;\r\n            } else if (statement instanceof AST.If) {\r\n                const functionCalls = [];\r\n                this._collectFunctionCalls(statement.condition, functionCalls);\r\n                for (const call of functionCalls) {\r\n                    state.commands.push(new CallExprCommand(call, statement));\r\n                }\r\n\r\n                let conditionCmd = new GotoCommand(statement.condition, 0, statement.line);\r\n                state.commands.push(conditionCmd);\r\n                if (statement.body.length > 0) {\r\n                    state.commands.push(new BlockCommand(statement.body));\r\n                }\r\n                const gotoEnd = new GotoCommand(null, 0, statement.line);\r\n                state.commands.push(gotoEnd);\r\n\r\n                for (const elseIf of statement.elseif) {\r\n                    conditionCmd.position = state.commands.length;\r\n\r\n                    const functionCalls = [];\r\n                    this._collectFunctionCalls(elseIf.condition, functionCalls);\r\n                    for (const call of functionCalls) {\r\n                        state.commands.push(new CallExprCommand(call, statement));\r\n                    }\r\n\r\n                    conditionCmd = new GotoCommand(elseIf.condition, 0, elseIf.line);\r\n                    state.commands.push(conditionCmd);\r\n                    if (elseIf.body.length > 0) {\r\n                        state.commands.push(new BlockCommand(elseIf.body));\r\n                    }\r\n                    state.commands.push(gotoEnd);\r\n                }\r\n\r\n                conditionCmd.position = state.commands.length;\r\n                if (statement.else) {\r\n                    state.commands.push(new BlockCommand(statement.else));\r\n                }\r\n\r\n                gotoEnd.position = state.commands.length;\r\n            } else if (statement instanceof AST.Switch) {\r\n                const functionCalls = [];\r\n                this._collectFunctionCalls(statement.condition, functionCalls);\r\n                for (const call of functionCalls) {\r\n                    state.commands.push(new CallExprCommand(call, statement));\r\n                }\r\n\r\n                let defaultCase: AST.SwitchCase | null = null;\r\n                for (const c of statement.cases) {\r\n                    if (c instanceof AST.Default) {\r\n                        defaultCase = c;\r\n                        break;\r\n                    } else if (c instanceof AST.Case) {\r\n                        for (const selector of c.selectors) {\r\n                            if (selector instanceof AST.DefaultSelector) {\r\n                                defaultCase = c;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                const gotoEndCommands: GotoCommand[] = [];\r\n\r\n                for (const c of statement.cases) {\r\n                    if (c === defaultCase) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (!(c instanceof AST.Case)) {\r\n                        continue;\r\n                    }\r\n\r\n                    let lastCondition = null;\r\n                    for (const selector of c.selectors) {\r\n                        let conditionExpr = new AST.BinaryOperator(\"==\", statement.condition, selector);\r\n                        if (lastCondition) {\r\n                            conditionExpr = new AST.BinaryOperator(\"||\", lastCondition, conditionExpr);\r\n                        }\r\n                        lastCondition = conditionExpr;\r\n                    }\r\n\r\n                    const gotoCommand = new GotoCommand(lastCondition, 0, c.line);\r\n                    state.commands.push(gotoCommand);\r\n\r\n                    if (c.body.length > 0) {\r\n                        state.commands.push(new BlockCommand(c.body));\r\n                    }\r\n\r\n                    const gotoEndCommand = new GotoCommand(null, 0, c.line);\r\n                    gotoEndCommands.push(gotoEndCommand);\r\n                    state.commands.push(gotoEndCommand);\r\n\r\n                    gotoCommand.position = state.commands.length;\r\n                }\r\n\r\n                if (defaultCase) {\r\n                    state.commands.push(new BlockCommand(defaultCase.body));\r\n                }\r\n\r\n                state.commands.push(new BreakTargetCommand(statement.id));\r\n\r\n                const commandPos = state.commands.length;\r\n                for (let i = 0; i < gotoEndCommands.length; ++i) {\r\n                    gotoEndCommands[i].position = commandPos;\r\n                }\r\n            } else if (statement instanceof AST.While) {\r\n                const functionCalls = [];\r\n                state.commands.push(new ContinueTargetCommand(statement.id));\r\n                this._collectFunctionCalls(statement.condition, functionCalls);\r\n                for (const call of functionCalls) {\r\n                    state.commands.push(new CallExprCommand(call, statement));\r\n                }\r\n                const conditionCmd = new GotoCommand(statement.condition, 0, statement.line);\r\n                state.commands.push(conditionCmd);\r\n                let lastLine = statement.line;\r\n\r\n                if (statement.body.length > 0) {\r\n                    state.commands.push(new BlockCommand(statement.body));\r\n                    lastLine = statement.body[statement.body.length - 1].line;\r\n                }\r\n\r\n                state.commands.push(new GotoCommand(statement.condition, 0, lastLine));\r\n                state.commands.push(new BreakTargetCommand(statement.id));\r\n                conditionCmd.position = state.commands.length;\r\n            } else if (statement instanceof AST.For) {\r\n                if (statement.init) {\r\n                    state.commands.push(new StatementCommand(statement.init));\r\n                }\r\n\r\n                let conditionPos = state.commands.length;\r\n\r\n                if (statement.increment === null) {\r\n                    state.commands.push(new ContinueTargetCommand(statement.id));\r\n                }\r\n                let conditionCmd = null;\r\n                if (statement.condition) {\r\n                    const functionCalls = [];\r\n                    this._collectFunctionCalls(statement.condition!, functionCalls);\r\n                    for (const call of functionCalls) {\r\n                        state.commands.push(new CallExprCommand(call, statement));\r\n                    }\r\n                    conditionCmd = new GotoCommand(statement.condition, 0, statement.line);\r\n                    state.commands.push(conditionCmd);\r\n                }\r\n\r\n                let lastLine = statement.line;\r\n                if (statement.body.length > 0) {\r\n                    state.commands.push(new BlockCommand(statement.body));\r\n                    lastLine = statement.body[statement.body.length - 1].line;\r\n                }\r\n\r\n                if (statement.increment) {\r\n                    state.commands.push(new ContinueTargetCommand(statement.id));\r\n                    state.commands.push(new StatementCommand(statement.increment));\r\n                }\r\n                state.commands.push(new GotoCommand(null, conditionPos, lastLine));\r\n                state.commands.push(new BreakTargetCommand(statement.id));\r\n                conditionCmd.position = state.commands.length;\r\n            } else if (statement instanceof AST.Loop) {\r\n                let loopStartPos = state.commands.length;\r\n                if (!statement.continuing) {\r\n                    state.commands.push(new ContinueTargetCommand(statement.id));\r\n                }\r\n                let lastLine = statement.line;\r\n                if (statement.body.length > 0) {\r\n                    state.commands.push(new BlockCommand(statement.body));\r\n                    lastLine = statement.body[statement.body.length - 1].line;\r\n                }\r\n                state.commands.push(new GotoCommand(null, loopStartPos, lastLine));\r\n                state.commands.push(new BreakTargetCommand(statement.id));\r\n            } else if (statement instanceof AST.Continuing) {\r\n                state.commands.push(new ContinueTargetCommand(statement.loopId));\r\n                state.commands.push(new BlockCommand(statement.body));\r\n            } else if (statement instanceof AST.Continue) {\r\n                state.commands.push(new ContinueCommand(statement.loopId, statement));\r\n            } else if (statement instanceof AST.Break) {\r\n                state.commands.push(new BreakCommand(statement.loopId, statement.condition, statement));\r\n            } else if (statement instanceof AST.StaticAssert) {\r\n                state.commands.push(new StatementCommand(statement));\r\n            } else if (statement instanceof AST.Struct) {\r\n                // nothing to do\r\n            } else {\r\n                console.error(`TODO: statement type ${statement.constructor.name}`);\r\n            }\r\n        }\r\n\r\n        return state;\r\n    }\r\n\r\n    _collectFunctionCalls(node: AST.Expression, functionCalls: AST.CallExpr[]) {\r\n        if (node instanceof AST.CallExpr) {\r\n            if (node.args) {\r\n                for (const arg of node.args) {\r\n                    this._collectFunctionCalls(arg, functionCalls);\r\n                }\r\n            }\r\n            // Only collect custom function calls, not built-in functions.\r\n            if (!node.isBuiltin) {\r\n                functionCalls.push(node);\r\n            }\r\n        } else if (node instanceof AST.BinaryOperator) {\r\n            this._collectFunctionCalls(node.left, functionCalls);\r\n            this._collectFunctionCalls(node.right, functionCalls);\r\n        } else if (node instanceof AST.UnaryOperator) {\r\n            this._collectFunctionCalls(node.right, functionCalls);\r\n        } else if (node instanceof AST.CreateExpr) {\r\n            if (node.args) {\r\n                for (const arg of node.args) {\r\n                    this._collectFunctionCalls(arg, functionCalls);\r\n                }\r\n            }\r\n        } else if (node instanceof AST.BitcastExpr) {\r\n            this._collectFunctionCalls(node.value, functionCalls);\r\n        } else if (node instanceof AST.ArrayIndex) {\r\n            this._collectFunctionCalls(node.index, functionCalls);\r\n        } else if (AST.LiteralExpr) {\r\n            // nothing to do\r\n        } else {\r\n            console.error(`TODO: expression type ${node.constructor.name}`);\r\n        }\r\n    }\r\n}\r\n", "/*TEXTURES*/\r\n\r\n/*TEXTURES*/\r\n\r\n\r\n/*GLOBALS*/\r\n\r\n/*GLOBALS*/\r\n\r\nstruct FragInput {\r\n  @builtin(position) position : vec4f,\r\n  @location(0) uv : vec2f,\r\n}\r\n\r\n@vertex\r\nfn VSMain(@builtin(vertex_index) vertexIndex: u32) -> FragInput {\r\n  var output: FragInput;\r\n\r\n  output.position = vec4(array(\r\n    vec2( 1.0,  1.0),\r\n    vec2( 1.0, -1.0),\r\n    vec2(-1.0, -1.0),\r\n    vec2( 1.0,  1.0),\r\n    vec2(-1.0, -1.0),\r\n    vec2(-1.0,  1.0),\r\n  )[vertexIndex], 0.5, 1.0);\r\n\r\n  output.uv = array(\r\n    vec2(1.0, 0.0),\r\n    vec2(1.0, 1.0),\r\n    vec2(0.0, 1.0),\r\n    vec2(1.0, 0.0),\r\n    vec2(0.0, 1.0),\r\n    vec2(0.0, 0.0),\r\n  )[vertexIndex];\r\n\r\n  return output;\r\n}\r\n\r\nstruct Output {\r\n/*OUTPUT_STRUCT*/\r\n\r\n/*OUTPUT_STRUCT*/\r\n}\r\n\r\n@fragment\r\nfn FSMain(@location(0) uv : vec2f) -> Output  {\r\n  /*FRAGMENT_BODY*/\r\n\r\n  /*FRAGMENT_BODY*/\r\n}", "import { makeDelimitedReplacements } from \"./string-utils\";\r\nimport { WgslReflect } from \"wgsl_reflect\";\r\n\r\nimport SimpleFilterSource from \"./simple-filter.wgsl?raw\";\r\nimport {\r\n  makeUniformBuffer,\r\n  Mat2,\r\n  Mat2x3,\r\n  Mat2x4,\r\n  Mat3,\r\n  Mat3x2,\r\n  Mat3x4,\r\n  Mat4,\r\n  Mat4x2,\r\n  Mat4x3,\r\n  Vec2,\r\n  Vec3,\r\n  Vec4,\r\n} from \"r628\";\r\n\r\nfunction createSimpleFilterShader(params: {\r\n  textures: string;\r\n  globals: string;\r\n  outputStruct: string;\r\n  fragmentBody: string;\r\n}) {\r\n  return makeDelimitedReplacements(SimpleFilterSource, [\r\n    {\r\n      delimiter: \"/*TEXTURES*/\",\r\n      replaceWith: params.textures,\r\n    },\r\n    {\r\n      delimiter: \"/*GLOBALS*/\",\r\n      replaceWith: params.globals,\r\n    },\r\n    {\r\n      delimiter: \"/*OUTPUT_STRUCT*/\",\r\n      replaceWith: params.outputStruct,\r\n    },\r\n    {\r\n      delimiter: \"/*FRAGMENT_BODY*/\",\r\n      replaceWith: params.fragmentBody,\r\n    },\r\n  ]);\r\n}\r\n\r\ntype SimpleFilterInputTextures = Record<\r\n  string,\r\n  {\r\n    type?: \"f32\" | \"i32\" | \"u32\";\r\n    dimensionality?: number;\r\n    sampleWith?: number; // default to Sampler 0, if available\r\n  }\r\n>;\r\n\r\nexport const TEXTURE_FORMAT_TO_WGSL_TYPE_LUT = {\r\n  r8unorm: \"f32\",\r\n  r8snorm: \"f32\",\r\n  r8uint: \"u32\",\r\n  r8sint: \"i32\",\r\n  r16unorm: \"u32\",\r\n  r16snorm: \"i32\",\r\n  r16uint: \"u32\",\r\n  r16sint: \"i32\",\r\n  r16float: \"f32\",\r\n  rg8unorm: \"vec2f\",\r\n  rg8snorm: \"vec2f\",\r\n  rg8uint: \"vec2u\",\r\n  rg8sint: \"vec2i\",\r\n  r32uint: \"u32\",\r\n  r32sint: \"i32\",\r\n  r32float: \"f32\",\r\n  rg16unorm: \"vec2f\",\r\n  rg16snorm: \"vec2f\",\r\n  rg16uint: \"vec2u\",\r\n  rg16sint: \"vec2i\",\r\n  rg16float: \"vec2f\",\r\n  rgba8unorm: \"vec4f\",\r\n  \"rgba8unorm-srgb\": \"vec4f\",\r\n  rgba8snorm: \"vec4f\",\r\n  rgba8uint: \"vec4u\",\r\n  rgba8sint: \"vec4i\",\r\n  bgra8unorm: \"vec4f\",\r\n  \"bgra8unorm-srgb\": \"vec4f\",\r\n  rgb9e5ufloat: \"vec4f\",\r\n  rgb10a2uint: \"vec4u\",\r\n  rgb10a2unorm: \"vec4f\",\r\n  rg11b10ufloat: \"vec4f\",\r\n  rg32uint: \"vec2u\",\r\n  rg32sint: \"vec2i\",\r\n  rg32float: \"vec2f\",\r\n  rgba16unorm: \"vec4u\",\r\n  rgba16snorm: \"vec4i\",\r\n  rgba16uint: \"vec4u\",\r\n  rgba16sint: \"vec4i\",\r\n  rgba16float: \"vec4f\",\r\n  rgba32uint: \"vec4u\",\r\n  rgba32sint: \"vec4i\",\r\n  rgba32float: \"vec4f\",\r\n  //  \"stencil8\"\r\n  //  \"depth16unorm\"\r\n  //  \"depth24plus\"\r\n  //  \"depth24plus-stencil8\"\r\n  // \"depth32float\"\r\n  // \"depth32float-stencil8\"\r\n  //  \"bc1-rgba-unorm\"\r\n  //  \"bc1-rgba-unorm-srgb\"\r\n  //  \"bc2-rgba-unorm\"\r\n  //  \"bc2-rgba-unorm-srgb\"\r\n  //  \"bc3-rgba-unorm\"\r\n  //  \"bc3-rgba-unorm-srgb\"\r\n  //  \"bc4-r-unorm\"\r\n  //  \"bc4-r-snorm\"\r\n  //  \"bc5-rg-unorm\"\r\n  //  \"bc5-rg-snorm\"\r\n  //  \"bc6h-rgb-ufloat\"\r\n  //  \"bc6h-rgb-float\"\r\n  //  \"bc7-rgba-unorm\"\r\n  //  \"bc7-rgba-unorm-srgb\"\r\n  //  \"etc2-rgb8unorm\"\r\n  //  \"etc2-rgb8unorm-srgb\"\r\n  //  \"etc2-rgb8a1unorm\"\r\n  //  \"etc2-rgb8a1unorm-srgb\"\r\n  //  \"etc2-rgba8unorm\"\r\n  //  \"etc2-rgba8unorm-srgb\"\r\n  //  \"eac-r11unorm\"\r\n  //  \"eac-r11snorm\"\r\n  //  \"eac-rg11unorm\"\r\n  //  \"eac-rg11snorm\"\r\n  //  \"astc-4x4-unorm\"\r\n  //  \"astc-4x4-unorm-srgb\"\r\n  //  \"astc-5x4-unorm\"\r\n  //  \"astc-5x4-unorm-srgb\"\r\n  //  \"astc-5x5-unorm\"\r\n  //  \"astc-5x5-unorm-srgb\"\r\n  //  \"astc-6x5-unorm\"\r\n  //  \"astc-6x5-unorm-srgb\"\r\n  //  \"astc-6x6-unorm\"\r\n  //  \"astc-6x6-unorm-srgb\"\r\n  //  \"astc-8x5-unorm\"\r\n  //  \"astc-8x5-unorm-srgb\"\r\n  //  \"astc-8x6-unorm\"\r\n  //  \"astc-8x6-unorm-srgb\"\r\n  //  \"astc-8x8-unorm\"\r\n  //  \"astc-8x8-unorm-srgb\"\r\n  //  \"astc-10x5-unorm\"\r\n  //  \"astc-10x5-unorm-srgb\"\r\n  //  \"astc-10x6-unorm\"\r\n  //  \"astc-10x6-unorm-srgb\"\r\n  //  \"astc-10x8-unorm\"\r\n  //  \"astc-10x8-unorm-srgb\"\r\n  //  \"astc-10x10-unorm\"\r\n  //  \"astc-10x10-unorm-srgb\"\r\n  //  \"astc-12x10-unorm\"\r\n  //  \"astc-12x10-unorm-srgb\"\r\n  //  \"astc-12x12-unorm\"\r\n  // \"astc-12x12-unorm-srgb\";\r\n} as const;\r\n\r\nexport type TextureFormat = keyof typeof TEXTURE_FORMAT_TO_WGSL_TYPE_LUT;\r\n\r\ntype SimpleFilterOutputTextures = Record<string, TextureFormat>;\r\n\r\ntype SimpleFilterSamplers = GPUSamplerDescriptor[];\r\n\r\ntype WebGPUPrimitiveBase<T extends string, S extends string> =\r\n  | `vec${S}${T}`\r\n  | `${T}32`\r\n  | `mat${S}x${S}f`\r\n  | `mat${S}`;\r\n\r\ntype WebGPUPrimitive = WebGPUPrimitiveBase<\"f\" | \"i\" | \"u\", \"2\" | \"3\" | \"4\">;\r\n\r\nexport type UniformParameters = Record<string, WebGPUPrimitive>;\r\ntype UniformParameterValues<T extends UniformParameters> = {\r\n  [K in keyof T]: ParseUniformPrimitive<T[K]>;\r\n};\r\n\r\ntype WithGPUBackedBuffer = {\r\n  gpuBuffer: GPUBuffer;\r\n};\r\n\r\ntype ParseUniformPrimitive<T extends string> = T extends `mat2x2${string}`\r\n  ? Mat2\r\n  : T extends `mat3x3${string}`\r\n    ? Mat3\r\n    : T extends `mat4x4${string}`\r\n      ? Mat4\r\n      : T extends `mat3x4${string}`\r\n        ? Mat3x4\r\n        : T extends `mat4x3${string}`\r\n          ? Mat4x3\r\n          : T extends `mat2x4${string}`\r\n            ? Mat2x4\r\n            : T extends `mat4x2${string}`\r\n              ? Mat4x2\r\n              : T extends `mat2x3${string}`\r\n                ? Mat2x3\r\n                : T extends `mat3x2${string}`\r\n                  ? Mat3x2\r\n                  : T extends `mat2${string}`\r\n                    ? Mat2\r\n                    : T extends `mat3${string}`\r\n                      ? Mat3\r\n                      : T extends `mat4${string}`\r\n                        ? Mat4\r\n                        : T extends `vec4${string}`\r\n                          ? Vec4\r\n                          : T extends `vec3${string}`\r\n                            ? Vec3\r\n                            : T extends `vec2${string}`\r\n                              ? Vec2\r\n                              : number;\r\n\r\nexport function createSimpleFilterPipeline<\r\n  Inputs extends SimpleFilterInputTextures,\r\n  Outputs extends SimpleFilterOutputTextures,\r\n  Samplers extends SimpleFilterSamplers,\r\n  Uniforms extends UniformParameters,\r\n>(\r\n  device: GPUDevice,\r\n  spec: {\r\n    inputs: Inputs;\r\n    outputs: Outputs;\r\n    samplers?: Samplers;\r\n    source: string;\r\n    globals?: string;\r\n    uniforms?: Uniforms;\r\n  }\r\n) {\r\n  let fragmentBody = \"\";\r\n\r\n  let bindings = \"\";\r\n\r\n  let bindingIndex = 0;\r\n\r\n  const samplers: GPUSampler[] = [];\r\n\r\n  for (const s of spec.samplers ?? [{}]) {\r\n    bindings += `@group(0) @binding(${bindingIndex})\r\nvar sampler${bindingIndex}: sampler;\\n`;\r\n    samplers.push(device.createSampler(s));\r\n    bindingIndex++;\r\n  }\r\n\r\n  bindingIndex = 0;\r\n\r\n  const nameToInputMap = new Map<string, number>();\r\n  const nameToOutputMap = new Map<string, number>();\r\n\r\n  const inputEntries = Object.entries(spec.inputs);\r\n\r\n  for (const [name, value] of inputEntries) {\r\n    bindings += `@group(1) @binding(${bindingIndex}) \r\nvar tex_${name}: texture_${value.dimensionality ?? \"2d\"}<${value.type ?? \"f32\"}>;`;\r\n    nameToInputMap.set(name, bindingIndex);\r\n    fragmentBody += `  var ${name} = textureSample(tex_${name}, sampler${value.sampleWith ?? 0}, uv);\\n`;\r\n    bindingIndex++;\r\n  }\r\n\r\n  let outputStruct = \"\";\r\n\r\n  let outputBindingIndex = 0;\r\n\r\n  for (const [name, value] of Object.entries(spec.outputs)) {\r\n    outputStruct += `  @location(${outputBindingIndex}) ${name}: ${TEXTURE_FORMAT_TO_WGSL_TYPE_LUT[value]},\\n`;\r\n    nameToOutputMap.set(name, outputBindingIndex);\r\n    fragmentBody += `  var ${name}: ${TEXTURE_FORMAT_TO_WGSL_TYPE_LUT[value]};\\n`;\r\n    outputBindingIndex++;\r\n  }\r\n\r\n  fragmentBody += spec.source;\r\n\r\n  fragmentBody += `\\n  var OUTPUT: Output;\\n`;\r\n\r\n  const outputsEntries = Object.entries(spec.outputs);\r\n\r\n  for (const [name, value] of outputsEntries) {\r\n    fragmentBody += `  OUTPUT.${name} = ${name};\\n`;\r\n  }\r\n\r\n  fragmentBody += \"return OUTPUT;\";\r\n\r\n  let globals = \"\";\r\n\r\n  globals += spec.globals ?? \"\";\r\n\r\n  if (spec.uniforms) {\r\n    globals += `@group(2) @binding(0) var<uniform> params : Params;\r\nstruct Params {\\n`;\r\n\r\n    for (const [uniformName, uniformType] of Object.entries(\r\n      spec.uniforms ?? {}\r\n    )) {\r\n      globals += `  ${uniformName}: ${uniformType},\\n`;\r\n    }\r\n\r\n    globals += \"}\";\r\n  }\r\n\r\n  const shaderSource = createSimpleFilterShader({\r\n    textures: bindings,\r\n    globals: globals,\r\n    outputStruct,\r\n    fragmentBody,\r\n  });\r\n\r\n  // console.log(shaderSource);\r\n\r\n  const reflect = new WgslReflect(shaderSource);\r\n\r\n  const reflectBindGroups = reflect.getBindGroups();\r\n\r\n  const module = device.createShaderModule({\r\n    code: shaderSource,\r\n  });\r\n\r\n  const pipeline = device.createRenderPipeline({\r\n    layout: \"auto\",\r\n    vertex: { module },\r\n    fragment: {\r\n      module,\r\n      targets: outputsEntries.map(([name, value]) => ({\r\n        format: value,\r\n      })),\r\n    },\r\n  });\r\n\r\n  const samplerBindGroup = device.createBindGroup({\r\n    layout: pipeline.getBindGroupLayout(0),\r\n    entries: samplers.map((s, i) => ({\r\n      resource: s,\r\n      binding: i,\r\n    })),\r\n  });\r\n\r\n  return {\r\n    pipeline,\r\n    makeUniformBuffer() {\r\n      const buffer = device.createBuffer({\r\n        size: 1024,\r\n        usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM,\r\n      });\r\n\r\n      const bindGroup = device.createBindGroup({\r\n        layout: pipeline.getBindGroupLayout(2),\r\n        entries: [\r\n          {\r\n            resource: buffer,\r\n            binding: 0,\r\n          },\r\n        ],\r\n      });\r\n\r\n      const ret = {\r\n        buffer,\r\n        bindGroup,\r\n        setBuffer(values: UniformParameterValues<Uniforms>) {\r\n          const buf = makeUniformBuffer(\r\n            {\r\n              bindGroups: reflectBindGroups,\r\n            },\r\n            2,\r\n            0,\r\n            // @ts-expect-error\r\n            values\r\n          );\r\n          device.queue.writeBuffer(buffer, 0, buf);\r\n          return ret;\r\n        },\r\n      };\r\n\r\n      return ret;\r\n    },\r\n    withInputs(inputs: {\r\n      [K in keyof Inputs]: GPUTextureView;\r\n    }) {\r\n      const inputTextureBindGroup = device.createBindGroup({\r\n        layout: pipeline.getBindGroupLayout(1),\r\n        entries: inputEntries.map(([name, value], i) => ({\r\n          resource: inputs[name],\r\n          binding: i,\r\n        })),\r\n      });\r\n\r\n      return (\r\n          uniforms: keyof Uniforms extends never\r\n            ? undefined\r\n            : { bindGroup: GPUBindGroup }\r\n        ) =>\r\n        (\r\n          encoder: GPUCommandEncoder,\r\n          outputs: {\r\n            [K in keyof Outputs]: GPUTextureView | GPURenderPassColorAttachment;\r\n          },\r\n          samplers?: GPUSampler[]\r\n        ) => {\r\n          const pass = encoder.beginRenderPass({\r\n            colorAttachments: outputsEntries.map(([name, value]) =>\r\n              outputs[name] instanceof GPUTextureView\r\n                ? {\r\n                    view: outputs[name],\r\n                    clearValue: [0, 0, 0, 1],\r\n                    loadOp: \"clear\",\r\n                    storeOp: \"store\",\r\n                  }\r\n                : outputs[name]\r\n            ),\r\n          });\r\n\r\n          pass.setPipeline(pipeline);\r\n\r\n          pass.setBindGroup(0, samplerBindGroup);\r\n\r\n          pass.setBindGroup(1, inputTextureBindGroup);\r\n\r\n          if (uniforms) pass.setBindGroup(2, uniforms.bindGroup);\r\n\r\n          pass.draw(6);\r\n\r\n          pass.end();\r\n        };\r\n    },\r\n  };\r\n}\r\n", "import {\r\n  add2,\r\n  add3,\r\n  Mat4,\r\n  mulMat4,\r\n  mulMat4ByVec4,\r\n  mulVec4ByMat4,\r\n  normalize3,\r\n  range,\r\n  rodrigues,\r\n  rotate,\r\n  scale2,\r\n  scale3,\r\n  sub3,\r\n  translate,\r\n  Vec2,\r\n  Vec3,\r\n  xy,\r\n  xyz,\r\n} from \"r628\";\r\nimport {\r\n  ComponentParams,\r\n  Components,\r\n  Entity,\r\n  specifyComponent,\r\n  System,\r\n} from \"../ecs\";\r\nimport { Keyboard, Mouse, MouseFirstPerson } from \"./input\";\r\nimport {\r\n  PhysicsWorld,\r\n  RigidBody,\r\n  toRapierVec3,\r\n  toVec3,\r\n} from \"./physics-components\";\r\nimport { DeferredWebgpuRenderer } from \"./renderer\";\r\nimport { Transform } from \"../transform-component\";\r\nimport { inv4 } from \"../matrix\";\r\nimport { SampleWebgpuRendererGeometry } from \"./geometry\";\r\n\r\nexport function castCameraRay(\r\n  pos: Vec2,\r\n  size: Vec2,\r\n  viewInv: Mat4,\r\n  fov: number,\r\n  aspect: number\r\n) {\r\n  const f = Math.tan(fov / 2);\r\n  const h = mulMat4ByVec4(viewInv, [\r\n    (pos[0] / size[0] - 0.5) * 2 * aspect * f,\r\n    (pos[1] / size[1] - 0.5) * -2 * f,\r\n    -1,\r\n    0,\r\n  ]);\r\n  const dir = normalize3(xyz(h));\r\n  return dir;\r\n}\r\n\r\nexport const TrackCamera = specifyComponent({\r\n  create() {\r\n    const rotation = translate([0, 0, 0]);\r\n    let distance = 15;\r\n    return { rotation, angles: [0, 0] as Vec2, distance };\r\n  },\r\n  init() {},\r\n  dependencies: [Transform] as const,\r\n  globalDependencies: [DeferredWebgpuRenderer, Mouse] as const,\r\n  onDestroy() {},\r\n  renderUpdate(params) {\r\n    for (const e of params.instances) {\r\n      const invtrans = e.entity.transform.matrix;\r\n      params.subsystem(DeferredWebgpuRenderer).state.viewMatrix = mulMat4(\r\n        mulMat4(translate([0, 0, -e.data.distance]), e.data.rotation),\r\n        translate([-invtrans[12], -invtrans[13], -invtrans[14]])\r\n      );\r\n    }\r\n  },\r\n  fixedUpdate({ state, instances, subsystem }) {\r\n    const mouse = subsystem(Mouse).state;\r\n\r\n    const movement = mouse.pollMovement();\r\n    const scroll = mouse.pollScroll();\r\n\r\n    for (const i of instances) {\r\n      i.data.distance *= Math.pow(1.1, scroll);\r\n      if (mouse.isRightPressed()) {\r\n        i.data.angles = add2(i.data.angles, scale2(movement, 0.008));\r\n\r\n        const xAxis: Vec3 = [1, 0, 0];\r\n        const yAxis: Vec3 = [0, 1, 0];\r\n\r\n        i.data.rotation = mulMat4(\r\n          rotate(xAxis, i.data.angles[1]),\r\n          rotate(yAxis, i.data.angles[0])\r\n        );\r\n      }\r\n    }\r\n  },\r\n  brand: \"trackCamera\" as const,\r\n});\r\n\r\nexport const PhysicalPlayerController = specifyComponent({\r\n  create(\r\n    params: {\r\n      geometry: ComponentParams<typeof SampleWebgpuRendererGeometry>;\r\n      sys: System<\r\n        typeof RigidBody | typeof SampleWebgpuRendererGeometry | Components\r\n      >;\r\n    },\r\n    global\r\n  ) {\r\n    let segments: Entity<\r\n      typeof RigidBody | typeof SampleWebgpuRendererGeometry\r\n    >[] = [];\r\n\r\n    for (const i of range(20)) {\r\n      segments.push({\r\n        // transform:\r\n      });\r\n    }\r\n\r\n    return {\r\n      segments,\r\n    };\r\n  },\r\n  init(waitFor) {\r\n    return undefined;\r\n  },\r\n  dependencies: [TrackCamera] as const,\r\n  globalDependencies: [Mouse, Keyboard, PhysicsWorld] as const,\r\n  brand: \"physicalPlayerController\" as const,\r\n  onDestroy() {},\r\n  fixedUpdate({ subsystem, instances }) {\r\n    const kbd = subsystem(Keyboard).state;\r\n\r\n    for (const e of instances) {\r\n      const cam = e.entity.trackCamera;\r\n\r\n      let force: Vec3 = [0, 0, 0];\r\n      if (kbd.isKeyHeld(\"w\")) {\r\n        force = add3(force, [0, 0, -1]);\r\n      }\r\n\r\n      if (kbd.isKeyHeld(\"s\")) {\r\n        force = add3(force, [0, 0, 1]);\r\n      }\r\n\r\n      if (kbd.isKeyHeld(\"a\")) {\r\n        force = add3(force, [-1, 0, 0]);\r\n      }\r\n\r\n      if (kbd.isKeyHeld(\"d\")) {\r\n        force = add3(force, [1, 0, 0]);\r\n      }\r\n\r\n      force = rodrigues(force, [0, -1, 0], cam.angles[0]);\r\n\r\n      if (kbd.isKeyHeld(\" \")) {\r\n        force = add3(force, [0, 1, 0]);\r\n      }\r\n\r\n      if (kbd.isKeyHeld(\"shift\")) {\r\n        force = add3(force, [0, -1, 0]);\r\n      }\r\n\r\n      const forceMag = 0.26;\r\n\r\n      e.entity.rigidBody.body.applyImpulse(\r\n        {\r\n          x: force[0] * forceMag,\r\n          y: force[1] * forceMag,\r\n          z: force[2] * forceMag,\r\n        },\r\n        true\r\n      );\r\n    }\r\n  },\r\n});\r\n", "// import { SampleWebgpuRenderer, Test } from \"./draw-components\";\r\n\r\nimport {\r\n  add2,\r\n  add3,\r\n  cartesianProduct,\r\n  length3,\r\n  Mat4,\r\n  mulMat4,\r\n  mulMat4ByVec4,\r\n  mulVec4ByMat4,\r\n  normalize3,\r\n  ortho,\r\n  perspective,\r\n  rand,\r\n  range,\r\n  rodrigues,\r\n  rotate,\r\n  scale2,\r\n  scale3,\r\n  smartRange,\r\n  sub3,\r\n  translate,\r\n  Vec2,\r\n  Vec3,\r\n  Vec4,\r\n  xyz,\r\n} from \"r628\";\r\nimport {\r\n  createBufferFromData,\r\n  MainCanvas,\r\n  DeferredWebgpuRenderer,\r\n} from \"./components/renderer\";\r\nimport { createSystem, Entity, System } from \"./ecs\";\r\nimport { Transform } from \"./transform-component\";\r\nimport { parse } from \"@loaders.gl/core\";\r\nimport {\r\n  GLTFLoader,\r\n  GLTFMeshPostprocessed,\r\n  postProcessGLTF,\r\n} from \"@loaders.gl/gltf\";\r\nimport {\r\n  PhysicsWorld,\r\n  RigidBody,\r\n  RigidBodyCollider,\r\n} from \"./components/physics-components\";\r\nimport { PointLightSource } from \"./components/lighting\";\r\nimport { SampleWebgpuRendererGeometry } from \"./components/geometry\";\r\nimport {\r\n  ParticleForcefield,\r\n  ParticleSystem,\r\n} from \"./components/particle-system\";\r\nimport { Keyboard, Mouse, MouseFirstPerson } from \"./components/input\";\r\nimport { PostprocessingPipeline } from \"./components/postprocess\";\r\nimport { createSimpleFilterPipeline } from \"./shaders/simple-filter\";\r\nimport {\r\n  PhysicalPlayerController,\r\n  TrackCamera,\r\n} from \"./components/player-controller\";\r\nimport {\r\n  SphericalImpulseJoint,\r\n  UnitImpulseJoint,\r\n} from \"@dimforge/rapier3d-simd\";\r\n\r\ntype MeshBuffers = {\r\n  attributes: Record<string, GPUBuffer>;\r\n  indices?: {\r\n    buffer: GPUBuffer;\r\n    format: \"uint16\" | \"uint32\";\r\n  };\r\n  count: number;\r\n};\r\n\r\nfunction gltfMeshToWebGPUBuffers(\r\n  device: GPUDevice,\r\n  mesh: GLTFMeshPostprocessed\r\n) {\r\n  const out: MeshBuffers[] = [];\r\n\r\n  for (const prim of mesh.primitives) {\r\n    const meshBufs: MeshBuffers = { attributes: {}, count: 0 };\r\n\r\n    for (const [attrName, attrValue] of Object.entries(prim.attributes)) {\r\n      const attrBuffer = createBufferFromData(\r\n        device,\r\n        attrValue.value.buffer,\r\n        GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST\r\n      );\r\n      meshBufs.attributes[attrName] = attrBuffer;\r\n      meshBufs.count = attrValue.count;\r\n    }\r\n\r\n    if (prim.indices) {\r\n      const indexBuffer = createBufferFromData(\r\n        device,\r\n        prim.indices.value.buffer,\r\n        GPUBufferUsage.INDEX | GPUBufferUsage.COPY_DST\r\n      );\r\n      meshBufs.indices = {\r\n        buffer: indexBuffer,\r\n        format: prim.indices.bytesPerElement === 2 ? \"uint16\" : \"uint32\",\r\n      };\r\n      meshBufs.count = prim.indices.count;\r\n    }\r\n\r\n    out.push(meshBufs);\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\nfunction gltlfMeshToRapierTrimesh(\r\n  RAPIER: Awaited<typeof import(\"@dimforge/rapier3d-simd/exports\")>,\r\n  mesh: GLTFMeshPostprocessed\r\n) {\r\n  const prim = mesh.primitives[0];\r\n  const position = Object.entries(prim.attributes).find(\r\n    (e) => e[0] === \"POSITION\"\r\n  )?.[1];\r\n  if (!position) throw new Error(\"No position!\");\r\n  const indices = prim.indices;\r\n  if (!indices) throw new Error(\"Mesh should be indexed!\");\r\n\r\n  if (indices.bytesPerElement === 2) {\r\n    return RAPIER.ColliderDesc.trimesh(\r\n      new Float32Array(position.value.buffer),\r\n      new Uint32Array([...new Uint16Array(indices.value.buffer)])\r\n    );\r\n  } else {\r\n    return RAPIER.ColliderDesc.trimesh(\r\n      new Float32Array(position.value.buffer),\r\n      new Uint32Array(indices.value.buffer)\r\n    );\r\n  }\r\n}\r\n\r\nfunction trans4(m: Mat4): Mat4 {\r\n  return [\r\n    m[0],\r\n    m[4],\r\n    m[8],\r\n    m[12],\r\n    m[1],\r\n    m[5],\r\n    m[9],\r\n    m[13],\r\n    m[2],\r\n    m[6],\r\n    m[10],\r\n    m[14],\r\n    m[3],\r\n    m[7],\r\n    m[11],\r\n    m[15],\r\n  ];\r\n}\r\n\r\nfunction perspectiveWebgpu(\r\n  fieldOfViewInRadians: number,\r\n  aspectRatio: number,\r\n  near: number,\r\n  far: number\r\n): Mat4 {\r\n  const f = 1.0 / Math.tan(fieldOfViewInRadians / 2);\r\n  const rangeInv = 1 / (near - far);\r\n\r\n  return [\r\n    f / aspectRatio,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    f,\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    far * rangeInv,\r\n    -1,\r\n    0,\r\n    0,\r\n    near * far * rangeInv,\r\n    0,\r\n  ];\r\n}\r\n\r\nasync function main() {\r\n  const monkey = await (await fetch(\"assets/models.glb\")).blob();\r\n\r\n  console.log(\r\n    \"sdsdsdfds\",\r\n    await parse(await (await fetch(\"assets/models.glb\")).blob(), GLTFLoader)\r\n  );\r\n\r\n  const gltf = await parse(monkey, GLTFLoader);\r\n\r\n  const g = postProcessGLTF(gltf);\r\n\r\n  console.log(g);\r\n\r\n  const sys = await createSystem([\r\n    Transform,\r\n    DeferredWebgpuRenderer,\r\n    SampleWebgpuRendererGeometry,\r\n    RigidBody,\r\n    PhysicsWorld,\r\n    RigidBodyCollider,\r\n    MainCanvas,\r\n    PointLightSource,\r\n    ParticleSystem,\r\n    ParticleForcefield,\r\n    Keyboard,\r\n    // MouseFirstPerson,\r\n    Mouse,\r\n    PostprocessingPipeline(\r\n      ({ device, canvas }) => {\r\n        return {\r\n          blitToCanvas: createSimpleFilterPipeline(device, {\r\n            inputs: { x: {} },\r\n            outputs: {\r\n              y: navigator.gpu.getPreferredCanvasFormat() as \"bgra8unorm\",\r\n            },\r\n            source: \"y = mix(vec4f(1.0,0.0,0.0,1.0), vec4f(x.rgb, 1.0), x.a);\",\r\n          }),\r\n        };\r\n      },\r\n      () => undefined,\r\n      ({ device, canvas, ctx, lighting }, res, g) => {\r\n        const encoder = device.createCommandEncoder();\r\n        g.blitToCanvas.withInputs({\r\n          x: lighting.createView(),\r\n        })(undefined)(encoder, { y: ctx.getCurrentTexture().createView() });\r\n        device.queue.submit([encoder.finish()]);\r\n      }\r\n    ),\r\n    PhysicalPlayerController,\r\n    TrackCamera,\r\n  ]);\r\n\r\n  const device = sys.subsystem(DeferredWebgpuRenderer).global.device;\r\n\r\n  const mesh = gltfMeshToWebGPUBuffers(device, g.meshes[0]);\r\n  const bg = gltfMeshToWebGPUBuffers(device, g.meshes[2]);\r\n  const tunnel = gltfMeshToWebGPUBuffers(device, g.meshes[4]);\r\n  const wormseg = gltfMeshToWebGPUBuffers(device, g.meshes[5]);\r\n\r\n  let entities: Entity<\r\n    | typeof Transform\r\n    | typeof SampleWebgpuRendererGeometry\r\n    | typeof RigidBody\r\n    | typeof RigidBodyCollider\r\n  >[] = [];\r\n\r\n  const { world, RAPIER } = sys.subsystem(PhysicsWorld).global;\r\n\r\n  const particleCount = 4 * 16 ** 3;\r\n\r\n  const particlePositions = createBufferFromData(\r\n    device,\r\n    new Float32Array(\r\n      range(particleCount).flatMap((x) => [\r\n        rand(-10, 10),\r\n        rand(-10, 10),\r\n        rand(-40, 0),\r\n        0,\r\n      ])\r\n    ),\r\n    GPUBufferUsage.COPY_DST | GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE\r\n  );\r\n\r\n  const particleVelocities = createBufferFromData(\r\n    device,\r\n    new Float32Array(range(particleCount).flatMap((x) => [0, 0, 0, 0])),\r\n    GPUBufferUsage.COPY_DST | GPUBufferUsage.VERTEX | GPUBufferUsage.STORAGE\r\n  );\r\n\r\n  const tex = device.createTexture({\r\n    dimension: \"3d\",\r\n    size: [32, 32, 32],\r\n    usage: GPUTextureUsage.STORAGE_BINDING | GPUTextureUsage.COPY_DST,\r\n    format: \"rgba8snorm\",\r\n  });\r\n\r\n  const forceField = new Int8Array(\r\n    cartesianProduct(range(32), range(32), range(32)).flatMap(([z, y, x]) => {\r\n      // let vecToCenter = sub3([15.5, 15.5, 15.5], [x, y, z]);\r\n\r\n      // vecToCenter = rodrigues(vecToCenter, [0, 0, 1], Math.PI / 2);\r\n\r\n      // const normVecToCenter = normalize3(vecToCenter);\r\n\r\n      // return [\r\n      //   ...scale3(normVecToCenter, 1 * (length3(vecToCenter) + 3)).map(\r\n      //     (c) => Math.sign(c) * Math.ceil(Math.abs(c))\r\n      //   ),\r\n      //   0,\r\n      // ];\r\n\r\n      return [rand(-4, 4), rand(-4, 4), rand(-4, 4), 0];\r\n    })\r\n  );\r\n\r\n  for (let i = 0; i < 32 * 32 * 32 * 4; i += 4) {\r\n    if (\r\n      forceField[i] == 0 &&\r\n      forceField[i + 1] === 0 &&\r\n      forceField[i + 2] === 0\r\n    ) {\r\n    }\r\n  }\r\n\r\n  device.queue.writeTexture(\r\n    { texture: tex },\r\n    forceField,\r\n    {\r\n      bytesPerRow: 32 * 4,\r\n      rowsPerImage: 32,\r\n    },\r\n    [32, 32, 32]\r\n  );\r\n\r\n  sys.entity({\r\n    transform: translate([0, 0, -15]),\r\n    particleForcefield: {\r\n      positionBuffer: particlePositions,\r\n      velocityBuffer: particleVelocities,\r\n      forceFieldTexture: tex,\r\n      count: particleCount,\r\n    },\r\n  });\r\n\r\n  const particles = sys.entity({\r\n    transform: translate([0, 0, -15]),\r\n    particleSystem: {\r\n      drawColor: [1.0, 1.0, 1.0, 1.0],\r\n      count: particleCount,\r\n      positionBuffer: particlePositions,\r\n    },\r\n  });\r\n\r\n  const background = sys.entity({\r\n    transform: translate([0, 0, -90]),\r\n    sampleWebgpuRendererGeometry: {\r\n      vertexBuffer: bg[0].attributes.POSITION,\r\n      normalBuffer: bg[0].attributes.NORMAL,\r\n      size: bg[0].count,\r\n      indexBuffer: bg[0].indices!.buffer,\r\n      indexFormat: \"uint16\",\r\n      drawColor: [0.2, 0.4, 1.0, 1.0],\r\n    },\r\n  });\r\n\r\n  sys.entity({\r\n    transform: translate([0, 0, 0]),\r\n    sampleWebgpuRendererGeometry: {\r\n      vertexBuffer: tunnel[0].attributes.POSITION,\r\n      normalBuffer: tunnel[0].attributes.NORMAL,\r\n      size: tunnel[0].count,\r\n      indexBuffer: tunnel[0].indices!.buffer,\r\n      indexFormat: \"uint16\",\r\n      drawColor: [0.27, 0.29, 0.31, 1.0],\r\n    },\r\n    rigidBody: RAPIER.RigidBodyDesc.fixed().setTranslation(0, -10, -10),\r\n    rigidBodyCollider: gltlfMeshToRapierTrimesh(\r\n      RAPIER,\r\n      g.meshes[4]\r\n    ).setFriction(0.6),\r\n  });\r\n\r\n  // const ground = sys.entity({\r\n  //   transform: translate([0, 0, 0]),\r\n  // });\r\n\r\n  // cartesianProduct(smartRange(10), smartRange(10), smartRange(10)).map(\r\n  //   ([x, y, z]) => {\r\n  //     const position: Vec3 = [\r\n  //       x.remap(-20, 20, true),\r\n  //       y.remap(-20, 20, true),\r\n  //       z.remap(-60, -20, true),\r\n  //     ];\r\n\r\n  //     sys.entity({\r\n  //       transform: translate(position),\r\n  //       sampleWebgpuRendererGeometry: {\r\n  //         vertexBuffer: mesh[0].attributes.POSITION,\r\n  //         normalBuffer: mesh[0].attributes.NORMAL,\r\n  //         size: mesh[0].count,\r\n  //         indexBuffer: mesh[0].indices!.buffer,\r\n  //         indexFormat: \"uint16\",\r\n  //         drawColor: [1.0, 0.4, 0.2, 1.0],\r\n  //       },\r\n  //     });\r\n  //   }\r\n  // );\r\n\r\n  const wormsegGeo = {\r\n    vertexBuffer: wormseg[0].attributes.POSITION,\r\n    normalBuffer: wormseg[0].attributes.NORMAL,\r\n    size: wormseg[0].count,\r\n    indexBuffer: wormseg[0].indices!.buffer,\r\n    indexFormat: \"uint16\" as const,\r\n    drawColor: [1.0, 0.5, 1.0, 1.0] as Vec4,\r\n  };\r\n\r\n  const PLAYER_COLLIDER_GROUP = 0x0001;\r\n\r\n  const sys2: System<typeof RigidBody | typeof SampleWebgpuRendererGeometry> =\r\n    sys;\r\n\r\n  const player = sys.entity({\r\n    transform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n    // sampleWebgpuRendererGeometry: wormsegGeo,\r\n    // rigidBody: RAPIER.RigidBodyDesc.dynamic().setTranslation(0, 5, -10),\r\n    // rigidBodyCollider: RAPIER.ColliderDesc.ball(0.5)\r\n    //   .setFriction(0.1)\r\n    //   .setCollisionGroups(\r\n    //     PLAYER_COLLIDER_GROUP | (~PLAYER_COLLIDER_GROUP << 16)\r\n    //   ),\r\n    physicalPlayerController: {\r\n      geometry: wormsegGeo,\r\n      sys,\r\n    },\r\n    trackCamera: {},\r\n  });\r\n\r\n  // const ropeEntities: Entity<typeof RigidBody>[] = [];\r\n  // for (let i = 0; i < 20; i++) {\r\n  //   ropeEntities.push(\r\n  //     sys.entity({\r\n  //       transform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n  //       sampleWebgpuRendererGeometry: wormsegGeo,\r\n  //       rigidBody: RAPIER.RigidBodyDesc.dynamic()\r\n  //         .setTranslation(0, 5 + i, -10)\r\n  //         .setCcdEnabled(true),\r\n  //       rigidBodyCollider: RAPIER.ColliderDesc.ball(0.4)\r\n  //         .setFriction(0.6)\r\n  //         .setCollisionGroups(\r\n  //           PLAYER_COLLIDER_GROUP | (~PLAYER_COLLIDER_GROUP << 16)\r\n  //         ),\r\n  //     })\r\n  //   );\r\n  // }\r\n\r\n  // for (let i = 0; i < 19; i++) {\r\n  //   let a = ropeEntities[i].component(RigidBody);\r\n  //   let b = ropeEntities[i + 1].component(RigidBody);\r\n\r\n  //   const params = RAPIER.JointData.spring(\r\n  //     0.1,\r\n  //     100,\r\n  //     0.2,\r\n  //     {\r\n  //       x: 0,\r\n  //       y: 0.3,\r\n  //       z: 0,\r\n  //     },\r\n  //     {\r\n  //       x: 0,\r\n  //       y: -0.3,\r\n  //       z: 0,\r\n  //     }\r\n  //   );\r\n  //   world.createImpulseJoint(params, a.body, b.body, true);\r\n  // }\r\n\r\n  // world.createImpulseJoint(\r\n  //   RAPIER.JointData.spring(\r\n  //     0.1,\r\n  //     100,\r\n  //     0.2,\r\n  //     {\r\n  //       x: 0,\r\n  //       y: 0.3,\r\n  //       z: 0,\r\n  //     },\r\n  //     {\r\n  //       x: 0,\r\n  //       y: -0.3,\r\n  //       z: 0,\r\n  //     }\r\n  //   ),\r\n  //   player.component(RigidBody).body,\r\n  //   ropeEntities[0].component(RigidBody).body,\r\n  //   true\r\n  // );\r\n\r\n  // for (const x of range(100)) {\r\n  //   const testEntity = sys.entity({\r\n  //     transform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\r\n  //     sampleWebgpuRendererGeometry: {\r\n  //       vertexBuffer: mesh[0].attributes.POSITION,\r\n  //       normalBuffer: mesh[0].attributes.NORMAL,\r\n  //       size: mesh[0].count,\r\n  //       indexBuffer: mesh[0].indices!.buffer,\r\n  //       indexFormat: \"uint16\",\r\n  //       drawColor: [1.0, 0.5, 0.25, 1.0],\r\n  //     },\r\n  //     rigidBody: RAPIER.RigidBodyDesc.dynamic().setTranslation(\r\n  //       rand(-1, 1),\r\n  //       x * 1.5 + 1,\r\n  //       rand(-15, -7)\r\n  //       // rand(-2, 2)\r\n  //     ),\r\n  //     rigidBodyCollider: RAPIER.ColliderDesc.ball(0.5).setFriction(0.9),\r\n  //   });\r\n  //   entities.push(testEntity);\r\n  // }\r\n\r\n  sys.entity({\r\n    transform: translate([0, 30, -20]),\r\n    pointLightSource: {\r\n      color: [1, 1, 1],\r\n      quadratic: 0.02,\r\n      linear: 0.01,\r\n      constant: 1,\r\n    },\r\n  });\r\n  sys.entity({\r\n    transform: translate([0, 30, 0]),\r\n    pointLightSource: {\r\n      color: [1, 1, 1],\r\n      quadratic: 0.02,\r\n      linear: 0.01,\r\n      constant: 1,\r\n    },\r\n  });\r\n\r\n  // const ground = sys.entity({\r\n  //   transform: translate([0, 0, 0]),\r\n  //   rigidBody: RAPIER.RigidBodyDesc.fixed(),\r\n  //   rigidBodyCollider: RAPIER.ColliderDesc.cuboid(60, 1, 60)\r\n  //     .setTranslation(0, -4, 0)\r\n  //     .setFriction(0.9),\r\n  // });\r\n\r\n  let t = 0;\r\n\r\n  const renderer = sys.subsystem(DeferredWebgpuRenderer);\r\n  const kbd = sys.subsystem(Keyboard).global;\r\n  // const mouse = sys.subsystem(MouseFirstPerson).global;\r\n\r\n  let pos: Vec3 = [0, 0, 0];\r\n  let vel: Vec3 = [0, 0, 0];\r\n\r\n  let viewRotation: Vec2 = [0, 0];\r\n\r\n  async function loop() {\r\n    renderer.global.aspect = window.innerWidth / window.innerHeight;\r\n    renderer.global.fov = 1;\r\n    renderer.global.near = 0.1;\r\n    renderer.global.far = 200;\r\n\r\n    // monkeyTest.component(Transform).matrix = translate([t % 10, 0, -50]);\r\n\r\n    // console.log(z);\r\n\r\n    // viewRotation = add2(viewRotation, scale2(mouse.pollMovement(), 0.004));\r\n\r\n    // const viewRotationMatrix = mulMat4(\r\n    //   rotate([1, 0, 0], viewRotation[1]),\r\n    //   rotate([0, 1, 0], viewRotation[0])\r\n    // );\r\n\r\n    // let force: Vec3 = [0, 0, 0];\r\n\r\n    // if (kbd.isKeyHeld(\"w\")) {\r\n    //   force = add3(force, [0, 0, -1]);\r\n    // }\r\n\r\n    // if (kbd.isKeyHeld(\"s\")) {\r\n    //   force = add3(force, [0, 0, 1]);\r\n    // }\r\n\r\n    // if (kbd.isKeyHeld(\"a\")) {\r\n    //   force = add3(force, [-1, 0, 0]);\r\n    // }\r\n\r\n    // if (kbd.isKeyHeld(\"d\")) {\r\n    //   force = add3(force, [1, 0, 0]);\r\n    // }\r\n\r\n    // force = xyz(mulVec4ByMat4([...force, 0.0], viewRotationMatrix));\r\n\r\n    // if (kbd.isKeyHeld(\" \")) {\r\n    //   force = add3(force, [0, 1, 0]);\r\n    // }\r\n\r\n    // if (kbd.isKeyHeld(\"shift\")) {\r\n    //   force = add3(force, [0, -1, 0]);\r\n    // }\r\n\r\n    // vel = add3(vel, force);\r\n\r\n    // pos = add3(pos, scale3(vel, 1 / 60));\r\n    // vel = scale3(vel, 0.9);\r\n\r\n    // renderer.global.viewMatrix = mulMat4(\r\n    //   viewRotationMatrix,\r\n    //   translate(scale3(pos, -1))\r\n    // );\r\n\r\n    await sys.renderUpdate();\r\n    await sys.fixedUpdate();\r\n\r\n    t++;\r\n\r\n    requestAnimationFrame(loop);\r\n    // setTimeout(loop, 500);\r\n  }\r\n\r\n  loop();\r\n}\r\n\r\nmain();\r\n"],
  "mappings": "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AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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,EACtBa,GAAAL,SAAW,IAAIK,GAGxB,IAAMK,GAAuB,IAAI3H,IAAI,CACnC,MACA,MACA,MACA,SACA,cACA,MACA,OACA,QACA,OACA,QACA,OACA,QACA,QACA,OACA,QACA,MACA,OACA,oBACA,eACA,qBACA,QACA,UACA,cACA,WACA,MACA,eACA,eACA,MACA,OACA,cACA,cACA,kBACA,mBACA,QACA,MACA,QACA,QACA,aACA,cACA,QACA,SACA,MACA,OACA,MACA,MACA,MACA,OACA,YACA,MACA,gBACA,UACA,UACA,UACA,cACA,QACA,WACA,OACA,MACA,OACA,aACA,OACA,OACA,MACA,OACA,YACA,QACA,OACA,aACA,WACA,OACA,aACA,WACA,SACA,eACA,aACA,oBACA,gBACA,uBACA,cACA,mBACA,mBACA,oBACA,gBACA,oBACA,uBACA,4BACA,oBACA,qBACA,+BACA,eACA,aACA,cACA,YACA,YACA,YACA,YACA,YACA,WACA,YACA,iBACA,4BACA,eACA,eACA,WACA,WACA,eACA,gBACA,gBACA,gBACA,gBACA,iBACA,iBACA,aACA,aACA,kBACA,kBACA,kBACA,iBACA,iBACA,mBACA,uBACA,cACA,uBACA,uBACA,cACA,cACA,cACA,iBACA,oBACA,yBACA,gBACA,cACA,cACA,cACA,uBACA,uBACA,aACA,kBACA,sBACA,oBACA,qBACA,cACA,gBACA,mBACA,YACA,WAAA,CAAA,EAQW4H,EAAP,cAAyBnB,EAAAA,CAC7B,aAAAvG,CACEjC,MAAAA,CACD,CAAA,EAQU4J,GAAP,cAAwBD,CAAAA,CAU5B,YACE7K,EACA+K,EACAlI,EACAmI,EACA7J,EACAC,EAAAA,CAEAF,MAAAA,EAVFhB,KAAA8C,MAAuB,IAAIC,IAWzB/C,KAAKF,KAAOA,EACZE,KAAK6K,KAAOA,EACZ7K,KAAK2C,WAAaA,EAClB3C,KAAK8K,KAAOA,EACZ9K,KAAKiB,UAAYA,EACjBjB,KAAKkB,QAAUA,CAChB,CAED,IAAA,aAAI0I,CACF,MAAO,UACR,CAED,OAAOC,EAAAA,CAC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",
  "names": ["toString", "isAnyArray", "value", "tag", "exports", "require_lib", "__commonJSMin", "exports", "module", "isAnyArray", "max", "input", "options", "fromIndex", "toIndex", "maxValue", "i", "require_lib", "__commonJSMin", "exports", "module", "isAnyArray", "min", "input", "options", "fromIndex", "toIndex", "minValue", "i", "require_lib", "__commonJSMin", "exports", "module", "isAnyArray", "max", "min", "_interopDefaultLegacy", "e", "max__default", "min__default", "rescale", "input", "options", "output", "currentMin", "currentMax", "minValue", "maxValue", "factor", "i", "require_matrix", "__commonJSMin", "exports", "isAnyArray", "rescale", "indent", "indentData", "inspectMatrix", "inspectMatrixWithOptions", "matrix", "options", "maxRows", "maxColumns", "maxNumSize", "padMinus", "inspectData", "rows", "columns", "maxI", "maxJ", "result", "loop", "i", "j", "line", "formatNumber", "num", "formatNumber2", "len", "str", "fix", "exp", "installMathOperations", "AbstractMatrix", "Matrix", "value", "arg0", "checkRowIndex", "index", "outer", "max", "checkColumnIndex", "checkRowVector", "vector", "checkColumnVector", "checkRowIndices", "rowIndices", "checkColumnIndices", "columnIndices", "checkRange", "startRow", "endRow", "startColumn", "endColumn", "checkNumber", "newArray", "length", "array", "name", "checkNonEmpty", "sumByRow", "sum", "sumByColumn", "sumAll", "v", "productByRow", "productByColumn", "productAll", "varianceByRow", "unbiased", "mean", "cols", "variance", "sum1", "sum2", "x", "varianceByColumn", "varianceAll", "size", "centerByRow", "centerByColumn", "centerAll", "getScaleByRow", "scale", "scaleByRow", "getScaleByColumn", "scaleByColumn", "getScaleAll", "divider", "scaleAll", "_AbstractMatrix", "newRows", "newColumns", "newData", "newMatrix", "row", "column", "random", "min", "interval", "data", "l", "matrix1", "matrix2", "callback", "copy", "previousColumn", "isEchelonForm", "checked", "isReducedEchelonForm", "k", "h", "iMax", "tmp", "factor", "m", "n", "p", "pivot", "row1", "row2", "temp", "column1", "column2", "by", "idx", "diag", "type", "vector2", "vector1", "dot", "other", "Bcolj", "s", "scalar", "bb", "e", "a11", "b11", "a12", "b12", "a21", "b21", "a22", "b22", "m1", "m2", "m3", "m4", "m5", "m6", "m7", "c00", "c01", "c10", "c11", "a00", "a01", "a02", "a10", "a20", "b00", "b01", "b02", "b10", "b20", "m8", "m9", "m10", "m11", "m12", "m13", "m14", "m15", "m16", "m17", "m18", "m19", "m20", "m21", "m22", "m23", "c02", "c12", "c20", "c21", "c22", "y", "r1", "c1", "r2", "c2", "embed", "mat", "r", "c", "resultat", "blockMult", "a", "b", "halfRows", "halfCols", "middle", "first", "last", "q", "AxI", "IxB", "compareFunction", "compareNumbers", "indices", "rowIndex", "columnIndex", "trace", "from", "to", "center", "col", "isArrayOfNumbers", "element", "_Matrix", "#initData", "nRows", "nColumns", "arrayData", "newRow", "SymmetricMatrix", "_SymmetricMatrix", "#matrix", "diagonalSize", "mask", "sidesToRemove", "passthroughs", "sideIndex", "compact", "compactSize", "DistanceMatrix", "_DistanceMatrix", "sideSize", "compactLength", "BaseView", "MatrixColumnView", "MatrixColumnSelectionView", "MatrixFlipColumnView", "MatrixFlipRowView", "MatrixRowView", "MatrixRowSelectionView", "MatrixSelectionView", "MatrixSubView", "MatrixTransposeView", "WrapperMatrix1D", "WrapperMatrix2D", "wrap", "LuDecomposition", "lu", "pivotVector", "pivotSign", "t", "LUcolj", "kmax", "count", "X", "determinant", "hypotenuse", "QrDecomposition", "qr", "rdiag", "nrm", "SingularValueDecomposition", "computeLeftSingularVectors", "computeRightSingularVectors", "autoTranspose", "wantu", "wantv", "swapped", "aux", "nu", "ni", "U", "V", "work", "si", "nct", "nrt", "mrc", "pp", "eps", "kase", "alpha", "ks", "f", "cs", "sn", "sp", "spm1", "epm1", "sk", "ek", "shift", "g", "Y", "scols", "Ls", "VL", "vrows", "urows", "VLU", "vcols", "ucols", "tol", "ii", "inverse", "useSVD", "solve", "leftHandSide", "rightHandSide", "d", "subMatrix0", "subMatrix1", "subMatrix2", "xrange", "exception", "range", "dependenciesOneRow", "error", "thresholdValue", "thresholdError", "returnArray", "linearDependencies", "results", "Abis", "pseudoInverse", "threshold", "svdSolution", "covariance", "xMatrix", "yMatrix", "yIsSame", "cov", "correlation", "sdx", "sdy", "corr", "EigenvalueDecomposition", "assumeSymmetric", "isSymmetric", "tred2", "tql2", "H", "ort", "orthes", "hqr2", "hh", "dl1", "c3", "el1", "s2", "tst1", "low", "high", "nn", "exshift", "norm", "z", "iter", "w", "ra", "sa", "vr", "vi", "notlast", "cdivres", "cdiv", "xr", "xi", "yr", "yi", "CholeskyDecomposition", "dimension", "positiveDefinite", "B", "nipals", "scaleScores", "maxIterations", "terminationCriteria", "u", "diff", "tOld", "counter", "xResidual", "residual", "yResidual", "MainCanvas", "canvas", "GBUFFER_PASS", "GBUFFER_SUBMIT", "LIGHTING_PASS", "perspectiveWebgpu", "fieldOfViewInRadians", "aspectRatio", "near", "far", "f", "rangeInv", "createGBufferTextures", "device", "dimensions", "albedo", "normal", "position", "depth", "createLightingTextures", "screenSizedTexture", "scaleFactor", "format", "mipLevelCount", "d", "color", "color2", "createBufferFromData", "data", "usage", "label", "buf", "maybeUpdateTextures", "existing", "outTextures", "fullscreenQuad2DBuffer", "DeferredWebgpuRenderer", "waitFor", "canvas", "MainCanvas", "ctx", "device", "format", "onResizeCallbacks", "resize", "cb", "ret", "maybeUpdateTextures", "fullscreenQuad2DBuffer", "translate", "value", "state", "scheduleTask", "textures", "fullscreenQuad", "perspectiveWebgpu", "encoder", "gbufferPass", "GBUFFER_SUBMIT", "GBUFFER_PASS", "parseFromContext", "data", "loaders", "options", "context", "assert", "condition", "message", "globals", "self_", "window_", "global_", "document_", "isBrowser", "matches", "nodeVersion", "window_", "document_", "process_", "console_", "navigator_", "isElectron", "mockUserAgent", "realUserAgent", "userAgent", "isBrowser", "isElectron", "VERSION", "getStorage", "type", "storage", "x", "LocalStorage", "id", "defaultConfig", "configuration", "serialized", "serializedConfiguration", "formatTime", "ms", "formatted", "leftPad", "string", "length", "padLength", "COLOR", "BACKGROUND_INCREMENT", "getColor", "color", "addColor", "string", "background", "isBrowser", "autobind", "obj", "predefined", "proto", "propNames", "object", "key", "value", "name", "assert", "condition", "message", "getHiResTimestamp", "timestamp", "isBrowser", "window_", "process_", "timeParts", "originalConsole", "isBrowser", "DEFAULT_LOG_CONFIGURATION", "noop", "cache", "ONCE", "Log", "id", "VERSION", "getHiResTimestamp", "LocalStorage", "autobind", "newLevel", "newPriority", "enabled", "level", "setting", "value", "condition", "message", "oldUsage", "newUsage", "logLevel", "table", "columns", "getTableHeader", "opts", "options", "normalizeArguments", "collapsed", "func", "normalizeLogLevel", "method", "args", "assert", "tag", "decorateMessage", "resolvedLevel", "messageType", "time", "leftPad", "formatTime", "addColor", "key", "title", "dist_default", "Log", "VERSION", "version", "createLog", "log", "Log", "mergeLoaderOptions", "baseOptions", "newOptions", "mergeOptionsRecursively", "level", "options", "key", "newValue", "registerJSModules", "modules", "getJSModuleOrNull", "name", "NPM_TAG", "getVersion", "VERSION", "assert", "condition", "message", "globals", "self_", "window_", "global_", "document_", "isBrowser", "isWorker", "isMobile", "matches", "nodeVersion", "WorkerJob", "jobName", "workerThread", "resolve", "reject", "type", "payload", "value", "assert", "error", "NodeWorker", "workerURLCache", "getLoadableWorkerURL", "props", "assert", "workerURL", "getLoadableWorkerURLFromURL", "getLoadableWorkerURLFromSource", "url", "workerSource", "buildScriptSource", "blob", "workerUrl", "getTransferList", "object", "recursive", "transfers", "transfersSet", "isTransferable", "key", "NOOP", "WorkerThread", "isBrowser", "NodeWorker", "props", "name", "source", "url", "assert", "error", "data", "transferList", "getTransferList", "event", "message", "getLoadableWorkerURL", "worker", "code", "WorkerPool", "WorkerThread", "props", "worker", "name", "onMessage", "job", "type", "data", "onError", "error", "startPromise", "onStart", "workerThread", "queuedJob", "WorkerJob", "isBrowser", "isMobile", "DEFAULT_PROPS", "WorkerFarm", "_WorkerFarm", "WorkerThread", "props", "workerPool", "options", "name", "source", "url", "WorkerPool", "getWorkerURL", "worker", "options", "workerOptions", "workerFile", "isBrowser", "url", "version", "NPM_TAG", "versionTag", "assert", "validateWorkerVersion", "worker", "coreVersion", "VERSION", "assert", "workerVersion", "loadLibraryPromises", "loadLibrary", "libraryUrl", "moduleName", "options", "libraryName", "getLibraryUrl", "loadLibraryFromFile", "library", "modules", "isBrowser", "assert", "VERSION", "isWorker", "loadAsArrayBuffer", "requireFromFile", "error", "scriptSource", "loadAsText", "loadLibraryFromString", "id", "requireFromString", "script", "url", "readFileAsArrayBuffer", "readFileAsText", "canParseWithWorker", "loader", "options", "WorkerFarm", "isBrowser", "parseWithWorker", "data", "context", "parseOnMainThread", "name", "url", "getWorkerURL", "workerPool", "job", "onMessage", "type", "payload", "id", "input", "result", "error", "message", "getFirstCharacters", "data", "length", "getMagicString", "arrayBuffer", "byteOffset", "dataView", "magic", "i", "parseJSON", "string", "getFirstCharacters", "compareArrayBuffers", "arrayBuffer1", "arrayBuffer2", "byteLength", "array1", "array2", "i", "concatenateArrayBuffers", "sources", "concatenateArrayBuffersFromArray", "sourceArrays", "source2", "length", "typedArray", "result", "offset", "sourceArray", "sliceArrayBuffer", "arrayBuffer", "byteOffset", "byteLength", "subArray", "padToNBytes", "byteLength", "padding", "assert", "copyToArray", "source", "target", "targetOffset", "sourceArray", "srcByteOffset", "srcByteLength", "padToNBytes", "concatenateArrayBuffersAsync", "asyncIterator", "arrayBuffers", "chunk", "concatenateArrayBuffers", "pathPrefix", "fileAliases", "resolvePath", "filename", "alias", "fileAliases", "replacement", "pathPrefix", "isBuffer", "value", "toArrayBuffer", "data", "isBuffer", "text", "path_exports", "__export", "dirname", "filename", "join", "resolve", "getCWD", "pathname", "filename", "url", "slashIndex", "dirname", "join", "parts", "part", "index", "resolve", "components", "paths", "_i", "resolvedPath", "resolvedAbsolute", "cwd", "i", "path", "getCWD", "SLASH", "normalizeStringPosix", "DOT", "allowAboveRoot", "res", "lastSlash", "dots", "code", "isAboveRoot", "start", "j", "slice", "isBoolean", "x", "isFunction", "isObject", "isPureObject", "isIterable", "x", "isAsyncIterable", "isResponse", "x", "isBlob", "x", "isBuffer", "isReadableDOMStream", "x", "isObject", "isFunction", "isReadableNodeStream", "x", "isObject", "isFunction", "isBoolean", "isReadableStream", "isReadableDOMStream", "FetchError", "message", "info", "DATA_URL_PATTERN", "MIME_TYPE_PATTERN", "compareMIMETypes", "mimeType1", "mimeType2", "parseMIMEType", "mimeString", "matches", "parseMIMETypeFromURL", "url", "QUERY_STRING_PATTERN", "extractQueryString", "url", "matches", "stripQueryString", "shortenUrlForDisplay", "urlEnd", "getResourceUrl", "resource", "isResponse", "isBlob", "getResourceMIMEType", "response", "contentTypeHeader", "noQueryUrl", "stripQueryString", "parseMIMEType", "parseMIMETypeFromURL", "getResourceContentLength", "makeResponse", "resource", "isResponse", "headers", "contentLength", "getResourceContentLength", "url", "getResourceUrl", "type", "getResourceMIMEType", "initialDataUrl", "getInitialDataUrl", "response", "checkResponse", "getResponseError", "getResponseError", "response", "shortUrl", "shortenUrlForDisplay", "message", "info", "contentType", "FetchError", "getInitialDataUrl", "resource", "blobSlice", "resolve", "reader", "event", "slice", "arrayBufferToBase64", "buffer", "binary", "bytes", "i", "isNodePath", "url", "isRequestURL", "isDataURL", "fetchFile", "urlOrData", "fetchOptions", "resolvePath", "makeResponse", "probeLog", "Log", "NullLog", "ConsoleLog", "args", "DEFAULT_LOADER_OPTIONS", "ConsoleLog", "isBrowser", "REMOVED_LOADER_OPTIONS", "getGlobalLoaderState", "loaders", "getGlobalLoaderOptions", "state", "DEFAULT_LOADER_OPTIONS", "normalizeOptions", "options", "loader", "loaders", "url", "validateOptions", "normalizeOptionsInternal", "validateOptionsObject", "DEFAULT_LOADER_OPTIONS", "REMOVED_LOADER_OPTIONS", "idOptions", "loaderOptions", "deprecatedOptions", "id", "defaultOptions", "loaderName", "prefix", "key", "isSubOptions", "isObject", "isBaseUriOption", "isWorkerUrlOption", "probeLog", "suggestion", "findSimilarOption", "optionKey", "lowerCaseOptionKey", "bestSuggestion", "lowerCaseKey", "mergedOptions", "addUrlOptions", "NullLog", "mergeNestedFields", "getGlobalLoaderOptions", "value", "isPureObject", "isLoaderObject", "loader", "normalizeLoader", "assert", "options", "getGlobalLoaderRegistry", "state", "getGlobalLoaderState", "getRegisteredLoaders", "getGlobalLoaderRegistry", "EXT_PATTERN", "selectLoader", "data", "loaders", "options", "context", "validHTTPResponse", "loader", "selectLoaderSync", "isBlob", "getNoValidLoaderMessage", "normalizeLoader", "candidateLoaders", "getRegisteredLoaders", "normalizeLoaders", "selectLoaderInternal", "url", "getResourceUrl", "type", "getResourceMIMEType", "testUrl", "stripQueryString", "reason", "findLoaderByMIMEType", "findLoaderByUrl", "findLoaderByInitialBytes", "getFirstCharacters", "log", "message", "path_exports", "firstCharacters", "match", "extension", "findLoaderByExtension", "loaderExtension", "mimeType", "mimeType1", "compareMIMETypes", "testDataAgainstText", "testDataAgainstBinary", "test", "byteOffset", "testBinary", "compareArrayBuffers", "magic", "getMagicString", "length", "arrayBuffer", "dataView", "i", "makeStringIterator", "string", "options", "chunkSize", "offset", "textEncoder", "chunkLength", "chunk", "makeArrayBufferIterator", "arrayBuffer", "options", "chunkSize", "byteOffset", "chunkByteLength", "chunk", "sourceArray", "makeBlobIterator", "blob", "options", "chunkSize", "offset", "end", "chunk", "makeStreamIterator", "stream", "options", "isBrowser", "makeBrowserStreamIterator", "makeNodeStreamIterator", "reader", "nextBatchPromise", "currentBatchPromise", "done", "value", "toArrayBuffer", "chunk", "makeIterator", "data", "options", "makeStringIterator", "makeArrayBufferIterator", "isBlob", "makeBlobIterator", "isReadableStream", "makeStreamIterator", "isResponse", "ERR_DATA", "getArrayBufferOrStringFromDataSync", "data", "loader", "options", "isBuffer", "arrayBuffer", "byteLength", "getArrayBufferOrStringFromData", "isArrayBuffer", "isBlob", "makeResponse", "isResponse", "response", "checkResponse", "isReadableStream", "makeIterator", "isIterable", "isAsyncIterable", "concatenateArrayBuffersAsync", "getFetchFunction", "options", "context", "globalOptions", "getGlobalLoaderOptions", "loaderOptions", "isObject", "url", "fetchFile", "getLoaderContext", "context", "options", "parentContext", "newContext", "getFetchFunction", "baseUrl", "stripQueryString", "extractQueryString", "path_exports", "getLoadersFromContext", "loaders", "candidateLoaders", "contextLoaders", "parse", "data", "loaders", "options", "context", "isLoaderObject", "url", "getResourceUrl", "candidateLoaders", "getLoadersFromContext", "loader", "selectLoader", "normalizeOptions", "getLoaderContext", "parseWithLoader", "validateWorkerVersion", "mergeLoaderOptions", "isResponse", "response", "ok", "redirected", "status", "statusText", "type", "headers", "getArrayBufferOrStringFromData", "loaderWithParser", "canParseWithWorker", "parseWithWorker", "assert", "getDataTypeFromTypedArray", "array", "getMeshBoundingBox", "attributes", "minX", "minY", "minZ", "maxX", "maxY", "maxZ", "positions", "len", "i", "x", "y", "z", "deduceMeshField", "name", "attribute", "optionalMetadata", "type", "getDataTypeFromTypedArray", "metadata", "makeMeshAttributeMetadata", "makeMeshAttributeMetadata", "attribute", "result", "EXT_mesh_features_exports", "__export", "createExtMeshFeatures", "decode", "encode", "name", "VERSION", "parseImageNode", "IMAGE_SUPPORTED", "IMAGE_BITMAP_SUPPORTED", "NODE_IMAGE_SUPPORTED", "DATA_SUPPORTED", "isBrowser", "isImageTypeSupported", "type", "getDefaultImageType", "getImageType", "image", "format", "getImageTypeOrNull", "getImageData", "image", "getImageType", "canvas", "context", "getImageTypeOrNull", "SVG_DATA_URL_PATTERN", "SVG_URL_PATTERN", "isSVG", "url", "getBlobOrSVGDataUrl", "arrayBuffer", "xmlText", "error", "getBlob", "parseToImage", "arrayBuffer", "options", "url", "blobOrDataUrl", "getBlobOrSVGDataUrl", "URL", "objectUrl", "loadToImage", "image", "resolve", "reject", "error", "message", "EMPTY_OBJECT", "imagebitmapOptionsSupported", "parseToImageBitmap", "arrayBuffer", "options", "url", "blob", "isSVG", "parseToImage", "getBlob", "imagebitmapOptions", "safeCreateImageBitmap", "isEmptyObject", "error", "object", "key", "getISOBMFFMediaType", "buffer", "checkString", "decodeMajorBrand", "getUTF8String", "array", "start", "end", "stringToBytes", "string", "character", "header", "offset", "headerBytes", "i", "BIG_ENDIAN", "LITTLE_ENDIAN", "getBinaryImageMetadata", "binaryData", "dataView", "toDataView", "getPngMetadata", "getJpegMetadata", "getGifMetadata", "getBmpMetadata", "getISOBMFFMetadata", "buffer", "mediaType", "getISOBMFFMediaType", "tableMarkers", "sofMarkers", "getJpegMarkers", "i", "marker", "data", "parseToNodeImage", "arrayBuffer", "options", "mimeType", "getBinaryImageMetadata", "parseImageNode", "assert", "parseImage", "arrayBuffer", "options", "context", "imageType", "url", "loadType", "getLoadableImageType", "image", "parseToImageBitmap", "parseToImage", "parseToNodeImage", "assert", "getImageData", "type", "getDefaultImageType", "isImageTypeSupported", "EXTENSIONS", "MIME_TYPES", "DEFAULT_IMAGE_LOADER_OPTIONS", "ImageLoader", "VERSION", "parseImage", "arrayBuffer", "getBinaryImageMetadata", "mimeTypeSupportedSync", "isImageFormatSupported", "mimeType", "supported", "isBrowser", "checkBrowserImageFormatSupport", "checkNodeImageFormatSupport", "NODE_FORMAT_SUPPORT", "imageFormatsNode", "testBrowserImageFormatSupport", "testBrowserImageFormatSupport", "mimeType", "assert", "condition", "message", "COMPONENTS", "BYTES", "TYPES", "ARRAY_CONSTRUCTOR_TO_WEBGL_CONSTANT", "ARRAY_TO_COMPONENT_TYPE", "ATTRIBUTE_TYPE_TO_COMPONENTS", "ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE", "ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY", "getAccessorTypeFromSize", "size", "getComponentTypeFromArray", "typedArray", "componentType", "getAccessorArrayTypeAndLength", "accessor", "bufferView", "ArrayType", "components", "bytesPerComponent", "length", "byteLength", "assert", "componentByteSize", "BYTES", "numberOfComponentsInElement", "COMPONENTS", "getTypedArrayForBufferView", "json", "buffers", "bufferViewIndex", "bufferView", "assert", "bufferIndex", "binChunk", "byteOffset", "getTypedArrayForAccessor", "json", "buffers", "accessor", "gltfAccessor", "bufferView", "arrayBuffer", "bufferByteOffset", "byteOffset", "ArrayType", "length", "componentByteSize", "numberOfComponentsInElement", "getAccessorArrayTypeAndLength", "elementByteSize", "elementAddressScale", "result", "i", "values", "makeDefaultGLTFJson", "GLTFScenegraph", "gltf", "key", "extensionName", "isUsedExtension", "name", "isRequiredExtension", "isExtension", "extensions", "object", "index", "array", "bufferView", "bufferIndex", "binChunk", "assert", "byteOffset", "accessor", "gltfAccessor", "getTypedArrayForAccessor", "image", "arrayBuffer", "data", "extensionsRemoved", "extensionData", "ext", "sceneIndex", "scene", "nodeIndices", "node", "meshIndex", "matrix", "nodeData", "mesh", "attributes", "indices", "material", "mode", "glTFMesh", "indicesAccessor", "imageData", "mimeTypeOpt", "metadata", "getBinaryImageMetadata", "mimeType", "glTFImage", "buffer", "byteLength", "glTFBufferView", "padToNBytes", "bufferViewIndex", "glTFAccessor", "getAccessorTypeFromSize", "sourceBuffer", "minMax", "accessorDefaults", "getComponentTypeFromArray", "texture", "imageIndex", "glTFTexture", "pbrMaterialInfo", "totalByteLength", "targetArray", "dstByteOffset", "copyToArray", "string", "found", "result", "attributeKey", "attributeData", "attrName", "attributeName", "size", "initValues", "value", "componentIndex", "emod", "n", "ATTRIBUTE_TYPE_TO_COMPONENTS", "ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY", "ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE", "getArrayElementByteSize", "attributeType", "componentType", "getOffsetsForProperty", "scenegraph", "bufferViewIndex", "offsetType", "numberOfElements", "arrayOffsetsBytes", "arrayOffsets", "convertRawBufferToMetadataArray", "data", "elementCount", "numberOfComponents", "ArrayType", "size", "length", "byteLength", "buffer", "offset", "getPrimitiveTextureData", "textureInfo", "primitive", "texCoordAccessorKey", "texCoordAccessorIndex", "textureCoordinates", "json", "textureIndex", "imageIndex", "mimeType", "parsedImage", "textureData", "index", "value", "getImageValueByCoordinates", "primitivePropertyDataToAttributes", "attributeName", "propertyData", "featureTable", "featureIndices", "texelData", "item", "typedArray", "bufferIndex", "accessorIndex", "getComponentTypeFromArray", "channels", "CHANNELS_MAP", "u", "v", "components", "coordinatesToOffset", "c", "map", "imageOffset", "imageData", "getImageData", "imageValue", "componentsCount", "w", "iX", "indX", "h", "iY", "indY", "parseVariableLengthArrayNumeric", "valuesData", "valuesDataBytesLength", "valueSize", "attributeValueArray", "arrayOffset", "arrayByteSize", "typedArrayOffset", "parseFixedLengthArrayNumeric", "arrayCount", "elementOffset", "getPropertyDataString", "valuesDataBytes", "stringOffsets", "stringsArray", "textDecoder", "stringOffset", "stringByteSize", "stringData", "stringAttribute", "EXT_MESH_FEATURES_NAME", "name", "decode", "gltfData", "options", "scenegraph", "GLTFScenegraph", "decodeExtMeshFeatures", "encode", "encodeExtMeshFeatures", "json", "mesh", "primitive", "processMeshPrimitiveFeatures", "featureIds", "featureId", "featureIdData", "accessorKey", "accessorIndex", "getPrimitiveTextureData", "meshes", "encodeExtMeshFeaturesForPrimitive", "createExtMeshFeatures", "featureIdArray", "propertyTableIndex", "extension", "elementIndex", "index", "createAccessorKey", "typedArray", "bufferViewIndex", "getComponentTypeFromArray", "attributes", "prefix", "attrs", "item", "max", "a", "n", "EXT_structural_metadata_exports", "__export", "createExtStructuralMetadata", "decode", "encode", "name", "EXT_STRUCTURAL_METADATA_NAME", "name", "decode", "gltfData", "options", "scenegraph", "GLTFScenegraph", "decodeExtStructuralMetadata", "encode", "encodeExtStructuralMetadata", "extension", "decodePropertyTextures", "decodePropertyTables", "propertyTextures", "json", "mesh", "primitive", "processPrimitivePropertyTextures", "schema", "schemaClasses", "propertyTables", "schemaName", "propertyTable", "findPropertyTableByClass", "processPropertyTable", "schemaClassName", "primitivePropertyTextureIndices", "primitivePropertyTextureIndex", "propertyTexture", "processPrimitivePropertyTexture", "className", "propertyName", "attributeName", "textureInfoTopLevel", "featureTextureTable", "propertyData", "getPrimitiveTextureData", "primitivePropertyDataToAttributes", "schemaClass", "numberOfElements", "classProperty", "propertyTableProperty", "data", "getPropertyDataFromBinarySource", "valuesBufferView", "valuesDataBytes", "arrayOffsets", "getArrayOffsetsForProperty", "stringOffsets", "getStringOffsetsForProperty", "getPropertyDataNumeric", "getPropertyDataString", "getPropertyDataENUM", "getOffsetsForProperty", "isArray", "arrayCount", "elementSize", "getArrayElementByteSize", "elementCount", "valuesData", "convertRawBufferToMetadataArray", "parseVariableLengthArrayNumeric", "parseFixedLengthArrayNumeric", "enumType", "enumEntry", "enumValueType", "parseVariableLengthArrayENUM", "parseFixedLengthArrayENUM", "getEnumsArray", "params", "valuesDataBytesLength", "attributeValueArray", "index", "arrayOffset", "arrayByteSize", "typedArrayOffset", "array", "elementOffset", "offset", "count", "i", "value", "enumObject", "getEnumByValue", "enumValue", "SCHEMA_CLASS_ID_DEFAULT", "table", "classId", "encodeProperties", "tableProperty", "createPropertyTableProperty", "createExtStructuralMetadata", "propertyAttributes", "createSchema", "createPropertyTable", "schemaToUpdate", "attribute", "values", "prop", "stringData", "createPropertyDataString", "createBufferView", "createPropertyDataScalar", "COMPONENT_TYPE_TO_ARRAY_CONSTRUCTOR", "componentType", "numberArray", "Construct", "strings", "utf8Encode", "arr", "len", "str", "uint8Array", "strArray", "strOffsets", "stringOffsetsTypedArray", "typedArray", "EXT_feature_metadata_exports", "__export", "decode", "name", "EXT_FEATURE_METADATA_NAME", "name", "decode", "gltfData", "options", "scenegraph", "GLTFScenegraph", "decodeExtFeatureMetadata", "extension", "decodePropertyTextures", "decodePropertyTables", "schema", "schemaClasses", "featureTextures", "schemaName", "schemaClass", "featureTexture", "findFeatureTextureByClass", "handleFeatureTextureProperties", "propertyTables", "propertyTable", "findPropertyTableByClass", "processPropertyTable", "schemaClassName", "propertyTableName", "featureTexturesName", "featureTable", "numberOfElements", "propertyName", "classProperty", "propertyTableProperty", "data", "getPropertyDataFromBinarySource", "attributeName", "featureTextureProperty", "getPropertyDataFromTexture", "numberOfFeatures", "featureTableProperty", "bufferView", "dataArray", "arrayOffsets", "getArrayOffsetsForProperty", "stringOffsets", "getStringOffsetsForProperty", "getPropertyDataString", "isNumericProperty", "getPropertyDataNumeric", "getOffsetsForProperty", "schemaProperty", "types", "valuesDataBytes", "isArray", "arrayCount", "attributeType", "componentType", "elementSize", "getArrayElementByteSize", "elementCount", "valuesData", "convertRawBufferToMetadataArray", "parseVariableLengthArrayNumeric", "parseFixedLengthArrayNumeric", "json", "featureTextureTable", "mesh", "primitive", "processPrimitiveTextures", "textureInfoTopLevel", "propertyData", "getPrimitiveTextureData", "primitivePropertyDataToAttributes", "VERSION", "VERSION", "BASIS_EXTERNAL_LIBRARIES", "loadBasisTranscoderPromise", "loadBasisTranscoderModule", "options", "registerJSModules", "basis", "getJSModuleOrNull", "loadBasisTranscoder", "BASIS", "wasmBinary", "loadLibrary", "initializeBasisTranscoderModule", "BasisModule", "resolve", "module", "BasisFile", "initializeBasis", "loadBasisEncoderPromise", "loadBasisEncoderModule", "modules", "loadBasisEncoder", "BASIS_ENCODER", "initializeBasisEncoderModule", "BasisEncoderModule", "KTX2File", "BasisEncoder", "GL_EXTENSIONS_CONSTANTS", "BROWSER_PREFIXES", "WEBGL_EXTENSIONS", "formats", "getSupportedGPUTextureFormats", "gl", "getWebGLContext", "prefix", "extension", "gpuTextureFormat", "KTX2_ID", "isKTX", "data", "id", "OutputFormat", "GL_EXTENSIONS_CONSTANTS", "parseBasis", "data", "options", "isKTX", "fileConstructors", "loadBasisEncoderModule", "parseKTX2File", "BasisFile", "loadBasisTranscoderModule", "parseBasisFile", "basisFile", "imageCount", "images", "imageIndex", "levelsCount", "levels", "levelIndex", "transcodeImage", "width", "height", "hasAlpha", "compressed", "format", "basisFormat", "getBasisOptions", "decodedSize", "decodedData", "KTX2File", "ktx2File", "transcodeKTX2Image", "alphaFlag", "selectSupportedBasisFormat", "supportedFormats", "getSupportedGPUTextureFormats", "BasisWorkerLoader", "VERSION", "BasisLoader", "parseBasis", "LITTLE_ENDIAN", "MAGIC_glTF", "GLB_FILE_HEADER_SIZE", "GLB_CHUNK_HEADER_SIZE", "GLB_CHUNK_TYPE_JSON", "GLB_CHUNK_TYPE_BIN", "GLB_V1_CONTENT_FORMAT_JSON", "GLB_CHUNK_TYPE_JSON_XVIZ_DEPRECATED", "GLB_CHUNK_TYPE_BIX_XVIZ_DEPRECATED", "getMagicString", "dataView", "byteOffset", "isGLB", "arrayBuffer", "options", "magic", "magic1", "parseGLBSync", "glb", "type", "version", "byteLength", "parseGLBV1", "parseGLBV2", "assert", "contentLength", "contentFormat", "parseJSONChunk", "parseBINChunk", "parseGLBChunksSync", "chunkLength", "chunkFormat", "padToNBytes", "jsonChunk", "jsonText", "resolveUrl", "url", "options", "baseUrl", "EXT_meshopt_compression_exports", "__export", "decode", "name", "wasm_base", "wasm_simd", "detector", "wasmpack", "FILTERS", "DECODERS", "meshoptDecodeGltfBuffer", "target", "count", "size", "source", "mode", "filter", "instance", "loadWasmInstance", "decode", "DECODERS", "FILTERS", "wasmPromise", "loadWasmModule", "wasm", "wasm_base", "detector", "wasm_simd", "result", "unpack", "data", "i", "ch", "write", "wasmpack", "fun", "sbrk", "count4", "tp", "sp", "heap", "res", "EXT_MESHOPT_COMPRESSION", "name", "decode", "gltfData", "options", "scenegraph", "GLTFScenegraph", "promises", "bufferViewIndex", "decodeMeshoptBufferView", "bufferView", "meshoptExtension", "byteOffset", "byteLength", "byteStride", "count", "mode", "filter", "bufferIndex", "buffer", "source", "result", "meshoptDecodeGltfBuffer", "EXT_texture_webp_exports", "__export", "name", "preprocess", "EXT_TEXTURE_WEBP", "name", "preprocess", "gltfData", "options", "scenegraph", "GLTFScenegraph", "isImageFormatSupported", "json", "texture", "extension", "KHR_texture_basisu_exports", "__export", "name", "preprocess", "KHR_TEXTURE_BASISU", "name", "preprocess", "gltfData", "options", "scene", "GLTFScenegraph", "json", "texture", "extension", "KHR_draco_mesh_compression_exports", "__export", "decode", "encode", "name", "preprocess", "VERSION", "DracoLoader", "VERSION", "getDracoSchema", "attributes", "loaderData", "indices", "metadata", "makeMetadata", "fields", "namedLoaderDataAttributes", "transformAttributesLoaderData", "attributeName", "attribute", "field", "getArrowFieldFromAttribute", "indicesField", "result", "key", "dracoAttribute", "metadataMap", "deduceMeshField", "serializedMetadata", "DRACO_TO_GLTF_ATTRIBUTE_NAME_MAP", "DRACO_DATA_TYPE_TO_TYPED_ARRAY_MAP", "INDEX_ITEM_SIZE", "DracoParser", "draco", "arrayBuffer", "options", "buffer", "geometry_type", "dracoGeometry", "dracoStatus", "message", "loaderData", "geometry", "boundingBox", "getMeshBoundingBox", "schema", "getDracoSchema", "metadata", "attributes", "dracoAttributes", "attributeId", "dracoAttribute", "quantization", "octahedron", "loaderAttribute", "attributeName", "values", "value", "size", "numIndices", "byteLength", "ptr", "dracoArray", "getUint32Array", "attribute", "TypedArrayCtor", "numComponents", "numValues", "dataType", "getDracoDataType", "uniqueId", "attributeUniqueId", "thisAttributeType", "dracoAttributeConstant", "entryName", "dracoMetadata", "result", "numEntries", "entryIndex", "intArray", "getInt32Array", "quantizedAttributes", "octahedronAttributes", "skipAttributes", "dracoAttributeName", "attribute_type", "type", "transform", "i", "attributeType", "DRACO_DECODER_VERSION", "DRACO_ENCODER_VERSION", "STATIC_DECODER_URL", "DRACO_EXTERNAL_LIBRARIES", "DRACO_EXTERNAL_LIBRARY_URLS", "loadDecoderPromise", "loadDracoDecoderModule", "options", "modules", "loadDecoderPromise", "draco", "loadDracoDecoder", "loadDracoDecoder", "options", "DracoDecoderModule", "wasmBinary", "loadLibrary", "DRACO_EXTERNAL_LIBRARY_URLS", "DRACO_EXTERNAL_LIBRARIES", "initializeDracoDecoder", "resolve", "draco", "DracoLoader", "parse", "arrayBuffer", "options", "draco", "loadDracoDecoderModule", "dracoParser", "DracoParser", "getGLTFAccessors", "attributes", "accessors", "name", "attribute", "glTFAccessor", "getGLTFAccessor", "buffer", "size", "count", "getAccessorData", "getAccessorTypeFromSize", "getComponentTypeFromArray", "toTypedArray", "array", "ArrayType", "convertTypedArrays", "KHR_DRACO_MESH_COMPRESSION", "name", "preprocess", "gltfData", "options", "context", "scenegraph", "GLTFScenegraph", "primitive", "makeMeshPrimitiveIterator", "decode", "promises", "decompressPrimitive", "encode", "mesh", "compressMesh", "dracoExtension", "buffer", "bufferCopy", "sliceArrayBuffer", "dracoOptions", "decodedData", "parseFromContext", "DracoLoader", "decodedAttributes", "getGLTFAccessors", "attributeName", "decodedAttribute", "accessorIndex", "accessor", "getGLTFAccessor", "checkPrimitive", "attributes", "indices", "mode", "compressedData", "fauxAccessors", "bufferViewIndex", "KHR_texture_transform_exports", "__export", "decode", "name", "RADIANS_TO_DEGREES", "DEGREES_TO_RADIANS", "DEFAULT_CONFIG", "config", "formatValue", "value", "precision", "config", "round", "isArray", "equals", "a", "b", "epsilon", "oldEpsilon", "config", "isArray", "i", "round", "value", "config", "MathArray", "array", "offset", "i", "targetArray", "targetObject", "arrayOrObject", "isArray", "target", "config", "opts", "string", "formatValue", "equals", "a", "b", "t", "ai", "endValue", "vector", "minVector", "maxVector", "vectors", "scale", "scalar", "valid", "min", "max", "validateVector", "v", "length", "i", "checkNumber", "value", "checkVector", "callerName", "config", "assert", "condition", "message", "Vector", "MathArray", "value", "checkNumber", "length", "i", "mathArray", "dist", "product", "vectors", "vector", "assert", "a", "b", "ARRAY_TYPE", "degree", "create", "out", "ARRAY_TYPE", "transformMat3", "out", "a", "m", "x", "y", "forEach", "vec", "create", "a", "stride", "offset", "count", "fn", "arg", "i", "l", "vec3_transformMat4AsVector", "out", "a", "m", "x", "y", "z", "w", "vec3_transformMat2", "vec4_transformMat3", "out", "a", "m", "x", "y", "z", "create", "out", "ARRAY_TYPE", "dot", "a", "b", "cross", "out", "ax", "ay", "az", "bx", "by", "bz", "transformMat4", "out", "a", "m", "x", "y", "z", "w", "transformMat3", "transformQuat", "q", "qx", "qy", "qz", "qw", "uvx", "uvy", "uvz", "uuvx", "uuvy", "uuvz", "w2", "rotateX", "b", "rad", "p", "r", "rotateY", "rotateZ", "angle", "ax", "ay", "az", "bx", "by", "bz", "mag", "cosine", "dot", "forEach", "vec", "create", "a", "stride", "offset", "count", "fn", "arg", "i", "l", "ORIGIN", "ZERO", "Vector3", "_Vector3", "Vector", "x", "y", "z", "isArray", "config", "checkNumber", "array", "object", "value", "vector", "angle", "cross", "radians", "origin", "rotateX", "rotateY", "rotateZ", "matrix4", "transformMat4", "vec3_transformMat4AsVector", "matrix3", "transformMat3", "matrix2", "vec3_transformMat2", "quaternion", "transformQuat", "Matrix", "MathArray", "string", "config", "row", "col", "i", "value", "checkNumber", "columnIndex", "result", "firstIndex", "columnVector", "transpose", "out", "a", "a01", "a02", "a12", "invert", "a00", "a10", "a11", "a20", "a21", "a22", "b01", "b11", "b21", "det", "determinant", "a", "a00", "a01", "a02", "a10", "a11", "a12", "a20", "a21", "a22", "multiply", "out", "b", "b00", "b01", "b02", "b10", "b11", "b12", "b20", "b21", "b22", "translate", "v", "x", "rotate", "rad", "s", "c", "scale", "y", "fromQuat", "out", "q", "x", "y", "z", "w", "x2", "y2", "z2", "xx", "yx", "yy", "zx", "zy", "zz", "wx", "wy", "wz", "INDICES", "IDENTITY_MATRIX", "Matrix3", "Matrix", "getIdentityMatrix", "getZeroMatrix", "array", "args", "object", "q", "fromQuat", "m00", "m10", "m20", "m01", "m11", "m21", "m02", "m12", "m22", "determinant", "transpose", "invert", "a", "multiply", "radians", "rotate", "factor", "scale", "vec", "translate", "vector", "result", "out", "transformMat3", "vec4_transformMat3", "checkVector", "ZERO_MATRIX3", "IDENTITY_MATRIX3", "KHR_TEXTURE_TRANSFORM", "name", "scratchVector", "Vector3", "scratchRotationMatrix", "Matrix3", "scratchScaleMatrix", "decode", "gltfData", "options", "GLTFScenegraph", "materials", "i", "transformTexCoords", "materialIndex", "material", "materialTextures", "processedTexCoords", "textureInfo", "transformPrimitives", "texture", "transformParameters", "getTransformParameters", "meshes", "mesh", "primitive", "transformPrimitive", "originalTexCoord", "texCoord", "original", "newTexCoord", "matrix", "makeTransformationMatrix", "texCoordAccessor", "accessor", "bufferView", "arrayBuffer", "bufferByteOffset", "byteOffset", "ArrayType", "length", "getAccessorArrayTypeAndLength", "bytes", "BYTES", "components", "COMPONENTS", "elementAddressScale", "result", "uv", "updateGltf", "createAttribute", "buffers", "newTexCoordArray", "originalAccessor", "bufferViews", "accessors", "extensionData", "offset", "rotation", "scale", "translationMatrix", "rotationMatrix", "scaleMatrix", "KHR_lights_punctual_exports", "__export", "decode", "encode", "name", "KHR_LIGHTS_PUNCTUAL", "name", "decode", "gltfData", "gltfScenegraph", "GLTFScenegraph", "json", "extension", "node", "nodeExtension", "encode", "assert", "light", "KHR_materials_unlit_exports", "__export", "decode", "encode", "name", "KHR_MATERIALS_UNLIT", "name", "decode", "gltfData", "gltfScenegraph", "GLTFScenegraph", "json", "material", "encode", "KHR_techniques_webgl_exports", "__export", "decode", "encode", "name", "KHR_TECHNIQUES_WEBGL", "name", "decode", "gltfData", "gltfScenegraph", "GLTFScenegraph", "json", "extension", "techniques", "resolveTechniques", "material", "materialExtension", "resolveValues", "encode", "options", "techniquesExtension", "programs", "shaders", "textDecoder", "shader", "program", "technique", "values", "uniform", "EXTENSIONS", "EXT_structural_metadata_exports", "EXT_mesh_features_exports", "EXT_meshopt_compression_exports", "EXT_texture_webp_exports", "KHR_texture_basisu_exports", "KHR_draco_mesh_compression_exports", "KHR_lights_punctual_exports", "KHR_materials_unlit_exports", "KHR_techniques_webgl_exports", "KHR_texture_transform_exports", "EXT_feature_metadata_exports", "preprocessExtensions", "gltf", "options", "context", "extensions", "EXTENSIONS", "extension", "useExtension", "decodeExtensions", "useExtension", "extensionName", "options", "excludes", "KHR_BINARY_GLTF", "preprocess", "gltfData", "gltfScenegraph", "GLTFScenegraph", "json", "image", "extension", "KHR_BINARY_GLTF", "GLTF_ARRAYS", "GLTF_KEYS", "GLTFV1Normalizer", "gltf", "options", "json", "preprocess", "arrayName", "mapName", "objectMap", "id", "object", "index", "texture", "mesh", "node", "primitive", "attributes", "indices", "material", "attributeName", "child", "scene", "topLevelArrayName", "key", "buffer", "textureId", "textureIndex", "normalizeGLTFV1", "parseGLTF", "gltf", "arrayBufferOrString", "byteOffset", "options", "context", "parseGLTFContainerSync", "normalizeGLTFV1", "preprocessExtensions", "loadBuffers", "loadImages", "decodeExtensions", "data", "isGLB", "parseJSON", "glb", "parseGLBSync", "assert", "buffers", "binChunks", "images", "i", "buffer", "fetch", "uri", "resolveUrl", "arrayBuffer", "imageIndices", "getReferencesImageIndices", "promises", "imageIndex", "loadImage", "textures", "texture", "image", "index", "array", "getTypedArrayForBufferView", "sliceArrayBuffer", "parsedImage", "parseFromContext", "ImageLoader", "BasisLoader", "selectSupportedBasisFormat", "GLTFLoader", "VERSION", "parse", "arrayBuffer", "options", "context", "byteOffset", "parseGLTF", "COMPONENTS", "BYTES", "GL_SAMPLER", "SAMPLER_PARAMETER_GLTF_TO_GL", "DEFAULT_SAMPLER_PARAMETERS", "makeDefaultSampler", "getBytesFromComponentType", "componentType", "getSizeFromAccessorType", "type", "GLTFPostProcessor", "gltf", "options", "json", "buffers", "images", "baseUri", "assert", "bufView", "i", "image", "sampler", "texture", "accessor", "material", "mesh", "node", "skin", "scene", "index", "array", "object", "gltfNode", "accum", "meshIndex", "child", "gltfSkin", "inverseBindMatrices", "gltfMesh", "gltfPrimitive", "primitive", "attributes", "attribute", "gltfMaterial", "mr", "gltfAccessor", "bytesPerComponent", "components", "bytesPerElement", "buffer", "ArrayType", "byteLength", "getAccessorArrayTypeAndLength", "byteOffset", "cutBuffer", "byteStride", "count", "result", "elementOffset", "gltfTexture", "gltfSampler", "key", "glEnum", "gltfImage", "preloadedImage", "gltfBufferView", "bufferIndex", "arrayBuffer", "gltfCamera", "camera", "postProcessGLTF", "PhysicsWorld", "RAPIER", "state", "instances", "c", "quatToAngleAxis", "quat", "s", "RigidBody", "Transform", "params", "_", "physicsWorld", "inst", "translation", "rotationQuat", "rotation", "mulMat4", "translate", "rotate", "RigidBodyCollider", "waitFor", "rigidBody", "uploadIndexedMeshToGPU", "device", "mesh", "createBufferFromData", "parametricTriangleMeshGeometry", "fn", "lo", "hi", "resolution", "vertCount", "indexCount", "vertices", "indices", "lowX", "lowY", "highX", "highY", "stepX", "stepY", "y", "x", "iVertices", "xIn", "yIn", "pt", "iIndices", "baseVertex", "uvSphere", "radius", "a", "b", "px", "pz", "py", "lighting_default", "lighting_default", "matrix", "matrix_default", "inverse", "inv4", "m", "M", "matrix_default", "inverse", "PointLightSource", "subsystem", "device", "canvasFormat", "onResize", "DeferredWebgpuRenderer", "lightingBindGroupLayout", "lightingUniformBindGroupLayout", "lightingPipeline", "lighting_default", "state", "uploadIndexedMeshToGPU", "uvSphere", "gbuffer", "params", "global", "deferredWebgpuRenderer", "uniformBuffer", "uniformBindGroup", "instances", "scheduleTask", "projectionMatrix", "viewMatrix", "textures", "ctx", "commandEncoder", "passEncoder", "cutoff", "i", "rad", "m", "mulMat4", "scale", "vp", "mvp", "lightPos", "mulMat4ByVec4", "buf", "makeUniformBuffer", "inv4", "LIGHTING_PASS", "GBUFFER_SUBMIT", "Transform", "gbuffer_default", "gbuffer_default", "SampleWebgpuRendererGeometry", "subsystem", "device", "DeferredWebgpuRenderer", "gbuffer_default", "params", "global", "deferredWebgpuRenderer", "uniformBuffer", "state", "instances", "scheduleTask", "viewMatrix", "projectionMatrix", "textures", "gBufferRenderPass", "gbufferPipeline", "passEncoder", "i", "buf", "makeUniformBuffer", "mulMat4", "GBUFFER_PASS", "Transform", "particles_default", "particles_default", "particle_forcefield_default", "ParticleForcefield", "subsystem", "device", "DeferredWebgpuRenderer", "particle_forcefield_default", "params", "global", "deferredWebgpuRenderer", "state", "instances", "scheduleTask", "viewMatrix", "projectionMatrix", "textures", "gBufferRenderPass", "commandEncoder", "compute", "i", "GBUFFER_PASS", "Transform", "ParticleSystem", "module", "particles_default", "blend", "particlesPipeline", "particlesForcefieldPipeline", "uniformBuffer", "aspect", "passEncoder", "buf", "makeUniformBuffer", "mulMat4", "PostprocessingPipeline", "initGlobal", "initResolutionDependent", "runFrame", "params", "global", "dependencies", "waitFor", "device", "canvas", "onResize", "ctx", "DeferredWebgpuRenderer", "post", "state", "scheduleTask", "subsystem", "textures", "LIGHTING_PASS", "delimitedSequenceRegex", "start", "end", "makeDelimitedReplacements", "str", "replacements", "r", "TypeInfo", "name", "attributes", "this", "size", "isArray", "isStruct", "isTemplate", "isPointer", "getTypeName", "MemberInfo", "type", "offset", "align", "members", "format", "count", "stride", "StructInfo", "super", "startLine", "endLine", "inUse", "ArrayInfo", "PointerInfo", "TemplateInfo", "access", "ResourceType", "VariableInfo", "group", "binding", "resourceType", "AliasInfo", "InputInfo", "locationType", "location", "interpolation", "OutputInfo", "OverrideInfo", "id", "ArgumentInfo", "FunctionInfo", "stage", "inputs", "outputs", "arguments", "returnType", "resources", "overrides", "calls", "Set", "EntryFunctions", "constructor", "vertex", "fragment", "compute", "float16ToFloat32", "float16", "s", "e", "f", "Math", "pow", "NaN", "Infinity", "float32View", "Float32Array", "int32View", "Int32Array", "buffer", "float16View", "Uint16Array", "float32ToFloat16", "float32", "f32", "sign", "exponent", "fraction", "shift", "uint32", "Uint32Array", "uint32ToFloat32", "float11ToFloat32", "f11", "u32", "getTexturePixel", "imageData", "x", "y", "z", "mipLevel", "height", "bytesPerRow", "texelByteSize", "pixelValue", "value", "uintValue", "gi", "bi", "f10", "numChannels", "i", "setPixelValue", "Int16Array", "f16", "TextureFormatInfo", "r8unorm", "bytesPerBlock", "blockWidth", "blockHeight", "isCompressed", "channels", "r8snorm", "r8uint", "r8sint", "rg8unorm", "rg8snorm", "rg8uint", "rg8sint", "rgba8unorm", "rgba8snorm", "rgba8uint", "rgba8sint", "bgra8unorm", "r16uint", "r16sint", "r16float", "rg16uint", "rg16sint", "rg16float", "rgba16uint", "rgba16sint", "rgba16float", "r32uint", "r32sint", "r32float", "rg32uint", "rg32sint", "rg32float", "rgba32uint", "rgba32sint", "rgba32float", "rgb10a2uint", "rgb10a2unorm", "rg11b10ufloat", "stencil8", "isDepthStencil", "hasDepth", "hasStencil", "depth16unorm", "depth24plus", "depthOnlyFormat", "depth32float", "stencilOnlyFormat", "rgb9e5ufloat", "Node", "_id", "line", "isAstNode", "astNodeType", "callback", "block", "_BlockStart", "instance", "node", "Array", "searchBlock", "search", "_BlockEnd", "context", "Error", "constEvaluate", "toString", "BuiltinFunctionNames", "Statement", "Function", "args", "body", "attr", "arg", "StaticAssert", "expression", "While", "condition", "Continuing", "loopId", "For", "init", "increment", "_a", "_b", "_c", "Var", "storage", "Override", "Let", "Const", "IncrementOperator", "AssignOperator", "TokenClass", "parse", "val", "key", "Increment", "operator", "variable", "Assign", "Call", "isBuiltin", "has", "Loop", "continuing", "Switch", "cases", "If", "elseif", "_else", "else", "Return", "Enable", "Requires", "extensions", "Diagnostic", "severity", "rule", "Alias", "Discard", "Break", "Continue", "Type", "t", "length", "tv", "_priority", "get", "i32", "x32", "bool", "void", "Map", "ForwardType", "Struct", "member", "TemplateType", "vec2f", "vec3f", "vec4f", "vec2i", "vec3i", "vec4i", "vec2u", "vec3u", "vec4u", "vec2h", "vec3h", "vec4h", "vec2b", "vec3b", "vec4b", "mat2x2f", "mat2x3f", "mat2x4f", "mat3x2f", "mat3x3f", "mat3x4f", "mat4x2f", "mat4x3f", "mat4x4f", "mat2x2h", "mat2x3h", "mat2x4h", "mat3x2h", "mat3x3h", "mat3x4h", "mat4x2h", "mat4x3h", "mat4x4h", "mat2x2i", "mat2x3i", "mat2x4i", "mat3x2i", "mat3x3i", "mat3x4i", "mat4x2i", "mat4x3i", "mat4x4i", "mat2x2u", "mat2x3u", "mat2x4u", "mat3x2u", "mat3x3u", "mat3x4u", "mat4x2u", "mat4x3u", "mat4x4u", "PointerType", "ArrayType", "SamplerType", "Expression", "postfix", "StringExpr", "constEvaluateString", "CreateExpr", "evalExpression", "CallExpr", "cachedReturnValue", "VariableExpr", "ConstExpr", "initializer", "data", "getSubData", "LiteralExpr", "isScalar", "ScalarData", "isVector", "VectorData", "MatrixData", "scalarValue", "console", "error", "vectorValue", "BitcastExpr", "ArrayIndex", "Expression", "index", "super", "this", "callback", "search", "Operator", "constructor", "UnaryOperator", "operator", "right", "astNodeType", "context", "type", "evalExpression", "BinaryOperator", "left", "t1", "t2", "name", "Type", "f32", "u32", "i32", "SwitchCase", "Node", "body", "searchBlock", "DefaultSelector", "Case", "selectors", "Default", "Argument", "attributes", "ElseIf", "condition", "Member", "Attribute", "value", "Data", "typeInfo", "parent", "id", "_id", "clone", "exec", "postfix", "console", "error", "toString", "getTypeName", "VoidData", "TypeInfo", "void", "PointerData", "reference", "PointerInfo", "setDataValue", "getSubData", "ScalarData", "Int32Array", "Uint32Array", "Float32Array", "data", "Math", "floor", "v", "_getVectorData", "values", "formatName", "size", "length", "VectorData", "getTypeInfo", "typename", "StringExpr", "format", "TemplateInfo", "typeName", "self", "idx", "i", "LiteralExpr", "d", "buffer", "byteOffset", "member", "toLowerCase", "m", "push", "s", "MatrixData", "endsWith", "formatSuffix", "vectorData", "TypedData", "offset", "ArrayBuffer", "cloned", "Uint8Array", "log", "ArrayInfo", "stride", "StructInfo", "found", "members", "element", "setData", "x", "byteLength", "set", "_i", "fa", "ua", "_a", "_b", "_c", "TextureData", "descriptor", "view", "width", "Array", "Object", "height", "depthOrArrayLayers", "sampleCount", "mipLevelCount", "dimension", "level", "max", "texelByteSize", "formatInfo", "TextureFormatInfo", "isDepthStencil", "bytesPerBlock", "bytesPerRow", "getGpuSize", "blockWidth", "blockHeight", "y", "z", "mipLevel", "getTexturePixel", "imageData", "setPixelValue", "TokenClass", "TokenType", "rule", "TokenTypes", "none", "reserved", "eof", "token", "asm", "bf16", "do", "enum", "f16", "f64", "handle", "i8", "i16", "i64", "mat", "premerge", "regardless", "typedef", "u8", "u16", "u64", "unless", "using", "vec", "keywords", "array", "keyword", "atomic", "bool", "mat2x2", "mat2x3", "mat2x4", "mat3x2", "mat3x3", "mat3x4", "mat4x2", "mat4x3", "mat4x4", "ptr", "sampler", "sampler_comparison", "struct", "texture_1d", "texture_2d", "texture_2d_array", "texture_3d", "texture_cube", "texture_cube_array", "texture_multisampled_2d", "texture_storage_1d", "texture_storage_2d", "texture_storage_2d_array", "texture_storage_3d", "texture_depth_2d", "texture_depth_2d_array", "texture_depth_cube", "texture_depth_cube_array", "texture_depth_multisampled_2d", "texture_external", "vec2", "vec3", "vec4", "bitcast", "block", "break", "case", "continue", "continuing", "default", "diagnostic", "discard", "else", "enable", "fallthrough", "false", "fn", "for", "function", "if", "let", "const", "loop", "while", "private", "read", "read_write", "return", "requires", "storage", "switch", "true", "alias", "uniform", "var", "override", "workgroup", "write", "r8unorm", "r8snorm", "r8uint", "r8sint", "r16uint", "r16sint", "r16float", "rg8unorm", "rg8snorm", "rg8uint", "rg8sint", "r32uint", "r32sint", "r32float", "rg16uint", "rg16sint", "rg16float", "rgba8unorm", "rgba8unorm_srgb", "rgba8snorm", "rgba8uint", "rgba8sint", "bgra8unorm", "bgra8unorm_srgb", "rgb10a2unorm", "rg11b10float", "rg32uint", "rg32sint", "rg32float", "rgba16uint", "rgba16sint", "rgba16float", "rgba32uint", "rgba32sint", "rgba32float", "static_assert", "tokens", "decimal_float_literal", "hex_float_literal", "int_literal", "uint_literal", "ident", "and", "and_and", "arrow", "attr", "forward_slash", "bang", "bracket_left", "bracket_right", "brace_left", "brace_right", "colon", "comma", "equal", "equal_equal", "not_equal", "greater_than", "greater_than_equal", "shift_right", "less_than", "less_than_equal", "shift_left", "modulo", "minus", "minus_minus", "period", "plus", "plus_plus", "or", "or_or", "paren_left", "paren_right", "semicolon", "star", "tilde", "underscore", "xor", "plus_equal", "minus_equal", "times_equal", "division_equal", "modulo_equal", "and_equal", "or_equal", "xor_equal", "shift_right_equal", "shift_left_equal", "simpleTokens", "literalTokens", "_", "regexTokens", "storage_class", "access_mode", "sampler_type", "sampled_texture_type", "multisampled_texture_type", "storage_texture_type", "depth_texture_type", "texture_external_type", "any_texture_type", "texel_format", "const_literal", "literal_or_ident", "element_count_expression", "template_types", "attribute_name", "assignment_operators", "increment_operators", "Token", "lexeme", "line", "start", "end", "isTemplateType", "indexOf", "isArrayType", "isArrayOrTemplateType", "WgslScanner", "source", "_tokens", "_start", "_current", "_line", "_source", "scanTokens", "_isAtEnd", "scanToken", "_advance", "_isWhitespace", "_peekAhead", "commentLevel", "simpleToken", "_addToken", "matchType", "isAlpha", "_isAlpha", "isUnderscore", "_isAlphaNumeric", "nextChar", "matchedType", "_findType", "nextLexeme", "ti", "foundLessThan", "count", "lookAheadLexeme", "lookAhead", "maxLookAhead", "li", "_match", "match", "c", "_isNumeric", "amount", "text", "substring", "isArray", "_f32", "_f32_i32", "_f32_u32", "_i32", "_i32_f32", "_i32_u32", "_u32", "_u32_f32", "_u32_i32", "castScalar", "from", "to", "_FunctionResources", "node", "resources", "inUse", "info", "_TypeSize", "align", "Reflect", "uniforms", "textures", "samplers", "aliases", "overrides", "structs", "entry", "EntryFunctions", "functions", "_types", "Map", "_functions", "ast", "Function", "Struct", "Alias", "_getAliasInfo", "Override", "_getAttributeNum", "OverrideInfo", "_isUniformVar", "g", "b", "varInfo", "VariableInfo", "ResourceType", "Uniform", "access", "_isStorageVar", "isStorageTexture", "_isStorageTexture", "StorageTexture", "Storage", "_isTextureVar", "Texture", "_isSamplerVar", "Sampler", "vertexStage", "_getAttribute", "fragmentStage", "computeStage", "stage", "FunctionInfo", "startLine", "endLine", "get", "_findResources", "inputs", "_getInputs", "args", "outputs", "_getOutputs", "returnType", "arguments", "map", "arg", "ArgumentInfo", "_addCalls", "calls", "VariableExpr", "u", "_markStructsInUse", "o", "isStruct", "isTemplate", "_getAlias", "call", "add", "group", "binding", "compute", "r", "vertex", "fragment", "t", "isEntry", "varStack", "_BlockStart", "_BlockEnd", "pop", "Var", "_markStructsFromAST", "CreateExpr", "Let", "_findResource", "CallExpr", "callFn", "Call", "getBindGroups", "groups", "_makeRoom", "undefined", "_getStructOutputs", "output", "_getOutputInfo", "location", "locationValue", "_parseInt", "OutputInfo", "_getStructInputs", "input", "_getInputInfo", "interpolation", "InputInfo", "_parseString", "n", "parseInt", "isNaN", "a", "AliasInfo", "has", "PointerType", "_updateTypeInfo", "ArrayType", "MemberInfo", "SamplerType", "formatIsType", "TemplateType", "typeSize", "_getTypeSize", "_updateStructInfo", "lastSize", "lastOffset", "structAlign", "mi", "ml", "sizeInfo", "_roundUp", "explicitSize", "explicitAlign", "_typeInfo", "divisor", "arrayType", "E", "_textureTypes", "_samplerTypes", "obj", "attrs", "defaultValue", "k", "ceil", "VarRef", "FunctionRef", "ExecContext", "variables", "currentFunctionName", "getVariable", "getFunction", "createVariable", "ExecInterface", "BuiltinFunctions", "isTrue", "forEach", "Error", "res", "some", "arrayArg", "arrayData", "ta", "abs", "acos", "acosh", "asin", "asinh", "atan", "atanh", "atan2", "ys", "xs", "min", "_clamp", "minS", "maxS", "cos", "cosh", "clz32", "_countOneBits", "_countTrailingZeros", "l", "lv", "rv", "radToDeg", "PI", "mv", "mt", "formatType", "sum", "sqrt", "ls", "rs", "e1", "e2", "dot", "_dot", "exp", "pow", "_firstLeadingBit", "log2", "_firstTrailingBit", "av", "bv", "cv", "insert", "mask", "invMask", "as", "Length", "e3", "sqrtK", "round", "sign", "sin", "sinh", "edge0", "edge1", "_smoothstep", "e0", "xS", "edge", "e", "tan", "tanh", "tname", "ttype", "_getTransposeType", "trunc", "textureArg", "textureName", "texture", "getVariableValue", "textureSize", "getMipLevelSize", "slice", "uv", "texel", "getPixel", "setPixel", "getVariableName", "currentValue", "originalValue", "VectorTypeSize", "vec2f", "vec2i", "vec2u", "vec2b", "vec2h", "vec3f", "vec3i", "vec3u", "vec3b", "vec3h", "vec4f", "vec4i", "vec4u", "vec4b", "vec4h", "MatrixTypeSize", "mat2x2f", "mat2x2h", "mat2x3f", "mat2x3h", "mat2x4f", "mat2x4h", "mat3x2f", "mat3x2h", "mat3x3f", "mat3x3h", "mat3x4f", "mat3x4h", "mat4x2f", "mat4x2h", "mat4x3f", "mat4x3h", "mat4x4f", "mat4x4h", "WgslExec", "reflection", "updateAST", "builtins", "config", "_setOverrides", "_execStatements", "kernel", "dispatchCount", "bindGroups", "f", "depth", "setVariable", "kernelRefl", "getFunctionInfo", "resource", "textureData", "_dispatchWorkgroup", "stmt", "Return", "Break", "_breakObj", "Continue", "_continueObj", "_let", "_var", "Const", "_const", "_function", "If", "_if", "Switch", "_switch", "For", "_for", "While", "_while", "Loop", "_loop", "Continuing", "subContext", "Assign", "_assign", "Increment", "_increment", "_call", "Diagnostic", "_evalBinaryOp", "_evalLiteral", "_evalVariable", "_evalCall", "_evalCreate", "ConstExpr", "_evalConst", "BitcastExpr", "_evalBitcast", "_evalUnaryOp", "getTypeInfoByName", "constants", "getOverrideInfo", "workgroup_id", "workgroupSize", "local_invocation_id", "global_invocation_id", "_dispatchExec", "globalName", "globalVar", "statements", "execStatement", "ai", "isBuiltin", "_callBuiltinFunction", "variable", "refData", "_getVariableData", "varData", "assignValue", "op", "rNode", "defType", "defaultCase", "cases", "selector", "selectorValue", "elseif", "init", "_getScalarValue", "increment", "fromType", "fromCast", "toType", "toCast", "cast", "_callConstructorValue", "_callConstructorVec", "_callConstructorMatrix", "memberInfo", "scalarValue", "tv", "_priority", "_r", "result", "rn", "_maxFormatTypeInfo", "_l", "la", "ra", "ln", "matrixA", "matrixB", "j", "colsB", "rowsA", "matrix", "vector", "cols", "rows", "resultVec", "cachedReturnValue", "All", "Any", "Select", "ArrayLength", "Abs", "Acos", "Acosh", "Asin", "Asinh", "Atan", "Atanh", "Atan2", "Ceil", "Clamp", "Cos", "Cosh", "CountLeadingZeros", "CountOneBits", "CountTrailingZeros", "Cross", "Degrees", "Determinant", "Distance", "Dot", "Dot4U8Packed", "Dot4I8Packed", "Exp", "Exp2", "ExtractBits", "FaceForward", "FirstLeadingBit", "FirstTrailingBit", "Floor", "Fma", "Fract", "Frexp", "InsertBits", "InverseSqrt", "Ldexp", "Log", "Log2", "Max", "Min", "Mix", "Modf", "Normalize", "Pow", "QuantizeToF16", "Radians", "Refract", "ReverseBits", "Round", "Saturate", "Sign", "Sin", "Sinh", "SmoothStep", "Sqrt", "Step", "Tan", "Tanh", "Transpose", "Trunc", "Dpdx", "DpdxCoarse", "DpdxFine", "Dpdy", "DpdyCoarse", "DpdyFine", "Fwidth", "FwidthCoarse", "FwidthFine", "TextureDimensions", "TextureGather", "TextureGatherCompare", "TextureLoad", "TextureNumLayers", "TextureNumLevels", "TextureNumSamples", "TextureSample", "TextureSampleBias", "TextureSampleCompare", "TextureSampleCompareLevel", "TextureSampleGrad", "TextureSampleLevel", "TextureSampleBaseClampToEdge", "TextureStore", "AtomicLoad", "AtomicStore", "AtomicAdd", "AtomicSub", "AtomicMax", "AtomicMin", "AtomicAnd", "AtomicOr", "AtomicXor", "AtomicExchange", "AtomicCompareExchangeWeak", "Pack4x8snorm", "Pack4x8unorm", "Pack4xI8", "Pack4xU8", "Pack4x8Clamp", "Pack4xU8Clamp", "Pack2x16snorm", "Pack2x16unorm", "Pack2x16float", "Unpack4x8snorm", "Unpack4x8unorm", "Unpack4xI8", "Unpack4xU8", "Unpack2x16snorm", "Unpack2x16unorm", "Unpack2x16float", "StorageBarrier", "TextureBarrier", "WorkgroupBarrier", "WorkgroupUniformLoad", "SubgroupAdd", "SubgroupExclusiveAdd", "SubgroupInclusiveAdd", "SubgroupAll", "SubgroupAnd", "SubgroupAny", "SubgroupBallot", "SubgroupBroadcast", "SubgroupBroadcastFirst", "SubgroupElect", "SubgroupMax", "SubgroupMin", "SubgroupMul", "SubgroupExclusiveMul", "SubgroupInclusiveMul", "SubgroupOr", "SubgroupShuffle", "SubgroupShuffleDown", "SubgroupShuffleUp", "SubgroupShuffleXor", "SubgroupXor", "QuadBroadcast", "QuadSwapDiagonal", "QuadSwapX", "QuadSwapY", "isVector", "vectorValue", "argValue", "vd", "fill", "ParseContext", "WgslParser", "_currentLine", "_deferArrayCountEval", "_currentLoop", "_context", "_exec", "_forwardTypeCount", "tokensOrCode", "_initialize", "statement", "_global_decl_or_directive", "arrayDecl", "countNode", "AST.VariableExpr", "constant", "constEvaluate", "AST.Member", "AST.PointerType", "_forwardType", "AST.ArrayType", "AST.Var", "AST.Let", "AST.Const", "AST.Function", "AST.Argument", "AST.ForwardType", "ft", "_getType", "scanner", "message", "_peek", "types", "_check", "_error", "tk", "hasNameType", "_previous", "_type_alias", "_consume", "directive", "_diagnostic", "_requires_directive", "_enable_directive", "_attribute", "_global_variable_decl", "_override", "_override_variable_decl", "_global_let_decl", "_global_const_decl", "_struct", "_struct_decl", "_fn", "_function_decl", "argAttrs", "typeAttrs", "_type_decl", "_updateNode", "_return", "_compound_statement", "_statement", "_if_statement", "_switch_statement", "_loop_statement", "_for_statement", "_while_statement", "_continuing_statement", "_static_assert_statement", "_return_statement", "_variable_statement", "AST.Discard", "breakStmt", "AST.Break", "loopId", "_optional_paren_expression", "continueStmt", "AST.Continue", "_increment_decrement_statement", "_func_call_statement", "_assignment_statement", "expression", "AST.StaticAssert", "whileLoop", "AST.While", "AST.Continuing", "forLoop", "AST.For", "_for_init", "_short_circuit_or_expression", "_for_increment", "_variable_decl", "AST.LiteralExpr", "savedPos", "_unary_expression", "AST.Increment", "AST.IncrementOperator", "decrement", "AST.Assign", "AST.AssignOperator", "parse", "_argument_expression_list", "AST.Call", "AST.Loop", "switchStmt", "AST.Switch", "_switch_body", "hasDefault", "_case_selectors", "AST.DefaultSelector", "_case_body", "AST.Case", "AST.Default", "_shift_expression", "nextStatement", "_match_elseif", "_elseif_statement", "_else", "AST.If", "AST.ElseIf", "AST.Return", "expr", "_short_circuit_and_expr", "AST.BinaryOperator", "_inclusive_or_expression", "_exclusive_or_expression", "_and_expression", "_equality_expression", "_relational_expression", "_additive_expression", "_multiplicative_expression", "AST.UnaryOperator", "_singular_expression", "_primary_expression", "p", "_postfix_expression", "arrayIndex", "AST.ArrayIndex", "AST.StringExpr", "_getStruct", "AST.Type", "AST.TemplateType", "mat2x2i", "mat2x3i", "mat2x4i", "mat3x2i", "mat3x3i", "mat3x4i", "mat4x2i", "mat4x3i", "mat4x4i", "mat2x2u", "mat2x3u", "mat2x4u", "mat3x2u", "mat3x3u", "mat3x4u", "mat4x2u", "mat4x3u", "mat4x4u", "AST.CreateExpr", "AST.CallExpr", "AST.ConstExpr", "x32", "_validateTypeRange", "fs", "isF16", "parseFloat", "_paren_expression", "AST.BitcastExpr", "memberAttrs", "memberName", "memberType", "structNode", "AST.Struct", "_const_expression", "isScalar", "_override_decl", "valueExpr", "constValue", "AST.Override", "severity", "ruleMessage", "AST.Diagnostic", "AST.Enable", "extensions", "AST.Requires", "aliasType", "aliasNode", "AST.Alias", "_texture_sampler_types", "pointer", "decl", "countInt", "AST.SamplerType", "AST.Attribute", "WgslReflect", "code", "update", "simple_filter_default", "createSimpleFilterShader", "params", "makeDelimitedReplacements", "simple_filter_default", "TEXTURE_FORMAT_TO_WGSL_TYPE_LUT", "createSimpleFilterPipeline", "device", "spec", "fragmentBody", "bindings", "bindingIndex", "samplers", "s", "nameToInputMap", "nameToOutputMap", "inputEntries", "name", "value", "outputStruct", "outputBindingIndex", "outputsEntries", "globals", "uniformName", "uniformType", "shaderSource", "reflectBindGroups", "_t", "module", "pipeline", "samplerBindGroup", "i", "buffer", "bindGroup", "ret", "values", "buf", "makeUniformBuffer", "inputs", "inputTextureBindGroup", "uniforms", "encoder", "outputs", "pass", "TrackCamera", "translate", "Transform", "DeferredWebgpuRenderer", "Mouse", "params", "invtrans", "mulMat4", "state", "instances", "subsystem", "mouse", "movement", "scroll", "add2", "scale2", "xAxis", "yAxis", "rotate", "PhysicalPlayerController", "global", "segments", "i", "range", "waitFor", "Keyboard", "PhysicsWorld", "kbd", "e", "cam", "force", "add3", "rodrigues", "forceMag", "gltfMeshToWebGPUBuffers", "device", "mesh", "out", "prim", "meshBufs", "attrName", "attrValue", "attrBuffer", "createBufferFromData", "indexBuffer", "gltlfMeshToRapierTrimesh", "RAPIER", "position", "e", "indices", "main", "monkey", "parse", "GLTFLoader", "gltf", "g", "postProcessGLTF", "sys", "createSystem", "Transform", "DeferredWebgpuRenderer", "SampleWebgpuRendererGeometry", "RigidBody", "PhysicsWorld", "RigidBodyCollider", "MainCanvas", "PointLightSource", "ParticleSystem", "ParticleForcefield", "Keyboard", "Mouse", "PostprocessingPipeline", "device", "canvas", "createSimpleFilterPipeline", "ctx", "lighting", "res", "encoder", "PhysicalPlayerController", "TrackCamera", "mesh", "gltfMeshToWebGPUBuffers", "bg", "tunnel", "wormseg", "entities", "world", "RAPIER", "particleCount", "particlePositions", "createBufferFromData", "range", "x", "rand", "particleVelocities", "tex", "forceField", "cartesianProduct", "z", "y", "i", "translate", "particles", "background", "gltlfMeshToRapierTrimesh", "wormsegGeo", "PLAYER_COLLIDER_GROUP", "sys2", "player", "t", "renderer", "kbd", "pos", "vel", "viewRotation", "loop"]
}
